<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no" />

  <title>TicTac 3x5 - Play Online</title>
  <meta name="description" content="Play TicTac 3x5 with friends online or challenge the AI. Works offline with cached gameplay!" />

  <meta name="theme-color" content="#3b82f6" />
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="dns-prefetch" href="https://fonts.googleapis.com" />
  <link rel="dns-prefetch" href="https://fonts.gstatic.com" />

  <style>
    body,html{
      margin:0;
      font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;
      background:#fff;
    }
    #root { display:none; }

    #blocked {
      display:none;
      height:100vh;
      width:100vw;
      text-align:center;
      padding-top:120px;
      background:#f3f4f6;
    }
    #blocked h2{
      font-size:22px;
      color:#333;
    }
    #blocked button{
      margin-top:20px;
      padding:12px 30px;
      background:#3b82f6;
      border:none;
      border-radius:10px;
      color:white;
      font-size:17px;
      cursor:pointer;
    }
  </style>

</head>
<body>

<!-- âŒ WEBSITE VERSION USER BLOCK -->
<div id="blocked">
  <div style="font-size:50px;">ðŸš«</div>
  <h2>Access Denied</h2>
  <p>This game can only be played inside the official TicTac 3x5 app.</p>
  <button onclick="window.location.href='https://tictac3x5.darklayerstudios.com'">Download App</button>
</div>

<!-- âœ” REAL APP CONTENT -->
<div id="root">
  <div style="display:flex;align-items:center;justify-content:center;min-height:100vh;background:linear-gradient(135deg,#667eea,#764ba2);">
    <div style="text-align:center;color:white;">
      <div style="width:60px;height:60px;border:4px solid rgba(255,255,255,0.3);border-top-color:white;border-radius:50%;margin:0 auto 20px;animation:spin 1s linear infinite;"></div>
      <h2 style="font-size:24px;font-weight:600;margin:0 0 10px;">TicTac 3x5</h2>
      <p style="font-size:14px;opacity:0.9;margin:0;">Loading game...</p>
    </div>
  </div>
  <style>
    @keyframes spin {0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
  </style>
</div>

<script>
(function() {
  const UA = navigator.userAgent;

  // Detect if running inside app/WebView
  const isWebView =
      /wv|WebView|Crosswalk/i.test(UA) ||
      window.ReactNativeWebView ||
      (window.Android && typeof window.Android !== "undefined");

  if (isWebView) {
    // Allow access inside app
    document.getElementById("root").style.display = "block";
  } else {
    // Block browser users
    document.getElementById("blocked").style.display = "block";
  }
})();
</script>


<!-- Service Worker (RESTORED) -->
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/sw.js', { scope: '/' })
      .then(reg => {
        console.log('Service Worker registered:', reg.scope);

        reg.addEventListener('updatefound', () => {
          const newWorker = reg.installing;
          if (newWorker) {
            newWorker.addEventListener('statechange', () => {
              if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                const event = new CustomEvent('serviceWorkerUpdateAvailable', { detail: newWorker });
                window.dispatchEvent(event);
              }
            });
          }
        });
      })
      .catch(err => console.warn('SW registration failed:', err));
  });

  let refreshing = false;
  navigator.serviceWorker.addEventListener('controllerchange', () => {
    if (!refreshing) {
      refreshing = true;
      window.location.reload();
    }
  });
}
</script>

<script type="module" src="/src/main.tsx"></script>
<script src="https://replit.com/public/js/replit-dev-banner.js"></script>
</body>
</html>