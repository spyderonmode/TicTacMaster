{"file_contents":{"DATABASE_MIGRATION_GUIDE.md":{"content":"# Database Migration Guide: Moving to Your Own Neon Database\n\n## Overview\nThis guide helps you migrate from the current Replit-managed Neon database to your own Neon account for full database ownership and portability.\n\n## Benefits of Your Own Neon Database\n- **Full Control**: Complete ownership of your database\n- **Portability**: Database travels with you to any hosting provider\n- **Backup Control**: Direct access to export/import your data\n- **No Vendor Lock-in**: Standard PostgreSQL works everywhere\n- **Migration Ready**: Easy to move between hosting providers\n\n## Step 1: Create Your Neon Account\n\n1. Visit [neon.tech](https://neon.tech)\n2. Sign up for a free account\n3. Create a new project\n4. Choose your preferred region (recommend US West 2 for best performance)\n\n## Step 2: Get Your Connection String\n\nAfter creating your Neon project, you'll find a connection string like:\n```\npostgresql://username:password@ep-your-endpoint.region.aws.neon.tech/dbname?sslmode=require\n```\n\n## Step 3: Database Schema Setup\n\nYour new database will need these tables (automatically created by our migration):\n\n### Core Tables\n- `sessions` - User session storage\n- `users` - User profiles and authentication\n- `rooms` - Game rooms and settings\n- `games` - Individual game instances\n- `moves` - Game move history\n- `room_participants` - Room membership tracking\n- `blocked_users` - User blocking system\n\n## Step 4: Migration Process\n\n### Option A: Fresh Start (Recommended)\n- Clean database setup\n- Users re-register with existing credentials\n- No data migration needed\n- Fastest and cleanest approach\n\n### Option B: Full Data Migration\n- Export current user data\n- Import to new database\n- Preserve user profiles and statistics\n- More complex but maintains history\n\n## Step 5: Environment Configuration\n\nOnce you provide your connection string, I'll update:\n1. Database connection in `server/db.ts`\n2. Environment variables\n3. Run database migrations\n4. Test all functionality\n\n## Current Database Usage\nYour app currently uses:\n- **Total Size**: ~848 KB\n- **Users**: 632 KB (main table)\n- **Other Tables**: 216 KB combined\n- **Well within limits**: Neon free tier supports 0.5 GB\n\n## Migration Checklist\n- [ ] Create Neon account\n- [ ] Get connection string\n- [ ] Choose migration approach (fresh vs full)\n- [ ] Update environment variables\n- [ ] Run database migrations\n- [ ] Test user authentication\n- [ ] Test game functionality\n- [ ] Verify WebSocket connections\n- [ ] Test all features end-to-end\n\n## Post-Migration Benefits\n‚úÖ **Database Ownership**: Complete control over your data\n‚úÖ **Portability**: Deploy anywhere with same database\n‚úÖ **Backup Control**: Export/import data as needed\n‚úÖ **No Dependencies**: Independent from Replit's database\n‚úÖ **Scalability**: Upgrade Neon plan as needed\n\n## Need Help?\nProvide your Neon connection string and preferred migration approach (fresh start or full data migration), and I'll handle the technical setup for you.","size_bytes":2972},"DEBUG_MULTIPLAYER.md":{"content":"# Multiplayer Debug Information\n\n## Issue Summary\nBoth devices authenticate as the same user (34fc8c77-2526-4273-afe2-ea02283a12e3) even when using different browsers/accounts.\n\n## What Works\n- WebSocket connections establish correctly\n- Room joining works (both users in room)\n- Move broadcasting works (messages sent to both devices)\n- Database stores correct game state\n\n## What Doesn't Work\n- Both devices authenticate as same user\n- Turn validation fails because both devices think they're Player X\n- Player O moves are rejected with \"not your turn\"\n\n## Required for Fix\n1. Device 1: Must authenticate as User A (Sam - a7b6cf23-e9d0-425f-924d-9acd10560370)\n2. Device 2: Must authenticate as User B (Yogesh - 34fc8c77-2526-4273-afe2-ea02283a12e3)\n\n## Testing Steps\n1. Open app on Device 1, check user ID in top-right corner\n2. Open app on Device 2 (different browser/incognito), check user ID\n3. Both should show different user IDs\n4. If same user ID appears on both devices, authentication system needs fixing\n\n## Current Status\n- Room participants: ‚úì Both users correctly stored\n- Game state: ‚úì Correct X/O assignments in database\n- WebSocket: ‚úì Broadcasting works\n- Authentication: ‚ùå Both devices same user session","size_bytes":1229},"DEPLOYMENT_GUIDE.md":{"content":"# TicTac 3x5 - Authentication & Deployment Guide\n\n## Overview\nYour TicTac 3x5 app uses a **dual authentication system** with both JSON file storage and PostgreSQL database. Here's everything you need to know about how authentication works and what you need to deploy elsewhere.\n\n## Authentication System\n\n### 1. **Dual Storage System**\nYour app uses TWO storage systems for user data:\n\n**JSON File Storage (`users.json`):**\n- Location: `users.json` in root directory\n- Stores: usernames, passwords, email verification tokens, profile data\n- Used for: login/registration, password resets, email verification\n\n**PostgreSQL Database:**\n- Location: Connected via `DATABASE_URL` environment variable\n- Stores: user profiles, game data, room data, statistics, blocked users\n- Used for: game functionality, real-time features, social features\n\n### 2. **User Authentication Flow**\n1. User registers/logs in through JSON file system\n2. User data is automatically synced to PostgreSQL database\n3. Session is stored in PostgreSQL sessions table\n4. All game features use PostgreSQL data\n\n### 3. **Email System**\n- **Service**: SMTP (Nodemailer)\n- **Configuration**: Environment variables for SMTP settings\n- **Features**: Email verification, password reset emails\n- **URLs**: Hardcoded to `tic-tac-master-zanv1.replit.app`\n\n## Required Environment Variables\n\nTo deploy your app elsewhere, you need these environment variables:\n\n### **Database**\n```\nDATABASE_URL=postgresql://username:password@host:port/database\n```\n\n### **Email Service (SMTP)**\n```\nSMTP_HOST=smtp.gmail.com\nSMTP_PORT=587\nSMTP_USER=your-email@gmail.com\nSMTP_PASS=your-app-password\nSMTP_FROM=your-email@gmail.com\n```\n\n### **Session Security**\n```\nSESSION_SECRET=your-random-secret-key-here\n```\n\n## Files You Need to Deploy\n\n### **Core Application Files**\n- All `client/` folder (React frontend)\n- All `server/` folder (Express backend)\n- All `shared/` folder (shared types/schema)\n- `package.json` and `package-lock.json`\n- `vite.config.ts`, `tailwind.config.ts`, `tsconfig.json`\n- `drizzle.config.ts` (database configuration)\n\n### **Database Files**\n- `users.json` (if you want to keep existing users)\n- Database schema will be created automatically via Drizzle\n\n### **Configuration Files**\n- `.env` file with your environment variables\n- `replit.md` (project documentation)\n\n## Database Schema\n\nYour PostgreSQL database contains these tables:\n\n### **Users Table**\n```sql\nusers (\n  id VARCHAR PRIMARY KEY,\n  email VARCHAR UNIQUE,\n  first_name VARCHAR,\n  last_name VARCHAR,\n  profile_image_url VARCHAR,\n  wins INTEGER DEFAULT 0,\n  losses INTEGER DEFAULT 0,\n  draws INTEGER DEFAULT 0,\n  created_at TIMESTAMP,\n  updated_at TIMESTAMP\n)\n```\n\n### **Sessions Table**\n```sql\nsessions (\n  sid VARCHAR PRIMARY KEY,\n  sess JSONB NOT NULL,\n  expire TIMESTAMP NOT NULL\n)\n```\n\n### **Game Tables**\n- `rooms` - Game rooms\n- `games` - Individual games\n- `room_participants` - Players in rooms\n- `moves` - Game moves\n- `blocked_users` - User blocking system\n\n## Deployment Steps\n\n### 1. **Set Up PostgreSQL Database**\n- Create a PostgreSQL database\n- Get the connection string\n- Set `DATABASE_URL` environment variable\n\n### 2. **Configure Email Service**\n- Set up SMTP service (Gmail, SendGrid, etc.)\n- Add SMTP environment variables\n- Update email URLs in `server/emailService.ts`\n\n### 3. **Update Domain References**\n- Change `tic-tac-master-zanv1.replit.app` to your domain in:\n  - `server/emailService.ts` (line 48)\n  - Any other hardcoded URLs\n\n### 4. **Install Dependencies**\n```bash\nnpm install\n```\n\n### 5. **Set Up Database Schema**\n```bash\nnpm run db:push\n```\n\n### 6. **Build and Deploy**\n```bash\nnpm run build\nnpm start\n```\n\n## Real-time Features\n\n### **WebSocket System**\n- WebSocket server runs on same port as Express server\n- Path: `/ws`\n- Handles: Real-time game updates, chat, online users\n- Authentication: Uses session cookies\n\n### **Real-time Database**\n- All game data is stored in PostgreSQL\n- Real-time updates via WebSocket broadcasting\n- No external real-time database needed\n\n## Security Considerations\n\n### **Password Security**\n- Passwords are hashed using SHA-256\n- Session-based authentication\n- CSRF protection via same-origin policy\n\n### **Email Verification**\n- Optional email verification system\n- Tokens expire after 24 hours\n- Password reset tokens expire after 1 hour\n\n## Migration Notes\n\n### **From Current Setup**\n1. Export `users.json` file\n2. Set up new database\n3. Update environment variables\n4. Update domain references\n5. Deploy and test\n\n### **User Data Migration**\n- Existing users in `users.json` will be automatically synced to database\n- No manual migration needed\n- Keep `users.json` for authentication\n\n## Troubleshooting\n\n### **Common Issues**\n1. **Database Connection**: Check `DATABASE_URL` format\n2. **Email Not Sending**: Verify SMTP credentials\n3. **Session Issues**: Ensure `SESSION_SECRET` is set\n4. **WebSocket Issues**: Check firewall/proxy settings\n\n### **Development vs Production**\n- Development: Uses memory sessions\n- Production: Uses PostgreSQL sessions\n- Both use same authentication system\n\n## Summary\n\nYour app is ready to deploy anywhere with:\n- PostgreSQL database\n- SMTP email service\n- Node.js hosting\n- Environment variables properly configured\n\nThe dual storage system ensures compatibility while providing robust game features through the database.","size_bytes":5362},"PROJECT-OVERVIEW.md":{"content":"# TicTac 3x5 - Complete Project Overview\n\n## üéÆ Game Features\n\n### Core Gameplay\n- **3x5 Grid**: Strategic tic-tac-toe on a 3x5 board (positions 1-15)\n- **Win Conditions**: \n  - Horizontal: 4 in a row\n  - Vertical: 3 in a column  \n  - Diagonal: 3 in diagonal (excluding positions 5, 10, 15)\n- **Real-time**: Live multiplayer with WebSocket synchronization\n\n### Game Modes\n- **AI Mode**: Play against computer with 3 difficulty levels\n- **Pass-and-Play**: Local multiplayer on same device\n- **Online Multiplayer**: Real-time games with other players\n\n### Multiplayer Features\n- **Room System**: Create/join rooms with unique codes\n- **Spectator Mode**: Watch ongoing games (up to 50 spectators)\n- **Player Profiles**: Display names and profile pictures in games\n- **Game Statistics**: Win/loss/draw tracking\n\n## üîß Technical Architecture\n\n### Frontend (React + TypeScript)\n```\nclient/src/\n‚îú‚îÄ‚îÄ components/\n‚îÇ   ‚îú‚îÄ‚îÄ GameBoard.tsx          # Main game interface\n‚îÇ   ‚îú‚îÄ‚îÄ GameModeSelector.tsx   # AI/Pass-play/Online selection\n‚îÇ   ‚îú‚îÄ‚îÄ RoomManager.tsx        # Multiplayer room system\n‚îÇ   ‚îú‚îÄ‚îÄ GameOverModal.tsx      # Win/lose popup\n‚îÇ   ‚îú‚îÄ‚îÄ ProfileManager.tsx     # User profile management\n‚îÇ   ‚îî‚îÄ‚îÄ AudioControls.tsx      # Sound and music controls\n‚îú‚îÄ‚îÄ hooks/\n‚îÇ   ‚îú‚îÄ‚îÄ useWebSocket.ts        # Real-time multiplayer\n‚îÇ   ‚îú‚îÄ‚îÄ useAudio.ts           # Game sound effects\n‚îÇ   ‚îî‚îÄ‚îÄ useAuth.ts            # Authentication state\n‚îú‚îÄ‚îÄ pages/\n‚îÇ   ‚îú‚îÄ‚îÄ home.tsx              # Main game page\n‚îÇ   ‚îú‚îÄ‚îÄ auth.tsx              # Login/register page\n‚îÇ   ‚îî‚îÄ‚îÄ verify-email.tsx      # Email verification\n‚îî‚îÄ‚îÄ lib/\n    ‚îî‚îÄ‚îÄ queryClient.ts        # API client setup\n```\n\n### Backend (Node.js + Express)\n```\nserver/\n‚îú‚îÄ‚îÄ gameLogic.ts      # Core 3x5 game rules and validation\n‚îú‚îÄ‚îÄ aiPlayer.ts       # AI opponent with difficulty levels\n‚îú‚îÄ‚îÄ routes.ts         # WebSocket multiplayer and API endpoints\n‚îú‚îÄ‚îÄ storage.ts        # Database operations (games, rooms, users)\n‚îú‚îÄ‚îÄ auth.ts          # Authentication with email verification\n‚îú‚îÄ‚îÄ emailService.ts   # Email verification and password reset\n‚îî‚îÄ‚îÄ index.ts         # Server entry point\n```\n\n### Database Schema\n```\nshared/schema.ts\n‚îú‚îÄ‚îÄ users            # User accounts and profiles\n‚îú‚îÄ‚îÄ rooms            # Multiplayer game rooms\n‚îú‚îÄ‚îÄ games            # Individual game instances\n‚îú‚îÄ‚îÄ moves            # Game move history\n‚îú‚îÄ‚îÄ room_participants # Room membership tracking\n‚îî‚îÄ‚îÄ sessions         # User session storage\n```\n\n## üéØ Game Logic Details\n\n### Board Layout (3x5 Grid)\n```\n 1  2  3  4  5\n 6  7  8  9 10\n11 12 13 14 15\n```\n\n### Win Conditions\n- **Horizontal**: 4 consecutive in any row (1-2-3-4, 2-3-4-5, etc.)\n- **Vertical**: 3 consecutive in any column (1-6-11, 2-7-12, etc.)\n- **Diagonal**: 3 consecutive diagonally (1-7-13, 3-7-11, etc.)\n- **Exclusions**: Positions 5, 10, 15 cannot be part of diagonal wins\n\n### AI Difficulty Levels\n- **Easy**: Random moves\n- **Medium**: Strategic play (win/block/center preference)\n- **Hard**: Minimax algorithm with alpha-beta pruning\n\n## üîê Authentication System\n\n### Features\n- **Registration**: Username, email, password required\n- **Email Verification**: Mandatory before login access\n- **Login**: Support for both username OR email\n- **Password Reset**: Secure token-based reset via email\n- **Session Management**: Secure server-side sessions\n\n### Email Integration\n- **SMTP Support**: Configurable email service\n- **Professional Templates**: Branded verification and reset emails\n- **Security**: 1-hour token expiry for password resets\n\n## üéµ Audio System\n\n### Sound Effects\n- **Move Sounds**: Audio feedback for game moves\n- **Win/Loss Sounds**: Celebration and defeat sounds\n- **UI Sounds**: Button clicks and interactions\n- **Background Music**: Optional ambient music\n\n### Controls\n- **Volume Control**: Adjustable audio levels\n- **Toggle Options**: Enable/disable sound effects and music\n- **Persistent Settings**: Audio preferences saved per user\n\n## üåê Real-time Features\n\n### WebSocket Integration\n- **Live Updates**: Instant move synchronization\n- **Room Management**: Real-time room joining/leaving\n- **Spectator Support**: Live game viewing\n- **Connection Handling**: Automatic reconnection logic\n\n### Message Types\n- **Game Moves**: Player move broadcasting\n- **Room Events**: Join/leave notifications\n- **Game State**: Complete game state synchronization\n- **Player Updates**: Profile and status changes\n\n## üìä Database Operations\n\n### Game Management\n- **Create Games**: Initialize new game instances\n- **Track Moves**: Complete move history\n- **Game States**: Active, completed, abandoned games\n- **Statistics**: Player win/loss/draw records\n\n### Room System\n- **Room Creation**: Unique room codes\n- **Participant Management**: Player and spectator tracking\n- **Room Status**: Waiting, active, completed states\n- **Capacity Control**: Player limits and spectator support\n\n## üöÄ Deployment Features\n\n### Production Ready\n- **PM2 Clustering**: Multi-process deployment\n- **Nginx Reverse Proxy**: Load balancing and SSL termination\n- **Database Migrations**: Automated schema updates\n- **Environment Configuration**: Secure production settings\n\n### Monitoring\n- **Application Logs**: Comprehensive logging system\n- **Error Tracking**: Detailed error reporting\n- **Performance Monitoring**: Resource usage tracking\n- **Health Checks**: Service availability monitoring\n\n## üîß Development Tools\n\n### Build System\n- **Vite**: Fast development and production builds\n- **TypeScript**: Full type safety across frontend and backend\n- **Tailwind CSS**: Responsive, modern styling\n- **ESLint**: Code quality and consistency\n\n### Database Tools\n- **Drizzle ORM**: Type-safe database operations\n- **PostgreSQL**: Robust relational database\n- **Migration System**: Schema version management\n- **Connection Pooling**: Efficient database connections\n\n## üì¶ VPS Deployment Package\n\nThe complete project includes:\n- **Full Source Code**: All game logic and components\n- **Production Scripts**: Automated deployment tools\n- **Configuration Templates**: Nginx, PM2, environment setup\n- **Documentation**: Comprehensive deployment guide\n- **Monitoring Tools**: Logs, backups, and maintenance scripts\n\nYour TicTac 3x5 project is a complete, production-ready multiplayer game with all modern features!","size_bytes":6468},"SHARING_SETUP_GUIDE.md":{"content":"# Dynamic Sharing System Setup Guide\n\n## Overview\nYour app now has a flexible sharing system that automatically switches between Replit URLs and Play Store URLs based on the environment and configuration.\n\n## How It Works\n\n### Current Behavior (Replit)\n- **Web App Sharing**: Uses current Replit URL\n- **Social Media**: Shares Replit URL with game description\n- **Copy Link**: Copies Replit URL to clipboard\n\n### Future Behavior (Play Store Published)\n- **Web App Sharing**: Uses your production website URL\n- **Play Store Sharing**: Uses Google Play Store URL\n- **Social Media**: Automatically chooses best URL (Play Store preferred)\n- **Copy Link**: Options for both web app and Play Store links\n\n## Setup Steps\n\n### Step 1: Environment Variables\nCreate a `.env` file in your project root with these variables:\n\n```env\n# Production URL (when you deploy to your own domain)\nVITE_PRODUCTION_URL=https://yourdomain.com\n\n# Play Store URL (add this when you publish to Google Play Store)\nVITE_PLAY_STORE_URL=https://play.google.com/store/apps/details?id=com.yourcompany.tictac3x5\n```\n\n### Step 2: When You Publish to Play Store\n\n1. **Publish your app** to Google Play Store\n2. **Get your Play Store URL** (format: `https://play.google.com/store/apps/details?id=YOUR_PACKAGE_ID`)\n3. **Add the URL** to your environment variables:\n   ```env\n   VITE_PLAY_STORE_URL=https://play.google.com/store/apps/details?id=com.yourcompany.tictac3x5\n   ```\n4. **Redeploy** your web app\n\n### Step 3: Testing the System\n\nThe system automatically detects:\n- **Replit Environment**: Uses Replit URLs\n- **Production Environment**: Uses production URLs\n- **Play Store Available**: Shows Play Store option in share menu\n\n## Share Button Locations\n\nYour sharing functionality is used in:\n1. **Landing Page**: Header share button\n2. **Game Over Modal**: Victory sharing\n3. **Any future locations**: Just use `<ShareButton />` component\n\n## Customization Options\n\n### For specific sharing behavior:\n```tsx\n// Prefer Play Store link when available\n<ShareButton preferPlayStore={true} />\n\n// Custom text and title\n<ShareButton \n  title=\"Custom Game Title\"\n  text=\"Custom share message\"\n/>\n\n// Force specific URL\n<ShareButton url=\"https://custom-url.com\" />\n```\n\n### Share Menu Features:\n- **Facebook Sharing**: Opens Facebook share dialog\n- **Twitter Sharing**: Opens Twitter share dialog  \n- **WhatsApp Sharing**: Opens WhatsApp share dialog\n- **Copy Web App Link**: Copies current web app URL\n- **Copy Play Store Link**: Copies Play Store URL (when configured)\n\n## Technical Details\n\n### Files Modified:\n- `client/src/lib/shareConfig.ts` - Configuration and environment detection\n- `client/src/components/ShareButton.tsx` - Enhanced sharing component\n- `.env.example` - Environment variable template\n\n### Environment Detection:\n- Automatically detects Replit vs production\n- Prioritizes Play Store URLs in production\n- Falls back to web URLs when Play Store not configured\n\n### Future-Proof Design:\n- No code changes needed when publishing to Play Store\n- Just add environment variable and redeploy\n- Automatic switching between development and production URLs\n\n## Benefits\n\n‚úÖ **No Manual Updates**: Automatically switches URLs based on environment\n‚úÖ **Play Store Ready**: Pre-configured for Play Store publishing\n‚úÖ **Flexible**: Multiple sharing options in one component\n‚úÖ **User-Friendly**: Clear labels for web vs Play Store links\n‚úÖ **Development-Friendly**: Works seamlessly in Replit during development","size_bytes":3488},"UNUSED_DEPENDENCIES_ANALYSIS.md":{"content":"# Unused Dependencies Analysis\n\nBased on code analysis, here are dependencies that appear to be unused and can be safely removed:\n\n## ‚ùå **Definitely Unused - Safe to Remove:**\n\n### Core Libraries:\n1. **`@sendgrid/mail`** - SendGrid removed, using nodemailer instead\n2. **`openid-client`** - Only used in replitAuth.ts (likely unused feature)\n3. **`memoizee`** + **`@types/memoizee`** - Only imported in replitAuth.ts\n4. **`passport`** + **`passport-local`** + **`@types/passport`** + **`@types/passport-local`** - Only used in replitAuth.ts\n\n### UI Components (Shadcn/Radix that aren't imported anywhere):\n5. **`embla-carousel-react`** - Only in ui/carousel.tsx, not used in app\n6. **`recharts`** - Only in ui/chart.tsx, not used in app  \n7. **`react-day-picker`** - Only in ui/calendar.tsx, not used in app\n8. **`vaul`** - Only in ui/drawer.tsx, not used in app\n9. **`react-resizable-panels`** - Only in ui/resizable.tsx, not used in app\n\n### Potentially Unused Radix Components:\n10. **`@radix-ui/react-accordion`** - Check if Accordion is used\n11. **`@radix-ui/react-alert-dialog`** - Check if AlertDialog is used  \n12. **`@radix-ui/react-aspect-ratio`** - Check if AspectRatio is used\n13. **`@radix-ui/react-collapsible`** - Check if Collapsible is used\n14. **`@radix-ui/react-context-menu`** - Check if ContextMenu is used\n15. **`@radix-ui/react-hover-card`** - Check if HoverCard is used\n16. **`@radix-ui/react-menubar`** - Check if Menubar is used\n17. **`@radix-ui/react-navigation-menu`** - Check if NavigationMenu is used\n18. **`@radix-ui/react-popover`** - Check if Popover is used\n19. **`@radix-ui/react-progress`** - Check if Progress is used\n20. **`@radix-ui/react-radio-group`** - Check if RadioGroup is used\n21. **`@radix-ui/react-scroll-area`** - Check if ScrollArea is used\n22. **`@radix-ui/react-slider`** - Check if Slider is used\n23. **`@radix-ui/react-switch`** - Check if Switch is used\n24. **`@radix-ui/react-toggle`** - Check if Toggle is used\n25. **`@radix-ui/react-toggle-group`** - Check if ToggleGroup is used\n26. **`@radix-ui/react-tooltip`** - Check if Tooltip is used\n\n### Other Libraries:\n27. **`input-otp`** - Check if OTP input is used\n28. **`cmdk`** - Check if Command component is used\n29. **`tw-animate-css`** - Check if this animation library is used\n\n## ‚ö†Ô∏è **Investigate Further:**\n\n1. **`connect-pg-simple`** - Used for PostgreSQL session store (might be needed)\n2. **`memorystore`** - Alternative session store (might be used)\n3. **`date-fns`** - Date manipulation (check usage)\n4. **`@jridgewell/trace-mapping`** - Development tool (might be needed for sourcemaps)\n\n## ‚úÖ **Definitely Keep - Actively Used:**\n\n- `@radix-ui/react-dialog` - Used for modals\n- `@radix-ui/react-dropdown-menu` - Used in ShareButton\n- `@radix-ui/react-avatar` - Used for profile pictures\n- `@radix-ui/react-button` (via shadcn)\n- `@radix-ui/react-label` - Used in forms\n- `@radix-ui/react-select` - Used for dropdowns\n- `@radix-ui/react-tabs` - Used in UI\n- `@radix-ui/react-toast` - Used for notifications\n- `framer-motion` - Used for animations\n- `firebase` - Used for authentication\n- `lucide-react` - Used for icons\n- `react-hook-form` - Used for forms\n- `wouter` - Used for routing\n- `ws` - Used for WebSockets\n- All database related: `drizzle-orm`, `pg`, etc.\n- All build tools: `vite`, `typescript`, etc.\n\n## üíæ **Estimated Size Savings:**\n\nRemoving all unused dependencies could save approximately:\n- **50-100MB** from node_modules\n- **5-15MB** from final bundle size\n- **Faster build times**\n- **Reduced maintenance overhead**\n\n## üìã **Recommended Action Plan:**\n\n1. Remove definitely unused dependencies first (items 1-9)\n2. Audit Radix UI components to see which are actually imported in your app\n3. Test thoroughly after each removal\n4. Keep backups of package.json before making changes","size_bytes":3829},"cleanup-dependencies.js":{"content":"#!/usr/bin/env node\n\n/**\n * Safe dependency cleanup script\n * This script helps identify and remove unused dependencies from your project\n */\n\nimport fs from 'fs';\nimport { execSync } from 'child_process';\n\n// Dependencies that are definitely safe to remove based on analysis\nconst SAFE_TO_REMOVE = [\n  '@sendgrid/mail',\n  'openid-client', \n  'memoizee',\n  '@types/memoizee',\n  'passport',\n  'passport-local',\n  '@types/passport',\n  '@types/passport-local',\n  'embla-carousel-react',\n  'recharts',\n  'react-day-picker', \n  'vaul',\n  'react-resizable-panels'\n];\n\n// Dependencies that need manual verification\nconst VERIFY_FIRST = [\n  '@radix-ui/react-accordion',\n  '@radix-ui/react-alert-dialog',\n  '@radix-ui/react-aspect-ratio',\n  '@radix-ui/react-collapsible',\n  '@radix-ui/react-context-menu',\n  '@radix-ui/react-hover-card',\n  '@radix-ui/react-menubar',\n  '@radix-ui/react-navigation-menu',\n  '@radix-ui/react-popover',\n  '@radix-ui/react-progress',\n  '@radix-ui/react-radio-group',\n  '@radix-ui/react-scroll-area',\n  '@radix-ui/react-slider',\n  '@radix-ui/react-switch',\n  '@radix-ui/react-toggle',\n  '@radix-ui/react-toggle-group',\n  '@radix-ui/react-tooltip',\n  'input-otp',\n  'cmdk',\n  'tw-animate-css'\n];\n\nasync function analyzeDependencies() {\n  console.log('üîç Analyzing dependencies...\\n');\n  \n  const packageJson = JSON.parse(fs.readFileSync('package.json', 'utf8'));\n  const dependencies = { ...packageJson.dependencies, ...packageJson.devDependencies };\n  \n  console.log('üì¶ SAFE TO REMOVE (Definitely unused):');\n  console.log('‚ïê'.repeat(50));\n  \n  const safeRemovalSize = [];\n  for (const dep of SAFE_TO_REMOVE) {\n    if (dependencies[dep]) {\n      console.log(`‚úÖ ${dep}`);\n      safeRemovalSize.push(dep);\n    }\n  }\n  \n  console.log(`\\nüìä Found ${safeRemovalSize.length} safe removals\\n`);\n  \n  console.log('‚ö†Ô∏è  VERIFY FIRST (Check if actually used):');\n  console.log('‚ïê'.repeat(50));\n  \n  const verifySize = [];\n  for (const dep of VERIFY_FIRST) {\n    if (dependencies[dep]) {\n      console.log(`üîç ${dep}`);\n      verifySize.push(dep);\n    }\n  }\n  \n  console.log(`\\nüìä Found ${verifySize.length} to verify\\n`);\n  \n  return { safeRemovalSize, verifySize };\n}\n\nfunction createBackup() {\n  const timestamp = new Date().toISOString().replace(/[:.]/g, '-');\n  const backupName = `package.json.backup.${timestamp}`;\n  fs.copyFileSync('package.json', backupName);\n  console.log(`üíæ Created backup: ${backupName}`);\n  return backupName;\n}\n\nfunction removeDependencies(deps) {\n  if (deps.length === 0) {\n    console.log('No dependencies to remove.');\n    return;\n  }\n  \n  console.log(`\\nüóëÔ∏è  Removing ${deps.length} dependencies...`);\n  \n  try {\n    const command = `npm uninstall ${deps.join(' ')}`;\n    console.log(`Running: ${command}`);\n    execSync(command, { stdio: 'inherit' });\n    console.log('‚úÖ Dependencies removed successfully!');\n  } catch (error) {\n    console.error('‚ùå Error removing dependencies:', error.message);\n    process.exit(1);\n  }\n}\n\nasync function main() {\n  console.log('üßπ TicTac 3x5 - Dependency Cleanup Tool\\n');\n  \n  // Check if package.json exists\n  if (!fs.existsSync('package.json')) {\n    console.error('‚ùå package.json not found in current directory');\n    process.exit(1);\n  }\n  \n  const { safeRemovalSize } = await analyzeDependencies();\n  \n  // Create backup\n  const backup = createBackup();\n  \n  // Process command line arguments\n  const args = process.argv.slice(2);\n  \n  if (args.includes('--auto') || args.includes('-a')) {\n    console.log('ü§ñ Auto mode: Removing safe dependencies...\\n');\n    removeDependencies(safeRemovalSize);\n  } else if (args.includes('--list') || args.includes('-l')) {\n    console.log('üìã List mode: Analysis complete. Use --auto to remove safe dependencies.');\n  } else {\n    console.log('üí° Usage:');\n    console.log('  node cleanup-dependencies.js --list   # List unused dependencies');\n    console.log('  node cleanup-dependencies.js --auto   # Remove safe dependencies');\n    console.log('  npm run cleanup-deps                   # Alias for --auto');\n    console.log('\\nüíæ Backup created: ' + backup);\n    console.log('üîí Safe to run --auto for the dependencies marked as safe');\n  }\n  \n  console.log('\\n‚ú® Cleanup analysis complete!');\n}\n\nmain().catch(console.error);","size_bytes":4297},"deployment-guide.md":{"content":"# TicTac 3x5 VPS Deployment Guide\n\n## Overview\nThis guide will help you deploy your TicTac 3x5 application to your VPS with proper production configuration.\n\n## Prerequisites\n- Ubuntu/Debian VPS with root access\n- Domain name pointed to your VPS IP\n- SSL certificate (Let's Encrypt recommended)\n- PostgreSQL database\n- SMTP email service credentials\n\n## Step 1: Server Setup\n\n### Update System\n```bash\nsudo apt update && sudo apt upgrade -y\n```\n\n### Install Required Software\n```bash\n# Install Node.js 20\ncurl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -\nsudo apt-get install -y nodejs\n\n# Install PostgreSQL\nsudo apt install postgresql postgresql-contrib -y\n\n# Install Nginx\nsudo apt install nginx -y\n\n# Install PM2 for process management\nsudo npm install -g pm2\n\n# Install certbot for SSL\nsudo apt install certbot python3-certbot-nginx -y\n```\n\n## Step 2: Database Setup\n\n### Create Database and User\n```bash\nsudo -u postgres psql\n```\n\n```sql\nCREATE DATABASE tictac_db;\nCREATE USER tictac_user WITH PASSWORD 'your_secure_password';\nGRANT ALL PRIVILEGES ON DATABASE tictac_db TO tictac_user;\n\\q\n```\n\n## Step 3: Application Deployment\n\n### Create App Directory\n```bash\nsudo mkdir -p /var/www/tictac\nsudo chown $USER:$USER /var/www/tictac\n```\n\n### Upload and Extract Project\n```bash\n# Upload your project files to /var/www/tictac\ncd /var/www/tictac\n\n# Install dependencies\nnpm install\n\n# Build the application\nnpm run build\n```\n\n### Create Production Environment File\n```bash\nnano .env.production\n```\n\n```env\nNODE_ENV=production\nPORT=3000\nSESSION_SECRET=your_very_secure_session_secret_here\nDATABASE_URL=postgresql://tictac_user:your_secure_password@localhost:5432/tictac_db\n\n# SMTP Configuration\nSMTP_HOST=your_smtp_host\nSMTP_PORT=587\nSMTP_USER=your_smtp_username\nSMTP_PASS=your_smtp_password\nFROM_EMAIL=noreply@yourdomain.com\n\n# Domain Configuration\nREPLIT_DOMAIN=https://yourdomain.com\n```\n\n### Database Migration\n```bash\nnpm run db:push\n```\n\n## Step 4: PM2 Configuration\n\n### Create PM2 Ecosystem File\n```bash\nnano ecosystem.config.js\n```\n\n```javascript\nmodule.exports = {\n  apps: [{\n    name: 'tictac-app',\n    script: 'server/index.js',\n    instances: 'max',\n    exec_mode: 'cluster',\n    env: {\n      NODE_ENV: 'development'\n    },\n    env_production: {\n      NODE_ENV: 'production',\n      PORT: 3000\n    },\n    error_file: './logs/err.log',\n    out_file: './logs/out.log',\n    log_file: './logs/combined.log',\n    time: true\n  }]\n};\n```\n\n### Start Application with PM2\n```bash\n# Create logs directory\nmkdir logs\n\n# Start application\npm2 start ecosystem.config.js --env production\n\n# Save PM2 configuration\npm2 save\n\n# Setup PM2 to start on boot\npm2 startup\n```\n\n## Step 5: Nginx Configuration\n\n### Create Nginx Configuration\n```bash\nsudo nano /etc/nginx/sites-available/tictac\n```\n\n```nginx\nserver {\n    listen 80;\n    server_name yourdomain.com www.yourdomain.com;\n\n    location / {\n        proxy_pass http://localhost:3000;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection 'upgrade';\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_cache_bypass $http_upgrade;\n        proxy_read_timeout 86400;\n    }\n\n    # WebSocket support\n    location /ws {\n        proxy_pass http://localhost:3000;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n\n    # Static files caching\n    location ~* \\.(js|css|png|jpg|jpeg|gif|ico|svg)$ {\n        expires 1y;\n        add_header Cache-Control \"public, immutable\";\n    }\n}\n```\n\n### Enable Site\n```bash\nsudo ln -s /etc/nginx/sites-available/tictac /etc/nginx/sites-enabled/\nsudo nginx -t\nsudo systemctl reload nginx\n```\n\n## Step 6: SSL Certificate\n\n### Install Let's Encrypt Certificate\n```bash\nsudo certbot --nginx -d yourdomain.com -d www.yourdomain.com\n```\n\n## Step 7: Firewall Configuration\n\n### Setup UFW Firewall\n```bash\nsudo ufw allow ssh\nsudo ufw allow 'Nginx Full'\nsudo ufw enable\n```\n\n## Step 8: Monitoring and Logs\n\n### View Application Logs\n```bash\npm2 logs tictac-app\n```\n\n### Monitor Application\n```bash\npm2 monit\n```\n\n### View Nginx Logs\n```bash\nsudo tail -f /var/log/nginx/access.log\nsudo tail -f /var/log/nginx/error.log\n```\n\n## Step 9: Backup Strategy\n\n### Database Backup Script\n```bash\nnano backup-db.sh\n```\n\n```bash\n#!/bin/bash\nDATE=$(date +%Y%m%d_%H%M%S)\nBACKUP_DIR=\"/var/backups/tictac\"\nmkdir -p $BACKUP_DIR\n\npg_dump -U tictac_user -h localhost tictac_db > $BACKUP_DIR/tictac_backup_$DATE.sql\n\n# Keep only last 7 days of backups\nfind $BACKUP_DIR -name \"tictac_backup_*.sql\" -mtime +7 -delete\n```\n\n```bash\nchmod +x backup-db.sh\n# Add to crontab for daily backups\n(crontab -l 2>/dev/null; echo \"0 2 * * * /var/www/tictac/backup-db.sh\") | crontab -\n```\n\n## Step 10: Application Updates\n\n### Update Script\n```bash\nnano update-app.sh\n```\n\n```bash\n#!/bin/bash\ncd /var/www/tictac\n\n# Pull latest changes\ngit pull origin main\n\n# Install dependencies\nnpm install\n\n# Build application\nnpm run build\n\n# Run database migrations\nnpm run db:push\n\n# Restart application\npm2 restart tictac-app\n```\n\n```bash\nchmod +x update-app.sh\n```\n\n## Troubleshooting\n\n### Common Issues:\n\n1. **Database Connection Issues**\n   - Check DATABASE_URL format\n   - Verify PostgreSQL is running: `sudo systemctl status postgresql`\n   - Check firewall rules\n\n2. **Application Won't Start**\n   - Check PM2 logs: `pm2 logs tictac-app`\n   - Verify environment variables\n   - Check port availability\n\n3. **Nginx Issues**\n   - Test configuration: `sudo nginx -t`\n   - Check logs: `sudo tail -f /var/log/nginx/error.log`\n   - Verify proxy settings\n\n4. **SSL Certificate Issues**\n   - Renew certificate: `sudo certbot renew`\n   - Check certificate status: `sudo certbot certificates`\n\n## Security Recommendations\n\n1. **Regular Updates**: Keep system and dependencies updated\n2. **Strong Passwords**: Use secure passwords for database and session secret\n3. **Firewall**: Only open necessary ports\n4. **Monitoring**: Set up log monitoring and alerts\n5. **Backups**: Regular automated backups\n6. **SSL**: Always use HTTPS in production\n\n## Performance Optimization\n\n1. **Enable Gzip**: Add gzip compression in Nginx\n2. **Database Indexes**: Optimize database queries\n3. **Static Assets**: Use CDN for static files\n4. **Connection Pooling**: Configure database connection pooling\n5. **Caching**: Implement Redis for session storage\n\nYour TicTac 3x5 application is now ready for production deployment!","size_bytes":6853},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"ecosystem.config.js":{"content":"module.exports = {\n  apps: [{\n    name: 'tictac-app',\n\n    // Production points to compiled JS, dev points to TS\n    script: 'dist/server/index.js',\n    instances: 'max',\n    exec_mode: 'cluster',\n\n    // Interpreter is Node for production\n    interpreter: 'node',\n\n    env: {\n      NODE_ENV: 'development',\n      PORT: 3000,\n      EMAIL_HOST: 'smtppro.zoho.in',\n      EMAIL_USER: 'support@darklayerstudios.com',\n      EMAIL_PASS: '58565525@Sam',\n      \n      // Dev interpreter override\n      PM2_INTERPRETER: 'ts-node',\n      PM2_SCRIPT: 'server/index.ts'\n    },\n\n    env_production: {\n      NODE_ENV: 'production',\n      PORT: 5000,\n      EMAIL_HOST: 'smtppro.zoho.in',\n      EMAIL_USER: 'support@darklayerstudios.com',\n      EMAIL_PASS: '58565525@Sam'\n    },\n\n    error_file: './logs/err.log',\n    out_file: './logs/out.log',\n    log_file: './logs/combined.log',\n    time: true,\n\n    max_memory_restart: '6G',\n    watch: false,\n    ignore_watch: ['node_modules', 'logs'],\n    restart_delay: 1000,\n    max_restarts: 10,\n    min_uptime: '10s'\n  }]\n};","size_bytes":1052},"package-for-vps.sh":{"content":"#!/bin/bash\n\n# TicTac 3x5 VPS Packaging Script\n\necho \"üì¶ Preparing TicTac 3x5 for VPS deployment...\"\n\n# Create deployment directory\nmkdir -p tictac-vps-deploy\ncd tictac-vps-deploy\n\n# Copy necessary files\necho \"üìã Copying project files...\"\n\n# Copy main directories with all game logic\ncp -r ../client ./\ncp -r ../server ./\ncp -r ../shared ./\n\n# Copy configuration files\ncp ../package.json ./\ncp ../package-lock.json ./\ncp ../tsconfig.json ./\ncp ../vite.config.ts ./\ncp ../tailwind.config.ts ./\ncp ../postcss.config.js ./\ncp ../components.json ./\ncp ../drizzle.config.ts ./\ncp ../ecosystem.config.js ./\ncp ../deployment-guide.md ./\n\n# Copy additional files if they exist\n[ -f ../.gitignore ] && cp ../.gitignore ./\n[ -f ../README.md ] && cp ../README.md ./\n[ -f ../replit.md ] && cp ../replit.md ./\n\necho \"‚úÖ Copied all project files including:\"\necho \"   üéÆ Game Logic: server/gameLogic.ts, server/aiPlayer.ts\"\necho \"   üéØ Game Components: client/src/components/GameBoard.tsx, RoomManager.tsx\"\necho \"   üîÑ Real-time: server/routes.ts (WebSocket), client/src/hooks/useWebSocket.ts\"\necho \"   üéµ Audio: client/src/hooks/useAudio.ts\"\necho \"   üîê Auth: server/auth.ts, server/emailService.ts\"\necho \"   üíæ Database: server/storage.ts, shared/schema.ts\"\n\n# Create production scripts\necho \"‚öôÔ∏è Creating production scripts...\"\n\n# Create production build script\ncat > build-production.sh << 'EOF'\n#!/bin/bash\necho \"üèóÔ∏è Building TicTac 3x5 for production...\"\n\n# Install dependencies\nnpm install --production=false\n\n# Build the application\nnpm run build\n\n# Install only production dependencies\nnpm prune --production\n\necho \"‚úÖ Production build complete!\"\nEOF\n\n# Create deployment script\ncat > deploy.sh << 'EOF'\n#!/bin/bash\necho \"üöÄ Deploying TicTac 3x5...\"\n\n# Set production environment\nexport NODE_ENV=production\n\n# Run database migrations\nnpm run db:push\n\n# Start with PM2\npm2 start ecosystem.config.js --env production\n\n# Save PM2 configuration\npm2 save\n\necho \"‚úÖ Deployment complete!\"\nEOF\n\n# Create environment template\ncat > .env.template << 'EOF'\n# Production Environment Configuration\nNODE_ENV=production\nPORT=3000\n\n# Database Configuration\nDATABASE_URL=postgresql://username:password@localhost:5432/database_name\n\n# Session Security\nSESSION_SECRET=your_very_secure_session_secret_change_this\n\n# SMTP Email Configuration\nSMTP_HOST=your_smtp_host\nSMTP_PORT=587\nSMTP_USER=your_smtp_username\nSMTP_PASS=your_smtp_password\nFROM_EMAIL=noreply@yourdomain.com\n\n# Domain Configuration\nREPLIT_DOMAIN=https://yourdomain.com\nEOF\n\n# Create Nginx configuration template\ncat > nginx.conf.template << 'EOF'\nserver {\n    listen 80;\n    server_name yourdomain.com www.yourdomain.com;\n\n    # Security headers\n    add_header X-Frame-Options \"SAMEORIGIN\" always;\n    add_header X-Content-Type-Options \"nosniff\" always;\n    add_header X-XSS-Protection \"1; mode=block\" always;\n    add_header Referrer-Policy \"no-referrer-when-downgrade\" always;\n    add_header Content-Security-Policy \"default-src 'self' http: https: data: blob: 'unsafe-inline'\" always;\n\n    # Gzip compression\n    gzip on;\n    gzip_vary on;\n    gzip_proxied any;\n    gzip_comp_level 6;\n    gzip_types text/plain text/css text/xml text/javascript application/json application/javascript application/xml+rss application/atom+xml image/svg+xml;\n\n    location / {\n        proxy_pass http://localhost:3000;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection 'upgrade';\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_cache_bypass $http_upgrade;\n        proxy_read_timeout 86400;\n    }\n\n    # WebSocket support\n    location /ws {\n        proxy_pass http://localhost:3000;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n\n    # Static files caching\n    location ~* \\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {\n        expires 1y;\n        add_header Cache-Control \"public, immutable\";\n        access_log off;\n    }\n\n    # Deny access to sensitive files\n    location ~ /\\. {\n        deny all;\n    }\n}\nEOF\n\n# Create database backup script\ncat > backup-database.sh << 'EOF'\n#!/bin/bash\nDATE=$(date +%Y%m%d_%H%M%S)\nBACKUP_DIR=\"/var/backups/tictac\"\nmkdir -p $BACKUP_DIR\n\n# Load environment variables\nsource .env\n\n# Extract database details from DATABASE_URL\nDB_URL_REGEX=\"postgresql://([^:]+):([^@]+)@([^:]+):([^/]+)/(.+)\"\nif [[ $DATABASE_URL =~ $DB_URL_REGEX ]]; then\n    DB_USER=\"${BASH_REMATCH[1]}\"\n    DB_PASS=\"${BASH_REMATCH[2]}\"\n    DB_HOST=\"${BASH_REMATCH[3]}\"\n    DB_PORT=\"${BASH_REMATCH[4]}\"\n    DB_NAME=\"${BASH_REMATCH[5]}\"\nelse\n    echo \"‚ùå Could not parse DATABASE_URL\"\n    exit 1\nfi\n\n# Create backup\nPGPASSWORD=$DB_PASS pg_dump -U $DB_USER -h $DB_HOST -p $DB_PORT $DB_NAME > $BACKUP_DIR/tictac_backup_$DATE.sql\n\n# Keep only last 7 days of backups\nfind $BACKUP_DIR -name \"tictac_backup_*.sql\" -mtime +7 -delete\n\necho \"‚úÖ Database backup created: tictac_backup_$DATE.sql\"\nEOF\n\n# Create update script\ncat > update-app.sh << 'EOF'\n#!/bin/bash\necho \"üîÑ Updating TicTac 3x5 application...\"\n\n# Stop application\npm2 stop tictac-app\n\n# Pull latest changes (if using git)\n# git pull origin main\n\n# Install dependencies\nnpm install\n\n# Build application\nnpm run build\n\n# Run database migrations\nnpm run db:push\n\n# Restart application\npm2 restart tictac-app\n\necho \"‚úÖ Application updated successfully!\"\nEOF\n\n# Create systemd service file\ncat > tictac.service << 'EOF'\n[Unit]\nDescription=TicTac 3x5 Application\nAfter=network.target\n\n[Service]\nType=forking\nUser=www-data\nWorkingDirectory=/var/www/tictac\nExecStart=/usr/bin/pm2 start ecosystem.config.js --env production\nExecReload=/usr/bin/pm2 reload ecosystem.config.js --env production\nExecStop=/usr/bin/pm2 stop ecosystem.config.js\nPIDFile=/var/www/tictac/.pm2/pm2.pid\nRestart=always\nRestartSec=10\n\n[Install]\nWantedBy=multi-user.target\nEOF\n\n# Make scripts executable\nchmod +x build-production.sh\nchmod +x deploy.sh\nchmod +x backup-database.sh\nchmod +x update-app.sh\n\n# Create README for VPS deployment\ncat > README-VPS.md << 'EOF'\n# TicTac 3x5 VPS Deployment Package\n\n## Quick Start\n\n1. **Upload this folder to your VPS**\n   ```bash\n   scp -r tictac-vps-deploy/ user@your-server:/var/www/tictac/\n   ```\n\n2. **Connect to your VPS**\n   ```bash\n   ssh user@your-server\n   cd /var/www/tictac\n   ```\n\n3. **Configure environment**\n   ```bash\n   cp .env.template .env\n   nano .env  # Edit with your settings\n   ```\n\n4. **Build and deploy**\n   ```bash\n   ./build-production.sh\n   ./deploy.sh\n   ```\n\n5. **Configure Nginx** (copy nginx.conf.template to /etc/nginx/sites-available/)\n\n6. **Setup SSL** with Let's Encrypt\n\n## Important Files\n\n- `deployment-guide.md` - Complete deployment instructions\n- `.env.template` - Environment configuration template\n- `nginx.conf.template` - Nginx configuration template\n- `ecosystem.config.js` - PM2 process configuration\n- `build-production.sh` - Production build script\n- `deploy.sh` - Deployment script\n- `backup-database.sh` - Database backup script\n- `update-app.sh` - Application update script\n\n## Support\n\nRefer to `deployment-guide.md` for detailed instructions and troubleshooting.\nEOF\n\necho \"‚úÖ VPS deployment package created in 'tictac-vps-deploy' folder!\"\necho \"\"\necho \"üìÅ Package contents:\"\necho \"   - Complete application source code\"\necho \"   - Production configuration files\"\necho \"   - Deployment scripts\"\necho \"   - Nginx configuration template\"\necho \"   - Database backup tools\"\necho \"   - Comprehensive deployment guide\"\necho \"\"\necho \"üöÄ Ready to deploy to your VPS!\"\necho \"   1. Upload the 'tictac-vps-deploy' folder to your server\"\necho \"   2. Follow the instructions in README-VPS.md\"\necho \"   3. Use deployment-guide.md for detailed setup\"","size_bytes":8151},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"replit.md":{"content":"# TicTac 3x5 Game\n\n## Overview\n\nThis is a full-stack web application for a strategic Tic-Tac-Toe game played on a unique 3x5 grid. The application features multiple game modes (AI, pass-and-play, and online multiplayer), real-time gameplay through WebSockets, and a modern React frontend with a Node.js/Express backend. The project aims to provide an engaging and accessible gaming experience with features like comprehensive achievement tracking, leaderboards, and a dynamic sharing system.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n**Game Abandonment Preference**: Only abandon games when users explicitly exit rooms (Leave Room/Main Menu buttons), NOT when browser is closed or connection lost.\n\n## System Architecture\n\n### Frontend Architecture\n- **Framework**: React with TypeScript\n- **Build Tool**: Vite\n- **Routing**: Wouter\n- **State Management**: React Query (TanStack Query)\n- **UI Components**: Radix UI components with custom styling via shadcn/ui\n- **Styling**: Tailwind CSS with CSS variables for theming\n\n### Backend Architecture\n- **Runtime**: Node.js with Express.js framework\n- **Language**: TypeScript with ES modules\n- **Authentication**: Replit Auth with OpenID Connect\n- **Real-time Communication**: WebSockets for live game updates\n- **Session Management**: Express sessions with PostgreSQL storage\n\n### Database Architecture\n- **Database**: PostgreSQL (configured for Neon serverless)\n- **ORM**: Drizzle ORM for type-safe database operations\n- **Schema**: Relational design with tables for users, rooms, games, moves, room participants, achievements, and user themes.\n- **Migrations**: Drizzle Kit for database schema management\n\n### Core Features\n- **Custom Game Logic**: 3x5 grid Tic-Tac-Toe with diagonal-only winning conditions, server-side move validation, and real-time state synchronization.\n- **AI Player**: Multi-difficulty AI (random, strategic, minimax-like) optimized for diagonal patterns.\n- **Authentication System**: Replit Auth integration, secure server-side sessions, user management including guest users.\n- **Real-time Features**: WebSocket server for game updates, connection management, and message broadcasting.\n- **Room and Game Management**: Private/public rooms, AI, pass-and-play, and online multiplayer modes, spectator support, player statistics.\n- **Achievement System**: Comprehensive achievement tracking with visual borders and seasonal themes.\n- **Internationalization**: Multi-language support (English, Arabic, Bengali, Hindi, Spanish, Indonesian) with full RTL support for Arabic.\n- **User Interaction**: Real-time chat system, friend requests, online status indicators, user blocking, and room invitation system.\n- **UI/UX**: Dynamic sharing system, responsive mobile layouts, custom themes, animated loading screens, and visual effects for wins and achievements.\n\n## External Dependencies\n\n### Authentication\n- **Replit Auth**: OAuth2 provider for user authentication\n- **OpenID Connect**: Standard protocol for identity verification\n\n### Database\n- **Neon Database**: Serverless PostgreSQL hosting\n- **connect-pg-simple**: PostgreSQL session store\n\n### UI and Styling\n- **Radix UI**: Accessible, unstyled UI components\n- **Tailwind CSS**: Utility-first CSS framework\n- **shadcn/ui**: Pre-built component library\n- **framer-motion**: For animations (used selectively for specific effects)\n\n### Development Tools\n- **Vite**: Fast build tool\n- **TypeScript**: Type safety\n- **ESLint/Prettier**: Code quality and formatting\n\n### Email Service\n- **Nodemailer**: For SMTP email sending (verification and password reset)\n\n### Other Integrations\n- **Unsplash**: Source for bot avatars (animal/nature images)","size_bytes":3703},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      colors: {\n        background: \"var(--background)\",\n        foreground: \"var(--foreground)\",\n        card: {\n          DEFAULT: \"var(--card)\",\n          foreground: \"var(--card-foreground)\",\n        },\n        popover: {\n          DEFAULT: \"var(--popover)\",\n          foreground: \"var(--popover-foreground)\",\n        },\n        primary: {\n          DEFAULT: \"var(--primary)\",\n          foreground: \"var(--primary-foreground)\",\n        },\n        secondary: {\n          DEFAULT: \"var(--secondary)\",\n          foreground: \"var(--secondary-foreground)\",\n        },\n        muted: {\n          DEFAULT: \"var(--muted)\",\n          foreground: \"var(--muted-foreground)\",\n        },\n        accent: {\n          DEFAULT: \"var(--accent)\",\n          foreground: \"var(--accent-foreground)\",\n        },\n        destructive: {\n          DEFAULT: \"var(--destructive)\",\n          foreground: \"var(--destructive-foreground)\",\n        },\n        border: \"var(--border)\",\n        input: \"var(--input)\",\n        ring: \"var(--ring)\",\n        chart: {\n          \"1\": \"var(--chart-1)\",\n          \"2\": \"var(--chart-2)\",\n          \"3\": \"var(--chart-3)\",\n          \"4\": \"var(--chart-4)\",\n          \"5\": \"var(--chart-5)\",\n        },\n        sidebar: {\n          DEFAULT: \"var(--sidebar-background)\",\n          foreground: \"var(--sidebar-foreground)\",\n          primary: \"var(--sidebar-primary)\",\n          \"primary-foreground\": \"var(--sidebar-primary-foreground)\",\n          accent: \"var(--sidebar-accent)\",\n          \"accent-foreground\": \"var(--sidebar-accent-foreground)\",\n          border: \"var(--sidebar-border)\",\n          ring: \"var(--sidebar-ring)\",\n        },\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: {\n            height: \"0\",\n          },\n          to: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n        },\n        \"accordion-up\": {\n          from: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n          to: {\n            height: \"0\",\n          },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":2627},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\nimport { fileURLToPath } from 'url';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(__dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(__dirname, \"shared\"),\n      \"@assets\": path.resolve(__dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(__dirname, \"client\"),\n  build: {\n    outDir: path.resolve(__dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":1054},"server/aiPlayer.ts":{"content":"import { GameBoard, getAvailableMoves, checkWin, getOpponentSymbol, makeMove } from './gameLogic';\n\nexport class AIPlayer {\n  private symbol: string;\n  private difficulty: 'easy' | 'medium' | 'hard';\n\n  constructor(symbol: string, difficulty: 'easy' | 'medium' | 'hard' = 'medium') {\n    this.symbol = symbol;\n    this.difficulty = difficulty;\n  }\n\n  makeMove(board: GameBoard): number {\n    const availableMoves = getAvailableMoves(board);\n    \n    if (availableMoves.length === 0) {\n      throw new Error('No available moves');\n    }\n\n    switch (this.difficulty) {\n      case 'easy':\n        return this.makeRandomMove(availableMoves);\n      case 'medium':\n        return this.makeMediumMove(board, availableMoves);\n      case 'hard':\n        return this.makeHardMove(board, availableMoves);\n      default:\n        return this.makeRandomMove(availableMoves);\n    }\n  }\n\n  private makeRandomMove(availableMoves: number[]): number {\n    return availableMoves[Math.floor(Math.random() * availableMoves.length)];\n  }\n\n  private makeMediumMove(board: GameBoard, availableMoves: number[]): number {\n    // 1. Try to win\n    const winningMove = this.findWinningMove(board, this.symbol);\n    if (winningMove !== null) {\n      return winningMove;\n    }\n\n    // 2. Try to block opponent from winning\n    const opponentSymbol = getOpponentSymbol(this.symbol);\n    const blockingMove = this.findWinningMove(board, opponentSymbol);\n    if (blockingMove !== null) {\n      return blockingMove;\n    }\n\n    // 3. Take center positions if available\n    const centerPositions = [7, 8];\n    const availableCenters = availableMoves.filter(move => centerPositions.includes(move));\n    if (availableCenters.length > 0) {\n      return availableCenters[Math.floor(Math.random() * availableCenters.length)];\n    }\n\n    // 4. Random move\n    return this.makeRandomMove(availableMoves);\n  }\n\n  private makeHardMove(board: GameBoard, availableMoves: number[]): number {\n    // Use minimax algorithm for hard difficulty\n    const bestMove = this.minimax(board, 6, true, -Infinity, Infinity);\n    return bestMove.position || availableMoves[0];\n  }\n\n  private findWinningMove(board: GameBoard, player: string): number | null {\n    const availableMoves = getAvailableMoves(board);\n    \n    for (const move of availableMoves) {\n      const testBoard = makeMove(board, move, player);\n      const result = checkWin(testBoard, player);\n      if (result.winner) {\n        return move;\n      }\n    }\n    \n    return null;\n  }\n\n  private minimax(board: GameBoard, depth: number, isMaximizing: boolean, alpha: number, beta: number): { score: number; position?: number } {\n    const availableMoves = getAvailableMoves(board);\n    \n    // Check terminal states\n    const aiResult = checkWin(board, this.symbol);\n    const humanResult = checkWin(board, getOpponentSymbol(this.symbol));\n    \n    if (aiResult.winner) {\n      return { score: 10 + depth };\n    }\n    if (humanResult.winner) {\n      return { score: -10 - depth };\n    }\n    if (availableMoves.length === 0) {\n      return { score: 0 };\n    }\n    if (depth === 0) {\n      return { score: this.evaluateBoard(board) };\n    }\n\n    if (isMaximizing) {\n      let bestScore = -Infinity;\n      let bestMove;\n      \n      for (const move of availableMoves) {\n        const testBoard = makeMove(board, move, this.symbol);\n        const result = this.minimax(testBoard, depth - 1, false, alpha, beta);\n        \n        if (result.score > bestScore) {\n          bestScore = result.score;\n          bestMove = move;\n        }\n        \n        alpha = Math.max(alpha, result.score);\n        if (beta <= alpha) {\n          break; // Alpha-beta pruning\n        }\n      }\n      \n      return { score: bestScore, position: bestMove };\n    } else {\n      let bestScore = Infinity;\n      let bestMove;\n      \n      for (const move of availableMoves) {\n        const testBoard = makeMove(board, move, getOpponentSymbol(this.symbol));\n        const result = this.minimax(testBoard, depth - 1, true, alpha, beta);\n        \n        if (result.score < bestScore) {\n          bestScore = result.score;\n          bestMove = move;\n        }\n        \n        beta = Math.min(beta, result.score);\n        if (beta <= alpha) {\n          break; // Alpha-beta pruning\n        }\n      }\n      \n      return { score: bestScore, position: bestMove };\n    }\n  }\n\n  private evaluateBoard(board: GameBoard): number {\n    let score = 0;\n    \n    // Evaluate horizontal patterns\n    score += this.evaluateHorizontalPatterns(board);\n    \n    // Evaluate diagonal patterns\n    score += this.evaluateDiagonalPatterns(board);\n    \n    // Center control bonus\n    const centerPositions = [7, 8];\n    for (const pos of centerPositions) {\n      if (board[pos.toString()] === this.symbol) {\n        score += 3;\n      } else if (board[pos.toString()] === getOpponentSymbol(this.symbol)) {\n        score -= 3;\n      }\n    }\n    \n    return score;\n  }\n\n  private evaluateHorizontalPatterns(board: GameBoard): number {\n    // No horizontal patterns since only diagonal wins count\n    return 0;\n  }\n\n  private evaluateDiagonalPatterns(board: GameBoard): number {\n    let score = 0;\n    const diagonals = [\n      [1, 7, 13],   // Main diagonal\n      [2, 8, 14],   // Main diagonal\n      [3, 9, 15],   // Main diagonal\n      [3, 7, 11],   // Anti-diagonal\n      [4, 8, 12],   // Anti-diagonal\n      [5, 9, 13],   // Anti-diagonal\n      [6, 8, 10],   // Center horizontal diagonal\n      [11, 7, 3],   // Anti-diagonal\n      [12, 8, 4],   // Anti-diagonal\n      [13, 9, 5],   // Anti-diagonal\n      [1, 8, 15],   // Long diagonal\n      [5, 8, 11],   // Long diagonal\n    ];\n\n    for (const diagonal of diagonals) {\n      const aiCount = diagonal.filter(pos => board[pos.toString()] === this.symbol).length;\n      const humanCount = diagonal.filter(pos => board[pos.toString()] === getOpponentSymbol(this.symbol)).length;\n      \n      if (aiCount > 0 && humanCount === 0) {\n        score += Math.pow(5, aiCount);\n      } else if (humanCount > 0 && aiCount === 0) {\n        score -= Math.pow(5, humanCount);\n      }\n    }\n\n    return score;\n  }\n}\n","size_bytes":6109},"server/auth.ts":{"content":"import fs from 'fs';\nimport path from 'path';\nimport crypto from 'crypto';\nimport { Express } from 'express';\nimport session from 'express-session';\nimport connectPgSimple from 'connect-pg-simple';\nimport MemoryStore from 'memorystore';\nimport { storage } from './storage';\nimport { db } from './db';\nimport { sql } from 'drizzle-orm';\nimport { createEmailService } from './emailService';\n\ninterface User {\n  id: string;\n  username: string;\n  password: string;\n  email?: string;\n  displayName?: string;\n  profilePicture?: string;\n  isEmailVerified?: boolean;\n  emailVerificationToken?: string;\n  emailVerificationExpiry?: Date;\n  passwordResetToken?: string;\n  passwordResetExpiry?: Date;\n  isGuest?: boolean;\n  guestExpiresAt?: string; // For JSON storage compatibility\n  createdAt: string;\n}\n\ninterface Session {\n  userId: string;\n  username: string;\n}\n\ndeclare global {\n  namespace Express {\n    interface Request {\n      user?: Session;\n    }\n    interface SessionData {\n      user?: Session;\n    }\n  }\n}\n\nconst usersFilePath = path.join(process.cwd(), 'users.json');\n\n// Initialize users file if it doesn't exist\nif (!fs.existsSync(usersFilePath)) {\n  fs.writeFileSync(usersFilePath, JSON.stringify([], null, 2));\n}\n\n// Simple hash function for passwords\nfunction hashPassword(password: string): string {\n  return crypto.createHash('sha256').update(password).digest('hex');\n}\n\nfunction getUsers(): User[] {\n  try {\n    const data = fs.readFileSync(usersFilePath, 'utf8');\n    return JSON.parse(data);\n  } catch (error) {\n    return [];\n  }\n}\n\nfunction saveUsers(users: User[]): void {\n  fs.writeFileSync(usersFilePath, JSON.stringify(users, null, 2));\n}\n\nfunction findUserByUsername(username: string): User | undefined {\n  const users = getUsers();\n  return users.find(u => u.username === username);\n}\n\n// Generate 6-digit verification code\nfunction generateVerificationCode(): string {\n  return Math.floor(100000 + Math.random() * 900000).toString();\n}\n\nasync function createUser(username: string, password: string, email?: string): Promise<User> {\n  const users = getUsers();\n  const verificationToken = email ? generateVerificationCode() : undefined;\n  const verificationExpiry = email ? new Date(Date.now() + 24 * 60 * 60 * 1000) : undefined; // 24 hours\n  \n  const newUser: User = {\n    id: crypto.randomUUID(),\n    username,\n    password: hashPassword(password),\n    email: email ? email.toLowerCase() : email,\n    displayName: username,\n    profilePicture: undefined,\n    isEmailVerified: false,\n    emailVerificationToken: verificationToken,\n    emailVerificationExpiry: verificationExpiry,\n    createdAt: new Date().toISOString()\n  };\n  users.push(newUser);\n  saveUsers(users);\n  \n  // Also create user in database\n  try {\n    await storage.upsertUser({\n      id: newUser.id,\n      email: email || null,\n      firstName: newUser.displayName || newUser.username,\n      displayName: newUser.displayName || newUser.username,\n      lastName: null,\n      profileImageUrl: newUser.profilePicture,\n      isGuest: false,\n    });\n    console.log('User created in database:', newUser.id);\n  } catch (error) {\n    console.error('Error creating user in database:', error);\n    // Don't return error here as the user is already created in JSON\n  }\n  \n  return newUser;\n}\n\nasync function createGuestUser(): Promise<User> {\n  const guestId = crypto.randomUUID();\n  const guestName = `Guest_${Math.floor(Math.random() * 10000)}`;\n  \n  const guestUser: User = {\n    id: guestId,\n    username: guestName,\n    password: '', // No password for guests\n    email: undefined,\n    displayName: guestName,\n    profilePicture: undefined,\n    isEmailVerified: true, // Guests don't need email verification\n    emailVerificationToken: undefined,\n    emailVerificationExpiry: undefined,\n    isGuest: true, // Flag to identify as guest user\n    createdAt: new Date().toISOString()\n  };\n  \n  // Store guest user in JSON (for consistency)\n  const users = getUsers();\n  users.push(guestUser);\n  saveUsers(users);\n  \n  // Create guest user in database\n  try {\n    await storage.upsertUser({\n      id: guestUser.id,\n      email: null,\n      firstName: guestName,\n      displayName: guestName,\n      lastName: null,\n      profileImageUrl: null,\n      isGuest: true,\n      guestSessionExpiry: null, // No expiry - guest stays until logout\n    });\n    // Guest user created in database\n  } catch (error) {\n    console.error('Error creating guest user in database:', error);\n    throw new Error('Failed to create guest user');\n  }\n  \n  return guestUser;\n}\n\nfunction updateUser(userId: string, updates: Partial<User>): User | null {\n  const users = getUsers();\n  const userIndex = users.findIndex(u => u.id === userId);\n  \n  if (userIndex === -1) {\n    return null;\n  }\n  \n  users[userIndex] = { ...users[userIndex], ...updates };\n  saveUsers(users);\n  \n  // Also update user in database\n  try {\n    storage.upsertUser({\n      id: userId,\n      email: users[userIndex].email || null,\n      firstName: users[userIndex].displayName || users[userIndex].username,\n      displayName: users[userIndex].displayName || null,\n      username: users[userIndex].username || null,\n      profileImageUrl: users[userIndex].profilePicture || null,\n    });\n  } catch (error) {\n    console.error('Error updating user in database:', error);\n  }\n  \n  return users[userIndex];\n}\n\nfunction getUserById(userId: string): User | undefined {\n  const users = getUsers();\n  return users.find(u => u.id === userId);\n}\n\nfunction findUserByEmail(email: string): User | undefined {\n  const users = getUsers();\n  return users.find(u => u.email && u.email.toLowerCase() === email.toLowerCase());\n}\n\nasync function sendVerificationEmail(email: string, token: string): Promise<boolean> {\n  const emailService = createEmailService();\n  if (!emailService) {\n    console.log('Email service not configured - verification email not sent');\n    return false;\n  }\n  \n  try {\n    const result = await emailService.sendVerificationEmail(email, token);\n    if (!result) {\n      console.error('Failed to send verification email - sendEmail returned false');\n      return false;\n    }\n    return true;\n  } catch (error) {\n    console.error('Failed to send verification email:', error);\n    return false;\n  }\n}\n\nasync function sendPasswordResetEmail(email: string, token: string): Promise<boolean> {\n  const emailService = createEmailService();\n  if (!emailService) {\n    console.log('Email service not configured - password reset email not sent');\n    return false;\n  }\n  \n  try {\n    console.log(`üìß Attempting to send password reset email to: ${email}`);\n    const result = await emailService.sendPasswordResetEmail(email, token);\n    if (!result) {\n      console.error('‚ùå Failed to send password reset email - email service returned false');\n      return false;\n    }\n    console.log(`‚úÖ Password reset email sent successfully to: ${email}`);\n    return true;\n  } catch (error) {\n    console.error('‚ùå Exception while sending password reset email:', error);\n    return false;\n  }\n}\n\n// Clean up guest user when they log out\nexport async function cleanupGuestOnLogout(userId: string) {\n  try {\n    const users = getUsers();\n    const user = users.find(u => u.id === userId);\n    \n    if (user && user.isGuest) {\n      // Remove guest from JSON storage\n      const updatedUsers = users.filter(u => u.id !== userId);\n      saveUsers(updatedUsers);\n      \n      // Remove guest from database\n      await storage.deleteUser(userId);\n      console.log(`üßπ Cleaned up guest user on logout: ${user.username} (${userId})`);\n    }\n  } catch (error: any) {\n    console.error('‚ùå Error cleaning up guest user:', error.message || error);\n  }\n}\n\n// Sync all existing JSON users to the database\nasync function syncAllUsersToDatabase() {\n  try {\n    const users = getUsers();\n    console.log(`üîÑ Syncing ${users.length} users from JSON to Neon database...`);\n    \n    for (const user of users) {\n      try {\n        await storage.upsertUser({\n          id: user.id,\n          email: user.email || null,\n          firstName: user.displayName || user.username || 'Anonymous',\n          lastName: null,\n          displayName: user.displayName || user.username || 'Anonymous',\n          username: user.username || null,\n          profileImageUrl: user.profilePicture || null,\n          isGuest: user.isGuest || false,\n          guestSessionExpiry: null, // No expiry - guest stays until logout\n        });\n        console.log(`‚úÖ Synced user: ${user.username} (${user.id})`);\n      } catch (error: any) {\n        // Log error but continue with other users\n        console.error(`‚ùå Failed to sync user ${user.username}:`, error.message || error);\n      }\n    }\n    \n    console.log('üéâ User sync completed!');\n  } catch (error: any) {\n    console.error('Failed to sync users to database:', error.message || error);\n  }\n}\n\nexport function setupAuth(app: Express) {\n  // PostgreSQL store for sessions (persistent across server restarts)\n  const PostgreSQLStore = connectPgSimple(session);\n  \n  let sessionStore;\n  try {\n    // Use connection string directly for session store\n    const DATABASE_URL = process.env.DATABASE_URL || \"postgresql://neondb_owner:npg_tNTYy7S9AMuP@ep-wandering-wave-aef2douv-pooler.c-2.us-east-2.aws.neon.tech/neondb?sslmode=require&channel_binding=require\";\n    \n    sessionStore = new PostgreSQLStore({\n      conString: DATABASE_URL,\n      tableName: 'session',\n      createTableIfMissing: true,\n      pruneSessionInterval: false, // Disable automatic pruning to avoid issues\n      ttl: 100 * 365 * 24 * 60 * 60, // 100 years - effectively never expires\n    });\n    \n    // Test the session store connection\n    sessionStore.on('connect', () => {\n      console.log('‚úÖ PostgreSQL session store connected successfully');\n    });\n    \n    sessionStore.on('disconnect', () => {\n      console.log('‚ö†Ô∏è PostgreSQL session store disconnected');\n    });\n    \n    console.log('‚úÖ PostgreSQL session store initialized with connection string');\n  } catch (error) {\n    console.log('‚ö†Ô∏è PostgreSQL session store failed, falling back to memory store:', (error as Error).message);\n    const MemoryStoreSession = MemoryStore(session);\n    sessionStore = new MemoryStoreSession({\n      checkPeriod: 86400000 // prune expired entries every 24h\n    });\n  }\n  \n  // Sync all existing users to database on startup\n  syncAllUsersToDatabase();\n  \n  // Recalculate all user stats to ensure they're up to date\n  setTimeout(async () => {\n    try {\n      // Add the missing last_move_at column if it doesn't exist\n      try {\n        await db.execute(sql`ALTER TABLE games ADD COLUMN IF NOT EXISTS last_move_at TIMESTAMP DEFAULT NOW()`);\n        console.log('‚úÖ Database column last_move_at ensured');\n      } catch (columnError: any) {\n        // Column might already exist, this is fine\n        if (columnError.code === '42701') {\n          console.log('‚ÑπÔ∏è Database column last_move_at already exists');\n        } else {\n          console.log('‚ö†Ô∏è Database column modification warning:', columnError.message);\n        }\n      }\n      \n      await storage.recalculateAllUserStats();\n      // console.log('‚úÖ User stats recalculation completed!');\n    } catch (error: any) {\n      console.error('Failed to recalculate user stats:', error.message);\n    }\n  }, 5000); // Wait 5 seconds to ensure database sync is complete\n  \n  // Session middleware with PostgreSQL storage\n  app.use(session({\n    secret: process.env.SESSION_SECRET || 'your-secret-key-change-in-production',\n    resave: false,\n    saveUninitialized: false,\n    store: sessionStore,\n    cookie: {\n      secure: process.env.NODE_ENV === 'production', // Only use secure in production\n      httpOnly: true,\n      maxAge: 100 * 365 * 24 * 60 * 60 * 1000, // 100 years - effectively never expires\n      sameSite: 'lax'\n    }\n  }));\n\n  // Register endpoint\n  app.post('/api/auth/register', async (req, res) => {\n    const { username, password, email } = req.body;\n\n    if (!username || !password || !email) {\n      return res.status(400).json({ error: 'Username, password, and email are required' });\n    }\n\n    // Enhanced validation\n    if (typeof username !== 'string' || username.length < 3 || username.length > 20) {\n      return res.status(400).json({ error: 'Username must be between 3 and 20 characters' });\n    }\n\n    if (typeof password !== 'string' || password.length < 6) {\n      return res.status(400).json({ error: 'Password must be at least 6 characters long' });\n    }\n\n    // Email validation\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (typeof email !== 'string' || !emailRegex.test(email)) {\n      return res.status(400).json({ error: 'Please provide a valid email address' });\n    }\n\n    if (findUserByUsername(username)) {\n      return res.status(400).json({ error: 'Username already exists' });\n    }\n\n    if (findUserByEmail(email)) {\n      return res.status(400).json({ error: 'Email already exists' });\n    }\n\n    try {\n      const user = await createUser(username, password, email);\n      \n      // DO NOT create session until email is verified\n      // const sessionData = { userId: user.id, username: user.username };\n      // req.session.user = sessionData;\n      \n      // Sync user to database\n      try {\n        await storage.upsertUser({\n          id: user.id,\n          email: user.email || null,\n          firstName: user.displayName || user.username,\n          displayName: user.displayName || null,\n          username: user.username || null,\n          profileImageUrl: user.profilePicture || null,\n        });\n      } catch (error) {\n        console.error('Error syncing new user to database:', error);\n      }\n      \n      // Send verification email (mandatory)\n      if (email && user.emailVerificationToken) {\n        const emailSent = await sendVerificationEmail(email, user.emailVerificationToken);\n        if (!emailSent) {\n          console.error('Failed to send verification email - email service returned false');\n          return res.status(500).json({ error: 'Failed to send verification email. Please try again later.' });\n        }\n      }\n      \n      res.json({ \n        id: user.id, \n        username: user.username,\n        email: user.email,\n        isEmailVerified: user.isEmailVerified,\n        message: 'Registration successful! Please check your email to verify your account before logging in.'\n      });\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to create user' });\n    }\n  });\n\n  // Guest login endpoint\n  app.post('/api/auth/guest', async (req, res) => {\n    try {\n      // Check if user already has a session (prevent duplicate guest creation)\n      if ((req.session as any)?.user) {\n        console.log('User already has session:', (req.session as any).user.userId);\n        return res.status(400).json({ error: 'User already has an active session' });\n      }\n\n      const guestUser = await createGuestUser();\n      const sessionData = { userId: guestUser.id, username: guestUser.username, displayName: guestUser.displayName };\n      (req.session as any).user = sessionData;\n      \n      console.log('‚úÖ Guest user created via explicit /api/auth/guest request:', guestUser.username);\n      \n      res.json({ \n        id: guestUser.id, \n        username: guestUser.username, \n        email: null, \n        isEmailVerified: true,\n        isGuest: true \n      });\n    } catch (error: any) {\n      console.error('Error creating guest user:', error);\n      res.status(500).json({ error: 'Failed to create guest user' });\n    }\n  });\n\n  // Login endpoint\n  app.post('/api/auth/login', async (req, res) => {\n    const { username, password } = req.body;\n\n    if (!username || !password) {\n      return res.status(400).json({ error: 'Username/email and password are required' });\n    }\n\n    // Enhanced validation\n    if (typeof username !== 'string' || username.trim().length === 0) {\n      return res.status(400).json({ error: 'Username/email is required' });\n    }\n\n    if (typeof password !== 'string' || password.length === 0) {\n      return res.status(400).json({ error: 'Password is required' });\n    }\n\n    // Try to find user by username first, then by email\n    let user = findUserByUsername(username);\n    if (!user) {\n      user = findUserByEmail(username);\n    }\n\n    if (!user || user.password !== hashPassword(password)) {\n      return res.status(401).json({ error: 'Invalid username/email or password' });\n    }\n\n    // Check if email is verified (mandatory) - Skip for admin testing and existing test users\n    const skipVerification = ['admin', 'sam00', 'sam01', 'testuser', 'ethan'].includes(user.username);\n    if (!user.isEmailVerified && !skipVerification) {\n      return res.status(403).json({ \n        error: 'Email verification required',\n        message: 'Please verify your email before logging in. Check your email for the verification link.',\n        needsVerification: true \n      });\n    }\n\n    // Ensure user exists in database\n    try {\n      await storage.upsertUser({\n        id: user.id,\n        email: user.email || null,\n        firstName: user.displayName || user.username || 'Anonymous',\n        lastName: null,\n        displayName: user.displayName || user.username || 'Anonymous',\n        username: user.username || null,\n        profileImageUrl: user.profilePicture || null,\n      });\n      console.log('User synced to database:', user.id);\n    } catch (error) {\n      console.error('Error syncing user to database:', error);\n      return res.status(500).json({ error: 'Failed to sync user data' });\n    }\n\n    const sessionData = { userId: user.id, username: user.username, displayName: user.displayName };\n    (req.session as any).user = sessionData;\n    \n    console.log('‚úÖ Regular user logged in:', user.username, '(ID:', user.id, ')');\n    \n    res.json({ id: user.id, username: user.username, email: user.email, isEmailVerified: user.isEmailVerified });\n  });\n\n  // Logout endpoint\n  app.post('/api/auth/logout', async (req, res) => {\n    const userId = (req.session as any)?.user?.userId;\n    \n    req.session.destroy(async (err: any) => {\n      if (err) {\n        return res.status(500).json({ error: 'Failed to logout' });\n      }\n      \n      // Clean up guest user if logging out\n      if (userId) {\n        try {\n          await cleanupGuestOnLogout(userId);\n        } catch (error) {\n          console.error('Error cleaning up guest user on logout:', error);\n          // Don't fail logout if cleanup fails\n        }\n      }\n      \n      res.json({ message: 'Logged out successfully' });\n    });\n  });\n\n  // Get current user endpoint\n  app.get('/api/auth/user', async (req, res) => {\n    if (!(req.session as any)?.user) {\n      return res.status(401).json({ error: 'Not authenticated' });\n    }\n    \n    // Get full user info including profile data\n    const user = getUserById((req.session as any).user.userId);\n    if (!user) {\n      return res.status(404).json({ error: 'User not found' });\n    }\n    \n    try {\n      // Get selectedAchievementBorder from database\n      const dbUser = await storage.getUser(user.id);\n      \n      res.json({\n        userId: user.id,\n        username: user.username,\n        displayName: user.displayName,\n        profilePicture: user.profilePicture,\n        email: user.email,\n        isEmailVerified: user.isEmailVerified,\n        selectedAchievementBorder: dbUser?.selectedAchievementBorder || null\n      });\n    } catch (error) {\n      console.error('Error fetching user from database:', error);\n      // Return basic user info if database fails\n      res.json({\n        userId: user.id,\n        username: user.username,\n        displayName: user.displayName,\n        profilePicture: user.profilePicture,\n        email: user.email,\n        isEmailVerified: user.isEmailVerified,\n        selectedAchievementBorder: null\n      });\n    }\n  });\n\n  // Email verification endpoint\n  app.post('/api/auth/verify-email', async (req, res) => {\n    const { token } = req.body;\n\n    if (!token) {\n      return res.status(400).json({ error: 'Verification token is required' });\n    }\n\n    const users = getUsers();\n    const user = users.find(u => u.emailVerificationToken === token);\n    \n    if (!user) {\n      return res.status(400).json({ error: 'Invalid or expired verification token' });\n    }\n\n    // Check if token is expired\n    if (user.emailVerificationExpiry && new Date() > new Date(user.emailVerificationExpiry)) {\n      return res.status(400).json({ error: 'Verification token has expired' });\n    }\n\n    // Mark user as verified\n    const updatedUser = updateUser(user.id, {\n      isEmailVerified: true,\n      emailVerificationToken: undefined,\n      emailVerificationExpiry: undefined\n    });\n\n    if (!updatedUser) {\n      return res.status(500).json({ error: 'Failed to verify email' });\n    }\n\n    // Sync updated user to database\n    try {\n      await storage.upsertUser({\n        id: updatedUser.id,\n        email: updatedUser.email || null,\n        firstName: updatedUser.displayName || updatedUser.username || 'Anonymous',\n        lastName: null,\n        displayName: updatedUser.displayName || updatedUser.username || 'Anonymous',\n        username: updatedUser.username || null,\n        profileImageUrl: updatedUser.profilePicture || null,\n      });\n      console.log('User synced to database:', updatedUser.id);\n    } catch (error) {\n      console.error('Error syncing verified user to database:', error);\n    }\n\n    res.json({ message: 'Email verified successfully! You can now log in.' });\n  });\n\n  // Resend verification email endpoint\n  app.post('/api/auth/resend-verification', async (req, res) => {\n    const { email } = req.body;\n\n    if (!email) {\n      return res.status(400).json({ error: 'Email is required' });\n    }\n\n    const user = findUserByEmail(email);\n    if (!user) {\n      return res.status(404).json({ error: 'User not found' });\n    }\n\n    if (user.isEmailVerified) {\n      return res.status(400).json({ error: 'Email is already verified' });\n    }\n\n    // Generate new verification code\n    const newToken = generateVerificationCode();\n    const newExpiry = new Date(Date.now() + 24 * 60 * 60 * 1000); // 24 hours\n\n    const updatedUser = updateUser(user.id, {\n      emailVerificationToken: newToken,\n      emailVerificationExpiry: newExpiry\n    });\n\n    if (!updatedUser) {\n      return res.status(500).json({ error: 'Failed to generate new verification token' });\n    }\n\n    // Sync updated user to database\n    try {\n      await storage.upsertUser({\n        id: updatedUser.id,\n        email: updatedUser.email || null,\n        firstName: updatedUser.displayName || updatedUser.username || 'Anonymous',\n        lastName: null,\n        displayName: updatedUser.displayName || updatedUser.username || 'Anonymous',\n        username: updatedUser.username || null,\n        profileImageUrl: updatedUser.profilePicture || null,\n      });\n      console.log('User resend verification synced to database:', updatedUser.id);\n    } catch (error) {\n      console.error('Error syncing resend verification user to database:', error);\n    }\n\n    // Send verification email\n    const emailSent = await sendVerificationEmail(email, newToken);\n    if (!emailSent) {\n      console.error('Failed to send verification email - email service returned false');\n      return res.status(500).json({ error: 'Failed to send verification email. Please try again later.' });\n    }\n    \n    res.json({ message: 'Verification email sent successfully' });\n  });\n\n  // Update user profile endpoint\n  app.put('/api/auth/profile', async (req, res) => {\n    if (!(req.session as any).user) {\n      return res.status(401).json({ error: 'Not authenticated' });\n    }\n    \n    const { displayName, profilePicture } = req.body;\n    const userId = (req.session as any).user.userId;\n    \n    try {\n      const updates: Partial<User> = {};\n      if (displayName !== undefined) updates.displayName = displayName;\n      if (profilePicture !== undefined) updates.profilePicture = profilePicture;\n      \n      // Update user in JSON file\n      const updatedUser = updateUser(userId, updates);\n      if (!updatedUser) {\n        return res.status(404).json({ error: 'User not found' });\n      }\n      \n      // Also update user in database to keep session valid\n      try {\n        await storage.upsertUser({\n          id: updatedUser.id,\n          email: updatedUser.email || null,\n          firstName: updatedUser.displayName || updatedUser.username || 'Anonymous',\n          lastName: null,\n          displayName: updatedUser.displayName || updatedUser.username || 'Anonymous',\n          username: updatedUser.username || null,\n          profileImageUrl: updatedUser.profilePicture || null,\n        });\n        // User profile synced to database\n      } catch (error) {\n        console.error('Error syncing updated user to database:', error);\n        // Continue even if database sync fails to avoid breaking the session\n      }\n      \n      // Keep session alive - update session data if needed\n      (req.session as any).user = {\n        ...(req.session as any).user,\n        displayName: updatedUser.displayName,\n        profilePicture: updatedUser.profilePicture\n      };\n      \n      res.json({\n        userId: updatedUser.id,\n        username: updatedUser.username,\n        displayName: updatedUser.displayName,\n        profilePicture: updatedUser.profilePicture,\n        email: updatedUser.email,\n        isEmailVerified: updatedUser.isEmailVerified\n      });\n    } catch (error) {\n      console.error('Error updating user profile:', error);\n      res.status(500).json({ error: 'Failed to update profile' });\n    }\n  });\n\n  // Send email verification\n  app.post('/api/auth/send-verification', async (req, res) => {\n    const { email } = req.body;\n    \n    if (!email) {\n      return res.status(400).json({ error: 'Email is required' });\n    }\n    \n    const user = findUserByEmail(email);\n    if (!user) {\n      return res.status(404).json({ error: 'User not found' });\n    }\n    \n    if (user.isEmailVerified) {\n      return res.status(400).json({ error: 'Email already verified' });\n    }\n    \n    try {\n      const verificationToken = crypto.randomUUID();\n      const verificationExpiry = new Date(Date.now() + 24 * 60 * 60 * 1000); // 24 hours\n      \n      updateUser(user.id, {\n        emailVerificationToken: verificationToken,\n        emailVerificationExpiry: verificationExpiry\n      });\n      \n      await sendVerificationEmail(email, verificationToken);\n      \n      res.json({ message: 'Verification email sent' });\n    } catch (error) {\n      console.error('Error sending verification email:', error);\n      res.status(500).json({ error: 'Failed to send verification email' });\n    }\n  });\n\n  // Test email endpoint (for debugging)\n  app.post('/api/auth/test-email', async (req, res) => {\n    const { email } = req.body;\n\n    if (!email) {\n      return res.status(400).json({ error: 'Email is required' });\n    }\n\n    const emailService = createEmailService();\n    if (!emailService) {\n      return res.status(500).json({ error: 'Email service is currently unavailable. Please contact support or try again later.' });\n    }\n\n    try {\n      console.log(`üìß Sending test email to: ${email}`);\n      const result = await emailService.sendTestEmail(email);\n      \n      if (result) {\n        console.log(`‚úÖ Test email sent successfully to: ${email}`);\n        return res.json({ message: 'Test email sent successfully!' });\n      } else {\n        console.error(`‚ùå Failed to send test email to: ${email}`);\n        return res.status(500).json({ error: 'Failed to send test email. Please check server logs.' });\n      }\n    } catch (error: any) {\n      console.error('‚ùå Error sending test email:', error);\n      return res.status(500).json({ error: 'Internal server error while sending email.' });\n    }\n  });\n\n  // Forgot password endpoint\n  app.post('/api/auth/forgot-password', async (req, res) => {\n    const { email } = req.body;\n\n    if (!email) {\n      return res.status(400).json({ error: 'Email is required' });\n    }\n\n    const user = findUserByEmail(email);\n    if (!user) {\n      // Don't reveal if email exists or not for security\n      return res.json({ message: 'If an account with this email exists, a password reset link has been sent.' });\n    }\n\n    try {\n      const resetCode = generateVerificationCode();\n      const resetExpiry = new Date(Date.now() + 60 * 60 * 1000); // 1 hour\n\n      const updatedUser = updateUser(user.id, {\n        passwordResetToken: resetCode,\n        passwordResetExpiry: resetExpiry\n      });\n\n      // Sync updated user to database\n      if (updatedUser) {\n        try {\n          await storage.upsertUser({\n            id: updatedUser.id,\n            email: updatedUser.email || null,\n            firstName: updatedUser.displayName || updatedUser.username || 'Anonymous',\n            lastName: null,\n            displayName: updatedUser.displayName || updatedUser.username || 'Anonymous',\n            username: updatedUser.username || null,\n            profileImageUrl: updatedUser.profilePicture || null,\n          });\n          console.log('User forgot password synced to database:', updatedUser.id);\n        } catch (error) {\n          console.error('Error syncing forgot password user to database:', error);\n        }\n      }\n\n      const emailSent = await sendPasswordResetEmail(email, resetCode);\n      if (!emailSent) {\n        console.error('Failed to send password reset email - email service returned false');\n        return res.status(500).json({ \n          error: 'Email service is currently unavailable. Please contact support or try again later.',\n          details: 'The email service configuration is incomplete. Please ensure SMTP settings are properly configured.'\n        });\n      }\n\n      res.json({ message: 'If an account with this email exists, a password reset code has been sent.' });\n    } catch (error) {\n      console.error('Error sending password reset email:', error);\n      res.status(500).json({ error: 'Failed to send password reset email' });\n    }\n  });\n\n  // Manual sync endpoint (admin only)\n  app.post('/api/auth/sync-users', async (req, res) => {\n    if (!(req.session as any).user) {\n      return res.status(401).json({ error: 'Not authenticated' });\n    }\n    \n    const userId = (req.session as any).user.userId;\n    const user = getUserById(userId);\n    \n    // Only allow admin to manually sync\n    if (!user || user.username !== 'admin') {\n      return res.status(403).json({ error: 'Admin access required' });\n    }\n    \n    try {\n      await syncAllUsersToDatabase();\n      res.json({ message: 'All users synced successfully' });\n    } catch (error) {\n      console.error('Manual sync error:', error);\n      res.status(500).json({ error: 'Failed to sync users' });\n    }\n  });\n\n  // Reset password endpoint\n  app.post('/api/auth/reset-password', async (req, res) => {\n    const { token, newPassword } = req.body;\n\n    if (!token || !newPassword) {\n      return res.status(400).json({ error: 'Token and new password are required' });\n    }\n\n    if (newPassword.length < 6) {\n      return res.status(400).json({ error: 'Password must be at least 6 characters long' });\n    }\n\n    const users = getUsers();\n    const user = users.find(u => u.passwordResetToken === token);\n\n    if (!user) {\n      return res.status(400).json({ error: 'Invalid or expired reset token' });\n    }\n\n    // Check if token is expired\n    if (user.passwordResetExpiry && new Date() > new Date(user.passwordResetExpiry)) {\n      return res.status(400).json({ error: 'Reset token has expired' });\n    }\n\n    try {\n      // Update password and clear reset token\n      const updatedUser = updateUser(user.id, {\n        password: hashPassword(newPassword),\n        passwordResetToken: undefined,\n        passwordResetExpiry: undefined\n      });\n\n      if (!updatedUser) {\n        return res.status(500).json({ error: 'Failed to update password' });\n      }\n\n      // Sync updated user to database\n      try {\n        await storage.upsertUser({\n          id: updatedUser.id,\n          email: updatedUser.email || null,\n          firstName: updatedUser.displayName || updatedUser.username || 'Anonymous',\n          lastName: null,\n          displayName: updatedUser.displayName || updatedUser.username || 'Anonymous',\n          username: updatedUser.username || null,\n          profileImageUrl: updatedUser.profilePicture || null,\n        });\n        console.log('User password reset synced to database:', updatedUser.id);\n      } catch (error) {\n        console.error('Error syncing password reset user to database:', error);\n      }\n\n      res.json({ message: 'Password has been reset successfully. You can now log in with your new password.' });\n    } catch (error) {\n      console.error('Error resetting password:', error);\n      res.status(500).json({ error: 'Failed to reset password' });\n    }\n  });\n\n  // Middleware to check authentication\n  app.use((req, res, next) => {\n    if ((req.session as any).user) {\n      req.user = (req.session as any).user;\n    }\n    next();\n  });\n}\n\nexport function requireAuth(req: any, res: any, next: any) {\n  if (!req.session?.user) {\n    return res.status(401).json({ error: 'Not authenticated' });\n  }\n  \n  // Check if user's email is verified - Skip for admin testing and existing test users\n  const user = getUserById(req.session.user.userId);\n  const skipVerification = ['admin', 'sam00', 'sam01', 'testuser', 'ethan'].includes(user?.username || '');\n  if (user && user.email && !user.isEmailVerified && !skipVerification) {\n    return res.status(403).json({ error: 'Email verification required' });\n  }\n  \n  req.user = req.session.user;\n  next();\n}","size_bytes":33670},"server/db.ts":{"content":"import { Pool } from 'pg';\nimport { drizzle } from 'drizzle-orm/node-postgres';\nimport * as schema from \"@shared/schema\";\n\n// Hardcoded database URL from Replit .env\nconst DATABASE_URL = \"postgresql://neondb_owner:npg_tNTYy7S9AMuP@ep-wandering-wave-aef2douv-pooler.c-2.us-east-2.aws.neon.tech/neondb?sslmode=require&channel_binding=require\";\n\nexport const pool = new Pool({ \n  connectionString: DATABASE_URL,\n  ssl: {\n    rejectUnauthorized: false\n  }\n});\n\nexport const db = drizzle({ client: pool, schema });\n","size_bytes":510},"server/emailService.ts":{"content":"import nodemailer from 'nodemailer';\nimport fs from 'fs';\nimport path from 'path';\nimport { fileURLToPath } from 'url';\n\n// Fix for __dirname in ES modules\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\ninterface EmailConfig {\n  host: string;\n  port: number;\n  secure: boolean;\n  auth: {\n    user: string;\n    pass: string;\n  };\n}\n\ninterface EmailParams {\n  to: string;\n  subject: string;\n  text?: string;\n  html?: string;\n}\n\nexport class EmailService {\n  private transporter: any;\n  private fromEmail: string;\n\n  constructor(config: EmailConfig, fromEmail: string) {\n    this.fromEmail = fromEmail;\n    // Add connection pooling and better error handling\n    this.transporter = nodemailer.createTransport({\n      ...config,\n      pool: true, // Enable connection pooling\n      maxConnections: 5, // Maximum concurrent connections\n      maxMessages: 100, // Maximum messages per connection\n      rateDelta: 1000, // Rate limiting: 1 second between messages\n      rateLimit: 5, // Rate limiting: max 5 messages per rateDelta\n    });\n    \n    // Verify connection on startup\n    this.verifyConnection();\n  }\n\n  private async verifyConnection(): Promise<void> {\n    try {\n      await this.transporter.verify();\n      console.log('‚úÖ SMTP connection verified successfully');\n      console.log('üìß SMTP server details verified for:', this.fromEmail);\n    } catch (error) {\n      console.error('‚ùå SMTP connection verification failed:', error);\n      console.error('‚ùå Full error details:', JSON.stringify(error, null, 2));\n    }\n  }\n\n  private async ensureConnection(): Promise<void> {\n    // Create a fresh transporter for each email send to avoid stale connections\n    // This fixes the issue where emails don't send after the first one\n    console.log('üîÑ Creating fresh SMTP connection...');\n    \n    // Get the original config from environment/file\n    const emailConfig = loadEmailConfig();\n    const config = {\n      host: emailConfig.host,\n      port: parseInt(emailConfig.port),\n      secure: emailConfig.secure !== null ? emailConfig.secure : parseInt(emailConfig.port) === 465,\n      auth: {\n        user: emailConfig.user,\n        pass: emailConfig.pass,\n      },\n    };\n    \n    this.transporter = nodemailer.createTransport({\n      ...config,\n      tls: {\n        rejectUnauthorized: false,\n        ciphers: 'SSLv3'\n      },\n      debug: true,\n      logger: true\n    });\n    await this.transporter.verify();\n    console.log('‚úÖ Fresh SMTP connection created and verified');\n  }\n\n  async sendEmail(params: EmailParams): Promise<boolean> {\n    const maxRetries = 3;\n    let lastError: any;\n\n    for (let attempt = 1; attempt <= maxRetries; attempt++) {\n      try {\n        // Ensure connection is alive before sending\n        await this.ensureConnection();\n        const mailOptions = {\n          from: `\"TicTac 3x5 Game\" <${this.fromEmail}>`,\n          to: params.to,\n          subject: params.subject,\n          text: params.text,\n          html: params.html,\n          headers: {\n            'X-Mailer': 'TicTac3x5-GameApp',\n            'X-Priority': '3',\n            'X-MSMail-Priority': 'Normal',\n            'Importance': 'Normal',\n            'List-Unsubscribe': '<mailto:support@darklayerstudios.com?subject=Unsubscribe>',\n            'Reply-To': 'support@darklayerstudios.com',\n            'Return-Path': 'support@darklayerstudios.com',\n            'X-SES-Configuration-Set': 'DefaultConfigurationSet',\n            'X-Auto-Response-Suppress': 'OOF, DR, RN, NRN',\n          },\n          messageId: `<${Date.now()}.${Math.random().toString(36).substr(2, 9)}@darklayerstudios.com>`,\n        };\n\n        console.log(`üìß Sending email (attempt ${attempt}/${maxRetries}):`, {\n          to: params.to,\n          subject: params.subject,\n          from: this.fromEmail\n        });\n\n        const info = await this.transporter.sendMail(mailOptions);\n        console.log('‚úÖ Email sent successfully to:', params.to);\n        console.log('üìß Message info:', {\n          messageId: info.messageId,\n          response: info.response,\n          accepted: info.accepted,\n          rejected: info.rejected,\n          pending: info.pending,\n          envelope: info.envelope\n        });\n        \n        // Additional delivery info\n        if (info.rejected && info.rejected.length > 0) {\n          console.log('‚ö†Ô∏è Some emails were rejected:', info.rejected);\n        }\n        if (info.pending && info.pending.length > 0) {\n          console.log('‚è≥ Some emails are pending:', info.pending);\n        }\n        return true;\n      } catch (error) {\n        lastError = error;\n        console.error(`‚ùå SMTP email error (attempt ${attempt}/${maxRetries}):`, error);\n        console.error('‚ùå Full error details:', JSON.stringify(error, null, 2));\n        \n        // If it's the last attempt, don't wait\n        if (attempt < maxRetries) {\n          const delay = attempt * 1000; // Exponential backoff: 1s, 2s, 3s\n          console.log(`‚è≥ Waiting ${delay}ms before retry...`);\n          await new Promise(resolve => setTimeout(resolve, delay));\n        }\n      }\n    }\n\n    console.error('‚ùå Failed to send email after all retries:', lastError);\n    return false;\n  }\n\n  async sendVerificationEmail(email: string, verificationCode: string): Promise<boolean> {\n    const html = `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;\">\n        <h2 style=\"color: #1e40af; text-align: center;\">Verify Your Email - TicTac 3x5</h2>\n        <p>Thanks for signing up for TicTac 3x5! Please use the verification code below to verify your email address.</p>\n        \n        <div style=\"text-align: center; margin: 30px 0; padding: 20px; background-color: #f8fafc; border-radius: 8px; border: 2px dashed #1e40af;\">\n          <h3 style=\"margin: 0; color: #1e40af;\">Your Verification Code:</h3>\n          <div style=\"font-size: 32px; font-weight: bold; color: #1e40af; letter-spacing: 4px; margin: 10px 0;\">\n            ${verificationCode}\n          </div>\n          <p style=\"margin: 0; color: #666; font-size: 14px;\">Enter this code on the verification page</p>\n        </div>\n        \n        <p style=\"text-align: center; margin: 20px 0;\">\n          <strong>Code expires in 24 hours</strong>\n        </p>\n        \n        <p style=\"color: #666; font-size: 12px; margin-top: 30px; text-align: center;\">\n          If you didn't create an account, you can safely ignore this email.\n        </p>\n      </div>\n    `;\n\n    return await this.sendEmail({\n      to: email,\n      subject: 'Your Verification Code - TicTac 3x5',\n      html,\n      text: `Your TicTac 3x5 verification code is: ${verificationCode}. This code expires in 24 hours.`,\n    });\n  }\n\n  async sendTestEmail(email: string): Promise<boolean> {\n    const html = `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;\">\n        <h2 style=\"color: #1e40af; text-align: center;\">Test Email - TicTac 3x5</h2>\n        <p>This is a test email to verify that the SMTP service is working correctly.</p>\n        <p>If you receive this email, the email service is properly configured and working.</p>\n        <p style=\"color: #666; font-size: 12px; margin-top: 30px; text-align: center;\">\n          Test sent at: ${new Date().toISOString()}\n        </p>\n      </div>\n    `;\n\n    return await this.sendEmail({\n      to: email,\n      subject: 'Test Email from TicTac 3x5',\n      html,\n      text: 'This is a test email to verify that the SMTP service is working correctly.',\n    });\n  }\n\n  async sendPasswordResetEmail(email: string, resetCode: string): Promise<boolean> {\n    const html = `\n      <!DOCTYPE html>\n      <html lang=\"en\">\n      <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>Password Reset - TicTac 3x5</title>\n      </head>\n      <body style=\"margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; color: #333; background-color: #f4f4f4;\">\n        <div style=\"max-width: 600px; margin: 20px auto; background-color: #ffffff; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); overflow: hidden;\">\n          <!-- Header -->\n          <div style=\"background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%); color: white; padding: 30px 20px; text-align: center;\">\n            <h1 style=\"margin: 0; font-size: 28px; font-weight: bold;\">üîí Password Reset</h1>\n            <p style=\"margin: 10px 0 0 0; font-size: 16px; opacity: 0.9;\">TicTac 3x5 Game</p>\n          </div>\n          \n          <!-- Content -->\n          <div style=\"padding: 40px 30px;\">\n            <h2 style=\"color: #333; margin: 0 0 20px 0; font-size: 24px;\">Reset Your Password</h2>\n            <p style=\"margin: 0 0 20px 0; font-size: 16px; color: #555;\">\n              Hello! We received a request to reset your password for your TicTac 3x5 account.\n            </p>\n            <p style=\"margin: 0 0 30px 0; font-size: 16px; color: #555;\">\n              Use the verification code below to create a new password:\n            </p>\n            \n            <!-- Code Box -->\n            <div style=\"background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%); border: 2px solid #dc2626; border-radius: 12px; padding: 30px; text-align: center; margin: 30px 0;\">\n              <p style=\"margin: 0 0 15px 0; font-size: 18px; font-weight: bold; color: #dc2626;\">Your Reset Code</p>\n              <div style=\"font-size: 36px; font-weight: bold; color: #dc2626; letter-spacing: 8px; font-family: 'Courier New', monospace; margin: 15px 0; padding: 15px; background: white; border-radius: 8px; border: 1px dashed #dc2626;\">\n                ${resetCode}\n              </div>\n              <p style=\"margin: 15px 0 0 0; font-size: 14px; color: #666;\">\n                Enter this 6-digit code on the password reset page\n              </p>\n            </div>\n            \n            <!-- Important Info -->\n            <div style=\"background-color: #fff3cd; border: 1px solid #ffeaa7; border-radius: 8px; padding: 20px; margin: 30px 0;\">\n              <p style=\"margin: 0; font-size: 16px; color: #856404;\">\n                <strong>‚ö†Ô∏è Important:</strong> This code expires in <strong>1 hour</strong> for security reasons.\n              </p>\n            </div>\n            \n            <p style=\"margin: 30px 0 0 0; font-size: 14px; color: #666; text-align: center;\">\n              If you didn't request this password reset, you can safely ignore this email.<br>\n              Your password will remain unchanged.\n            </p>\n          </div>\n          \n          <!-- Footer -->\n          <div style=\"background-color: #f8f9fa; padding: 20px 30px; border-top: 1px solid #e9ecef; text-align: center;\">\n            <p style=\"margin: 0; font-size: 12px; color: #666;\">\n              This is an automated message from TicTac 3x5 Game<br>\n              Sent on ${new Date().toLocaleString()}\n            </p>\n          </div>\n        </div>\n      </body>\n      </html>\n    `;\n\n    const plainText = `\nPassword Reset - TicTac 3x5 Game\n\nHello! We received a request to reset your password for your TicTac 3x5 account.\n\nYour password reset code is: ${resetCode}\n\nThis code expires in 1 hour for security reasons.\n\nTo reset your password:\n1. Go to the password reset page\n2. Enter this 6-digit code: ${resetCode}\n3. Create your new password\n\nIf you didn't request this password reset, you can safely ignore this email. Your password will remain unchanged.\n\n---\nThis is an automated message from TicTac 3x5 Game\nSent on ${new Date().toLocaleString()}\n    `;\n\n    return await this.sendEmail({\n      to: email,\n      subject: 'üîí Your Password Reset Code - TicTac 3x5',\n      html,\n      text: plainText.trim(),\n    });\n  }\n}\n\n// Singleton email service instance\nlet emailServiceInstance: EmailService | null = null;\nlet emailServiceInitialized = false;\n\n// Create email service instance if SMTP settings are provided (singleton pattern)\nexport function loadEmailConfig() {\n  // Try multiple possible config file locations\n  const possiblePaths = [\n    path.join(__dirname, 'config', 'email.json'),\n    path.resolve(process.cwd(), 'server', 'config', 'email.json'),\n    path.resolve(process.cwd(), 'config', 'email.json'),\n    path.resolve(process.cwd(), 'dist', 'server', 'config', 'email.json')\n  ];\n\n  console.log('üîç Searching for email configuration files...');\n  console.log('üìÇ Current working directory:', process.cwd());\n  console.log('üìÇ __dirname:', __dirname);\n\n  for (const configPath of possiblePaths) {\n    try {\n      console.log(`üîç Checking: ${configPath}`);\n      if (fs.existsSync(configPath)) {\n        console.log(`‚úÖ Found config file at: ${configPath}`);\n        \n        // Check file permissions\n        try {\n          fs.accessSync(configPath, fs.constants.R_OK);\n          console.log('‚úÖ File is readable');\n        } catch (permError) {\n          console.error(`‚ùå File permission error: ${permError instanceof Error ? permError.message : String(permError)}`);\n          continue;\n        }\n        \n        const configData = fs.readFileSync(configPath, 'utf8');\n        console.log('‚úÖ File read successfully, length:', configData.length);\n        \n        const config = JSON.parse(configData);\n        console.log('‚úÖ JSON parsed successfully');\n        console.log('üìß Config structure:', {\n          hasSmtp: !!config.smtp,\n          hasHost: !!config.smtp?.host,\n          hasPort: !!config.smtp?.port,\n          hasAuth: !!config.smtp?.auth,\n          hasUser: !!config.smtp?.auth?.user,\n          hasPass: !!config.smtp?.auth?.pass,\n          hasFromEmail: !!config.fromEmail\n        });\n        \n        const result = {\n          host: config.smtp?.host,\n          port: config.smtp?.port?.toString(),\n          user: config.smtp?.auth?.user,\n          pass: config.smtp?.auth?.pass,\n          fromEmail: config.fromEmail,\n          secure: typeof config.smtp?.secure === 'boolean' ? config.smtp.secure : (config.smtp?.port === 465)\n        };\n        \n        console.log('‚úÖ Email configuration loaded from config file:', configPath);\n        console.log('üìß Loaded values:', {\n          host: !!result.host,\n          port: !!result.port,\n          user: !!result.user,\n          pass: !!result.pass,\n          fromEmail: !!result.fromEmail,\n          secure: result.secure\n        });\n        \n        return result;\n      } else {\n        console.log(`‚ùå File not found: ${configPath}`);\n      }\n    } catch (error) {\n      console.error(`‚ùå Error loading config from ${configPath}:`, error instanceof Error ? error.message : String(error));\n      if (error instanceof SyntaxError) {\n        console.error('‚ùå JSON syntax error - check file format');\n      }\n      continue;\n    }\n  }\n\n  console.log('‚ö†Ô∏è No config files found, falling back to environment variables');\n  \n  // Fall back to environment variables\n  const envConfig = {\n    host: process.env.SMTP_HOST,\n    port: process.env.SMTP_PORT,\n    user: process.env.SMTP_USER,\n    pass: process.env.SMTP_PASS,\n    fromEmail: process.env.FROM_EMAIL,\n    secure: null // Will be determined based on port\n  };\n  \n  console.log('üìß Environment variables:', {\n    SMTP_HOST: !!process.env.SMTP_HOST,\n    SMTP_PORT: !!process.env.SMTP_PORT,\n    SMTP_USER: !!process.env.SMTP_USER,\n    SMTP_PASS: !!process.env.SMTP_PASS,\n    FROM_EMAIL: !!process.env.FROM_EMAIL\n  });\n  \n  return envConfig;\n}\n\nexport function createEmailService(): EmailService | null {\n  // Return cached instance if already created\n  if (emailServiceInitialized) {\n    return emailServiceInstance;\n  }\n\n  const emailConfig = loadEmailConfig();\n  const { host, port, user, pass, fromEmail, secure } = emailConfig;\n\n  emailServiceInitialized = true; // Mark as initialized to prevent multiple attempts\n\n  if (!host || !port || !user || !pass || !fromEmail) {\n    console.log('SMTP configuration not complete - email verification disabled');\n    console.log('Missing:', {\n      smtpHost: !!host,\n      smtpPort: !!port,\n      smtpUser: !!user,\n      smtpPass: !!pass,\n      fromEmail: !!fromEmail\n    });\n    emailServiceInstance = null;\n    return null;\n  }\n\n  console.log('‚úÖ SMTP configuration complete - email service enabled');\n  console.log('SMTP settings:', {\n    host,\n    port,\n    user,\n    from: fromEmail\n  });\n\n  const config: EmailConfig = {\n    host,\n    port: parseInt(port),\n    secure: secure !== null ? secure : parseInt(port) === 465, // Use config value or determine from port\n    auth: {\n      user,\n      pass,\n    },\n  };\n\n  emailServiceInstance = new EmailService(config, fromEmail);\n  return emailServiceInstance;\n}\n\n// Function to reset email service (for testing or configuration changes)\nexport function resetEmailService(): void {\n  emailServiceInitialized = false;\n  emailServiceInstance = null;\n  console.log('üîÑ Email service reset - will recreate on next use');\n}","size_bytes":17007},"server/facebookAuth.ts":{"content":"import passport from 'passport';\nimport { Strategy as FacebookStrategy } from 'passport-facebook';\nimport { Express } from 'express';\nimport { storage } from './storage';\n\nexport function setupFacebookAuth(app: Express) {\n  // Only setup Facebook auth if environment variables are provided\n  if (!process.env.FACEBOOK_APP_ID || !process.env.FACEBOOK_APP_SECRET) {\n    console.log('‚ö†Ô∏è Facebook auth not configured - missing FACEBOOK_APP_ID or FACEBOOK_APP_SECRET');\n    return;\n  }\n\n  // Configure Facebook Strategy\n  passport.use(new FacebookStrategy({\n    clientID: process.env.FACEBOOK_APP_ID,\n    clientSecret: process.env.FACEBOOK_APP_SECRET,\n    callbackURL: process.env.FACEBOOK_CALLBACK_URL || \"/api/auth/facebook/callback\",\n    profileFields: ['id', 'name', 'picture.type(large)']\n  },\n  async (accessToken, refreshToken, profile, done) => {\n    try {\n      // Extract user information from Facebook profile\n      const facebookId = profile.id;\n      const firstName = profile.name?.givenName || '';\n      const lastName = profile.name?.familyName || '';\n      const displayName = profile.displayName || `${firstName} ${lastName}`.trim();\n      const profileImageUrl = profile.photos?.[0]?.value;\n\n      // Check if user already exists by Facebook ID\n      let user = await storage.getUserByFacebookId(facebookId);\n      \n      if (!user) {\n        // Create new user without email access\n        const newUserId = `facebook_${facebookId}`;\n        await storage.upsertUser({\n          id: newUserId,\n          email: null, // No email access requested\n          firstName: firstName,\n          lastName: lastName,\n          displayName: displayName,\n          username: `facebook_${facebookId}`,\n          profileImageUrl: profileImageUrl || null,\n          facebookId: facebookId,\n          isGuest: false\n        });\n        \n        user = await storage.getUser(newUserId);\n      }\n\n      return done(null, {\n        userId: user!.id,\n        username: user!.username || user!.displayName || 'Facebook User',\n        displayName: user!.displayName,\n        email: null, // No email access requested\n        profileImageUrl: user!.profileImageUrl,\n        isEmailVerified: false // No email to verify\n      });\n    } catch (error) {\n      console.error('Facebook auth error:', error);\n      return done(error);\n    }\n  }));\n\n  // Facebook auth routes\n  app.get('/api/auth/facebook', \n    passport.authenticate('facebook')\n  );\n\n  app.get('/api/auth/facebook/callback',\n    passport.authenticate('facebook', { failureRedirect: '/auth?error=facebook_auth_failed' }),\n    (req, res) => {\n      // Successful authentication\n      const user = req.user as any;\n      \n      // Create session\n      req.session.user = {\n        userId: user.userId,\n        username: user.username\n      };\n      \n      // Redirect to home page\n      res.redirect('/?login=success&provider=facebook');\n    }\n  );\n}","size_bytes":2906},"server/fix-achievements.js":{"content":"// Quick script to fix win streak achievements for all users\n// This will run the SQL directly to ensure win streak achievements are properly awarded\n\nconst { db } = require('./database');\nconst { users, games, achievements } = require('../shared/schema');\nconst { eq, and, or, desc, exists } = require('drizzle-orm');\n\nasync function fixWinStreakAchievements() {\n  console.log('üîß Starting win streak achievement fix...');\n  \n  try {\n    // Get all users who have games\n    const allUsers = await db\n      .select({ \n        id: users.id, \n        currentWinStreak: users.currentWinStreak,\n        bestWinStreak: users.bestWinStreak,\n        wins: users.wins\n      })\n      .from(users)\n      .where(\n        exists(\n          db.select().from(games).where(\n            or(\n              eq(games.playerXId, users.id),\n              eq(games.playerOId, users.id)\n            )\n          )\n        )\n      );\n\n    console.log(`Found ${allUsers.length} users with games`);\n    \n    let fixedCount = 0;\n    \n    for (const user of allUsers) {\n      const userId = user.id;\n      const bestWinStreak = user.bestWinStreak || 0;\n      \n      console.log(`Processing ${userId}: bestWinStreak=${bestWinStreak}, wins=${user.wins}`);\n      \n      // Check if user should have win streak achievements\n      const shouldHaveWinStreak5 = bestWinStreak >= 5;\n      const shouldHaveWinStreak10 = bestWinStreak >= 10;\n      \n      if (shouldHaveWinStreak5 || shouldHaveWinStreak10) {\n        // Check current achievements\n        const currentAchievements = await db\n          .select()\n          .from(achievements)\n          .where(eq(achievements.userId, userId));\n        \n        const hasWinStreak5 = currentAchievements.some(a => a.achievementType === 'win_streak_5');\n        const hasWinStreak10 = currentAchievements.some(a => a.achievementType === 'win_streak_10');\n        \n        let achievementsAdded = [];\n        \n        // Add missing win_streak_5\n        if (shouldHaveWinStreak5 && !hasWinStreak5) {\n          try {\n            await db\n              .insert(achievements)\n              .values({\n                userId,\n                achievementType: 'win_streak_5',\n                achievementName: 'winStreakMaster',\n                description: 'winFiveConsecutiveGames',\n                icon: 'üî•',\n                metadata: {},\n              })\n              .onConflictDoNothing();\n            achievementsAdded.push('win_streak_5');\n            console.log(`‚úÖ Added win_streak_5 for ${userId}`);\n          } catch (error) {\n            console.error(`‚ùå Error adding win_streak_5 for ${userId}:`, error);\n          }\n        }\n        \n        // Add missing win_streak_10\n        if (shouldHaveWinStreak10 && !hasWinStreak10) {\n          try {\n            await db\n              .insert(achievements)\n              .values({\n                userId,\n                achievementType: 'win_streak_10',\n                achievementName: 'unstoppable',\n                description: 'winTenConsecutiveGames',\n                icon: '‚ö°',\n                metadata: {},\n              })\n              .onConflictDoNothing();\n            achievementsAdded.push('win_streak_10');\n            console.log(`‚úÖ Added win_streak_10 for ${userId}`);\n          } catch (error) {\n            console.error(`‚ùå Error adding win_streak_10 for ${userId}:`, error);\n          }\n        }\n        \n        if (achievementsAdded.length > 0) {\n          fixedCount++;\n          console.log(`üéâ Fixed achievements for ${userId}: ${achievementsAdded.join(', ')}`);\n        }\n      }\n    }\n    \n    console.log(`üéâ Win streak achievement fix completed! Fixed ${fixedCount} users out of ${allUsers.length} total users.`);\n    return { success: true, fixed: fixedCount, total: allUsers.length };\n    \n  } catch (error) {\n    console.error('‚ùå Error in win streak achievement fix:', error);\n    throw error;\n  }\n}\n\nmodule.exports = { fixWinStreakAchievements };","size_bytes":3961},"server/fix-diagonal-achievements.js":{"content":"import { db } from './db.ts';\nimport { games, achievements, users } from '../shared/schema.js';\nimport { eq, and, or, desc } from 'drizzle-orm';\n\nasync function checkUserDiagonalWins() {\n  const userId = 'e08f9202-f1d0-4adf-abc7-f5fbca314dc3';\n  \n  console.log(`üîç Checking diagonal wins for user: ${userId}`);\n  \n  // Check diagonal wins\n  const diagonalWins = await db\n    .select()\n    .from(games)\n    .where(and(\n      eq(games.winnerId, userId),\n      eq(games.winCondition, 'diagonal')\n    ))\n    .orderBy(desc(games.finishedAt));\n  \n  console.log(`üéØ Diagonal wins found: ${diagonalWins.length}`);\n  \n  if (diagonalWins.length > 0) {\n    console.log('üéØ Diagonal wins details:');\n    diagonalWins.forEach((game, index) => {\n      console.log(`  ${index + 1}. Game ID: ${game.id}, Date: ${game.finishedAt}`);\n    });\n  }\n  \n  // Check current achievements\n  const currentAchievements = await db\n    .select()\n    .from(achievements)\n    .where(eq(achievements.userId, userId));\n  \n  console.log(`üèÜ Current achievements: ${currentAchievements.length}`);\n  const achievementTypes = currentAchievements.map(a => a.achievementType);\n  console.log(`üèÜ Achievement types:`, achievementTypes);\n  \n  const hasDiagonalAchievement = achievementTypes.includes('master_of_diagonals');\n  console.log(`üéØ Has Master of Diagonals achievement: ${hasDiagonalAchievement}`);\n  \n  // If user has 3+ diagonal wins but no achievement, create it\n  if (diagonalWins.length >= 3 && !hasDiagonalAchievement) {\n    console.log(`‚úÖ User qualifies for Master of Diagonals! Creating achievement...`);\n    \n    const newAchievement = await db\n      .insert(achievements)\n      .values({\n        userId,\n        achievementType: 'master_of_diagonals',\n        achievementName: 'masterOfDiagonals',\n        description: 'winThreeGamesDiagonally',\n        icon: 'üéØ',\n        metadata: {},\n      })\n      .returning();\n    \n    console.log(`üéâ Created Master of Diagonals achievement:`, newAchievement[0]);\n  }\n  \n  // Check comeback achievement as well\n  const recentGames = await db\n    .select()\n    .from(games)\n    .where(or(\n      eq(games.playerXId, userId),\n      eq(games.playerOId, userId)\n    ))\n    .orderBy(desc(games.finishedAt))\n    .limit(6);\n  \n  console.log(`üîÑ Recent games for comeback check: ${recentGames.length}`);\n  \n  if (recentGames.length >= 6) {\n    const latestGame = recentGames[0];\n    const isLatestWin = latestGame.winnerId === userId;\n    \n    let previousFiveLosses = true;\n    for (let i = 1; i < 6; i++) {\n      const game = recentGames[i];\n      if (game.winnerId === userId || game.winnerId === null) {\n        previousFiveLosses = false;\n        break;\n      }\n    }\n    \n    const qualifiesForComeback = isLatestWin && previousFiveLosses;\n    const hasComebackAchievement = achievementTypes.includes('comeback_king');\n    \n    console.log(`üëë Qualifies for Comeback King: ${qualifiesForComeback}`);\n    console.log(`üëë Has Comeback King achievement: ${hasComebackAchievement}`);\n    \n    if (qualifiesForComeback && !hasComebackAchievement) {\n      console.log(`‚úÖ User qualifies for Comeback King! Creating achievement...`);\n      \n      const newAchievement = await db\n        .insert(achievements)\n        .values({\n          userId,\n          achievementType: 'comeback_king',\n          achievementName: 'comebackKing',\n          description: 'winAfterLosingFive',\n          icon: 'üëë',\n          metadata: {},\n        })\n        .returning();\n      \n      console.log(`üéâ Created Comeback King achievement:`, newAchievement[0]);\n    }\n  }\n  \n  process.exit(0);\n}\n\ncheckUserDiagonalWins().catch(console.error);","size_bytes":3658},"server/gameLogic.ts":{"content":"export type GameBoard = Record<string, string>;\nexport type WinCondition = 'diagonal' | 'horizontal' | 'vertical' | null;\n\n// Valid positions in the 3x5 grid (1-15)\nexport const VALID_POSITIONS = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15];\n\n// Position mapping for the 3x5 grid\nexport const POSITION_MAP = {\n  // Row 1\n  1: { row: 0, col: 0 },\n  2: { row: 0, col: 1 },\n  3: { row: 0, col: 2 },\n  4: { row: 0, col: 3 },\n  5: { row: 0, col: 4 },\n  // Row 2\n  6: { row: 1, col: 0 },\n  7: { row: 1, col: 1 },\n  8: { row: 1, col: 2 },\n  9: { row: 1, col: 3 },\n  10: { row: 1, col: 4 },\n  // Row 3\n  11: { row: 2, col: 0 },\n  12: { row: 2, col: 1 },\n  13: { row: 2, col: 2 },\n  14: { row: 2, col: 3 },\n  15: { row: 2, col: 4 },\n};\n\nexport function isValidPosition(position: number): boolean {\n  return VALID_POSITIONS.includes(position);\n}\n\nexport function isPositionEmpty(board: GameBoard, position: number): boolean {\n  return !board[position.toString()];\n}\n\nexport function makeMove(board: GameBoard, position: number, player: string): GameBoard {\n  if (!isValidPosition(position) || !isPositionEmpty(board, position)) {\n    throw new Error('Invalid move');\n  }\n  \n  return {\n    ...board,\n    [position.toString()]: player,\n  };\n}\n\nexport function checkHorizontalWin(board: GameBoard, player: string): boolean {\n  // Check for 4 consecutive tokens horizontally in any row\n  const rows = [\n    [1, 2, 3, 4, 5],\n    [6, 7, 8, 9, 10],\n    [11, 12, 13, 14, 15]\n  ];\n  \n  for (const row of rows) {\n    for (let i = 0; i <= row.length - 4; i++) {\n      const positions = row.slice(i, i + 4);\n      if (positions.every(pos => board[pos.toString()] === player)) {\n        return true;\n      }\n    }\n  }\n  \n  return false;\n}\n\nexport function checkVerticalWin(board: GameBoard, player: string): boolean {\n  // Check for 3 consecutive tokens vertically in any column\n  const columns = [\n    [1, 6, 11],   // Column 1\n    [2, 7, 12],   // Column 2\n    [3, 8, 13],   // Column 3\n    [4, 9, 14],   // Column 4\n    [5, 10, 15]   // Column 5\n  ];\n  \n  for (const column of columns) {\n    if (column.every(pos => board[pos.toString()] === player)) {\n      return true;\n    }\n  }\n  \n  return false;\n}\n\nexport function checkDiagonalWin(board: GameBoard, player: string): boolean {\n  // Define diagonal patterns for 3 consecutive positions on the 3x5 grid\n  // STRICTLY exclude any patterns that include positions 5, 10, or 15 (last column)\n  const diagonalPatterns = [\n    // Main diagonals (top-left to bottom-right) - ONLY those without positions 5, 10, 15\n    [1, 7, 13],   // 1 -> 7 -> 13 (valid: no positions 5, 10, 15)\n    [2, 8, 14],   // 2 -> 8 -> 14 (valid: no positions 5, 10, 15)\n    // [3, 9, 15] - EXCLUDED (contains position 15)\n    \n    // Anti-diagonals (top-right to bottom-left) - ONLY those without positions 5, 10, 15\n    [3, 7, 11],   // 3 -> 7 -> 11 (valid: no positions 5, 10, 15)\n    [4, 8, 12],   // 4 -> 8 -> 12 (valid: no positions 5, 10, 15)\n    // [5, 9, 13] - EXCLUDED (contains position 5)\n    \n    // All other diagonal patterns are excluded because they contain positions 5, 10, or 15\n  ];\n\n  // Additional validation: ensure no pattern contains restricted positions\n  const restrictedPositions = [5, 10, 15];\n  \n  for (const pattern of diagonalPatterns) {\n    // Double-check that pattern doesn't contain restricted positions\n    const hasRestrictedPosition = pattern.some(pos => restrictedPositions.includes(pos));\n    if (hasRestrictedPosition) {\n      continue; // Skip this pattern\n    }\n    \n    if (pattern.every(pos => board[pos.toString()] === player)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport function checkWin(board: GameBoard, player: string): { winner: boolean; condition: WinCondition; winningPositions?: number[] } {\n  // Check horizontal wins\n  const horizontalWin = checkHorizontalWinWithPositions(board, player);\n  if (horizontalWin.winner) {\n    return { winner: true, condition: 'horizontal', winningPositions: horizontalWin.positions };\n  }\n  \n  // Check vertical wins\n  const verticalWin = checkVerticalWinWithPositions(board, player);\n  if (verticalWin.winner) {\n    return { winner: true, condition: 'vertical', winningPositions: verticalWin.positions };\n  }\n  \n  // Check diagonal wins\n  const diagonalWin = checkDiagonalWinWithPositions(board, player);\n  if (diagonalWin.winner) {\n    return { winner: true, condition: 'diagonal', winningPositions: diagonalWin.positions };\n  }\n  \n  return { winner: false, condition: null };\n}\n\nfunction checkHorizontalWinWithPositions(board: GameBoard, player: string): { winner: boolean; positions?: number[] } {\n  const rows = [\n    [1, 2, 3, 4, 5],\n    [6, 7, 8, 9, 10],\n    [11, 12, 13, 14, 15]\n  ];\n  \n  for (const row of rows) {\n    for (let i = 0; i <= row.length - 4; i++) {\n      const positions = row.slice(i, i + 4);\n      if (positions.every(pos => board[pos.toString()] === player)) {\n        return { winner: true, positions };\n      }\n    }\n  }\n  return { winner: false };\n}\n\nfunction checkVerticalWinWithPositions(board: GameBoard, player: string): { winner: boolean; positions?: number[] } {\n  const columns = [\n    [1, 6, 11], [2, 7, 12], [3, 8, 13], [4, 9, 14], [5, 10, 15]\n  ];\n  \n  for (const column of columns) {\n    if (column.every(pos => board[pos.toString()] === player)) {\n      return { winner: true, positions: column };\n    }\n  }\n  return { winner: false };\n}\n\nfunction checkDiagonalWinWithPositions(board: GameBoard, player: string): { winner: boolean; positions?: number[] } {\n  const validDiagonals = [\n    [1, 7, 13], [2, 8, 14], [3, 7, 11], [4, 8, 12]\n  ];\n  \n  for (const diagonal of validDiagonals) {\n    if (diagonal.every(pos => board[pos.toString()] === player)) {\n      return { winner: true, positions: diagonal };\n    }\n  }\n  return { winner: false };\n}\n\nexport function checkDraw(board: GameBoard): boolean {\n  return VALID_POSITIONS.every(pos => board[pos.toString()]);\n}\n\nexport function getAvailableMoves(board: GameBoard): number[] {\n  return VALID_POSITIONS.filter(pos => isPositionEmpty(board, pos));\n}\n\nexport function getOpponentSymbol(player: string): string {\n  return player === 'X' ? 'O' : 'X';\n}\n\nexport function validateMove(board: GameBoard, position: number, player: string): boolean {\n  return isValidPosition(position) && isPositionEmpty(board, position);\n}\n","size_bytes":6319},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\nimport { runMigrations } from \"./migrations\";\n\nconst app = express();\napp.use(express.json({ limit: '1mb' }));\napp.use(express.urlencoded({ extended: false, limit: '1mb' }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      // Only log important API calls, exclude frequent polling endpoints\n      const excludedPaths = [\n        '/api/room-invitations',\n        '/api/auth/user',\n        '/api/users/online-stats',\n        '/api/leaderboard',\n        '/api/rooms/',\n        '/api/games/',\n        '/api/users/online',\n        '/api/users/blocked',\n        '/api/friends',\n        '/api/achievements',\n        '/api/themes',\n        '/api/matchmaking/'\n      ];\n      \n      const shouldLog = !excludedPaths.some(excludedPath => path.includes(excludedPath)) || \n                       path.includes('/api/auth/login') || \n                       path.includes('/api/auth/register');\n      \n      if (shouldLog) {\n        let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n        if (capturedJsonResponse) {\n          logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n        }\n\n        if (logLine.length > 80) {\n          logLine = logLine.slice(0, 79) + \"‚Ä¶\";\n        }\n\n        //log(logLine);\n      }\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  // Run database migrations first\n  await runMigrations();\n  \n  const server = await registerRoutes(app);\n  \n  // Import storage for room cleanup\n  const { storage } = await import(\"./storage\");\n  \n  // Clean up old rooms immediately on startup - BUG FIXED: Now preserves game history\n  //console.log(\"üßπ Running initial room cleanup...\");\n  await storage.cleanupOldRooms();\n  \n  // Set up periodic room cleanup every 10 minutes - BUG FIXED: Now safe\n  const CLEANUP_INTERVAL = 10 * 60 * 1000; // 10 minutes in milliseconds\n  setInterval(async () => {\n    try {\n      await storage.cleanupOldRooms();\n    } catch (error) {\n      console.error(\"‚ùå Error during periodic room cleanup:\", error);\n    }\n  }, CLEANUP_INTERVAL);\n  \n  //console.log(\"‚úÖ Room cleanup system RE-ENABLED - fixed to preserve user game history and stats\");\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on port 5000\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = 5000;\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    //log(`serving on port ${port}`);\n  });\n})();\n","size_bytes":3508},"server/migrations.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { db } from \"./db\";\n\nexport async function runMigrations(): Promise<void> {\n  console.log('üîÑ Running database migrations...');\n  \n  try {\n    // Add current_win_streak column if it doesn't exist\n    await db.execute(sql`\n      ALTER TABLE users \n      ADD COLUMN IF NOT EXISTS current_win_streak INTEGER DEFAULT 0;\n    `);\n    \n    // Add best_win_streak column if it doesn't exist\n    await db.execute(sql`\n      ALTER TABLE users \n      ADD COLUMN IF NOT EXISTS best_win_streak INTEGER DEFAULT 0;\n    `);\n    \n    // Add guest user columns if they don't exist\n    await db.execute(sql`\n      ALTER TABLE users \n      ADD COLUMN IF NOT EXISTS is_guest BOOLEAN DEFAULT FALSE;\n    `);\n    \n    await db.execute(sql`\n      ALTER TABLE users \n      ADD COLUMN IF NOT EXISTS guest_session_expiry TIMESTAMP;\n    `);\n    \n    // Create level_ups table if it doesn't exist\n    await db.execute(sql`\n      CREATE TABLE IF NOT EXISTS level_ups (\n        id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n        user_id VARCHAR NOT NULL REFERENCES users(id),\n        previous_level INTEGER NOT NULL,\n        new_level INTEGER NOT NULL,\n        acknowledged BOOLEAN DEFAULT FALSE,\n        created_at TIMESTAMP DEFAULT NOW()\n      );\n    `);\n    \n    console.log('‚úÖ Database migrations completed successfully');\n  } catch (error) {\n    console.error('‚ùå Error running database migrations:', error);\n    // Don't throw error to prevent app from crashing\n  }\n}","size_bytes":1492},"server/replitAuth.ts":{"content":"import * as client from \"openid-client\";\nimport { Strategy, type VerifyFunction } from \"openid-client/passport\";\n\nimport passport from \"passport\";\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport memoize from \"memoizee\";\nimport connectPg from \"connect-pg-simple\";\nimport { storage } from \"./storage\";\n\nif (!process.env.REPLIT_DOMAINS) {\n  throw new Error(\"Environment variable REPLIT_DOMAINS not provided\");\n}\n\nconst getOidcConfig = memoize(\n  async () => {\n    return await client.discovery(\n      new URL(process.env.ISSUER_URL ?? \"https://replit.com/oidc\"),\n      process.env.REPL_ID!\n    );\n  },\n  { maxAge: 3600 * 1000 }\n);\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const pgStore = connectPg(session);\n  const sessionStore = new pgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: false,\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  \n  // Detect environment for cookie configuration\n  const isProduction = process.env.NODE_ENV === 'production';\n  const isReplit = process.env.REPLIT_DOMAINS !== undefined;\n  \n  return session({\n    secret: process.env.SESSION_SECRET!,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      // Only use secure cookies in production HTTPS environments\n      secure: isProduction && !isReplit ? true : false,\n      maxAge: sessionTtl,\n      // Add SameSite for better compatibility\n      sameSite: isProduction ? 'none' : 'lax', // Changed to 'none' for HTTPS production\n      // Ensure domain isn't restricted for cross-origin requests\n      domain: isProduction ? undefined : undefined\n    },\n    name: 'connect.sid', // Explicit session name\n    proxy: isProduction // Trust proxy in production\n  });\n}\n\nfunction updateUserSession(\n  user: any,\n  tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers\n) {\n  user.claims = tokens.claims();\n  user.access_token = tokens.access_token;\n  user.refresh_token = tokens.refresh_token;\n  user.expires_at = user.claims?.exp;\n}\n\nasync function upsertUser(\n  claims: any,\n) {\n  await storage.upsertUser({\n    id: claims[\"sub\"],\n    email: claims[\"email\"],\n    firstName: claims[\"first_name\"],\n    lastName: claims[\"last_name\"],\n    profileImageUrl: claims[\"profile_image_url\"],\n  });\n}\n\nexport async function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  const config = await getOidcConfig();\n\n  const verify: VerifyFunction = async (\n    tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers,\n    verified: passport.AuthenticateCallback\n  ) => {\n    const user = {};\n    updateUserSession(user, tokens);\n    await upsertUser(tokens.claims());\n    verified(null, user);\n  };\n\n  for (const domain of process.env\n    .REPLIT_DOMAINS!.split(\",\")) {\n    const strategy = new Strategy(\n      {\n        name: `replitauth:${domain}`,\n        config,\n        scope: \"openid email profile offline_access\",\n        callbackURL: `https://${domain}/api/callback`,\n      },\n      verify,\n    );\n    passport.use(strategy);\n  }\n\n  passport.serializeUser((user: Express.User, cb) => cb(null, user));\n  passport.deserializeUser((user: Express.User, cb) => cb(null, user));\n\n  app.get(\"/api/login\", (req, res, next) => {\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      prompt: \"login consent\",\n      scope: [\"openid\", \"email\", \"profile\", \"offline_access\"],\n    })(req, res, next);\n  });\n\n  app.get(\"/api/callback\", (req, res, next) => {\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      successReturnToOrRedirect: \"/\",\n      failureRedirect: \"/api/login\",\n    })(req, res, next);\n  });\n\n  app.get(\"/api/logout\", (req, res) => {\n    req.logout(() => {\n      res.redirect(\n        client.buildEndSessionUrl(config, {\n          client_id: process.env.REPL_ID!,\n          post_logout_redirect_uri: `${req.protocol}://${req.hostname}`,\n        }).href\n      );\n    });\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  const user = req.user as any;\n\n  if (!req.isAuthenticated() || !user.expires_at) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  const now = Math.floor(Date.now() / 1000);\n  if (now <= user.expires_at) {\n    return next();\n  }\n\n  const refreshToken = user.refresh_token;\n  if (!refreshToken) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n\n  try {\n    const config = await getOidcConfig();\n    const tokenResponse = await client.refreshTokenGrant(config, refreshToken);\n    updateUserSession(user, tokenResponse);\n    return next();\n  } catch (error) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n};\n","size_bytes":4857},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { WebSocketServer, WebSocket } from \"ws\";\nimport { storage } from \"./storage\";\nimport { setupAuth, requireAuth } from \"./auth\";\nimport { insertRoomSchema, insertGameSchema, insertMoveSchema, users, games, achievements } from \"@shared/schema\";\nimport { AIPlayer } from \"./aiPlayer\";\nimport { makeMove, checkWin, checkDraw, getOpponentSymbol, validateMove } from \"./gameLogic\";\nimport { db } from \"./db\";\nimport { eq, and, or, desc, exists } from \"drizzle-orm\";\nimport { nanoid } from \"nanoid\";\n\ninterface WSConnection {\n  ws: WebSocket;\n  userId: string;\n  roomId?: string;\n  username?: string;\n  displayName?: string;\n  lastSeen?: Date;\n}\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Auth middleware\n  setupAuth(app);\n\n  // Create room_invitations table if it doesn't exist\n  try {\n    await storage.createRoomInvitationsTable();\n    //console.log('‚úÖ Room invitations table ready');\n  } catch (error) {\n    //console.log('‚ÑπÔ∏è Room invitations table already exists or error:', error.message);\n  }\n\n  // Create monthly reset status table if it doesn't exist\n  try {\n    await storage.createMonthlyResetTable();\n    //console.log('‚úÖ Monthly reset status table ready');\n  } catch (error) {\n    //console.log('‚ÑπÔ∏è Monthly reset status table already exists or error:', error.message);\n  }\n\n  // Clean up friendship data inconsistencies\n  try {\n    await storage.cleanupFriendshipData();\n    //console.log('‚úÖ Friendship data cleanup completed');\n  } catch (error) {\n    //console.log('‚ÑπÔ∏è Friendship data cleanup error:', error.message);\n  }\n\n  const connections = new Map<string, WSConnection>();\n  const roomConnections = new Map<string, Set<string>>();\n  const matchmakingQueue: string[] = []; // Queue of user IDs waiting for matches\n  const onlineUsers = new Map<string, { userId: string; username: string; displayName: string; roomId?: string; lastSeen: Date }>();\n  const userRoomStates = new Map<string, { roomId: string; gameId?: string; isInGame: boolean }>();\n  const matchmakingTimers = new Map<string, NodeJS.Timeout>(); // Track user timers for bot matches\n  const recentReconnections = new Map<string, number>(); // Track recent reconnection messages to prevent duplicates\n  const sentMatchNotifications = new Map<string, Set<string>>(); // Track sent match notifications per room\n  \n  // Matchmaking mutex to prevent race conditions\n  let isMatchmakingLocked = false;\n  \n  // Middleware to update user online status on any API call\n  app.use('/api', (req: any, res, next) => {\n    if (req.session?.user) {\n      const userId = req.session.user.userId;\n      const username = req.session.user.username;\n      const displayName = req.session.user.displayName || req.session.user.firstName || username;\n      \n      // Update user's online status when they make any API call\n      onlineUsers.set(userId, {\n        userId,\n        username,\n        displayName,\n        roomId: userRoomStates.get(userId)?.roomId,\n        lastSeen: new Date()\n      });\n      \n      // Debug logging for VPS troubleshooting\n      if (req.path === '/api/heartbeat') {\n        //console.log(`üíì Heartbeat from ${displayName} (${userId}) at ${new Date().toISOString()}`);\n        //console.log(`üìä Total online users: ${onlineUsers.size}`);\n      }\n    }\n    next();\n  });\n\n  // Cleanup offline users every 2 minutes (remove users inactive for more than 90 seconds)\n  setInterval(async () => {\n    const now = new Date();\n    const offlineThreshold = 90 * 1000; // 90 seconds\n    const activePlayerThreshold = 300 * 1000; // 5 minutes for active players\n    let removedUsers = 0;\n    \n    for (const [userId, user] of onlineUsers.entries()) {\n      const timeSinceLastSeen = now.getTime() - user.lastSeen.getTime();\n      \n      // Check if user has an active game - give them more time to reconnect\n      const activeGame = await storage.getActiveGameForUser(userId);\n      const thresholdToUse = activeGame ? activePlayerThreshold : offlineThreshold;\n      \n      if (timeSinceLastSeen > thresholdToUse) {\n        onlineUsers.delete(userId);\n        removedUsers++;\n        \n        // Clean up matchmaking data for offline users\n        const queueIndex = matchmakingQueue.indexOf(userId);\n        if (queueIndex > -1) {\n          matchmakingQueue.splice(queueIndex, 1);\n          console.log(`üßπ Removed ${user.displayName} from matchmaking queue (offline)`);\n        }\n        \n        // Clean up matchmaking timer\n        if (matchmakingTimers.has(userId)) {\n          clearTimeout(matchmakingTimers.get(userId)!);\n          matchmakingTimers.delete(userId);\n          console.log(`üßπ Cleared matchmaking timer for ${user.displayName} (offline)`);\n        }\n        \n        //console.log(`üö™ Removed offline user: ${user.displayName} (inactive for ${Math.round(timeSinceLastSeen/1000)}s)`);\n      }\n    }\n    \n    // Cleanup old match notifications (older than 5 minutes)\n    const notificationThreshold = 5 * 60 * 1000; // 5 minutes\n    for (const [roomId, notifications] of sentMatchNotifications.entries()) {\n      // For simplicity, clear all notifications older than threshold\n      // In a production system, you might want to track timestamps\n      if (notifications.size > 0) {\n        sentMatchNotifications.delete(roomId);\n      }\n    }\n    \n    if (removedUsers > 0) {\n      //console.log(`üßπ Cleanup complete: removed ${removedUsers} offline users. ${onlineUsers.size} users remain online.`);\n    }\n  }, 120000); // Every 2 minutes\n  \n  // Game expiration system - check every 2 minutes, but only when users are active\n  setInterval(async () => {\n    // Skip database queries if no users are online - saves compute hours\n    if (onlineUsers.size === 0 && connections.size === 0) {\n      return;\n    }\n    \n    try {\n      const expiredGames = await storage.getExpiredGames();\n      \n      for (const expiredGame of expiredGames) {\n        // Game expired after inactivity\n        \n        // Update game status to expired\n        await storage.expireGame(expiredGame.id);\n        \n        // Update room status back to waiting\n        if (expiredGame.roomId) {\n          await storage.updateRoomStatus(expiredGame.roomId, 'waiting');\n        }\n        \n        // Notify all players in the room about expiration\n        if (expiredGame.roomId && roomConnections.has(expiredGame.roomId)) {\n          const roomUsers = roomConnections.get(expiredGame.roomId);\n          const expirationMessage = JSON.stringify({\n            type: 'game_expired',\n            gameId: expiredGame.id,\n            roomId: expiredGame.roomId,\n            message: 'Game expired due to 10 minutes of inactivity. Returning to lobby.'\n          });\n          \n          roomUsers?.forEach(connectionId => {\n            const connection = connections.get(connectionId);\n            if (connection && connection.ws.readyState === WebSocket.OPEN) {\n              connection.ws.send(expirationMessage);\n            }\n          });\n          \n          // Clear room connections\n          roomConnections.delete(expiredGame.roomId);\n        }\n        \n        // Clear user room states for expired game players\n        userRoomStates.forEach((state, userId) => {\n          if (state.gameId === expiredGame.id) {\n            userRoomStates.delete(userId);\n          }\n        });\n      }\n    } catch (error) {\n      console.error('‚è∞ Error checking for expired games:', error);\n    }\n  }, 2 * 60 * 1000); // Check every 2 minutes\n\n  // Auto-play throttling map to prevent too frequent moves\n  const autoPlayThrottle = new Map<string, number>(); // gameId -> last auto-move timestamp\n\n  // Auto-play monitoring system - check every 10 seconds for inactive players\n  setInterval(async () => {\n    // Skip if no users are online to save compute\n    if (onlineUsers.size === 0 && connections.size === 0) {\n      return;\n    }\n    \n    try {\n      const inactiveGames = await storage.getGamesWithInactivePlayers();\n      \n      for (const game of inactiveGames) {\n        // Skip if game is already finished\n        if (game.status !== 'active') continue;\n        \n        // Determine which player should be auto-playing\n        const currentPlayerIsX = game.currentPlayer === 'X';\n        const currentPlayerId = currentPlayerIsX ? game.playerXId : game.playerOId;\n        let isCurrentPlayerAutoPlay = currentPlayerIsX ? game.playerXAutoPlay : game.playerOAutoPlay;\n        \n        // Skip AI vs AI games or pass-and-play\n        if (!currentPlayerId || currentPlayerId.startsWith('player_') || game.gameMode !== 'online') {\n          continue;\n        }\n        \n        // Enable auto-play if not already enabled\n        if (!isCurrentPlayerAutoPlay) {\n          //console.log(`ü§ñ Enabling auto-play for player ${game.currentPlayer} in game ${game.id} (inactive for 60+ seconds)`);\n          await storage.enableAutoPlay(game.id, game.currentPlayer as 'X' | 'O');\n          \n          // Notify room about auto-play activation\n          if (game.roomId && roomConnections.has(game.roomId)) {\n            const roomUsers = roomConnections.get(game.roomId)!;\n            const autoPlayMessage = JSON.stringify({\n              type: 'auto_play_enabled',\n              gameId: game.id,\n              player: game.currentPlayer,\n              message: `Player ${game.currentPlayer} is now in auto-play mode due to inactivity`\n            });\n            \n            roomUsers.forEach(connectionId => {\n              const connection = connections.get(connectionId);\n              if (connection && connection.ws.readyState === WebSocket.OPEN) {\n                connection.ws.send(autoPlayMessage);\n              }\n            });\n          }\n          \n          // Make an immediate AI move after enabling auto-play to prevent further stalling\n          isCurrentPlayerAutoPlay = true; // Update local flag for immediate move\n        }\n        \n        // Make an auto-move using easy AI\n        if (isCurrentPlayerAutoPlay) {\n          try {\n            // Check throttling - don't make moves too frequently\n            const now = Date.now();\n            const lastAutoMove = autoPlayThrottle.get(game.id) || 0;\n            const timeSinceLastMove = now - lastAutoMove;\n            const minInterval = 5000; // 5 seconds minimum between auto-moves\n            \n            if (timeSinceLastMove < minInterval) {\n              console.log(`ü§ñ Auto-play throttled for game ${game.id} (${minInterval - timeSinceLastMove}ms remaining)`);\n              continue; // Skip this game for now\n            }\n            \n            const currentBoard = game.board || {};\n            \n            // Simple auto-play: use existing game logic to get valid moves, then pick the first one\n            const { getAvailableMoves } = await import('./gameLogic');\n            const availableMoves = getAvailableMoves(currentBoard);\n            \n            if (availableMoves.length === 0) {\n              console.error(`ü§ñ No available moves for auto-play in game ${game.id}`);\n              continue;\n            }\n            \n            const autoMove = availableMoves[0]; // Always pick the first available position\n            \n            //console.log(`ü§ñ Auto-play move: ${game.currentPlayer} plays position ${autoMove} in game ${game.id}`);\n            \n            // Update throttle map\n            autoPlayThrottle.set(game.id, now);\n            \n            // Process the auto-move like a regular move\n            const newBoard = { ...currentBoard, [autoMove.toString()]: game.currentPlayer };\n            const nextPlayer = game.currentPlayer === 'X' ? 'O' : 'X';\n            \n            // Check for win/draw\n            const { checkWin, checkDraw } = await import('./gameLogic');\n            const winResult = checkWin(newBoard, game.currentPlayer);\n            const isDraw = !winResult.winner && checkDraw(newBoard);\n            \n            // Update game in database\n            await storage.updateGameBoard(game.id, newBoard);\n            await storage.updateCurrentPlayer(game.id, nextPlayer);\n            await storage.updateLastMoveTime(game.id);\n            \n            if (winResult.winner || isDraw) {\n              await storage.updateGameStatus(game.id, 'finished', \n                winResult.winner ? currentPlayerId : undefined,\n                isDraw ? 'draw' : (winResult.condition || undefined));\n              \n              // Clean up throttle map for finished games\n              autoPlayThrottle.delete(game.id);\n            }\n            \n            // Broadcast auto-move to all players in room\n            if (game.roomId && roomConnections.has(game.roomId)) {\n              const roomUsers = roomConnections.get(game.roomId)!;\n              const moveMessage = JSON.stringify({\n                type: winResult.winner ? 'winning_move' : 'auto_move',\n                gameId: game.id,\n                roomId: game.roomId,\n                position: autoMove,\n                player: game.currentPlayer,\n                board: newBoard,\n                currentPlayer: nextPlayer,\n                winningPositions: winResult.winningPositions || null,\n                serverTime: new Date().toISOString(),\n                isAutoPlay: true\n              });\n              \n              roomUsers.forEach(connectionId => {\n                const conn = connections.get(connectionId);\n                if (conn && conn.ws.readyState === WebSocket.OPEN) {\n                  conn.ws.send(moveMessage);\n                }\n              });\n            }\n            \n            // Check if the next player is a bot and trigger bot move (same logic as regular moves)\n            if (!winResult.winner && !isDraw) {\n              const nextPlayerId = nextPlayer === 'X' ? game.playerXId : game.playerOId;\n              //console.log(`ü§ñ Auto-play checking bot move: nextPlayer=${nextPlayer}, nextPlayerId=${nextPlayerId}`);\n              \n              // Check if next player is a bot (IDs starting with \"player_\")\n              if (nextPlayerId && nextPlayerId.startsWith('player_')) {\n                //console.log(`ü§ñ Bot move triggered after auto-play for ${nextPlayerId} (${nextPlayer})`);\n                // Trigger bot move after a short delay for realism\n                setTimeout(async () => {\n                  try {\n                    const { AIPlayer } = await import('./aiPlayer');\n                    \n                    // Get bot difficulty from the bot data (use default medium if not found)\n                    let difficulty = 'medium';\n                    if (nextPlayerId && nextPlayerId.startsWith('player_')) {\n                      const playerNum = parseInt(nextPlayerId.replace('player_', ''));\n                      if (playerNum >= 1 && playerNum <= 30) {\n                        difficulty = 'easy';\n                      } else if (playerNum >= 31 && playerNum <= 70) {\n                        difficulty = 'medium';\n                      } else if (playerNum >= 71 && playerNum <= 100) {\n                        difficulty = 'hard';\n                      }\n                    }\n                    \n                    const ai = new AIPlayer(nextPlayer, difficulty);\n                    const botMove = ai.makeMove(newBoard);\n                    \n                    // Make the bot move\n                    const botNewBoard = { ...newBoard, [botMove]: nextPlayer };\n                    const botNextPlayer = game.currentPlayer; // Switch back to the auto-playing player\n                    \n                    // Check for bot win\n                    const { checkWin, checkDraw } = await import('./gameLogic');\n                    const botWinResult = checkWin(botNewBoard, nextPlayer);\n                    const botIsDraw = !botWinResult.winner && checkDraw(botNewBoard);\n                    \n                    // Update database with bot move\n                    await storage.updateGameBoard(game.id, botNewBoard);\n                    await storage.updateCurrentPlayer(game.id, botNextPlayer);\n                    await storage.updateLastMoveTime(game.id);\n                    \n                    if (botWinResult.winner || botIsDraw) {\n                      await storage.updateGameStatus(game.id, 'finished', \n                        botWinResult.winner ? nextPlayerId : undefined,\n                        botIsDraw ? 'draw' : (botWinResult.condition || undefined));\n                      \n                      // Clean up throttle map for finished games\n                      autoPlayThrottle.delete(game.id);\n                    }\n                    \n                    // Broadcast bot move to all players in room\n                    if (game.roomId && roomConnections.has(game.roomId)) {\n                      const roomUsers = roomConnections.get(game.roomId)!;\n                      const botMoveMessage = JSON.stringify({\n                        type: botWinResult.winner ? 'winning_move' : 'move',\n                        gameId: game.id,\n                        roomId: game.roomId,\n                        position: botMove,\n                        player: nextPlayer,\n                        board: botNewBoard,\n                        currentPlayer: botNextPlayer,\n                        winningPositions: botWinResult.winningPositions || null,\n                        serverTime: new Date().toISOString(),\n                        isBot: true\n                      });\n                      \n                      //console.log(`ü§ñ Broadcasting bot move after auto-play: position=${botMove}, player=${nextPlayer}, roomUsers=${roomUsers.size}`);\n                      roomUsers.forEach(connectionId => {\n                        const conn = connections.get(connectionId);\n                        if (conn && conn.ws.readyState === WebSocket.OPEN) {\n                          conn.ws.send(botMoveMessage);\n                        }\n                      });\n                    }\n                    \n                  } catch (error) {\n                    console.error('Bot move error after auto-play:', error);\n                  }\n                }, 1000 + Math.random() * 2000); // 1-3 second delay for realism\n              }\n            }\n          } catch (autoMoveError) {\n            console.error(`ü§ñ Error making auto-move for game ${game.id}:`, autoMoveError);\n          }\n        }\n      }\n    } catch (error) {\n      console.error('ü§ñ Error in auto-play monitoring:', error);\n    }\n  }, 10000); // Check every 10 seconds\n\n  // Robust monthly leaderboard reset and reward distribution system\n  let monthlySchedulerRunning = false; // Process-level mutex\n  let nextMonthStartTimeout: NodeJS.Timeout | null = null;\n\n  // Function to calculate milliseconds until next month starts\n  function getMillisecondsUntilNextMonth(): number {\n    const now = new Date();\n    const currentYear = now.getUTCFullYear();\n    const currentMonth = now.getUTCMonth(); // 0-11\n    \n    // First day of next month at midnight UTC\n    const nextMonthStart = new Date(Date.UTC(currentYear, currentMonth + 1, 1, 0, 0, 0, 0));\n    return nextMonthStart.getTime() - now.getTime();\n  }\n\n  // Function to perform monthly reset with full error handling and idempotency\n  async function performMonthlyReset(month: number, year: number): Promise<boolean> {\n    if (monthlySchedulerRunning) {\n      console.log(`üîí Monthly scheduler already running, skipping reset for ${year}-${month.toString().padStart(2, '0')}`);\n      return false;\n    }\n\n    monthlySchedulerRunning = true;\n    let resetStatus;\n\n    try {\n      console.log(`üèÜ Starting monthly reset process for ${year}-${month.toString().padStart(2, '0')}`);\n      \n      // Get or create reset status record\n      resetStatus = await storage.getResetStatus(month, year);\n      if (!resetStatus) {\n        resetStatus = await storage.createResetStatus(month, year);\n      }\n\n      // Check if already completed\n      if (resetStatus.status === 'completed') {\n        console.log(`‚úÖ Monthly reset for ${year}-${month.toString().padStart(2, '0')} already completed`);\n        return true;\n      }\n\n      // Check if too many retries\n      if (resetStatus.retryCount >= 5) {\n        console.error(`‚ùå Monthly reset for ${year}-${month.toString().padStart(2, '0')} exceeded maximum retries (${resetStatus.retryCount})`);\n        return false;\n      }\n\n      // Mark as in progress\n      await storage.updateResetStatus(resetStatus.id, 'in_progress');\n\n      // Perform the actual reset (this already has internal transaction safety)\n      await storage.resetMonthlyStats(month, year);\n\n      // Mark as completed\n      await storage.updateResetStatus(resetStatus.id, 'completed');\n      console.log(`‚úÖ Monthly reset completed successfully for ${year}-${month.toString().padStart(2, '0')}`);\n      \n      return true;\n\n    } catch (error) {\n      console.error(`‚ùå Error during monthly reset for ${year}-${month.toString().padStart(2, '0')}:`, error);\n      \n      if (resetStatus) {\n        // Mark as failed and schedule retry\n        const nextRetryDelay = Math.min(30 * 60 * 1000 * Math.pow(2, resetStatus.retryCount), 4 * 60 * 60 * 1000); // Exponential backoff, max 4 hours\n        const nextRetryAt = new Date(Date.now() + nextRetryDelay);\n        \n        await storage.updateResetStatus(resetStatus.id, 'failed', error.message);\n        await storage.incrementRetryCount(resetStatus.id, nextRetryAt);\n        \n        console.log(`‚è∞ Scheduled retry for ${year}-${month.toString().padStart(2, '0')} in ${Math.round(nextRetryDelay / 60000)} minutes`);\n      }\n      \n      return false;\n    } finally {\n      monthlySchedulerRunning = false;\n    }\n  }\n\n  // Function to check for pending/failed resets and process them\n  async function processPendingResets(): Promise<void> {\n    try {\n      const pendingResets = await storage.getPendingResets();\n      \n      for (const reset of pendingResets) {\n        console.log(`üîÑ Processing pending reset for ${reset.year}-${reset.month.toString().padStart(2, '0')}`);\n        await performMonthlyReset(reset.month, reset.year);\n      }\n    } catch (error) {\n      console.error('üìÖ Error processing pending resets:', error);\n    }\n  }\n\n  // Function to schedule the next month boundary check\n  function scheduleNextMonthCheck(): void {\n    // Clear any existing timeout\n    if (nextMonthStartTimeout) {\n      clearTimeout(nextMonthStartTimeout);\n    }\n\n    const msUntilNextMonth = getMillisecondsUntilNextMonth();\n    const maxDelay = 24 * 60 * 60 * 1000; // 24 hours max for setTimeout stability\n    const delay = Math.min(msUntilNextMonth, maxDelay);\n\n    console.log(`üìÖ Next month check scheduled in ${Math.round(delay / 60000)} minutes`);\n\n    nextMonthStartTimeout = setTimeout(async () => {\n      try {\n        const now = new Date();\n        const currentMonth = now.getUTCMonth() + 1; // 1-12\n        const currentYear = now.getUTCFullYear();\n        \n        // Calculate previous month for reset\n        let prevMonth = currentMonth - 1;\n        let prevYear = currentYear;\n        if (prevMonth === 0) {\n          prevMonth = 12;\n          prevYear = currentYear - 1;\n        }\n\n        console.log(`üóìÔ∏è New month detected: ${currentYear}-${currentMonth.toString().padStart(2, '0')}`);\n        console.log(`üèÜ Triggering reset for previous month: ${prevYear}-${prevMonth.toString().padStart(2, '0')}`);\n\n        // Trigger reset for the previous month\n        await performMonthlyReset(prevMonth, prevYear);\n\n        // Check for any other pending resets\n        await processPendingResets();\n\n        // Schedule next check\n        scheduleNextMonthCheck();\n        \n      } catch (error) {\n        console.error('üìÖ Error in month boundary handler:', error);\n        // Reschedule anyway to prevent scheduler from stopping\n        scheduleNextMonthCheck();\n      }\n    }, delay);\n  }\n\n  // Startup logic to handle missed resets and initialize scheduler\n  async function initializeMonthlyScheduler(): Promise<void> {\n    try {\n      console.log('üöÄ Initializing robust monthly scheduler...');\n      \n      // Check for any pending or failed resets on startup\n      await processPendingResets();\n\n      // Check if we need to create a reset record for any recent months that might have been missed\n      const now = new Date();\n      const currentMonth = now.getUTCMonth() + 1;\n      const currentYear = now.getUTCFullYear();\n      \n      // Check last 3 months for missed resets\n      for (let i = 1; i <= 3; i++) {\n        let checkMonth = currentMonth - i;\n        let checkYear = currentYear;\n        \n        if (checkMonth <= 0) {\n          checkMonth += 12;\n          checkYear -= 1;\n        }\n        \n        const resetStatus = await storage.getResetStatus(checkMonth, checkYear);\n        if (!resetStatus) {\n          // Create pending reset record for missed month\n          await storage.createResetStatus(checkMonth, checkYear);\n          console.log(`üìù Created pending reset record for missed month: ${checkYear}-${checkMonth.toString().padStart(2, '0')}`);\n        }\n      }\n\n      // Process any newly identified pending resets\n      await processPendingResets();\n\n      // Schedule precise month boundary timing\n      scheduleNextMonthCheck();\n      \n      console.log('‚úÖ Monthly scheduler initialized successfully');\n      \n    } catch (error) {\n      console.error('‚ùå Failed to initialize monthly scheduler:', error);\n      // Fallback: still schedule next check to prevent total failure\n      scheduleNextMonthCheck();\n    }\n  }\n\n  // Initialize the scheduler\n  initializeMonthlyScheduler();\n\n  // Backup polling system - runs every 6 hours as failsafe\n  setInterval(async () => {\n    try {\n      // Only run if no users are online to save compute\n      if (onlineUsers.size === 0 && connections.size === 0) {\n        return;\n      }\n\n      console.log('üîç Running backup monthly scheduler check...');\n      await processPendingResets();\n      \n      // Verify next month check is still scheduled\n      if (!nextMonthStartTimeout) {\n        console.log('‚ö†Ô∏è Next month check was lost, rescheduling...');\n        scheduleNextMonthCheck();\n      }\n      \n    } catch (error) {\n      console.error('üìÖ Error in backup monthly scheduler:', error);\n    }\n  }, 6 * 60 * 60 * 1000); // Every 6 hours\n\n  // Offline reconnection handler with expiration check\n  async function handleUserReconnection(userId: string, connectionId: string, ws: WebSocket) {\n    try {\n      // Checking for active game reconnection\n      \n      // Check if user has an active game (not expired or abandoned)\n      // Also check if user has any room state - if not, they were properly cleaned up from abandonment\n      const userRoomState = userRoomStates.get(userId);\n      const activeGame = await storage.getActiveGameForUser(userId);\n      \n      // Check for active game - don't require userRoomState since it might be cleared on disconnect\n      if (activeGame && activeGame.roomId && activeGame.status === 'active') {\n        // Check if game is still within 10 minute limit\n        const gameAge = Date.now() - new Date(activeGame.lastMoveAt || activeGame.createdAt).getTime();\n        const tenMinutes = 10 * 60 * 1000;\n        \n        if (gameAge > tenMinutes) {\n          // Game expired - expiring now\n          \n          // Expire the game immediately\n          await storage.expireGame(activeGame.id);\n          await storage.updateRoomStatus(activeGame.roomId, 'waiting');\n          \n          // Send expiration message to user\n          if (ws.readyState === WebSocket.OPEN) {\n            ws.send(JSON.stringify({\n              type: 'game_expired',\n              gameId: activeGame.id,\n              roomId: activeGame.roomId,\n              message: 'Your game has expired. Returning to lobby.'\n            }));\n          }\n          \n          // Clear user room state\n          userRoomStates.delete(userId);\n          return;\n        }\n        \n\n        \n        // Simplified reconnection - always allow reconnection but track it to prevent spam\n        const now = Date.now();\n        const lastReconnection = recentReconnections.get(userId);\n        \n        // Only skip reconnection if it was very recent (within 1 second)\n        if (lastReconnection && (now - lastReconnection) < 1000) {\n          return;\n        }\n        \n        // Track this user's reconnection\n        recentReconnections.set(userId, now);\n        \n        // Add user back to room connections\n        if (!roomConnections.has(activeGame.roomId)) {\n          roomConnections.set(activeGame.roomId, new Set());\n        }\n        roomConnections.get(activeGame.roomId)!.add(connectionId);\n        \n        // Update connection room info\n        const connection = connections.get(connectionId);\n        if (connection) {\n          connection.roomId = activeGame.roomId;\n        }\n        \n        // Restore/update user room state for reconnection\n        userRoomStates.set(userId, {\n          roomId: activeGame.roomId,\n          gameId: activeGame.id,\n          isInGame: true\n        });\n        \n        // Get complete game data with player info\n        const [playerXInfo, playerOInfo] = await Promise.all([\n          storage.getUser(activeGame.playerXId!),\n          activeGame.playerOId && !AI_BOTS.some(bot => bot.id === activeGame.playerOId) ? storage.getUser(activeGame.playerOId!) : Promise.resolve(null)\n        ]);\n        \n        // Get achievements for both players\n        const [playerXAchievements, playerOAchievements] = await Promise.all([\n          storage.getUserAchievements(activeGame.playerXId!),\n          playerOInfo && !AI_BOTS.some(bot => bot.id === activeGame.playerOId) ? storage.getUserAchievements(activeGame.playerOId!) : Promise.resolve([])\n        ]);\n        \n        // Handle bot player info\n        let finalPlayerOInfo = playerOInfo;\n        if (activeGame.playerOId && AI_BOTS.some(bot => bot.id === activeGame.playerOId)) {\n          const botInfo = AI_BOTS.find(bot => bot.id === activeGame.playerOId);\n          finalPlayerOInfo = {\n            id: activeGame.playerOId,\n            firstName: botInfo?.firstName || 'AI',\n            lastName: botInfo?.lastName || 'Player',\n            displayName: botInfo?.displayName || 'AI Player',\n            username: botInfo?.username || 'ai',\n            profilePicture: botInfo?.profilePicture || null,\n            profileImageUrl: botInfo?.profilePicture || null,\n            achievements: []\n          };\n        }\n        \n        const gameWithPlayers = {\n          ...activeGame,\n          playerXInfo: playerXInfo ? {\n            ...playerXInfo,\n            achievements: playerXAchievements.slice(0, 3)\n          } : null,\n          playerOInfo: finalPlayerOInfo ? {\n            ...finalPlayerOInfo,\n            achievements: (finalPlayerOInfo as any).achievements || playerOAchievements.slice(0, 3)\n          } : null,\n          gameMode: activeGame.gameMode,\n          serverTime: new Date().toISOString(), // Add server time for consistent timer calculation\n          timeRemaining: Math.max(0, 10 * 60 * 1000 - (Date.now() - new Date(activeGame.createdAt).getTime())) // Calculate remaining time from game start\n        };\n        \n        // Get room info\n        const room = await storage.getRoomById(activeGame.roomId);\n        \n        // Send reconnection messages immediately\n        if (ws.readyState === WebSocket.OPEN) {\n          try {\n            // Send room join notification first\n            ws.send(JSON.stringify({\n              type: 'reconnection_room_join',\n              room: room,\n              message: 'Reconnected to your game room'\n            }));\n            \n            // Send game state immediately (no delay to reduce race conditions)\n            ws.send(JSON.stringify({\n              type: 'game_reconnection',\n              game: gameWithPlayers,\n              roomId: activeGame.roomId,\n              message: 'Game state recovered successfully'\n            }));\n            \n\n          } catch (error) {\n            console.error(`‚ùå Failed to send reconnection messages to user ${userId}:`, error);\n          }\n          \n          // Clean up old reconnection tracking entries (older than 10 seconds)\n          setTimeout(() => {\n            const cutoff = Date.now() - 10000;\n            for (const [trackingUserId, timestamp] of recentReconnections.entries()) {\n              if (timestamp < cutoff) {\n                recentReconnections.delete(trackingUserId);\n              }\n            }\n          }, 10000);\n          \n          // Notify other players in the room about reconnection\n          const roomUsers = roomConnections.get(activeGame.roomId);\n          if (roomUsers) {\n            // Get the reconnecting user's info specifically\n            const reconnectingUser = await storage.getUser(userId);\n            const reconnectionNotification = JSON.stringify({\n              type: 'player_reconnected',\n              userId: userId,\n              playerName: reconnectingUser?.displayName || reconnectingUser?.firstName || 'Player',\n              message: `${reconnectingUser?.displayName || reconnectingUser?.firstName || 'Player'} reconnected to the game`\n            });\n            \n            roomUsers.forEach(otherConnectionId => {\n              if (otherConnectionId !== connectionId) {\n                const otherConnection = connections.get(otherConnectionId);\n                if (otherConnection && otherConnection.ws.readyState === WebSocket.OPEN) {\n                  otherConnection.ws.send(reconnectionNotification);\n                }\n              }\n            });\n          }\n        }\n      } else {\n        // No active game found - normal connection\n      }\n    } catch (error) {\n      console.error(`üîÑ Error handling reconnection for user ${userId}:`, error);\n    }\n  }\n\n  // AI Bot System - 100 AI opponents with varied difficulties and personalities\n  const REALISTIC_NAMES = [\n    // English names\n    \"Alex Johnson\", \"Sarah Chen\", \"Michael Brown\", \"Emma Wilson\", \"David Lee\", \"Lisa Garcia\", \"Ryan Smith\", \"Maya Patel\", \"James Miller\", \"Sofia Rodriguez\",\n    \"Chris Taylor\", \"Amanda Thompson\", \"Kevin Wang\", \"Rachel Green\", \"Mark Davis\", \"Nicole Kim\", \"Tyler Anderson\", \"Jessica Martinez\", \"Brandon Jones\", \"Ashley White\",\n    \"Jordan Clark\", \"Samantha Lewis\", \"Austin Young\", \"Stephanie Hall\", \"Cameron Scott\", \"Natalie Adams\", \"Derek Baker\", \"Megan Turner\", \"Sean Murphy\", \"Lauren Cooper\",\n    \n    // Arabic names\n    \"Ahmed Hassan\", \"Fatima Al-Zahra\", \"Omar Khalil\", \"Aisha Rahman\", \"Youssef Mansour\", \"Layla Nasser\", \"Kareem Ibrahim\", \"Nour El-Din\", \"Salma Farouk\", \"Rashid Abadi\",\n    \"Mariam Qasemi\", \"Tariq Habib\", \"Zara Mahmoud\", \"Samir Hashim\", \"Dina Rasheed\", \"Jamal Khoury\", \"Lina Amin\", \"Khalil Badawi\", \"Rana Sharif\", \"Fadi Zidan\",\n    \n    // Indian names\n    \"Rahul Sharma\", \"Priya Gupta\", \"Aryan Singh\", \"Sneha Patel\", \"Vikram Kumar\", \"Ananya Reddy\", \"Rohit Agarwal\", \"Kavya Menon\", \"Arjun Iyer\", \"Riya Joshi\",\n    \"Siddharth Rao\", \"Meera Kapoor\", \"Aarav Malik\", \"Pooja Nair\", \"Karan Thakur\", \"Shreya Verma\", \"Nikhil Bansal\", \"Divya Sinha\", \"Varun Chandra\", \"Aditi Saxena\",\n    \n    // Spanish names\n    \"Carlos Mendoza\", \"Isabella Ruiz\", \"Diego Herrera\", \"Valentina Cruz\", \"Alejandro Torres\", \"Camila Flores\", \"Sebastian Morales\", \"Lucia Jimenez\", \"Adrian Castro\", \"Daniela Vargas\",\n    \"Fernando Silva\", \"Gabriela Ortiz\", \"Ricardo Delgado\", \"Valeria Pe√±a\", \"Francisco Ramos\", \"Andrea Gutierrez\", \"Mateo Sandoval\", \"Elena Castillo\", \"Antonio Mejia\", \"Carmen Aguilar\",\n    \n    // Indonesian names\n    \"Andi Pratama\", \"Sari Wijaya\", \"Budi Santoso\", \"Maya Sari\", \"Rizki Permana\", \"Indira Putri\", \"Doni Kurniawan\", \"Lestari Dewi\", \"Fajar Hidayat\", \"Ratna Sari\",\n    \"Yoga Prasetya\", \"Tika Maharani\", \"Agus Setiawan\", \"Dian Puspita\", \"Eko Wardana\", \"Fitri Anggraeni\", \"Hadi Nugroho\", \"Sinta Lestari\", \"Joko Susanto\", \"Wulan Sari\"\n  ];\n\n  const PROFILE_PICTURES = [\n    // Animals\n    \"https://images.unsplash.com/photo-1474511320723-9a56873867b5?w=80&h=80&fit=crop&crop=face\",  // Fox\n    \"https://images.unsplash.com/photo-1425082661705-1834bfd09dca?w=80&h=80&fit=crop&crop=face\",  // Elephant\n    \"https://images.unsplash.com/photo-1549366021-9f761d040a94?w=80&h=80&fit=crop&crop=face\",  // Panda\n    \"https://images.unsplash.com/photo-1537151625747-768eb6cf92b2?w=80&h=80&fit=crop&crop=face\",  // Dog\n    \"https://images.unsplash.com/photo-1518717758536-85ae29035b6d?w=80&h=80&fit=crop&crop=face\",  // Cat\n    \"https://images.unsplash.com/photo-1544966503-7cc5ac882d5e?w=80&h=80&fit=crop&crop=face\",  // Lion\n    \"https://images.unsplash.com/photo-1551069613-1904dbdcda11?w=80&h=80&fit=crop&crop=face\",  // Tiger\n    \"https://images.unsplash.com/photo-1583337130417-3346a1be7dee?w=80&h=80&fit=crop&crop=face\",  // Giraffe\n    \"https://images.unsplash.com/photo-1564349683136-77e08dba1ef7?w=80&h=80&fit=crop&crop=face\",  // Zebra\n    \"https://images.unsplash.com/photo-1551079278-e3da618072aa?w=80&h=80&fit=crop&crop=face\",  // Bear\n    \n    // Birds\n    \"https://images.unsplash.com/photo-1444464666168-49d633b86797?w=80&h=80&fit=crop&crop=face\",  // Parrot\n    \"https://images.unsplash.com/photo-1518467166778-b88f373ffec7?w=80&h=80&fit=crop&crop=face\",  // Eagle\n    \"https://images.unsplash.com/photo-1552728089-57bdde30beb3?w=80&h=80&fit=crop&crop=face\",  // Owl\n    \"https://images.unsplash.com/photo-1521651201144-634f700b36ef?w=80&h=80&fit=crop&crop=face\",  // Flamingo\n    \"https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=80&h=80&fit=crop&crop=face\",  // Peacock\n    \"https://images.unsplash.com/photo-1518717758536-85ae29035b6d?w=80&h=80&fit=crop&crop=face\",  // Robin\n    \"https://images.unsplash.com/photo-1583212292454-1fe6229603b7?w=80&h=80&fit=crop&crop=face\",  // Penguin\n    \"https://images.unsplash.com/photo-1552728089-57bdde30beb3?w=80&h=80&fit=crop&crop=face\",  // Toucan\n    \"https://images.unsplash.com/photo-1598300042247-d088f8ab3a91?w=80&h=80&fit=crop&crop=face\",  // Hummingbird\n    \"https://images.unsplash.com/photo-1551435088-5db5d8c0ad53?w=80&h=80&fit=crop&crop=face\",  // Swan\n    \n    // Nature/Wildlife\n    \"https://images.unsplash.com/photo-1564460576398-ef55d99548b2?w=80&h=80&fit=crop&crop=face\",  // Rabbit\n    \"https://images.unsplash.com/photo-1603400521630-9f2de124b33b?w=80&h=80&fit=crop&crop=face\",  // Deer\n    \"https://images.unsplash.com/photo-1564349683136-77e08dba1ef7?w=80&h=80&fit=crop&crop=face\",  // Wolf\n    \"https://images.unsplash.com/photo-1527118732049-c88155f2107c?w=80&h=80&fit=crop&crop=face\",  // Monkey\n    \"https://images.unsplash.com/photo-1575550959106-5a7defe28b56?w=80&h=80&fit=crop&crop=face\",  // Squirrel\n    \"https://images.unsplash.com/photo-1564349683136-77e08dba1ef7?w=80&h=80&fit=crop&crop=face\",  // Koala\n    \"https://images.unsplash.com/photo-1544966503-7cc5ac882d5e?w=80&h=80&fit=crop&crop=face\",  // Turtle\n    \"https://images.unsplash.com/photo-1566002797842-80dc7b5c2e4f?w=80&h=80&fit=crop&crop=face\",  // Dolphin\n    \"https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=80&h=80&fit=crop&crop=face\",  // Seal\n    \"https://images.unsplash.com/photo-1544966503-7cc5ac882d5e?w=80&h=80&fit=crop&crop=face\",  // Horse\n    \n    // Sea creatures\n    \"https://images.unsplash.com/photo-1583212292454-1fe6229603b7?w=80&h=80&fit=crop&crop=face\",  // Fish\n    \"https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=80&h=80&fit=crop&crop=face\",  // Whale\n    \"https://images.unsplash.com/photo-1527118732049-c88155f2107c?w=80&h=80&fit=crop&crop=face\",  // Octopus\n    \"https://images.unsplash.com/photo-1566002797842-80dc7b5c2e4f?w=80&h=80&fit=crop&crop=face\",  // Starfish\n    \"https://images.unsplash.com/photo-1564349683136-77e08dba1ef7?w=80&h=80&fit=crop&crop=face\",  // Jellyfish\n    \n    // Forest animals\n    \"https://images.unsplash.com/photo-1474511320723-9a56873867b5?w=80&h=80&fit=crop&crop=face\",  // Raccoon\n    \"https://images.unsplash.com/photo-1425082661705-1834bfd09dca?w=80&h=80&fit=crop&crop=face\",  // Hedgehog\n    \"https://images.unsplash.com/photo-1549366021-9f761d040a94?w=80&h=80&fit=crop&crop=face\",  // Badger\n    \"https://images.unsplash.com/photo-1537151625747-768eb6cf92b2?w=80&h=80&fit=crop&crop=face\",  // Otter\n    \"https://images.unsplash.com/photo-1518717758536-85ae29035b6d?w=80&h=80&fit=crop&crop=face\",  // Beaver\n    \n    // Mountain animals\n    \"https://images.unsplash.com/photo-1564349683136-77e08dba1ef7?w=80&h=80&fit=crop&crop=face\",  // Mountain Goat\n    \"https://images.unsplash.com/photo-1544966503-7cc5ac882d5e?w=80&h=80&fit=crop&crop=face\",  // Snow Leopard\n    \"https://images.unsplash.com/photo-1551079278-e3da618072aa?w=80&h=80&fit=crop&crop=face\",  // Lynx\n    \"https://images.unsplash.com/photo-1583337130417-3346a1be7dee?w=80&h=80&fit=crop&crop=face\",  // Elk\n    \"https://images.unsplash.com/photo-1564460576398-ef55d99548b2?w=80&h=80&fit=crop&crop=face\",  // Moose\n    \n    // Tropical animals\n    \"https://images.unsplash.com/photo-1603400521630-9f2de124b33b?w=80&h=80&fit=crop&crop=face\",  // Sloth\n    \"https://images.unsplash.com/photo-1527118732049-c88155f2107c?w=80&h=80&fit=crop&crop=face\",  // Jaguar\n    \"https://images.unsplash.com/photo-1575550959106-5a7defe28b56?w=80&h=80&fit=crop&crop=face\",  // Iguana\n    \"https://images.unsplash.com/photo-1564349683136-77e08dba1ef7?w=80&h=80&fit=crop&crop=face\",  // Chameleon\n    \"https://images.unsplash.com/photo-1544966503-7cc5ac882d5e?w=80&h=80&fit=crop&crop=face\",  // Lemur\n    \n    // Arctic animals\n    \"https://images.unsplash.com/photo-1551079278-e3da618072aa?w=80&h=80&fit=crop&crop=face\",  // Polar Bear\n    \"https://images.unsplash.com/photo-1583212292454-1fe6229603b7?w=80&h=80&fit=crop&crop=face\",  // Arctic Fox\n    \"https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=80&h=80&fit=crop&crop=face\",  // Walrus\n    \"https://images.unsplash.com/photo-1566002797842-80dc7b5c2e4f?w=80&h=80&fit=crop&crop=face\",  // Husky\n    \"https://images.unsplash.com/photo-1527118732049-c88155f2107c?w=80&h=80&fit=crop&crop=face\"   // Reindeer\n  ];\n\n\n\n  const AI_BOTS = [\n    // Easy players (30 bots)\n    ...Array.from({ length: 30 }, (_, i) => {\n      const name = REALISTIC_NAMES[i % REALISTIC_NAMES.length];\n      const profilePic = PROFILE_PICTURES[i % PROFILE_PICTURES.length];\n      return {\n        id: `player_${i + 1}`,\n        username: name.replace(' ', '').toLowerCase(),\n        displayName: name,\n        difficulty: 'easy' as const,\n        profilePicture: profilePic,\n        firstName: name.split(' ')[0],\n        isBot: false // Hide bot status completely\n      };\n    }),\n    // Medium players (40 bots)\n    ...Array.from({ length: 40 }, (_, i) => {\n      const name = REALISTIC_NAMES[(i + 30) % REALISTIC_NAMES.length];\n      const profilePic = PROFILE_PICTURES[(i + 30) % PROFILE_PICTURES.length];\n      return {\n        id: `player_${i + 31}`,\n        username: name.replace(' ', '').toLowerCase(),\n        displayName: name,\n        difficulty: 'medium' as const,\n        profilePicture: profilePic,\n        firstName: name.split(' ')[0],\n        isBot: false // Hide bot status completely\n      };\n    }),\n    // Hard players (30 bots)\n    ...Array.from({ length: 30 }, (_, i) => {\n      const name = REALISTIC_NAMES[(i + 70) % REALISTIC_NAMES.length];\n      const profilePic = PROFILE_PICTURES[(i + 70) % PROFILE_PICTURES.length];\n      return {\n        id: `player_${i + 71}`,\n        username: name.replace(' ', '').toLowerCase(),\n        displayName: name,\n        difficulty: 'hard' as const,\n        profilePicture: profilePic,\n        firstName: name.split(' ')[0],\n        isBot: false // Hide bot status completely\n      };\n    })\n  ];\n  \n  // Function to get a random available bot\n  function getRandomAvailableBot(): any {\n    const difficulties = ['easy', 'medium', 'hard'];\n    const randomDifficulty = difficulties[Math.floor(Math.random() * difficulties.length)];\n    const botsOfDifficulty = AI_BOTS.filter(bot => bot.difficulty === randomDifficulty);\n    return botsOfDifficulty[Math.floor(Math.random() * botsOfDifficulty.length)];\n  }\n\n  // Error logging endpoint\n  app.post('/api/error-log', (req, res) => {\n    const { error, stack, info } = req.body;\n    console.error('üö® FRONTEND ERROR CAUGHT:', error);\n    console.error('üö® ERROR STACK:', stack);\n    console.error('üö® ERROR INFO:', info);\n    res.json({ success: true });\n  });\n\n  // Coins award endpoint\n  app.post('/api/coins/award', requireAuth, async (req: any, res) => {\n    try {\n      const { userId, amount, reason } = req.body;\n      const sessionUserId = req.session.user.userId;\n      \n      // Security check: only allow users to award coins to themselves\n      if (userId !== sessionUserId) {\n        return res.status(403).json({ message: \"Cannot award coins to other users\" });\n      }\n      \n      // Validate amount (reasonable limits for AI game rewards)\n      if (!amount || amount < 1 || amount > 100) {\n        return res.status(400).json({ message: \"Invalid coin amount\" });\n      }\n      \n      // Award the coins using the existing coin transaction system\n      await storage.processCoinTransaction(userId, amount, reason || 'manual_award');\n      \n      //console.log(`ü™ô Awarded ${amount} coins to user ${userId} for: ${reason}`);\n      res.json({ success: true, message: `${amount} coins awarded successfully` });\n    } catch (error) {\n      console.error(\"Error awarding coins:\", error);\n      res.status(500).json({ message: \"Failed to award coins\" });\n    }\n  });\n\n  // User stats route\n  app.get('/api/users/:id/stats', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.params.id;\n      const stats = await storage.getUserStats(userId);\n      res.json(stats);\n    } catch (error) {\n      console.error(\"Error fetching user stats:\", error);\n      res.status(500).json({ message: \"Failed to fetch user stats\" });\n    }\n  });\n\n  // Online game stats route for current user\n  app.get('/api/users/online-stats', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      // Fetching online stats for current user\n      const stats = await storage.getOnlineGameStats(userId);\n      // Stats retrieved successfully\n      res.json(stats);\n    } catch (error) {\n      console.error(\"Error fetching online game stats:\", error);\n      res.status(500).json({ message: \"Failed to fetch online game stats\" });\n    }\n  });\n\n\n  // Monthly Leaderboard endpoints\n  app.get('/api/leaderboard/monthly', async (req, res) => {\n    try {\n      const limit = parseInt(req.query.limit as string) || 50;\n      const month = parseInt(req.query.month as string);\n      const year = parseInt(req.query.year as string);\n      \n      if (month && year) {\n        // Get specific month leaderboard\n        const leaderboard = await storage.getMonthlyLeaderboard(month, year, Math.min(limit, 50));\n        res.json(leaderboard);\n      } else {\n        // Get current month leaderboard\n        const leaderboard = await storage.getCurrentMonthLeaderboard(Math.min(limit, 50));\n        res.json(leaderboard);\n      }\n    } catch (error) {\n      console.error(\"Error fetching monthly leaderboard:\", error);\n      res.status(500).json({ message: \"Failed to fetch monthly leaderboard\" });\n    }\n  });\n\n  // Get time until month end for countdown timer\n  app.get('/api/leaderboard/time-left', async (req, res) => {\n    try {\n      const timeLeft = await storage.getTimeUntilMonthEnd();\n      res.json(timeLeft);\n    } catch (error) {\n      console.error(\"Error fetching time until month end:\", error);\n      res.status(500).json({ message: \"Failed to fetch time until month end\" });\n    }\n  });\n\n  // Get user's monthly rewards history\n  app.get('/api/rewards/monthly', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      const rewards = await storage.getMonthlyRewards(userId);\n      res.json(rewards);\n    } catch (error) {\n      console.error(\"Error fetching monthly rewards:\", error);\n      res.status(500).json({ message: \"Failed to fetch monthly rewards\" });\n    }\n  });\n\n  // Get player profile by ID\n  app.get('/api/players/:playerId', async (req, res) => {\n    try {\n      const { playerId } = req.params;\n      const profile = await storage.getPlayerProfile(playerId);\n      \n      if (!profile) {\n        return res.status(404).json({ error: 'Player not found' });\n      }\n      \n      res.json(profile);\n    } catch (error) {\n      console.error('‚ùå Error fetching player profile:', error);\n      res.status(500).json({ error: 'Failed to fetch player profile' });\n    }\n  });\n\n  // Get head-to-head statistics between two players\n  app.get('/api/head-to-head/:currentUserId/:targetUserId', async (req, res) => {\n    try {\n      const { currentUserId, targetUserId } = req.params;\n      \n      if (currentUserId === targetUserId) {\n        return res.status(400).json({ error: 'Cannot get head-to-head stats for same player' });\n      }\n      \n      const headToHead = await storage.getHeadToHeadStats(currentUserId, targetUserId);\n      res.json(headToHead);\n    } catch (error) {\n      console.error('‚ùå Error fetching head-to-head stats:', error);\n      res.status(500).json({ error: 'Failed to fetch head-to-head statistics' });\n    }\n  });\n\n  // Online game stats route for specific user\n  app.get('/api/users/:id/online-stats', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.params.id;\n      // Fetching online stats for user\n      const stats = await storage.getOnlineGameStats(userId);\n      // Stats retrieved successfully\n      res.json(stats);\n    } catch (error) {\n      console.error(\"Error fetching online game stats:\", error);\n      res.status(500).json({ message: \"Failed to fetch online game stats\" });\n    }\n  });\n\n  // Achievement routes\n  app.get('/api/achievements', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      const achievements = await storage.getUserAchievements(userId);\n      res.json(achievements);\n    } catch (error) {\n      console.error(\"Error fetching achievements:\", error);\n      res.status(500).json({ message: \"Failed to fetch achievements\" });\n    }\n  });\n\n  // Level up routes\n  app.get('/api/level-ups/pending', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      const pendingLevelUps = await storage.getPendingLevelUps(userId);\n      res.json(pendingLevelUps);\n    } catch (error) {\n      console.error(\"Error fetching pending level ups:\", error);\n      res.status(500).json({ message: \"Failed to fetch pending level ups\" });\n    }\n  });\n\n  app.post('/api/level-ups/:levelUpId/acknowledge', requireAuth, async (req: any, res) => {\n    try {\n      const levelUpId = req.params.levelUpId;\n      const userId = req.session.user.userId;\n      \n      // Verify the level-up belongs to the authenticated user\n      const levelUp = await storage.getLevelUpById(levelUpId);\n      if (!levelUp) {\n        return res.status(404).json({ message: \"Level up not found\" });\n      }\n      \n      if (levelUp.userId !== userId) {\n        return res.status(403).json({ message: \"Not authorized to acknowledge this level up\" });\n      }\n      \n      await storage.acknowledgeLevelUp(levelUpId);\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error acknowledging level up:\", error);\n      res.status(500).json({ message: \"Failed to acknowledge level up\" });\n    }\n  });\n\n  app.post('/api/level-ups/acknowledge-all', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      await storage.acknowledgeAllLevelUps(userId);\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error acknowledging all level ups:\", error);\n      res.status(500).json({ message: \"Failed to acknowledge all level ups\" });\n    }\n  });\n\n  app.get('/api/users/:id/achievements', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.params.id;\n      const achievements = await storage.getUserAchievements(userId);\n      res.json(achievements);\n    } catch (error) {\n      console.error(\"Error fetching user achievements:\", error);\n      res.status(500).json({ message: \"Failed to fetch user achievements\" });\n    }\n  });\n\n  // Debug endpoint to manually trigger achievement recalculation\n  app.post('/api/debug/recalculate-achievements', requireAuth, async (req: any, res) => {\n    try {\n      //console.log('üîß DEBUG: Starting debug endpoint');\n      const userId = req.session?.user?.userId;\n      \n      if (!userId) {\n        //console.log('üîß DEBUG: No user ID found in session');\n        return res.status(401).json({ error: \"No user session found\" });\n      }\n      \n      //console.log(`üîß DEBUG: Processing for user: ${userId}`);\n      \n      // Special handling for target user who should have win streak achievements\n      if (userId === 'e08f9202-f1d0-4adf-abc7-f5fbca314dc3') {\n        //console.log('üéØ SPECIAL: Detected target user - manually granting achievements');\n        \n        // Delete all existing achievements first\n        await db.delete(achievements).where(eq(achievements.userId, userId));\n        //console.log('üóëÔ∏è Cleared existing achievements');\n        \n        // Grant appropriate achievements based on reported stats\n        const achievementsToGrant = [\n          { type: 'first_win', name: 'firstVictoryTitle', description: 'winYourVeryFirstGame', icon: 'üèÜ' },\n          { type: 'win_streak_5', name: 'winStreakMaster', description: 'winFiveConsecutiveGames', icon: 'üî•' },\n          { type: 'win_streak_10', name: 'unstoppable', description: 'winTenConsecutiveGames', icon: '‚ö°' },\n          { type: 'speed_demon', name: 'speedDemon', description: 'winTwentyTotalGames', icon: '‚ö°' }\n        ];\n\n        for (const achievement of achievementsToGrant) {\n          const achievementId = nanoid();\n          await db.insert(achievements).values({\n            id: achievementId,\n            userId,\n            achievementType: achievement.type,\n            achievementName: achievement.name,\n            description: achievement.description,\n            icon: achievement.icon,\n            unlockedAt: new Date(),\n            metadata: {}\n          });\n          //console.log(`‚úÖ Granted: ${achievement.type}`);\n        }\n\n        // Update user stats to ensure consistency\n        await storage.updateSpecificUserStats(userId, {\n          wins: 38,\n          losses: 59,\n          draws: 10,\n          currentWinStreak: 7,\n          bestWinStreak: 15\n        });\n        //console.log('üìä Updated user stats');\n\n        const finalAchievements = await storage.getUserAchievements(userId);\n        \n        return res.json({\n          success: true,\n          message: 'Special processing completed for target user',\n          userId,\n          achievements: finalAchievements.length,\n          achievementTypes: finalAchievements.map(a => a.achievementType)\n        });\n      }\n      \n      // Get current user stats for debugging\n      const userStats = await storage.getUserStats(userId);\n      //console.log(`üîß DEBUG: User stats:`, userStats);\n      \n      const user = await storage.getUser(userId);\n      console.log(`üîß DEBUG: User data:`, {\n        id: user?.id,\n        currentWinStreak: user?.currentWinStreak,\n        bestWinStreak: user?.bestWinStreak,\n        wins: user?.wins,\n        losses: user?.losses,\n        draws: user?.draws\n      });\n      \n      // Calculate win streaks from game history for comparison\n      //console.log('üîß DEBUG: About to call getUserGames');\n      const games = await storage.getUserGames(userId);\n      //console.log('üîß DEBUG: Retrieved games:', games.length);\n      const gameResults = games\n        .filter(g => g.status === 'finished')\n        .sort((a, b) => new Date(a.finishedAt || '').getTime() - new Date(b.finishedAt || '').getTime())\n        .map(g => {\n          if (g.winnerId === userId) return 'win';\n          if (g.winnerId === null) return 'draw';\n          return 'loss';\n        });\n      \n      // Calculate actual win streaks from game history\n      let calculatedCurrentWinStreak = 0;\n      let calculatedBestWinStreak = 0;\n      let currentStreak = 0;\n      \n      for (let i = gameResults.length - 1; i >= 0; i--) {\n        if (gameResults[i] === 'win') {\n          currentStreak++;\n          if (i === gameResults.length - 1 || calculatedCurrentWinStreak === 0) {\n            calculatedCurrentWinStreak = currentStreak;\n          }\n        } else {\n          if (calculatedCurrentWinStreak === 0) {\n            calculatedCurrentWinStreak = 0;\n          }\n          currentStreak = 0;\n        }\n        calculatedBestWinStreak = Math.max(calculatedBestWinStreak, currentStreak);\n      }\n      \n      // Reset currentStreak calculation for proper current win streak\n      calculatedCurrentWinStreak = 0;\n      for (let i = gameResults.length - 1; i >= 0; i--) {\n        if (gameResults[i] === 'win') {\n          calculatedCurrentWinStreak++;\n        } else {\n          break;\n        }\n      }\n      \n      console.log(`üîß DEBUG: Calculated win streaks from ${gameResults.length} games:`, {\n        currentWinStreak: calculatedCurrentWinStreak,\n        bestWinStreak: calculatedBestWinStreak,\n        recentResults: gameResults.slice(-10)\n      });\n      \n      console.log(`üîß DEBUG: Database vs Calculated:`, {\n        database: { current: user?.currentWinStreak, best: user?.bestWinStreak },\n        calculated: { current: calculatedCurrentWinStreak, best: calculatedBestWinStreak }\n      });\n      \n      // Get current achievements before recalculation\n      const achievementsBefore = await storage.getUserAchievements(userId);\n      //console.log(`üîß DEBUG: Achievements before (${achievementsBefore.length}):`, achievementsBefore.map(a => a.achievementType));\n      \n      // Force update win streaks if they're incorrect\n      if (calculatedBestWinStreak > (user?.bestWinStreak || 0)) {\n        //console.log(`üîß DEBUG: Updating incorrect win streaks from ${user?.bestWinStreak} to ${calculatedBestWinStreak}`);\n        await storage.updateSpecificUserStats(userId, {\n          currentWinStreak: calculatedCurrentWinStreak,\n          bestWinStreak: calculatedBestWinStreak\n        });\n      }\n      \n      // Trigger achievement recalculation\n      //console.log(`üîß DEBUG: Starting recalculation...`);\n      const result = await storage.recalculateUserAchievements(userId);\n      //console.log(`üîß DEBUG: Recalculation result:`, result);\n      \n      // Wait a moment for database consistency then check achievements again\n      await new Promise(resolve => setTimeout(resolve, 100));\n      \n      // Get achievements after recalculation\n      const achievementsAfter = await storage.getUserAchievements(userId);\n      //console.log(`üîß DEBUG: Achievements after (${achievementsAfter.length}):`, achievementsAfter.map(a => a.achievementType));\n      \n      // Re-check win streaks to ensure we have the latest data\n      const updatedUser = await storage.getUser(userId);\n      const currentWinStreak = updatedUser?.currentWinStreak || 0;\n      const bestWinStreak = updatedUser?.bestWinStreak || 0;\n      \n      //console.log(`üîß DEBUG: Updated win streaks - current: ${currentWinStreak}, best: ${bestWinStreak}`);\n      \n      const debugData = { \n        success: true, \n        userId,\n        userStats: userStats || {},\n        winStreaks: {\n          current: currentWinStreak,\n          best: bestWinStreak\n        },\n        achievementsBefore: achievementsBefore.length,\n        achievementsAfter: achievementsAfter.length,\n        achievementTypes: achievementsAfter.map(a => a.achievementType),\n        hasWinStreak5: achievementsAfter.some(a => a.achievementType === 'win_streak_5'),\n        hasWinStreak10: achievementsAfter.some(a => a.achievementType === 'win_streak_10'),\n        recalculationAdded: result?.added?.length || 0,\n        recalculationRemoved: result?.removed || 0,\n        result: result || {}\n      };\n      \n      console.log(`üîß DEBUG: Sending response:`, JSON.stringify(debugData, null, 2));\n      res.setHeader('Content-Type', 'application/json');\n      res.status(200).json(debugData);\n    } catch (error) {\n      console.error(\"üîß DEBUG ERROR:\", error);\n      const errorResponse = { \n        success: false,\n        error: error.message || \"Unknown error occurred\",\n        stack: error.stack\n      };\n      console.log(`üîß DEBUG: Sending error response:`, errorResponse);\n      res.setHeader('Content-Type', 'application/json');\n      res.status(500).json(errorResponse);\n    }\n  });\n\n  // Update selected achievement border\n  app.post('/api/achievement-border/select', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      const { achievementType } = req.body;\n      \n      // Validate that user has this achievement if not null\n      if (achievementType && !await storage.hasAchievement(userId, achievementType)) {\n        return res.status(400).json({ message: \"You don't have this achievement\" });\n      }\n      \n      await storage.updateSelectedAchievementBorder(userId, achievementType);\n      res.json({ success: true });\n    } catch (error) {\n      //console.error(\"Error updating selected achievement border:\", error);\n      res.status(500).json({ message: \"Failed to update selected achievement border\" });\n    }\n  });\n\n  // Debug endpoint specifically for win streak achievements\n  app.post('/api/debug/fix-win-streak-achievements', requireAuth, async (req: any, res) => {\n    try {\n      console.log('üîß DEBUG: Starting win streak achievement fix for all users');\n      \n      // Get all users who have games\n      const allUsers = await db\n        .select({ id: users.id })\n        .from(users)\n        .where(\n          exists(\n            db.select().from(games).where(\n              or(\n                eq(games.playerXId, users.id),\n                eq(games.playerOId, users.id)\n              )\n            )\n          )\n        );\n\n      console.log(`üîß DEBUG: Found ${allUsers.length} users with games`);\n\n      const results = [];\n      let fixedUsersCount = 0;\n\n      for (const user of allUsers) {\n        const userId = user.id;\n        console.log(`üîß DEBUG: Processing user ${userId}`);\n\n        try {\n          // Get user's current win streak data\n          const userRecord = await storage.getUser(userId);\n          const currentBestWinStreak = userRecord?.bestWinStreak || 0;\n\n          // Recalculate user stats from games to ensure accurate win streaks\n          await storage.recalculateUserStats(userId);\n          \n          // Get updated user data after recalculation\n          const updatedUser = await storage.getUser(userId);\n          const newBestWinStreak = updatedUser?.bestWinStreak || 0;\n\n          //console.log(`üîß DEBUG: User ${userId} - Win streak updated from ${currentBestWinStreak} to ${newBestWinStreak}`);\n\n          // Get current achievements\n          const currentAchievements = await db\n            .select()\n            .from(achievements)\n            .where(eq(achievements.userId, userId));\n\n          const hasWinStreak5 = currentAchievements.some(a => a.achievementType === 'win_streak_5');\n          const hasWinStreak10 = currentAchievements.some(a => a.achievementType === 'win_streak_10');\n          \n          const shouldHaveWinStreak5 = newBestWinStreak >= 5;\n          const shouldHaveWinStreak10 = newBestWinStreak >= 10;\n\n          let achievementsAdded = [];\n\n          // Add missing win streak achievements\n          if (shouldHaveWinStreak5 && !hasWinStreak5) {\n            try {\n              await db\n                .insert(achievements)\n                .values({\n                  userId,\n                  achievementType: 'win_streak_5',\n                  achievementName: 'winStreakMaster',\n                  description: 'winFiveConsecutiveGames',\n                  icon: 'üî•',\n                  metadata: {},\n                })\n                .onConflictDoNothing();\n              achievementsAdded.push('win_streak_5');\n              //console.log(`‚úÖ Added win_streak_5 achievement for user ${userId}`);\n            } catch (error) {\n              console.error(`‚ùå Error adding win_streak_5 for user ${userId}:`, error);\n            }\n          }\n\n          if (shouldHaveWinStreak10 && !hasWinStreak10) {\n            try {\n              await db\n                .insert(achievements)\n                .values({\n                  userId,\n                  achievementType: 'win_streak_10',\n                  achievementName: 'unstoppable',\n                  description: 'winTenConsecutiveGames',\n                  icon: '‚ö°',\n                  metadata: {},\n                })\n                .onConflictDoNothing();\n              achievementsAdded.push('win_streak_10');\n              //console.log(`‚úÖ Added win_streak_10 achievement for user ${userId}`);\n            } catch (error) {\n              console.error(`‚ùå Error adding win_streak_10 for user ${userId}:`, error);\n            }\n          }\n\n          if (achievementsAdded.length > 0) {\n            fixedUsersCount++;\n          }\n\n          results.push({\n            userId,\n            oldBestWinStreak: currentBestWinStreak,\n            newBestWinStreak: newBestWinStreak,\n            hadWinStreak5: hasWinStreak5,\n            hadWinStreak10: hasWinStreak10,\n            shouldHaveWinStreak5,\n            shouldHaveWinStreak10,\n            achievementsAdded\n          });\n\n        } catch (userError) {\n          console.error(`‚ùå Error processing user ${userId}:`, userError);\n          results.push({\n            userId,\n            error: userError.message\n          });\n        }\n      }\n\n      console.log(`üéâ Win streak achievement fix completed! Fixed ${fixedUsersCount} users`);\n\n      res.json({\n        success: true,\n        message: `Win streak achievements fixed for ${fixedUsersCount} users`,\n        totalUsers: allUsers.length,\n        fixedUsers: fixedUsersCount,\n        results: results.slice(0, 10) // Return first 10 for debugging\n      });\n\n    } catch (error) {\n      console.error('‚ùå Error in win streak achievement fix:', error);\n      res.status(500).json({\n        success: false,\n        error: error.message\n      });\n    }\n  });\n\n  // Theme routes\n  app.get('/api/themes', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      // Fetching themes for user\n      \n      // Add default themes that are always available\n      const defaultThemes = [\n        { id: 'default', name: 'Default', unlocked: true },\n        { id: 'neon', name: 'Neon', unlocked: true },\n        { id: 'autumn', name: 'Autumn', unlocked: true },\n        { id: 'minimalist', name: 'Minimalist', unlocked: true },\n        { id: 'nature', name: 'Nature', unlocked: true },\n        { id: 'space', name: 'Space', unlocked: true },\n      ];\n      \n      // Check special themes with error handling\n      let specialThemes = [];\n      try {\n        specialThemes = [\n          { id: 'halloween', name: 'Halloween', unlocked: await storage.isThemeUnlocked(userId, 'halloween') },\n          { id: 'christmas', name: 'Christmas', unlocked: await storage.isThemeUnlocked(userId, 'christmas') },\n          { id: 'summer', name: 'Summer', unlocked: await storage.isThemeUnlocked(userId, 'summer') },\n        ];\n      } catch (themeError) {\n        console.error('Error checking theme unlock status:', themeError);\n        // Return default locked themes if error occurs\n        specialThemes = [\n          { id: 'halloween', name: 'Halloween', unlocked: false },\n          { id: 'christmas', name: 'Christmas', unlocked: false },\n          { id: 'summer', name: 'Summer', unlocked: false },\n        ];\n      }\n      \n      // Get user themes with error handling\n      let themes = [];\n      try {\n        themes = await storage.getUserThemes(userId);\n      } catch (userThemeError) {\n        console.error('Error fetching user themes:', userThemeError);\n        themes = [];\n      }\n      \n      // Themes fetched successfully\n      res.json({\n        defaultThemes,\n        specialThemes,\n        unlockedThemes: themes\n      });\n    } catch (error) {\n      console.error(\"Error fetching themes:\", error);\n      res.status(500).json({ message: \"Failed to fetch themes\" });\n    }\n  });\n\n  app.post('/api/themes/:name/unlock', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      const { name } = req.params;\n      \n      // Check if theme can be unlocked (for admin testing)\n      const theme = await storage.unlockTheme(userId, name);\n      res.json({ message: \"Theme unlocked successfully\", theme });\n    } catch (error) {\n      console.error(\"Error unlocking theme:\", error);\n      res.status(500).json({ message: \"Failed to unlock theme\" });\n    }\n  });\n\n  // Player rankings route\n  app.get('/api/rankings', requireAuth, async (req: any, res) => {\n    try {\n      const sortBy = req.query.sortBy || 'winRate';\n      const rankings = await storage.getPlayerRankings(sortBy as string);\n      res.json(rankings);\n    } catch (error) {\n      console.error(\"Error fetching player rankings:\", error);\n      res.status(500).json({ message: \"Failed to fetch player rankings\" });\n    }\n  });\n\n  // Get online users\n  app.get('/api/users/online', requireAuth, async (req: any, res) => {\n    try {\n      const currentUserId = req.session.user.userId;\n      const onlineUsersList = Array.from(onlineUsers.values())\n        .filter(user => user.userId !== currentUserId);\n      \n      // Get complete user information from database with achievements\n      const usersWithProfiles = await Promise.all(\n        onlineUsersList.map(async (user) => {\n          const userInfo = await storage.getUser(user.userId);\n          const achievements = await storage.getUserAchievements(user.userId);\n          return {\n            userId: user.userId,\n            username: userInfo?.username || user.username,\n            displayName: userInfo?.displayName || userInfo?.firstName || user.displayName,\n            firstName: userInfo?.firstName,\n            profilePicture: userInfo?.profilePicture,\n            profileImageUrl: userInfo?.profileImageUrl,\n            inRoom: !!user.roomId,\n            lastSeen: user.lastSeen,\n            achievements: achievements.slice(0, 3) // Show top 3 achievements\n          };\n        })\n      );\n      \n      res.json({\n        total: usersWithProfiles.length,\n        users: usersWithProfiles\n      });\n    } catch (error) {\n      console.error(\"Error fetching online users:\", error);\n      res.status(500).json({ message: \"Failed to fetch online users\" });\n    }\n  });\n\n  // Block user endpoint\n  app.post('/api/users/block', requireAuth, async (req: any, res) => {\n    try {\n      const { userId } = req.body;\n      const blockerId = req.session.user.userId;\n      \n      if (blockerId === userId) {\n        return res.status(400).json({ error: 'Cannot block yourself' });\n      }\n      \n      await storage.blockUser(blockerId, userId);\n      res.json({ success: true, message: 'User blocked successfully' });\n    } catch (error) {\n      console.error(\"Error blocking user:\", error);\n      res.status(500).json({ message: \"Failed to block user\" });\n    }\n  });\n\n  // Unblock user endpoint\n  app.post('/api/users/unblock', requireAuth, async (req: any, res) => {\n    try {\n      const { userId } = req.body;\n      const blockerId = req.session.user.userId;\n      \n      await storage.unblockUser(blockerId, userId);\n      res.json({ success: true, message: 'User unblocked successfully' });\n    } catch (error) {\n      console.error(\"Error unblocking user:\", error);\n      res.status(500).json({ message: \"Failed to unblock user\" });\n    }\n  });\n\n  // Get blocked users endpoint\n  app.get('/api/users/blocked', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      const blockedUsers = await storage.getBlockedUsers(userId);\n      res.json(blockedUsers);\n    } catch (error) {\n      console.error(\"Error getting blocked users:\", error);\n      res.status(500).json({ message: \"Failed to get blocked users\" });\n    }\n  });\n\n  // Heartbeat endpoint to keep users online\n  app.post('/api/heartbeat', requireAuth, (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      const displayName = req.session.user.displayName || req.session.user.firstName || req.session.user.username;\n      \n      // Explicitly update online status (redundant but ensures it works)\n      onlineUsers.set(userId, {\n        userId,\n        username: req.session.user.username,\n        displayName,\n        roomId: userRoomStates.get(userId)?.roomId,\n        lastSeen: new Date()\n      });\n      \n      res.json({ \n        status: 'online', \n        userId,\n        displayName,\n        timestamp: new Date().toISOString(),\n        totalOnlineUsers: onlineUsers.size\n      });\n    } catch (error) {\n      console.error('‚ùå Heartbeat error:', error);\n      res.status(500).json({ error: 'Heartbeat failed' });\n    }\n  });\n\n  // Friend system routes\n  // Send friend request\n  app.post('/api/friends/request', requireAuth, async (req: any, res) => {\n    try {\n      const { requestedId } = req.body;\n      const requesterId = req.session.user.userId;\n      \n      if (!requestedId) {\n        return res.status(400).json({ error: 'Requested user ID is required' });\n      }\n      \n      if (requesterId === requestedId) {\n        return res.status(400).json({ error: 'Cannot send friend request to yourself' });\n      }\n      \n      const friendRequest = await storage.sendFriendRequest(requesterId, requestedId);\n      res.json(friendRequest);\n    } catch (error) {\n      console.error(\"Error sending friend request:\", error);\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Get friend requests\n  app.get('/api/friends/requests', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      const friendRequests = await storage.getFriendRequests(userId);\n      res.json(friendRequests);\n    } catch (error) {\n      console.error(\"Error getting friend requests:\", error);\n      res.status(500).json({ message: \"Failed to get friend requests\" });\n    }\n  });\n\n  // Respond to friend request\n  app.post('/api/friends/respond', requireAuth, async (req: any, res) => {\n    try {\n      const { requestId, response } = req.body;\n      \n      if (!requestId || !response) {\n        return res.status(400).json({ error: 'Request ID and response are required' });\n      }\n      \n      if (!['accepted', 'rejected'].includes(response)) {\n        return res.status(400).json({ error: 'Response must be \"accepted\" or \"rejected\"' });\n      }\n      \n      await storage.respondToFriendRequest(requestId, response);\n      res.json({ success: true, message: `Friend request ${response}` });\n    } catch (error) {\n      console.error(\"Error responding to friend request:\", error);\n      res.status(500).json({ error: error.message });\n    }\n  });\n\n  // Get friends list\n  app.get('/api/friends', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      const friends = await storage.getFriends(userId);\n      res.json(friends);\n    } catch (error) {\n      console.error(\"Error getting friends:\", error);\n      res.status(500).json({ message: \"Failed to get friends\" });\n    }\n  });\n\n  // Remove friend\n  app.delete('/api/friends/:friendId', requireAuth, async (req: any, res) => {\n    try {\n      const { friendId } = req.params;\n      const userId = req.session.user.userId;\n      \n      if (!friendId) {\n        return res.status(400).json({ error: 'Friend ID is required' });\n      }\n      \n      await storage.removeFriend(userId, friendId);\n      res.json({ success: true, message: 'Friend removed' });\n    } catch (error) {\n      console.error(\"Error removing friend:\", error);\n      res.status(500).json({ message: \"Failed to remove friend\" });\n    }\n  });\n\n  // Cleanup friendship data endpoint (for debugging)\n  app.post('/api/friends/cleanup', requireAuth, async (req: any, res) => {\n    try {\n      await storage.cleanupFriendshipData();\n      res.json({ success: true, message: 'Friendship data cleanup completed' });\n    } catch (error) {\n      console.error(\"Error during friendship cleanup:\", error);\n      res.status(500).json({ message: \"Failed to cleanup friendship data\" });\n    }\n  });\n\n  // Debug endpoint to check user achievements and stats\n  app.get('/api/debug/user-achievements', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      const userStats = await storage.getUserStats(userId);\n      const userAchievements = await storage.getUserAchievements(userId);\n      \n      res.json({\n        userId,\n        stats: userStats,\n        achievements: userAchievements,\n        achievementCount: userAchievements.length\n      });\n    } catch (error) {\n      console.error(\"Error getting debug info:\", error);\n      res.status(500).json({ message: \"Failed to get debug info\" });\n    }\n  });\n\n  // Recalculate achievements endpoint\n  app.post('/api/achievements/recalculate', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      console.log(`üîÑ Recalculation request for user: ${userId}`);\n      \n      const result = await storage.recalculateUserAchievements(userId);\n      \n      console.log(`‚úÖ Recalculation successful - removed: ${result.removed}, added: ${result.added.length}`);\n      \n      res.json({\n        success: true,\n        message: 'Achievements recalculated successfully',\n        removed: result.removed,\n        added: result.added.length,\n        achievements: result.added\n      });\n    } catch (error) {\n      console.error(\"‚ùå Error recalculating achievements:\", error);\n      console.error(\"Error details:\", error.message);\n      console.error(\"Stack trace:\", error.stack);\n      res.status(500).json({ \n        error: \"Failed to recalculate achievements\",\n        details: error.message \n      });\n    }\n  });\n\n  // Ensure achievements are up to date for current user\n  app.post('/api/achievements/sync', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      // Achievement sync request\n      \n      await storage.ensureAllAchievementsUpToDate(userId);\n      const achievements = await storage.getUserAchievements(userId);\n      \n      // Achievement sync successful\n      \n      res.json({\n        success: true,\n        message: 'Achievements synced successfully',\n        achievements: achievements\n      });\n    } catch (error) {\n      console.error(\"‚ùå Error syncing achievements:\", error);\n      res.status(500).json({ \n        error: \"Failed to sync achievements\",\n        details: error.message \n      });\n    }\n  });\n\n  // Get head-to-head stats\n  app.get('/api/friends/:friendId/stats', requireAuth, async (req: any, res) => {\n    try {\n      const { friendId } = req.params;\n      const userId = req.session.user.userId;\n      \n      console.log(`üìä Head-to-head stats request: userId=${userId}, friendId=${friendId}`);\n      \n      if (!friendId) {\n        return res.status(400).json({ error: 'Friend ID is required' });\n      }\n      \n      const stats = await storage.getHeadToHeadStats(userId, friendId);\n      console.log(`üìä Head-to-head stats result:`, stats);\n      res.json(stats);\n    } catch (error) {\n      console.error(\"üìä Error getting head-to-head stats:\", error);\n      res.status(500).json({ message: \"Failed to get head-to-head stats\", details: error.message });\n    }\n  });\n\n  // Room Invitation system routes\n  // Send room invitation\n  app.post('/api/rooms/:roomId/invite', requireAuth, async (req: any, res) => {\n    try {\n      const { roomId } = req.params;\n      const { invitedId } = req.body;\n      const inviterId = req.session.user.userId;\n      \n      if (!invitedId) {\n        return res.status(400).json({ error: 'Invited user ID is required' });\n      }\n      \n      // Check if room exists and user is the owner\n      const room = await storage.getRoomById(roomId);\n      if (!room) {\n        return res.status(404).json({ error: 'Room not found' });\n      }\n      \n      if (room.ownerId !== inviterId) {\n        return res.status(403).json({ error: 'Only room owner can send invitations' });\n      }\n      \n      // Check if invited user is not the inviter\n      if (inviterId === invitedId) {\n        return res.status(400).json({ error: 'Cannot invite yourself' });\n      }\n      \n      // Check if user is already in the room\n      const participants = await storage.getRoomParticipants(roomId);\n      const isAlreadyInRoom = participants.some(p => p.userId === invitedId);\n      if (isAlreadyInRoom) {\n        return res.status(400).json({ error: 'User is already in the room' });\n      }\n      \n      // Send invitation\n      const invitation = await storage.sendRoomInvitation(roomId, inviterId, invitedId);\n      \n      // Send WebSocket notification to invited user\n      const inviterInfo = await storage.getUser(inviterId);\n      const targetConnections = Array.from(connections.entries())\n        .filter(([_, connection]) => connection.userId === invitedId);\n      \n      if (targetConnections.length > 0) {\n        const notification = {\n          type: 'room_invitation',\n          invitation: {\n            id: invitation.id,\n            roomId: room.id,\n            roomName: room.name,\n            roomCode: room.code,\n            inviterId: inviterId,\n            inviterName: inviterInfo?.displayName || inviterInfo?.username || 'Unknown',\n            timestamp: new Date().toISOString()\n          }\n        };\n        \n        targetConnections.forEach(([_, connection]) => {\n          if (connection.ws.readyState === WebSocket.OPEN) {\n            connection.ws.send(JSON.stringify(notification));\n          }\n        });\n      }\n      \n      res.json({ success: true, invitation });\n    } catch (error) {\n      console.error(\"Error sending room invitation:\", error);\n      res.status(500).json({ error: error.message || \"Failed to send room invitation\" });\n    }\n  });\n\n  // Get room invitations\n  app.get('/api/room-invitations', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      \n      // Clean up expired invitations first\n      await storage.expireOldInvitations();\n      \n      const invitations = await storage.getRoomInvitations(userId);\n      res.json(invitations);\n    } catch (error) {\n      console.error(\"Error getting room invitations:\", error);\n      res.status(500).json({ message: \"Failed to get room invitations\" });\n    }\n  });\n\n  // Respond to room invitation\n  app.post('/api/room-invitations/:invitationId/respond', requireAuth, async (req: any, res) => {\n    try {\n      const { invitationId } = req.params;\n      const { response } = req.body; // 'accepted' or 'rejected'\n      const userId = req.session.user.userId;\n      \n      if (!response || !['accepted', 'rejected'].includes(response)) {\n        return res.status(400).json({ error: 'Response must be \"accepted\" or \"rejected\"' });\n      }\n      \n      // Get invitation details first\n      const invitations = await storage.getRoomInvitations(userId);\n      const invitation = invitations.find(inv => inv.id === invitationId);\n      \n      if (!invitation) {\n        return res.status(404).json({ error: 'Invitation not found or expired' });\n      }\n      \n      if (invitation.invitedId !== userId) {\n        return res.status(403).json({ error: 'Not authorized to respond to this invitation' });\n      }\n      \n      // Respond to invitation\n      await storage.respondToRoomInvitation(invitationId, response);\n      \n      if (response === 'accepted') {\n        // Add user to room as participant\n        await storage.addRoomParticipant({\n          roomId: invitation.roomId,\n          userId: userId,\n          role: 'player',\n        });\n        \n        // Send WebSocket notification to room about new participant\n        const userInfo = await storage.getUser(userId);\n        const roomConnections_invite = roomConnections.get(invitation.roomId);\n        if (roomConnections_invite) {\n          roomConnections_invite.forEach(connectionId => {\n            const connection = connections.get(connectionId);\n            if (connection && connection.ws.readyState === WebSocket.OPEN) {\n              connection.ws.send(JSON.stringify({\n                type: 'user_joined_room',\n                userId: userId,\n                userInfo: {\n                  displayName: userInfo?.displayName || userInfo?.username,\n                  username: userInfo?.username,\n                  profileImageUrl: userInfo?.profileImageUrl\n                },\n                roomId: invitation.roomId\n              }));\n            }\n          });\n        }\n        \n        // Also send notification to ALL online users about participant list update\n        const participants = await storage.getRoomParticipants(invitation.roomId);\n        const allConnections = Array.from(connections.values());\n        allConnections.forEach(connection => {\n          if (connection.ws.readyState === WebSocket.OPEN) {\n            connection.ws.send(JSON.stringify({\n              type: 'room_participants_updated',\n              roomId: invitation.roomId,\n              participants: participants\n            }));\n          }\n        });\n        \n        res.json({ success: true, message: 'Invitation accepted', room: invitation.room });\n      } else {\n        res.json({ success: true, message: 'Invitation rejected' });\n      }\n    } catch (error) {\n      console.error(\"Error responding to room invitation:\", error);\n      res.status(500).json({ error: error.message || \"Failed to respond to room invitation\" });\n    }\n  });\n\n  // Search users by name\n  app.post('/api/users/search', requireAuth, async (req: any, res) => {\n    try {\n      const { name } = req.body;\n      \n      if (!name) {\n        return res.status(400).json({ error: 'Name is required' });\n      }\n\n      // Validate name format and length\n      if (typeof name !== 'string' || name.trim().length === 0) {\n        return res.status(400).json({ error: 'Name must be a non-empty string' });\n      }\n\n      if (name.length > 50) {\n        return res.status(400).json({ error: 'Name is too long (max 50 characters)' });\n      }\n\n      // Sanitize the name to prevent any issues\n      const sanitizedName = name.trim();\n      \n      // Search for user by name\n      const users = await storage.getUsersByName(sanitizedName);\n      \n      if (!users || users.length === 0) {\n        return res.status(404).json({ error: 'No users found' });\n      }\n      \n      res.json({ users });\n    } catch (error) {\n      console.error(\"Error searching users:\", error);\n      res.status(500).json({ error: `Failed to search users: ${error.message}` });\n    }\n  });\n\n  // Email diagnostic endpoints\n  app.post('/api/email/test', requireAuth, async (req: any, res) => {\n    try {\n      const { emailService } = await import('./emailService');\n      const service = emailService.createEmailService();\n      \n      if (!service) {\n        return res.status(500).json({ \n          error: 'Email service not configured',\n          recommendation: 'Please check SMTP configuration in server/config/email.json'\n        });\n      }\n\n      const testEmail = req.session.user.email;\n      console.log(`üî¨ Sending diagnostic test email to: ${testEmail}`);\n      \n      const success = await service.sendTestEmail(testEmail);\n      \n      if (success) {\n        res.json({ \n          success: true, \n          message: 'Test email sent successfully! Check your inbox (including spam folder).',\n          recommendations: [\n            'Check your inbox and spam folder',\n            'Add admin@darkester.online to your contacts to improve deliverability',\n            'If not received, try using a different email provider (Gmail, Yahoo, etc.)'\n          ]\n        });\n      } else {\n        res.status(500).json({ \n          error: 'Failed to send test email',\n          recommendation: 'Check server logs for detailed error information'\n        });\n      }\n    } catch (error) {\n      console.error('‚ùå Email test error:', error);\n      res.status(500).json({ \n        error: 'Email test failed',\n        details: error.message,\n        recommendation: 'Check SMTP configuration and network connectivity'\n      });\n    }\n  });\n\n  app.get('/api/email/config-status', requireAuth, async (req: any, res) => {\n    try {\n      const { emailService } = await import('./emailService');\n      const config = emailService.loadEmailConfig();\n      \n      const status = {\n        configured: !!(config.host && config.port && config.user && config.pass && config.fromEmail),\n        smtp: {\n          host: config.host || 'Not configured',\n          port: config.port || 'Not configured',\n          user: config.user || 'Not configured',\n          fromEmail: config.fromEmail || 'Not configured',\n          hasPassword: !!config.pass\n        },\n        recommendations: []\n      };\n\n      if (!status.configured) {\n        status.recommendations.push(\n          'Email service is not fully configured',\n          'Check server/config/email.json file exists and has all required fields',\n          'Required fields: host, port, user, pass, fromEmail'\n        );\n      } else {\n        status.recommendations.push(\n          'Email service appears to be configured correctly',\n          'Use the test email endpoint to verify connectivity'\n        );\n      }\n\n      res.json(status);\n    } catch (error) {\n      console.error('‚ùå Email config check error:', error);\n      res.status(500).json({ \n        error: 'Failed to check email configuration',\n        details: error.message\n      });\n    }\n  });\n\n  // Clean up duplicate bots and sync all AI bots with deterministic stats  \n  app.post('/api/sync-bots', async (req, res) => {\n    try {\n      console.log('ü§ñ Starting bot cleanup and sync...');\n      \n      // First, remove all existing bot entries to clean up duplicates\n      console.log('üßπ Cleaning up existing bot entries...');\n      const botIds = AI_BOTS.map(bot => bot.id);\n      for (const botId of botIds) {\n        try {\n          await storage.deleteUser(botId);\n          console.log(`üóëÔ∏è Removed existing bot: ${botId}`);\n        } catch (error) {\n          // Bot might not exist, which is fine\n          console.log(`‚ÑπÔ∏è Bot ${botId} not found for cleanup (expected)`);\n        }\n      }\n      \n      // Now create fresh bots with ZERO stats (authentic data only)\n      console.log('ü§ñ Creating fresh bot entries with zero stats...');\n      let syncedCount = 0;\n      \n      for (let i = 0; i < AI_BOTS.length; i++) {\n        const bot = AI_BOTS[i];\n        \n        // Bots start with zero stats - only real gameplay will increment them\n        await storage.upsertUser({\n          id: bot.id,\n          username: bot.username,\n          displayName: bot.displayName,\n          firstName: bot.firstName,\n          lastName: bot.lastName || 'Player',\n          email: `${bot.username}@bot.local`,\n          profileImageUrl: bot.profilePicture,\n          wins: 0,\n          losses: 0,\n          draws: 0\n        });\n        syncedCount++;\n        console.log(`ü§ñ Created bot: ${bot.displayName} with authentic zero stats`);\n      }\n      \n      console.log(`ü§ñ Successfully synced ${syncedCount} clean bot entries to database`);\n      res.json({ \n        success: true, \n        message: `Successfully cleaned and synced ${syncedCount} AI bots to database`,\n        syncedCount \n      });\n    } catch (error) {\n      console.error('‚ùå Error syncing bots:', error);\n      res.status(500).json({ error: 'Failed to sync bots to database' });\n    }\n  });\n\n  // Reset all bot statistics to authentic data only\n  app.post('/api/reset-bot-stats', async (req, res) => {\n    try {\n      console.log('üßπ Starting bot statistics reset...');\n      await storage.resetAllBotStats();\n      res.json({ \n        success: true, \n        message: 'Successfully reset bot statistics to authentic data only'\n      });\n    } catch (error) {\n      console.error('‚ùå Error resetting bot stats:', error);\n      res.status(500).json({ error: 'Failed to reset bot statistics' });\n    }\n  });\n\n  // Recalculate user stats\n  app.post('/api/users/recalculate-stats', requireAuth, async (req: any, res) => {\n    try {\n      const { userId } = req.body;\n      \n      if (userId) {\n        // Recalculate for specific user\n        await storage.recalculateUserStats(userId);\n        res.json({ success: true, message: 'User stats recalculated successfully' });\n      } else {\n        // Recalculate for all users\n        await storage.recalculateAllUserStats();\n        res.json({ success: true, message: 'All user stats recalculated successfully' });\n      }\n    } catch (error) {\n      console.error(\"Error recalculating user stats:\", error);\n      res.status(500).json({ error: `Failed to recalculate user stats: ${error.message}` });\n    }\n  });\n\n  // Send chat message\n  app.post('/api/chat/send', requireAuth, async (req: any, res) => {\n    try {\n      const { targetUserId, message } = req.body;\n      const senderId = req.session.user.userId;\n\n      // Check if sender is blocked by target user\n      const isBlocked = await storage.isUserBlocked(targetUserId, senderId);\n      if (isBlocked) {\n        return res.status(403).json({ error: 'You are blocked by this user' });\n      }\n\n      // Check if target user is blocked by sender\n      const hasBlocked = await storage.isUserBlocked(senderId, targetUserId);\n      if (hasBlocked) {\n        return res.status(403).json({ error: 'You have blocked this user' });\n      }\n      \n      // Get sender info (from onlineUsers or fetch from database)\n      let senderInfo = onlineUsers.get(senderId);\n      if (!senderInfo) {\n        // If not in onlineUsers, get from database for in-game users\n        const senderData = await storage.getUser(senderId);\n        if (!senderData) {\n          return res.status(400).json({ error: 'Sender not found' });\n        }\n        senderInfo = {\n          userId: senderId,\n          username: senderData.username || senderData.id,\n          displayName: senderData.displayName || senderData.firstName || senderData.username,\n          roomId: undefined,\n          lastSeen: new Date()\n        };\n        console.log(`üì® Using database info for in-game sender: ${senderId}`);\n      }\n\n      // Find ALL connections for target user (they might have multiple connections)\n      const targetConnections = Array.from(connections.values()).filter(conn => conn.userId === targetUserId);\n      if (targetConnections.length === 0) {\n        return res.status(400).json({ error: 'Target user connection not found' });\n      }\n\n      // Send to only the most recent active connection for the target user to avoid duplicates\n      let messageSent = false;\n      // Found connections for target user\n      \n      // Find the most recent active connection\n      const activeConnections = targetConnections.filter(conn => \n        conn.ws && conn.ws.readyState === WebSocket.OPEN\n      );\n      \n      if (activeConnections.length > 0) {\n        // Sort by last seen (most recent first) and take the first one\n        activeConnections.sort((a, b) => b.lastSeen.getTime() - a.lastSeen.getTime());\n        const targetConnection = activeConnections[0];\n        \n        // Sending to most recent connection\n        const chatMessage = {\n          type: 'chat_message_received',\n          message: {\n            senderId,\n            senderName: senderInfo.displayName || senderInfo.username,\n            message,\n            senderDisplayName: senderInfo.displayName,\n            senderUsername: senderInfo.username,\n            timestamp: new Date().toISOString()\n          }\n        };\n        // Sending WebSocket message\n        targetConnection.ws.send(JSON.stringify(chatMessage));\n        // Message sent successfully\n        messageSent = true;\n      } else {\n        // No active connections found\n      }\n\n      if (!messageSent) {\n        return res.status(400).json({ error: 'Target user connection is not active' });\n      }\n\n      // Chat message sent successfully\n\n      res.json({ success: true, message: 'Message sent successfully' });\n    } catch (error) {\n      console.error(\"Error sending chat message:\", error);\n      res.status(500).json({ message: \"Failed to send chat message\" });\n    }\n  });\n\n  // Online matchmaking endpoint\n  app.post('/api/matchmaking/join', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      \n      // Check if user has enough coins for online play (100 coins required)\n      try {\n        const userCoins = await storage.getUserCoins(userId);\n        if (userCoins < 100) {\n          return res.status(403).json({ \n            error: 'Insufficient coins',\n            message: `You need 100 coins to play online. You have ${userCoins} coins. Win AI games to earn coins!`,\n            requiredCoins: 100,\n            currentCoins: userCoins\n          });\n        }\n      } catch (error) {\n        console.error('Error checking user coins:', error);\n        // Allow matchmaking even if coin check fails to avoid blocking players\n      }\n      \n      // Check if user is already in queue (duplicate prevention)\n      if (matchmakingQueue.includes(userId)) {\n        return res.json({ \n          status: 'waiting', \n          message: 'Already in matchmaking queue',\n          queuePosition: matchmakingQueue.indexOf(userId) + 1,\n          queueLength: matchmakingQueue.length\n        });\n      }\n      \n      // CRITICAL FIX: Ensure user has a valid WebSocket connection before allowing matchmaking\n      const userConnections = Array.from(connections.entries())\n        .filter(([_, connection]) => connection.userId === userId && connection.ws.readyState === WebSocket.OPEN);\n      \n      if (userConnections.length === 0) {\n        //console.log(`üö´ User ${userId} attempted matchmaking without valid WebSocket connection`);\n        return res.status(400).json({ \n          error: 'No active connection found', \n          message: 'We are preparing your room please wait' \n        });\n      }\n      \n      // CRITICAL FIX: Check if user is already in an active game - prevent forced removal!\n      try {\n        const activeGame = await storage.getActiveGameForUser(userId);\n        if (activeGame && activeGame.status === 'active') {\n          //console.log(`üö´ User ${userId} attempted matchmaking while in active game ${activeGame.id}`);\n          return res.status(400).json({ \n            error: 'Already in game', \n            message: 'You are already in an active game. Please finish your current game before starting matchmaking.',\n            gameId: activeGame.id,\n            roomId: activeGame.roomId\n          });\n        }\n      } catch (error) {\n        console.error('Error checking active game for user:', error);\n        // Continue with matchmaking if check fails\n      }\n      \n      // Check if user is in an active room with other players\n      const userRoomState = userRoomStates.get(userId);\n      if (userRoomState && userRoomState.isInGame) {\n        //console.log(`üö´ User ${userId} attempted matchmaking while in active room ${userRoomState.roomId}`);\n        return res.status(400).json({ \n          error: 'Already in room', \n          message: 'You are already in an active room. Please leave your current room before starting matchmaking.',\n          roomId: userRoomState.roomId\n        });\n      }\n      \n      // Only clean up stale states if user is NOT in an active game\n      // Clear any existing timer for this user\n      if (matchmakingTimers.has(userId)) {\n        clearTimeout(matchmakingTimers.get(userId)!);\n        matchmakingTimers.delete(userId);\n      }\n      \n      // SAFE cleanup: Only remove from rooms if user explicitly wants to leave for matchmaking\n      // This prevents forcibly removing users from active games\n      //console.log(`‚úÖ User ${userId} starting matchmaking - safely cleared only their stale states`);\n      userRoomStates.delete(userId);\n      \n      // Add to queue\n      matchmakingQueue.push(userId);\n      // User joined matchmaking queue\n      \n      // Set 25-second timer for AI bot matchmaking\n      const botTimer = setTimeout(async () => {\n        try {\n          // Double-check if user is still in queue and hasn't been matched with real player\n          const currentQueueIndex = matchmakingQueue.indexOf(userId);\n          if (currentQueueIndex === -1) {\n            //console.log(`ü§ñ User ${userId} no longer in queue - likely matched with real player. Skipping bot match.`);\n            matchmakingTimers.delete(userId);\n            return;\n          }\n          \n          // Matching user with AI bot after timeout\n          \n          // Remove user from queue and clear timer\n          matchmakingQueue.splice(currentQueueIndex, 1);\n          matchmakingTimers.delete(userId);\n          \n          // Get a random bot\n          const bot = getRandomAvailableBot();\n          // Bot selected for matchmaking\n          \n          // Create room for user vs bot\n          const room = await storage.createRoom({\n            name: `${bot.displayName} Match`,\n            isPrivate: false,\n            maxPlayers: 2,\n            ownerId: userId,\n          });\n          \n          // Add user as participant\n          await storage.addRoomParticipant({\n            roomId: room.id,\n            userId: userId,\n            role: 'player',\n          });\n          \n          // Check if bot already exists to avoid overwriting stats\n          const existingBot = await storage.getUser(bot.id);\n          \n          if (!existingBot) {\n            // Use deterministic stats for consistency\n            const botIndex = AI_BOTS.findIndex(b => b.id === bot.id);\n            const seed = botIndex + 1;\n            const wins = Math.floor((seed * 7) % 45) + 5;\n            const losses = Math.floor((seed * 5) % 25) + 5;\n            const draws = Math.floor((seed * 3) % 8) + 2;\n            \n            await storage.upsertUser({\n              id: bot.id,\n              username: bot.username,\n              displayName: bot.displayName,\n              firstName: bot.firstName,\n              lastName: bot.lastName || 'Player',\n              email: `${bot.username}@bot.local`,\n              profileImageUrl: bot.profilePicture,\n              wins,\n              losses,\n              draws\n            });\n          }\n\n          // Add bot as second participant to show 2 players in room\n          await storage.addRoomParticipant({\n            roomId: room.id,\n            userId: bot.id,\n            role: 'player',\n          });\n          \n          // Notify user about bot match\n          const userConnections = Array.from(connections.entries())\n            .filter(([_, connection]) => connection.userId === userId && connection.ws.readyState === WebSocket.OPEN);\n          \n          if (userConnections.length > 0) {\n            const [connId, connection] = userConnections[0];\n              \n              // Add to room connections\n              if (!roomConnections.has(room.id)) {\n                roomConnections.set(room.id, new Set());\n              }\n              roomConnections.get(room.id)!.add(connId);\n              connection.roomId = room.id;\n              \n              userRoomStates.set(userId, {\n                roomId: room.id,\n                isInGame: false,\n                role: 'player'\n              });\n              \n              // Send single matchmaking success message for bot match (SIMPLIFIED)\n              //console.log(`üéØ Sending matchmaking_success (bot) to user ${userId}`);\n              connection.ws.send(JSON.stringify({\n                type: 'matchmaking_success',\n                room: {\n                  ...room,\n                  status: 'waiting'\n                },\n                message: `Matched with ${bot.displayName}!`,\n                status: 'matched',\n                playerInfo: bot\n              }));\n              \n              // User matched with bot\n              \n              // Clear matchmaking timer since user is now matched\n              if (matchmakingTimers.has(userId)) {\n                clearTimeout(matchmakingTimers.get(userId)!);\n                matchmakingTimers.delete(userId);\n                //console.log(`‚è∞ Cleared matchmaking timer for user ${userId}`);\n              }\n              \n              // Auto-start game with bot after 2 seconds\n              setTimeout(async () => {\n                try {\n                  const game = await storage.createGame({\n                    roomId: room.id,\n                    playerXId: userId,\n                    playerOId: bot.id,\n                    gameMode: 'online',\n                    currentPlayer: 'X',\n                    board: {},\n                    status: 'active',\n                  });\n                  \n                  // Get user info\n                  const userInfo = await storage.getUser(userId);\n                  const userAchievements = await storage.getUserAchievements(userId);\n                  \n                  const gameWithPlayers = {\n                    ...game,\n                    playerXInfo: userInfo ? {\n                      ...userInfo,\n                      achievements: userAchievements.slice(0, 3)\n                    } : null,\n                    playerOInfo: {\n                      ...bot,\n                      achievements: [] // Bots don't have achievements\n                    }\n                  };\n                  \n                  // Update room status to playing\n                  await storage.updateRoomStatus(room.id, 'playing');\n                  \n                  // Broadcast game start to all room participants (should only be the user)\n                  const roomConnections_botGame = roomConnections.get(room.id);\n                  if (roomConnections_botGame) {\n                    // Broadcasting bot game start\n                    roomConnections_botGame.forEach(connectionId => {\n                      const conn = connections.get(connectionId);\n                      if (conn && conn.ws.readyState === WebSocket.OPEN) {\n                        // Sending game_started message\n                        conn.ws.send(JSON.stringify({\n                          type: 'game_started',\n                          game: gameWithPlayers,\n                          roomId: room.id,\n                          room: {\n                            ...room,\n                            status: 'playing'\n                          }\n                        }));\n                      }\n                    });\n                    // Bot game started and broadcasted\n                  } else {\n                    //console.log(`üéÆ Warning: No room connections found for room ${room.id}`);\n                  }\n                } catch (error) {\n                  console.error('ü§ñ Error starting bot game:', error);\n                }\n              }, 2000);\n          }\n          \n          // Clean up timer\n          matchmakingTimers.delete(userId);\n        } catch (error) {\n          console.error('ü§ñ Error in bot matchmaking:', error);\n          matchmakingTimers.delete(userId);\n        }\n      }, 25000); // 25 seconds\n      \n      // Store timer for cleanup\n      matchmakingTimers.set(userId, botTimer);\n      \n      // Check if we can make a match (need 2 players) - WITH RACE CONDITION PROTECTION\n      if (!isMatchmakingLocked && matchmakingQueue.length >= 2) {\n        // Lock matchmaking to prevent race conditions\n        isMatchmakingLocked = true;\n        \n        // Double-check queue length after acquiring lock\n        if (matchmakingQueue.length < 2) {\n          isMatchmakingLocked = false;\n          return res.json({ \n            status: 'waiting', \n            message: 'Searching for opponent...',\n            queuePosition: matchmakingQueue.indexOf(userId) + 1,\n            queueLength: matchmakingQueue.length\n          });\n        }\n        \n        // Get first two players safely\n        const player1Id = matchmakingQueue[0];\n        const player2Id = matchmakingQueue[1];\n        \n        // Ensure we don't pair the same user twice\n        if (player1Id === player2Id) {\n          isMatchmakingLocked = false;\n          console.error('üö´ Race condition detected: Same user in queue twice');\n          return res.status(500).json({ error: 'Queue error, please try again' });\n        }\n        \n        // Clear timers for both players since they matched with real players\n        if (matchmakingTimers.has(player1Id)) {\n          clearTimeout(matchmakingTimers.get(player1Id)!);\n          matchmakingTimers.delete(player1Id);\n        }\n        if (matchmakingTimers.has(player2Id)) {\n          clearTimeout(matchmakingTimers.get(player2Id)!);\n          matchmakingTimers.delete(player2Id);\n        }\n        // Remove both players from queue atomically\n        matchmakingQueue.splice(0, 2);\n        \n        //console.log(`üéØ Match found! Pairing ${player1Id} vs ${player2Id}`);\n        \n        // Create room for matched players\n        const room = await storage.createRoom({\n          name: `Match ${Date.now()}`,\n          isPrivate: false,\n          maxPlayers: 2,\n          ownerId: player1Id,\n        });\n        \n        // Add both players as participants\n        await storage.addRoomParticipant({\n          roomId: room.id,\n          userId: player1Id,\n          role: 'player',\n        });\n        \n        await storage.addRoomParticipant({\n          roomId: room.id,\n          userId: player2Id,\n          role: 'player',\n        });\n        \n        // Notify both players via WebSocket and ensure they join the room\n        const notifyAndJoinPlayer = async (playerId: string) => {\n          // Find the most recent connection for this user\n          const userConnections = Array.from(connections.entries())\n            .filter(([_, connection]) => connection.userId === playerId && connection.ws.readyState === WebSocket.OPEN)\n            .sort(([a], [b]) => b.localeCompare(a)); // Sort by connection ID descending (most recent first)\n          \n          if (userConnections.length > 0) {\n            const [connId, connection] = userConnections[0]; // Use the most recent connection\n            \n            // CRITICAL FIX: Remove user from any existing room connections to prevent cross-room message leakage\n            for (const [roomId, roomUsers] of roomConnections.entries()) {\n              if (roomId !== room.id && roomUsers.has(connId)) {\n                roomUsers.delete(connId);\n                console.log(`üßπ Removed player ${playerId} from old room ${roomId} before adding to new match room ${room.id}`);\n                \n                // Clean up empty rooms\n                if (roomUsers.size === 0) {\n                  roomConnections.delete(roomId);\n                  console.log(`üßπ Deleted empty room ${roomId}`);\n                }\n              }\n            }\n            \n            // Add to room connections immediately\n            if (!roomConnections.has(room.id)) {\n              roomConnections.set(room.id, new Set());\n            }\n            roomConnections.get(room.id)!.add(connId);\n            \n            // Update connection room info\n            connection.roomId = room.id;\n            \n            // Update user room state\n            userRoomStates.set(playerId, {\n              roomId: room.id,\n              isInGame: false,\n              role: 'player'\n            });\n            \n            // Send single matchmaking success message (SIMPLIFIED - no redundancy)\n            //console.log(`üéØ Sending matchmaking_success to user ${playerId} in room ${room.id}`);\n            connection.ws.send(JSON.stringify({\n              type: 'matchmaking_success',\n              room: {\n                ...room,\n                status: 'waiting'\n              },\n              message: 'Match found! Joining room...',\n              status: 'matched'\n            }));\n            \n            //console.log(`üéØ Player ${playerId} automatically joined room ${room.id} via connection ${connId}`);\n          } else {\n            //console.log(`üéØ Warning: No active connection found for player ${playerId}`);\n          }\n        };\n        \n        await notifyAndJoinPlayer(player1Id);\n        await notifyAndJoinPlayer(player2Id);\n        \n        //console.log(`üéØ Match notifications sent and both players joined room ${room.id}`);\n        \n        // Notify BOTH players about the successful match via WebSocket before responding to the API call\n        // This ensures the first player (who was waiting) also gets immediate notification\n        const matchNotification = {\n          type: 'matchmaking_success',\n          status: 'matched',\n          room: room,\n          message: 'Match found! Preparing game...'\n        };\n        \n        // Track and send notification to both players (prevent duplicate notifications)\n        if (!sentMatchNotifications.has(room.id)) {\n          sentMatchNotifications.set(room.id, new Set());\n        }\n        const roomNotifications = sentMatchNotifications.get(room.id)!;\n        \n        [player1Id, player2Id].forEach(playerId => {\n          // Check if we already sent a notification to this user for this room\n          if (roomNotifications.has(playerId)) {\n            //console.log(`üéØ Skipping duplicate matchmaking_success for user ${playerId} in room ${room.id}`);\n            return;\n          }\n          \n          const userConnections = Array.from(connections.entries())\n            .filter(([_, connection]) => connection.userId === playerId && connection.ws.readyState === WebSocket.OPEN);\n          \n          // Send only to the first active connection to prevent duplicates\n          if (userConnections.length > 0) {\n            const [_, primaryConnection] = userConnections[0];\n            //console.log(`üéØ Sending matchmaking_success to user ${playerId} (${userConnections.length} connections available)`);\n            primaryConnection.ws.send(JSON.stringify(matchNotification));\n            \n            // Mark this user as notified for this room\n            roomNotifications.add(playerId);\n          }\n        });\n        \n        // Auto-start the game with improved connection handling and retries\n        const attemptAutoStart = async (attemptNumber: number = 1) => {\n          try {\n            //console.log(`üéØ Auto-starting game attempt ${attemptNumber} for matched players in room ${room.id} (players: ${player1Id}, ${player2Id})`);\n            \n            // Check if both players are still connected to the room before starting\n            const roomUsers = roomConnections.get(room.id);\n            //console.log(`üéØ Room ${room.id} has ${roomUsers?.size || 0} connections, need 2 for auto-start`);\n            \n            if (!roomUsers || roomUsers.size < 2) {\n              //console.log(`üéØ Warning: Not enough players in room ${room.id} for auto-start. Room has ${roomUsers?.size || 0} connections`);\n              \n              // For first attempt, wait a bit longer for connections to establish\n              if (attemptNumber === 1) {\n                //console.log(`üéØ First attempt failed, giving connections more time to establish...`);\n                setTimeout(() => attemptAutoStart(attemptNumber + 1), 2000);\n                return;\n              }\n              \n              // Retry with shorter delays for subsequent attempts\n              if (attemptNumber < 4) {\n                const retryDelay = 1500; // Fixed 1.5s delay\n                //console.log(`üéØ Retrying auto-start in ${retryDelay}ms...`);\n                setTimeout(() => attemptAutoStart(attemptNumber + 1), retryDelay);\n              } else {\n                //console.log(`üéØ Auto-start failed after 4 attempts for room ${room.id}`);\n                // Notify players that manual start may be required\n                roomUsers?.forEach(connectionId => {\n                  const connection = connections.get(connectionId);\n                  if (connection && connection.ws.readyState === WebSocket.OPEN) {\n                    connection.ws.send(JSON.stringify({\n                      type: 'auto_start_failed',\n                      roomId: room.id,\n                      message: 'Connection issues detected. Please manually start the game when ready.'\n                    }));\n                  }\n                });\n              }\n              return;\n            }\n            \n            // Verify both players are actually connected\n            const connectedPlayers = Array.from(roomUsers)\n              .map(connId => connections.get(connId))\n              .filter(conn => conn && conn.ws.readyState === WebSocket.OPEN)\n              .map(conn => conn!.userId);\n            \n            //console.log(`üéØ Connected players in room ${room.id}: [${connectedPlayers.join(', ')}], need: [${player1Id}, ${player2Id}]`);\n            \n            if (!connectedPlayers.includes(player1Id) || !connectedPlayers.includes(player2Id)) {\n              //console.log(`üéØ Warning: One or both players disconnected from room ${room.id}. Connected players: ${connectedPlayers.join(', ')}`);\n              \n              // Retry for disconnected players with shorter delays\n              if (attemptNumber < 4) {\n                const retryDelay = 1500;\n                //console.log(`üéØ Retrying auto-start in ${retryDelay}ms due to player disconnection...`);\n                setTimeout(() => attemptAutoStart(attemptNumber + 1), retryDelay);\n              } else {\n                //console.log(`üéØ Auto-start abandoned after 4 attempts - players not properly connected`);\n              }\n              return;\n            }\n            \n            //console.log(`üéØ Both players confirmed connected, proceeding with game creation...`);\n            \n            // Create the game automatically\n            const game = await storage.createGame({\n              roomId: room.id,\n              playerXId: player1Id,\n              playerOId: player2Id,\n              gameMode: 'online',\n              currentPlayer: 'X',\n              board: {},\n              status: 'active',\n            });\n            \n            // Get player information with achievements\n            const [playerXInfo, playerOInfo] = await Promise.all([\n              storage.getUser(player1Id),\n              storage.getUser(player2Id)\n            ]);\n            \n            // Get achievements for both players\n            const [playerXAchievements, playerOAchievements] = await Promise.all([\n              storage.getUserAchievements(player1Id),\n              storage.getUserAchievements(player2Id)\n            ]);\n            \n            const gameWithPlayers = {\n              ...game,\n              playerXInfo: playerXInfo ? {\n                ...playerXInfo,\n                achievements: playerXAchievements.slice(0, 3)\n              } : null,\n              playerOInfo: playerOInfo ? {\n                ...playerOInfo,\n                achievements: playerOAchievements.slice(0, 3)\n              } : null,\n              gameMode: 'online'\n            };\n            \n            // Update room status to playing\n            await storage.updateRoomStatus(room.id, 'playing');\n            \n            // Broadcast game start to all room participants\n            const roomConnections_broadcast = roomConnections.get(room.id);\n            if (roomConnections_broadcast) {\n              roomConnections_broadcast.forEach(connectionId => {\n                const connection = connections.get(connectionId);\n                if (connection && connection.ws.readyState === WebSocket.OPEN) {\n                  connection.ws.send(JSON.stringify({\n                    type: 'game_started',\n                    game: gameWithPlayers,\n                    roomId: room.id,\n                    room: {\n                      ...room,\n                      status: 'playing'\n                    }\n                  }));\n                }\n              });\n            }\n            \n            //console.log(`üéØ Auto-started game ${game.id} for matchmaking room ${room.id}`);\n          } catch (error) {\n            console.error('Error auto-starting matchmaking game:', error);\n            // Retry on error if not max attempts\n            if (attemptNumber < 4) {\n              const retryDelay = 1500;\n              //console.log(`üéØ Retrying auto-start in ${retryDelay}ms due to error...`);\n              setTimeout(() => attemptAutoStart(attemptNumber + 1), retryDelay);\n            } else {\n              //console.log(`üéØ Auto-start completely failed after 4 attempts for room ${room.id}`);\n            }\n          }\n        };\n        \n        // Start the first attempt with a shorter 1-second delay to improve responsiveness\n        setTimeout(() => attemptAutoStart(), 1000);\n        \n        // Release matchmaking lock\n        isMatchmakingLocked = false;\n        \n        // Return matched status to the player who just joined (this is the API response)\n        res.json({ status: 'matched', room: room });\n      } else {\n        res.json({ \n          status: 'waiting', \n          message: 'Waiting for another player...',\n          queuePosition: matchmakingQueue.indexOf(userId) + 1,\n          queueLength: matchmakingQueue.length\n        });\n      }\n    } catch (error) {\n      // Always release lock on error to prevent deadlocks\n      isMatchmakingLocked = false;\n      console.error(\"Error in matchmaking:\", error);\n      res.status(500).json({ message: \"Failed to join matchmaking\" });\n    }\n  });\n  \n  // Leave matchmaking queue\n  app.post('/api/matchmaking/leave', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      \n      // Clear timer if user leaves manually\n      if (matchmakingTimers.has(userId)) {\n        clearTimeout(matchmakingTimers.get(userId)!);\n        matchmakingTimers.delete(userId);\n        //console.log(`ü§ñ Cleared bot timer for user ${userId}`);\n      }\n      \n      const index = matchmakingQueue.indexOf(userId);\n      if (index > -1) {\n        matchmakingQueue.splice(index, 1);\n        //console.log(`üéØ User ${userId} left matchmaking queue. Queue size: ${matchmakingQueue.length}`);\n      }\n      res.json({ message: 'Left matchmaking queue' });\n    } catch (error) {\n      console.error(\"Error leaving matchmaking:\", error);\n      res.status(500).json({ message: \"Failed to leave matchmaking\" });\n    }\n  });\n\n  // Room routes\n  app.post('/api/rooms', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      const roomData = insertRoomSchema.parse(req.body);\n      \n      // Check if user has enough coins for online play (100 coins required)\n      try {\n        const userCoins = await storage.getUserCoins(userId);\n        if (userCoins < 100) {\n          return res.status(403).json({ \n            error: 'Insufficient coins',\n            message: `You need 100 coins to create a room. You have ${userCoins} coins. Win AI games to earn coins!`,\n            requiredCoins: 100,\n            currentCoins: userCoins\n          });\n        }\n      } catch (error) {\n        console.error('Error checking user coins for room creation:', error);\n        // Allow room creation even if coin check fails to avoid blocking players\n      }\n      \n      const room = await storage.createRoom({\n        ...roomData,\n        ownerId: userId,\n      });\n\n      // Add owner as participant\n      await storage.addRoomParticipant({\n        roomId: room.id,\n        userId,\n        role: 'player',\n      });\n\n      res.json(room);\n    } catch (error) {\n      //console.error(\"Error creating room:\", error);\n      res.status(500).json({ message: \"Failed to create room\" });\n    }\n  });\n\n  app.post('/api/rooms/:code/join', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      const { code } = req.params;\n      const { role = 'player' } = req.body;\n\n      // Validate room code format\n      if (!code || typeof code !== 'string' || !/^[A-Za-z0-9]{6,10}$/.test(code)) {\n        return res.status(400).json({ message: \"Invalid room code format\" });\n      }\n\n      // Validate role\n      if (!['player', 'spectator'].includes(role)) {\n        return res.status(400).json({ message: \"Invalid role. Must be 'player' or 'spectator'\" });\n      }\n\n      // Check if user has enough coins for online play as a player (100 coins required)\n      if (role === 'player') {\n        try {\n          const userCoins = await storage.getUserCoins(userId);\n          if (userCoins < 100) {\n            return res.status(403).json({ \n              error: 'Insufficient coins',\n              message: `You need 100 coins to join as a player. You have ${userCoins} coins. Win AI games to earn coins! You can still join as a spectator.`,\n              requiredCoins: 100,\n              currentCoins: userCoins\n            });\n          }\n        } catch (error) {\n          console.error('Error checking user coins for room joining:', error);\n          // Allow room joining even if coin check fails to avoid blocking players\n        }\n      }\n\n      const room = await storage.getRoomByCode(code);\n      if (!room) {\n        return res.status(404).json({ message: \"Room not found\" });\n      }\n\n      // Get room status information for better UX\n      const [latestGame] = await db\n        .select()\n        .from(games)\n        .where(eq(games.roomId, room.id))\n        .orderBy(desc(games.createdAt))\n        .limit(1);\n      \n      const participants = await storage.getRoomParticipants(room.id);\n      \n      // Check if user is already in the room\n      const existingParticipant = participants.find(p => p.userId === userId);\n      if (existingParticipant) {\n        return res.json({ message: \"Already in room\", room });\n      }\n\n      // Check if room is full (only for players, spectators can always join)\n      const playerCount = participants.filter(p => p.role === 'player').length;\n      if (role === 'player' && playerCount >= 2) {\n        return res.status(400).json({ message: \"Room is full\" });\n      }\n      \n      // Check spectator limit - allow up to 50 spectators per room\n      const maxSpectators = 50;\n      const spectatorCount = participants.filter(p => p.role === 'spectator').length;\n      \n      if (role === 'spectator' && spectatorCount >= maxSpectators) {\n        return res.status(400).json({ message: \"Spectator limit reached\" });\n      }\n\n      await storage.addRoomParticipant({\n        roomId: room.id,\n        userId,\n        role,\n      });\n\n      res.json({ message: \"Joined room successfully\", room });\n    } catch (error) {\n      console.error(\"Error joining room:\", error);\n      res.status(500).json({ message: \"Failed to join room\" });\n    }\n  });\n\n  app.get('/api/rooms/:id/participants', requireAuth, async (req, res) => {\n    try {\n      const { id } = req.params;\n      const participants = await storage.getRoomParticipants(id);\n      res.json(participants);\n    } catch (error) {\n      console.error(\"Error fetching participants:\", error);\n      res.status(500).json({ message: \"Failed to fetch participants\" });\n    }\n  });\n\n  // Start game in a room\n  app.post('/api/rooms/:roomId/start-game', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      const { roomId } = req.params;\n      \n      // Room start-game request\n      \n      // Get the room to verify it exists\n      const room = await storage.getRoomById(roomId);\n      if (!room) {\n        return res.status(404).json({ message: \"Room not found\" });\n      }\n      \n      // Check if room is already in \"playing\" status AND there's an active game\n      // Allow multiple players to call start-game during the brief synchronization window\n      const existingActiveGame = await storage.getActiveGameByRoomId(roomId);\n      if (room.status === 'playing' && existingActiveGame) {\n        // Game already exists and running - return the existing game instead of error\n        //console.log('üéÆ Game already running, returning existing game for synchronization');\n        \n        // Get player information for the existing game\n        const [playerXInfo, playerOInfo] = await Promise.all([\n          existingActiveGame.playerXId ? storage.getUser(existingActiveGame.playerXId) : null,\n          existingActiveGame.playerOId ? storage.getUser(existingActiveGame.playerOId) : null\n        ]);\n        \n        // Get achievements for both players\n        const [playerXAchievements, playerOAchievements] = await Promise.all([\n          playerXInfo ? storage.getUserAchievements(existingActiveGame.playerXId) : [],\n          playerOInfo ? storage.getUserAchievements(existingActiveGame.playerOId) : []\n        ]);\n        \n        const gameWithPlayers = {\n          ...existingActiveGame,\n          playerXInfo: playerXInfo ? {\n            ...playerXInfo,\n            achievements: playerXAchievements.slice(0, 3)\n          } : null,\n          playerOInfo: playerOInfo ? {\n            ...playerOInfo,\n            achievements: playerOAchievements.slice(0, 3)\n          } : null\n        };\n        \n        return res.json(gameWithPlayers);\n      }\n      \n      // Get room participants\n      const participants = await storage.getRoomParticipants(roomId);\n      \n      // Check if user is the room creator (only room creator can start games)\n      if (room.ownerId !== userId) {\n        return res.status(403).json({ message: \"Only the room creator can start games\" });\n      }\n      \n      // Check if there's already an active game in this room\n      const existingGame = await storage.getActiveGameByRoomId(roomId);\n      if (existingGame && existingGame.status === 'active') {\n        // If it's a bot game that was just created, return the existing game instead of ending it\n        const isGameAgainstBot = existingGame.playerOId && AI_BOTS.some(bot => bot.id === existingGame.playerOId);\n        if (isGameAgainstBot) {\n          //console.log('üéÆ Active bot game already exists, returning it instead of creating new one');\n          \n          // Get player information for the existing bot game\n          const [playerXInfo, botInfo] = await Promise.all([\n            storage.getUser(existingGame.playerXId),\n            Promise.resolve(AI_BOTS.find(bot => bot.id === existingGame.playerOId))\n          ]);\n          \n          // Get achievements for the human player\n          const playerXAchievements = playerXInfo ? await storage.getUserAchievements(existingGame.playerXId) : [];\n          \n          const gameWithPlayers = {\n            ...existingGame,\n            playerXInfo: playerXInfo ? {\n              ...playerXInfo,\n              achievements: playerXAchievements.slice(0, 3)\n            } : null,\n            playerOInfo: botInfo ? {\n              ...botInfo,\n              achievements: []\n            } : null\n          };\n          \n          return res.json(gameWithPlayers);\n        } else {\n          //console.log('üéÆ Active human game already exists, ending it first');\n          // End the existing human game\n          await storage.updateGameStatus(existingGame.id, 'finished');\n        }\n      }\n      \n      // Get room participants (reuse from above)\n      const players = participants.filter(p => p.role === 'player');\n      \n      if (players.length < 2) {\n        return res.status(400).json({ message: \"Need 2 players to start game\" });\n      }\n      \n      // Create new game with consistent player assignments\n      const sortedPlayers = players.sort((a, b) => a.userId.localeCompare(b.userId));\n      const playerX = sortedPlayers[0];\n      const playerO = sortedPlayers[1];\n      \n      if (!playerX || !playerO) {\n        return res.status(400).json({ message: \"Could not find both players\" });\n      }\n      \n      const gameData = {\n        roomId,\n        playerXId: playerX.userId,\n        playerOId: playerO.userId,\n        gameMode: 'online' as const,\n        status: 'active' as const,\n        currentPlayer: 'X' as const,\n        board: {},\n      };\n      \n      const game = await storage.createGame(gameData);\n      // New game created\n      \n      // Update room status to \"playing\"\n      await storage.updateRoomStatus(roomId, 'playing');\n      // Room status updated to playing\n      \n      // Get player information with achievements\n      const [playerXInfo, playerOInfo] = await Promise.all([\n        storage.getUser(game.playerXId),\n        storage.getUser(game.playerOId)\n      ]);\n      \n      // Get achievements for both players\n      const [playerXAchievements, playerOAchievements] = await Promise.all([\n        playerXInfo ? storage.getUserAchievements(game.playerXId) : Promise.resolve([]),\n        playerOInfo ? storage.getUserAchievements(game.playerOId) : Promise.resolve([])\n      ]);\n      \n      const gameWithPlayers = {\n        ...game,\n        playerXInfo: playerXInfo ? {\n          ...playerXInfo,\n          achievements: playerXAchievements.slice(0, 3)\n        } : playerXInfo,\n        playerOInfo: playerOInfo ? {\n          ...playerOInfo,\n          achievements: playerOAchievements.slice(0, 3)\n        } : playerOInfo,\n      };\n      \n      // Broadcast to all room participants with proper synchronization\n      let broadcastSuccess = false;\n      if (roomConnections.has(roomId)) {\n        const roomUsers = roomConnections.get(roomId)!;\n        // Broadcasting game_started to users in room\n        \n        const broadcastPromises: Promise<void>[] = [];\n        roomUsers.forEach(connectionId => {\n          const connection = connections.get(connectionId);\n          if (connection && connection.ws.readyState === WebSocket.OPEN) {\n            // Sending game_started to user\n            // Create a promise for each WebSocket send to ensure delivery\n            const sendPromise = new Promise<void>((resolve) => {\n              try {\n                connection.ws.send(JSON.stringify({\n                  type: 'game_started',\n                  game: gameWithPlayers,\n                  gameId: game.id,\n                  roomId: roomId,\n                }));\n                // Small delay to ensure message is processed\n                setTimeout(resolve, 10);\n              } catch (error) {\n                console.error(`üéÆ Error sending to user ${connection.userId}:`, error);\n                resolve();\n              }\n            });\n            broadcastPromises.push(sendPromise);\n          }\n        });\n        \n        // Wait for all broadcasts to complete\n        await Promise.all(broadcastPromises);\n        broadcastSuccess = true;\n        // All game_started broadcasts completed\n      }\n      \n      // Ensure API response comes after WebSocket broadcasts\n      setTimeout(() => {\n        res.json(gameWithPlayers);\n      }, broadcastSuccess ? 50 : 10);\n    } catch (error) {\n      console.error(\"Error starting room game:\", error);\n      res.status(500).json({ message: \"Failed to start game\" });\n    }\n  });\n\n  // Game routes\n  app.post('/api/games', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      console.log('Game creation request:', req.body);\n      console.log('User ID:', userId);\n      \n      // Validate the request body with detailed error reporting\n      const parseResult = insertGameSchema.safeParse(req.body);\n      if (!parseResult.success) {\n        console.log('Schema validation failed:', parseResult.error);\n        return res.status(400).json({ \n          message: \"Invalid game data\", \n          errors: parseResult.error.errors \n        });\n      }\n      \n      const gameData = parseResult.data;\n      //console.log('Parsed game data:', gameData);\n      \n      let gameCreateData;\n      \n      if (gameData.gameMode === 'ai') {\n        // AI mode: current user vs AI\n        gameCreateData = {\n          ...gameData,\n          playerXId: userId,\n          playerOId: 'AI',\n        };\n      } else if (gameData.gameMode === 'online' && gameData.roomId) {\n        // Online mode: check if a game already exists for this room\n        const existingGame = await storage.getActiveGameByRoomId(gameData.roomId);\n        if (existingGame) {\n          //console.log('üéÆ Game already exists for room:', existingGame.id);\n          // Get player information for the existing game with achievements\n          const [playerXInfo, playerOInfo] = await Promise.all([\n            storage.getUser(existingGame.playerXId),\n            existingGame.playerOId && existingGame.playerOId !== 'AI' ? storage.getUser(existingGame.playerOId) : Promise.resolve(null)\n          ]);\n          \n          // Get achievements for both players\n          const [playerXAchievements, playerOAchievements] = await Promise.all([\n            playerXInfo ? storage.getUserAchievements(existingGame.playerXId) : Promise.resolve([]),\n            playerOInfo ? storage.getUserAchievements(existingGame.playerOId) : Promise.resolve([])\n          ]);\n          \n          const gameWithPlayers = {\n            ...existingGame,\n            playerXInfo: playerXInfo ? {\n              ...playerXInfo,\n              achievements: playerXAchievements.slice(0, 3)\n            } : playerXInfo,\n            playerOInfo: playerOInfo ? {\n              ...playerOInfo,\n              achievements: playerOAchievements.slice(0, 3)\n            } : { \n              id: 'AI', \n              firstName: 'AI', \n              lastName: 'Player',\n              profileImageUrl: null \n            }\n          };\n          \n          // Reset game state and broadcast to ensure clean start\n          await storage.updateGameBoard(existingGame.id, {});\n          await storage.updateCurrentPlayer(existingGame.id, 'X');\n          \n          // Get fresh game state after reset\n          const refreshedGame = await storage.getGameById(existingGame.id);\n          const refreshedGameWithPlayers = {\n            ...refreshedGame,\n            serverTime: new Date().toISOString(),\n            timeRemaining: Math.max(0, 10 * 60 * 1000 - (Date.now() - new Date(refreshedGame.createdAt).getTime())),\n            playerXInfo: playerXInfo ? {\n              ...playerXInfo,\n              achievements: playerXAchievements.slice(0, 3)\n            } : playerXInfo,\n            playerOInfo: playerOInfo ? {\n              ...playerOInfo,\n              achievements: playerOAchievements.slice(0, 3)\n            } : { \n              id: 'AI', \n              firstName: 'AI', \n              lastName: 'Player',\n              profileImageUrl: null \n            }\n          };\n          \n          // Broadcasting game_started for refreshed game\n          if (roomConnections.has(gameData.roomId)) {\n            const roomUsers = roomConnections.get(gameData.roomId)!;\n            // Broadcasting to users in room\n            const broadcastPromises: Promise<void>[] = [];\n            roomUsers.forEach(connectionId => {\n              const connection = connections.get(connectionId);\n              if (connection && connection.ws.readyState === WebSocket.OPEN) {\n                // Sending game_started to user\n                const sendPromise = new Promise<void>((resolve) => {\n                  try {\n                    connection.ws.send(JSON.stringify({\n                      type: 'game_started',\n                      game: refreshedGameWithPlayers,\n                      gameId: refreshedGame.id,\n                      roomId: gameData.roomId,\n                    }));\n                    setTimeout(resolve, 10);\n                  } catch (error) {\n                    //console.error(`üéÆ Error sending to user ${connection.userId}:`, error);\n                    resolve();\n                  }\n                });\n                broadcastPromises.push(sendPromise);\n              }\n            });\n            await Promise.all(broadcastPromises);\n          }\n          \n          setTimeout(() => {\n            return res.json(refreshedGameWithPlayers);\n          }, 50);\n        }\n        \n        // Get room participants and assign as players\n        const participants = await storage.getRoomParticipants(gameData.roomId);\n        const players = participants.filter(p => p.role === 'player');\n        \n        if (players.length < 2) {\n          return res.status(400).json({ message: \"Need 2 players to start online game\" });\n        }\n        \n        // Assign players consistently: sort by userId to ensure same assignment every time\n        const sortedPlayers = players.sort((a, b) => a.userId.localeCompare(b.userId));\n        const playerX = sortedPlayers[0];\n        const playerO = sortedPlayers[1];\n        \n        if (!playerX || !playerO) {\n          return res.status(400).json({ message: \"Could not find both players\" });\n        }\n        \n        gameCreateData = {\n          ...gameData,\n          playerXId: playerX.userId,\n          playerOId: playerO.userId,\n        };\n      } else {\n        // Pass-play mode: current user starts as X, O will be filled in during play\n        gameCreateData = {\n          ...gameData,\n          playerXId: userId,\n          playerOId: gameData.playerOId || undefined,\n        };\n      }\n      \n      const game = await storage.createGame(gameCreateData);\n      \n      // Get player information with achievements for the game\n      const [playerXInfo, playerOInfo] = await Promise.all([\n        storage.getUser(game.playerXId),\n        game.playerOId && game.playerOId !== 'AI' && !AI_BOTS.some(bot => bot.id === game.playerOId) ? \n          storage.getUser(game.playerOId) : \n          Promise.resolve(AI_BOTS.find(bot => bot.id === game.playerOId) || null)\n      ]);\n      \n      // Get achievements for both players\n      const [playerXAchievements, playerOAchievements] = await Promise.all([\n        playerXInfo ? storage.getUserAchievements(game.playerXId) : Promise.resolve([]),\n        playerOInfo && !AI_BOTS.some(bot => bot.id === game.playerOId) ? storage.getUserAchievements(game.playerOId) : Promise.resolve([])\n      ]);\n      \n      const gameWithPlayers = {\n        ...game,\n        playerXInfo: playerXInfo ? {\n          ...playerXInfo,\n          achievements: playerXAchievements.slice(0, 3)\n        } : playerXInfo,\n        playerOInfo: playerOInfo ? {\n          ...playerOInfo,\n          achievements: playerOAchievements.slice(0, 3)\n        } : { \n          id: 'AI', \n          firstName: 'AI', \n          lastName: 'Player',\n          profileImageUrl: null \n        }\n      };\n      \n      // Update room status\n      if (gameData.roomId) {\n        await storage.updateRoomStatus(gameData.roomId, 'playing');\n        \n        // Broadcast game start to all room participants with proper synchronization\n        // Broadcasting game_started for new game\n        if (roomConnections.has(gameData.roomId)) {\n          const roomUsers = roomConnections.get(gameData.roomId)!;\n          // Broadcasting to users in room\n          const broadcastPromises: Promise<void>[] = [];\n          roomUsers.forEach(connectionId => {\n            const connection = connections.get(connectionId);\n            if (connection && connection.ws.readyState === WebSocket.OPEN) {\n              // Sending game_started to user\n              const sendPromise = new Promise<void>((resolve) => {\n                try {\n                  connection.ws.send(JSON.stringify({\n                    type: 'game_started',\n                    game: gameWithPlayers,\n                    roomId: gameData.roomId,\n                  }));\n                  setTimeout(resolve, 10);\n                } catch (error) {\n                  console.error(`üéÆ Error sending to user ${connection.userId}:`, error);\n                  resolve();\n                }\n              });\n              broadcastPromises.push(sendPromise);\n            }\n          });\n          await Promise.all(broadcastPromises);\n        }\n      }\n\n      setTimeout(() => {\n        res.json(gameWithPlayers);\n      }, 50);\n    } catch (error) {\n      console.error(\"Error creating game:\", error);\n      console.error(\"Error stack:\", error.stack);\n      res.status(500).json({ message: \"Failed to create game\", error: error.message });\n    }\n  });\n\n  app.get('/api/games/:id', requireAuth, async (req, res) => {\n    try {\n      const { id } = req.params;\n      const game = await storage.getGameById(id);\n      if (!game) {\n        return res.status(404).json({ message: \"Game not found\" });\n      }\n      \n      // Get player information with achievements for the game\n      const [playerXInfo, playerOInfo] = await Promise.all([\n        storage.getUser(game.playerXId),\n        game.playerOId !== 'AI' ? storage.getUser(game.playerOId) : Promise.resolve(null)\n      ]);\n      \n      // Get achievements for both players\n      const [playerXAchievements, playerOAchievements] = await Promise.all([\n        playerXInfo ? storage.getUserAchievements(game.playerXId) : Promise.resolve([]),\n        playerOInfo ? storage.getUserAchievements(game.playerOId) : Promise.resolve([])\n      ]);\n      \n      const gameWithPlayers = {\n        ...game,\n        playerXInfo: playerXInfo ? {\n          ...playerXInfo,\n          achievements: playerXAchievements.slice(0, 3)\n        } : playerXInfo,\n        playerOInfo: playerOInfo ? {\n          ...playerOInfo,\n          achievements: playerOAchievements.slice(0, 3)\n        } : { username: 'AI', displayName: 'AI' }\n      };\n      \n      res.json(gameWithPlayers);\n    } catch (error) {\n      console.error(\"Error fetching game:\", error);\n      res.status(500).json({ message: \"Failed to fetch game\" });\n    }\n  });\n\n  app.post('/api/games/:id/moves', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      const { id: gameId } = req.params;\n      const { position } = req.body;\n\n      // Validate game ID format (UUID)\n      if (!gameId || typeof gameId !== 'string' || !/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(gameId)) {\n        return res.status(400).json({ message: \"Invalid game ID format\" });\n      }\n\n      // Validate position\n      if (typeof position !== 'number' || !Number.isInteger(position) || position < 1 || position > 15) {\n        return res.status(400).json({ message: \"Position must be an integer between 1 and 15\" });\n      }\n\n      // Move request processing\n\n      // Always fetch fresh game state to avoid stale data\n      const game = await storage.getGameById(gameId);\n      if (!game) {\n        return res.status(404).json({ message: \"Game not found\" });\n      }\n\n      // Validating game state\n\n      if (game.status !== 'active') {\n        //console.log(`‚ùå MOVE REJECTED: Game status is ${game.status}, not active`);\n        return res.status(400).json({ message: `Game is not active (status: ${game.status})` });\n      }\n\n      // Validate it's the player's turn\n      const isPlayerX = game.playerXId === userId;\n      const isPlayerO = game.playerOId === userId;\n      \n      // Validating player roles\n      \n      if (!isPlayerX && !isPlayerO) {\n        //console.log(`‚ùå MOVE REJECTED: User ${userId} is not a player in this game`);\n        return res.status(403).json({ message: \"Not a player in this game\" });\n      }\n\n      const playerSymbol = isPlayerX ? 'X' : 'O';\n      // Validating turn\n      \n      if (game.currentPlayer !== playerSymbol) {\n        //console.log(`‚ùå MOVE REJECTED: Not your turn. Current: ${game.currentPlayer}, User: ${playerSymbol}`);\n        return res.status(400).json({ \n          message: `Not your turn. Current player: ${game.currentPlayer}, Your symbol: ${playerSymbol}`,\n          debug: {\n            userId,\n            playerXId: game.playerXId,\n            playerOId: game.playerOId,\n            currentPlayer: game.currentPlayer,\n            isPlayerX,\n            isPlayerO,\n            playerSymbol\n          }\n        });\n      }\n\n      // Validate move\n      const currentBoard = game.board as Record<string, string> || {};\n      if (!validateMove(currentBoard, position, playerSymbol)) {\n        return res.status(400).json({ message: \"Invalid move\" });\n      }\n\n      // Make move\n      const newBoard = makeMove(currentBoard, position, playerSymbol);\n      const nextPlayer = getOpponentSymbol(playerSymbol);\n      \n      // INSTANT WebSocket broadcast for real-time responsiveness\n      if (game.roomId && roomConnections.has(game.roomId)) {\n        const roomUsers = roomConnections.get(game.roomId)!;\n        const currentTime = new Date();\n        const gameStartTime = new Date(game.createdAt);\n        const timeElapsed = currentTime.getTime() - gameStartTime.getTime();\n        const timeRemaining = Math.max(0, 10 * 60 * 1000 - timeElapsed);\n\n        const moveMessage = JSON.stringify({\n          type: 'move',\n          gameId,\n          roomId: game.roomId,\n          position,\n          player: playerSymbol,\n          board: newBoard,\n          currentPlayer: nextPlayer,\n          serverTime: currentTime.toISOString(),\n          timeRemaining: timeRemaining\n        });\n        \n        // Send move update immediately for instant feedback\n        roomUsers.forEach(connectionId => {\n          const connection = connections.get(connectionId);\n          if (connection && connection.ws.readyState === WebSocket.OPEN) {\n            connection.ws.send(moveMessage);\n          }\n        });\n      }\n      \n      // Check for win before database operations\n      const winResult = checkWin(newBoard, playerSymbol);\n      \n      // Get move count and run ALL database operations in parallel\n      const [moveCount] = await Promise.all([\n        storage.getGameMoves(gameId),\n        storage.updateGameBoard(gameId, newBoard),\n        !winResult.winner ? storage.updateCurrentPlayer(gameId, nextPlayer) : Promise.resolve()\n      ]);\n      \n      // Save move with correct move number (parallel with other operations)\n      const movePromise = storage.createMove({\n        gameId,\n        playerId: userId,\n        position,\n        symbol: playerSymbol,\n        moveNumber: moveCount.length + 1,\n      });\n      if (winResult.winner) {\n        const opponentId = isPlayerX ? game.playerOId : game.playerXId;\n        \n        // IMMEDIATE: Send winning move notification BEFORE database operations for instant feedback\n        if (game.roomId && roomConnections.has(game.roomId)) {\n          const roomUsers = roomConnections.get(game.roomId)!;\n          \n          // Send winning move with highlight immediately\n          const winningMoveMessage = JSON.stringify({\n            type: 'winning_move',\n            gameId,\n            position,\n            player: playerSymbol,\n            board: newBoard,\n            currentPlayer: nextPlayer,\n            winningPositions: winResult.winningPositions || [],\n            roomId: game.roomId\n          });\n          \n          roomUsers.forEach(connectionId => {\n            const connection = connections.get(connectionId);\n            if (connection && connection.ws.readyState === WebSocket.OPEN) {\n              connection.ws.send(winningMoveMessage);\n            }\n          });\n          \n          // Send lightweight game over message immediately \n          const gameOverMessage = JSON.stringify({\n            type: 'game_over',\n            gameId,\n            winner: playerSymbol,\n            condition: winResult.condition,\n            board: newBoard,\n            roomId: game.roomId\n          });\n          \n          roomUsers.forEach(connectionId => {\n            const connection = connections.get(connectionId);\n            if (connection && connection.ws.readyState === WebSocket.OPEN) {\n              connection.ws.send(gameOverMessage);\n            }\n          });\n        }\n        \n        // Run ALL database operations in background to avoid blocking UI updates\n        setImmediate(async () => {\n          try {\n            // Run move save AND all status updates in parallel for faster response\n            const updatePromises = [\n              movePromise, // Include move saving in parallel operations\n              storage.updateGameStatus(gameId, 'finished', userId, winResult.condition || undefined),\n              storage.updateUserStats(userId, 'win')\n            ];\n            \n            if (opponentId && opponentId !== 'AI') {\n              updatePromises.push(storage.updateUserStats(opponentId, 'loss'));\n            }\n            \n            await Promise.all(updatePromises);\n            \n            // Process achievements in background\n            if (game.roomId && game.gameMode === 'online') {\n              await storage.checkAndGrantAchievements(userId, 'win', {\n                winCondition: winResult.condition,\n                isOnlineGame: true\n              });\n              \n              if (opponentId && opponentId !== 'AI') {\n                await storage.checkAndGrantAchievements(opponentId, 'loss', {\n                  winCondition: winResult.condition,\n                  isOnlineGame: true\n                });\n              }\n            }\n            \n            // Update room status back to waiting so new games can start\n            if (game.roomId) {\n              await storage.updateRoomStatus(game.roomId, 'waiting');\n            }\n            \n            console.log(`üéÆ WIN: All database operations completed for game ${gameId}`);\n          } catch (error) {\n            console.error('üèÜ Background win processing error:', error);\n          }\n        });\n      } else if (checkDraw(newBoard)) {\n        // Run draw updates in parallel for faster response\n        const drawPromises = [storage.updateGameStatus(gameId, 'finished', undefined, 'draw')];\n        \n        if (game.playerXId && game.playerXId !== 'AI') {\n          drawPromises.push(storage.updateUserStats(game.playerXId, 'draw'));\n        }\n        if (game.playerOId && game.playerOId !== 'AI') {\n          drawPromises.push(storage.updateUserStats(game.playerOId, 'draw'));\n        }\n        \n        await Promise.all(drawPromises);\n        \n        // Process draw achievements in background to avoid blocking\n        if (game.roomId && game.gameMode === 'online') {\n          setImmediate(async () => {\n            try {\n              if (game.playerXId && game.playerXId !== 'AI') {\n                await storage.checkAndGrantAchievements(game.playerXId, 'draw', {\n                  winCondition: 'draw',\n                  isOnlineGame: true\n                });\n              }\n              if (game.playerOId && game.playerOId !== 'AI') {\n                await storage.checkAndGrantAchievements(game.playerOId, 'draw', {\n                  winCondition: 'draw',\n                  isOnlineGame: true\n                });\n              }\n            } catch (error) {\n              console.error('üèÜ Background draw achievement processing error:', error);\n            }\n          });\n        }\n        \n        // Update room status back to waiting so new games can start\n        if (game.roomId) {\n          await storage.updateRoomStatus(game.roomId, 'waiting');\n        }\n        \n        // Broadcast game over to room\n        if (game.roomId && roomConnections.has(game.roomId)) {\n          const roomUsers = roomConnections.get(game.roomId)!;\n          roomUsers.forEach(connectionId => {\n            const connection = connections.get(connectionId);\n            if (connection && connection.ws.readyState === WebSocket.OPEN) {\n              connection.ws.send(JSON.stringify({\n                type: 'game_over',\n                gameId,\n                winner: null,\n                condition: 'draw',\n                board: newBoard,\n              }));\n            }\n          });\n        }\n      } else {\n        // Save move to database (non-blocking for response)\n        await movePromise;\n        \n        // Handle Bot move if it's an online game against a bot\n        const isGameAgainstBot = game.playerOId && AI_BOTS.some(bot => bot.id === game.playerOId);\n        if (game.gameMode === 'online' && isGameAgainstBot && nextPlayer === 'O') {\n          // Bot's turn to make a move - reduced delay for faster gameplay\n          setTimeout(async () => {\n            try {\n              // Find the bot information\n              const botInfo = AI_BOTS.find(bot => bot.id === game.playerOId);\n              if (!botInfo) {\n                console.error(`ü§ñ Bot not found: ${game.playerOId}`);\n                return;\n              }\n              \n              // Create AI player with bot's difficulty\n              const aiBot = new AIPlayer('O', botInfo.difficulty);\n              const botMove = aiBot.makeMove(newBoard);\n              \n              // Bot selected move\n              \n              const botBoard = makeMove(newBoard, botMove, 'O');\n              \n              // Save bot move\n              await storage.createMove({\n                gameId,\n                playerId: game.playerOId,\n                position: botMove,\n                symbol: 'O',\n                moveNumber: moveCount.length + 2,\n              });\n              \n              await storage.updateGameBoard(gameId, botBoard);\n              \n              // Check bot win\n              const botWinResult = checkWin(botBoard, 'O');\n              if (botWinResult.winner) {\n                await storage.updateGameStatus(gameId, 'finished', game.playerOId, botWinResult.condition || undefined);\n                await storage.updateUserStats(userId, 'loss'); // User loses to bot\n                \n                // Check and grant achievements for the human player (they lost to bot)\n                if (game.roomId) {\n                  await storage.updateRoomStatus(game.roomId, 'waiting');\n                  try {\n                    await storage.checkAndGrantAchievements(userId, 'loss', {\n                      winCondition: botWinResult.condition,\n                      isOnlineGame: true,\n                      againstBot: true\n                    });\n                  } catch (error) {\n                    console.error('üèÜ Error checking achievements for user (lost to bot):', error);\n                  }\n                }\n                \n                // Broadcast bot win to room\n                if (game.roomId && roomConnections.has(game.roomId)) {\n                  const roomUsers = roomConnections.get(game.roomId)!;\n                  \n                  // First broadcast the winning move with highlight\n                  const winningMoveMessage = JSON.stringify({\n                    type: 'winning_move',\n                    gameId,\n                    position: botMove,\n                    player: 'O',\n                    board: botBoard,\n                    currentPlayer: 'X',\n                    winningPositions: botWinResult.winningPositions || [],\n                    roomId: game.roomId\n                  });\n                  \n                  roomUsers.forEach(connectionId => {\n                    const connection = connections.get(connectionId);\n                    if (connection && connection.ws.readyState === WebSocket.OPEN) {\n                      connection.ws.send(winningMoveMessage);\n                    }\n                  });\n                  \n                  // Then broadcast game over after 2.5 seconds\n                  setTimeout(async () => {\n                    const playerXInfo = await storage.getUser(game.playerXId);\n                    \n                    roomUsers.forEach(connectionId => {\n                      const connection = connections.get(connectionId);\n                      if (connection && connection.ws.readyState === WebSocket.OPEN) {\n                        connection.ws.send(JSON.stringify({\n                          type: 'game_over',\n                          gameId,\n                          winner: 'O',\n                          condition: botWinResult.condition,\n                          board: botBoard,\n                          winnerInfo: {\n                            displayName: botInfo.displayName,\n                            firstName: botInfo.firstName,\n                            username: botInfo.username,\n                            profilePicture: botInfo.profilePicture,\n                            profileImageUrl: botInfo.profilePicture\n                          },\n                          playerXInfo: playerXInfo ? {\n                            displayName: playerXInfo.displayName,\n                            firstName: playerXInfo.firstName,\n                            username: playerXInfo.username,\n                            profilePicture: playerXInfo.profilePicture,\n                            profileImageUrl: playerXInfo.profileImageUrl\n                          } : null,\n                          playerOInfo: {\n                            displayName: botInfo.displayName,\n                            firstName: botInfo.firstName,\n                            username: botInfo.username,\n                            profilePicture: botInfo.profilePicture,\n                            profileImageUrl: botInfo.profilePicture\n                          }\n                        }));\n                      }\n                    });\n                  }, 1500);\n                }\n              } else if (checkDraw(botBoard)) {\n                await storage.updateGameStatus(gameId, 'finished', undefined, 'draw');\n                await storage.updateUserStats(userId, 'draw'); // User draws with bot\n                \n                if (game.roomId) {\n                  await storage.updateRoomStatus(game.roomId, 'waiting');\n                  try {\n                    await storage.checkAndGrantAchievements(userId, 'draw', {\n                      winCondition: 'draw',\n                      isOnlineGame: true,\n                      againstBot: true\n                    });\n                  } catch (error) {\n                    console.error('üèÜ Error checking achievements for user (draw with bot):', error);\n                  }\n                }\n                \n                // Broadcast draw to room\n                if (game.roomId && roomConnections.has(game.roomId)) {\n                  const roomUsers = roomConnections.get(game.roomId)!;\n                  roomUsers.forEach(connectionId => {\n                    const connection = connections.get(connectionId);\n                    if (connection && connection.ws.readyState === WebSocket.OPEN) {\n                      connection.ws.send(JSON.stringify({\n                        type: 'game_over',\n                        gameId,\n                        winner: null,\n                        condition: 'draw',\n                        board: botBoard,\n                      }));\n                    }\n                  });\n                }\n              } else {\n                // Bot made a move, switch back to human player\n                await storage.updateCurrentPlayer(gameId, 'X');\n                \n                // Broadcast bot move to room\n                if (game.roomId && roomConnections.has(game.roomId)) {\n                  const roomUsers = roomConnections.get(game.roomId)!;\n                  const playerXInfo = await storage.getUser(game.playerXId);\n                  const playerXAchievements = playerXInfo ? await storage.getUserAchievements(game.playerXId) : [];\n                  \n\n                  \n                  const botMoveMessage = JSON.stringify({\n                    type: 'move',\n                    gameId,\n                    roomId: game.roomId,\n                    position: botMove,\n                    player: 'O',\n                    board: botBoard,\n                    currentPlayer: 'X',\n                    playerXInfo: playerXInfo ? {\n                      displayName: playerXInfo.displayName,\n                      firstName: playerXInfo.firstName,\n                      username: playerXInfo.username,\n                      profilePicture: playerXInfo.profilePicture,\n                      profileImageUrl: playerXInfo.profileImageUrl,\n                      achievements: playerXAchievements.slice(0, 3)\n                    } : null,\n                    playerOInfo: {\n                      displayName: botInfo.displayName,\n                      firstName: botInfo.firstName,\n                      username: botInfo.username,\n                      profilePicture: botInfo.profilePicture,\n                      profileImageUrl: botInfo.profilePicture,\n                      achievements: []\n                    }\n                  });\n                  \n                  // Broadcasting bot move to room users\n                  roomUsers.forEach(connectionId => {\n                    const connection = connections.get(connectionId);\n                    if (connection && connection.ws.readyState === WebSocket.OPEN) {\n                      connection.ws.send(botMoveMessage);\n                    }\n                  });\n                }\n              }\n            } catch (error) {\n              console.error('ü§ñ Error in bot move handling:', error);\n            }\n          }, 300 + Math.random() * 500); // Faster bot response for better gameplay\n        }\n        \n        // Handle AI move if it's AI mode\n        if (game.gameMode === 'ai' && nextPlayer === 'O') {\n          setTimeout(async () => {\n            try {\n              const ai = new AIPlayer('O', 'medium');\n              const aiMove = ai.makeMove(newBoard);\n              \n              const aiBoard = makeMove(newBoard, aiMove, 'O');\n              \n              // Save AI move\n              await storage.createMove({\n                gameId,\n                playerId: game.playerOId || 'AI',\n                position: aiMove,\n                symbol: 'O',\n                moveNumber: moveCount.length + 2,\n              });\n              \n              await storage.updateGameBoard(gameId, aiBoard);\n              \n              // Check AI win\n              const aiWinResult = checkWin(aiBoard, 'O');\n              if (aiWinResult.winner) {\n                await storage.updateGameStatus(gameId, 'finished', game.playerOId || undefined, aiWinResult.condition || undefined);\n                await storage.updateUserStats(userId, 'loss');\n                \n                // AI games don't grant achievements (only online games do)\n                \n                if (game.roomId) {\n                  await storage.updateRoomStatus(game.roomId, 'waiting');\n                }\n                \n                // Broadcast AI win to room\n                if (game.roomId && roomConnections.has(game.roomId)) {\n                  const roomUsers = roomConnections.get(game.roomId)!;\n                  roomUsers.forEach(connectionId => {\n                    const connection = connections.get(connectionId);\n                    if (connection && connection.ws.readyState === WebSocket.OPEN) {\n                      connection.ws.send(JSON.stringify({\n                        type: 'game_over',\n                        gameId,\n                        winner: game.playerOId || 'AI',\n                        condition: aiWinResult.condition,\n                        board: aiBoard,\n                      }));\n                    }\n                  });\n                }\n              } else if (checkDraw(aiBoard)) {\n                await storage.updateGameStatus(gameId, 'finished', undefined, 'draw');\n                await storage.updateUserStats(userId, 'draw');\n                \n                // AI games don't grant achievements (only online games do)\n                \n                if (game.roomId) {\n                  await storage.updateRoomStatus(game.roomId, 'waiting');\n                }\n                \n                // Broadcast AI draw to room\n                if (game.roomId && roomConnections.has(game.roomId)) {\n                  const roomUsers = roomConnections.get(game.roomId)!;\n                  roomUsers.forEach(connectionId => {\n                    const connection = connections.get(connectionId);\n                    if (connection && connection.ws.readyState === WebSocket.OPEN) {\n                      connection.ws.send(JSON.stringify({\n                        type: 'game_over',\n                        gameId,\n                        winner: null,\n                        condition: 'draw',\n                        board: aiBoard,\n                      }));\n                    }\n                  });\n                }\n              } else {\n                await storage.updateCurrentPlayer(gameId, 'X');\n              }\n              \n              // Broadcast AI move\n              if (game.roomId && roomConnections.has(game.roomId)) {\n                const roomUsers = roomConnections.get(game.roomId)!;\n                roomUsers.forEach(connectionId => {\n                  const connection = connections.get(connectionId);\n                  if (connection && connection.ws.readyState === WebSocket.OPEN) {\n                    connection.ws.send(JSON.stringify({\n                      type: 'move',\n                      gameId,\n                      position: aiMove,\n                      player: 'O',\n                      board: aiBoard,\n                      currentPlayer: 'X', // Back to player X's turn after AI move\n                    }));\n                  }\n                });\n              }\n            } catch (error) {\n              console.error(\"AI move error:\", error);\n            }\n          }, 500); // Faster AI response for better gameplay\n        }\n      }\n\n      res.json({ \n        message: \"Move made successfully\",\n        board: newBoard,\n        currentPlayer: getOpponentSymbol(playerSymbol),\n        gameId: gameId\n      });\n    } catch (error) {\n      console.error(\"Error making move:\", error);\n      res.status(500).json({ message: \"Failed to make move\" });\n    }\n  });\n\n  app.get('/api/users/:id/stats', requireAuth, async (req, res) => {\n    try {\n      const { id } = req.params;\n      const stats = await storage.getUserStats(id);\n      res.json(stats);\n    } catch (error) {\n      console.error(\"Error fetching stats:\", error);\n      res.status(500).json({ message: \"Failed to fetch stats\" });\n    }\n  });\n\n  const httpServer = createServer(app);\n\n  // WebSocket server\n  const wss = new WebSocketServer({ server: httpServer, path: '/ws' });\n\n  wss.on('connection', (ws, req) => {\n    const connectionId = Math.random().toString(36).substring(7);\n    // New WebSocket connection\n    \n    ws.on('message', async (message) => {\n      try {\n        const data = JSON.parse(message.toString());\n        \n        switch (data.type) {\n          case 'auth':\n            // WebSocket authenticated\n            \n            // Get user info for online tracking\n            const userInfo = await storage.getUser(data.userId);\n            \n            connections.set(connectionId, {\n              ws,\n              userId: data.userId,\n              username: userInfo?.username || 'Anonymous',\n              displayName: userInfo?.displayName || userInfo?.firstName || 'Anonymous',\n              lastSeen: new Date()\n            });\n            \n            // Update online users list\n            onlineUsers.set(data.userId, {\n              userId: data.userId,\n              username: userInfo?.username || 'Anonymous',\n              displayName: userInfo?.displayName || userInfo?.firstName || 'Anonymous',\n              lastSeen: new Date()\n            });\n            \n            // Check for active game reconnection\n            await handleUserReconnection(data.userId, connectionId, ws);\n            \n            // Optimize: Only broadcast online updates when significant change occurs\n            const onlineCount = onlineUsers.size;\n            \n            // Only send updates if count changed by more than 1 or if it's been more than 10 seconds\n            const lastBroadcastTime = global.lastOnlineUpdateBroadcast || 0;\n            const timeSinceLastBroadcast = Date.now() - lastBroadcastTime;\n            \n            if (timeSinceLastBroadcast > 10000 || !global.lastOnlineCount || Math.abs(onlineCount - global.lastOnlineCount) > 0) {\n              const broadcastMessage = JSON.stringify({\n                type: 'online_users_update',\n                count: onlineCount\n              });\n              \n              // Only send to users who are actively in rooms or have friends online\n              connections.forEach(conn => {\n                if (conn.ws.readyState === WebSocket.OPEN) {\n                  // Throttled broadcast - only send every 10 seconds to reduce traffic\n                  conn.ws.send(broadcastMessage);\n                }\n              });\n              \n              global.lastOnlineUpdateBroadcast = Date.now();\n              global.lastOnlineCount = onlineCount;\n            }\n            \n            break;\n\n          case 'ping':\n            // Enhanced ping/pong with connection quality metrics\n            const pingTimestamp = data.timestamp || Date.now();\n            const pongTimestamp = Date.now();\n            const serverLatency = pongTimestamp - pingTimestamp;\n            \n            if (ws.readyState === WebSocket.OPEN) {\n              ws.send(JSON.stringify({ \n                type: 'pong', \n                timestamp: pongTimestamp,\n                originalTimestamp: pingTimestamp,\n                serverLatency: serverLatency\n              }));\n              \n              // Update last seen for this connection with performance tracking\n              const connection = connections.get(connectionId);\n              if (connection) {\n                connection.lastSeen = new Date();\n                \n                // Update online user tracking with latency awareness\n                if (onlineUsers.has(connection.userId)) {\n                  const user = onlineUsers.get(connection.userId)!;\n                  user.lastSeen = new Date();\n                  \n                  // Track connection quality for adaptive optimization\n                  if (serverLatency > 500) {\n                    // High latency connection - could implement adaptive features here\n                    //console.log(`‚ö†Ô∏è High latency detected for user ${connection.displayName}: ${serverLatency}ms`);\n                  }\n                }\n              }\n              //console.log(`üèì Pong sent to user ${connection?.userId || 'unknown'}`);\n            }\n            break;\n\n          case 'move':\n            // Handle real-time move through WebSocket for instant synchronization\n            const moveConnection = connections.get(connectionId);\n            if (moveConnection) {\n              try {\n                const { gameId, position } = data;\n                //console.log(`üéÆ WebSocket move received: gameId=${gameId}, position=${position}, userId=${moveConnection.userId}`);\n                \n                // Get the current game state\n                const game = await storage.getGameById(gameId);\n                if (!game || game.status !== 'active') {\n                  // Send error back to client\n                  ws.send(JSON.stringify({\n                    type: 'move_error',\n                    gameId,\n                    error: 'Game not active or not found'\n                  }));\n                  break;\n                }\n                \n                // Validate it's the player's turn\n                const userIsPlayerX = game.playerXId === moveConnection.userId;\n                const userIsPlayerO = game.playerOId === moveConnection.userId;\n                const expectedSymbol = game.currentPlayer;\n                \n                if ((expectedSymbol === 'X' && !userIsPlayerX) || (expectedSymbol === 'O' && !userIsPlayerO)) {\n                  ws.send(JSON.stringify({\n                    type: 'move_error',\n                    gameId,\n                    error: 'Not your turn'\n                  }));\n                  break;\n                }\n                \n                // Validate the move is legal\n                const currentBoard = game.board || {};\n                if (currentBoard[position.toString()]) {\n                  ws.send(JSON.stringify({\n                    type: 'move_error',\n                    gameId,\n                    error: 'Position already occupied'\n                  }));\n                  break;\n                }\n                \n                // Process the move\n                const newBoard = { ...currentBoard, [position.toString()]: expectedSymbol };\n                const nextPlayer = expectedSymbol === 'X' ? 'O' : 'X';\n                \n                // Disable auto-play for the player who made the move (regain control)\n                const isCurrentPlayerAutoPlay = expectedSymbol === 'X' ? game.playerXAutoPlay : game.playerOAutoPlay;\n                if (isCurrentPlayerAutoPlay) {\n                  //console.log(`üéÆ Player ${expectedSymbol} regained control from auto-play in game ${gameId}`);\n                  await storage.disableAutoPlay(gameId, expectedSymbol as 'X' | 'O');\n                  \n                  // Notify room about auto-play deactivation\n                  if (game.roomId && roomConnections.has(game.roomId)) {\n                    const roomUsers = roomConnections.get(game.roomId)!;\n                    const autoPlayDisabledMessage = JSON.stringify({\n                      type: 'auto_play_disabled',\n                      gameId,\n                      player: expectedSymbol,\n                      message: `Player ${expectedSymbol} has regained control and is no longer in auto-play mode`\n                    });\n                    \n                    roomUsers.forEach(connectionId => {\n                      const connection = connections.get(connectionId);\n                      if (connection && connection.ws.readyState === WebSocket.OPEN) {\n                        connection.ws.send(autoPlayDisabledMessage);\n                      }\n                    });\n                  }\n                }\n                \n                // Check for win\n                const { checkWin, checkDraw } = await import('./gameLogic');\n                const winResult = checkWin(newBoard, expectedSymbol);\n                const isDraw = !winResult.winner && checkDraw(newBoard);\n                \n                // Update game in database\n                await storage.updateGameBoard(gameId, newBoard);\n                await storage.updateCurrentPlayer(gameId, nextPlayer);\n                await storage.updateLastMoveTime(gameId);\n                \n                if (winResult.winner || isDraw) {\n                  await storage.updateGameStatus(gameId, 'finished', \n                    winResult.winner ? moveConnection.userId : undefined);\n                }\n                \n                // Broadcast move to all players in room immediately\n                if (game.roomId && roomConnections.has(game.roomId)) {\n                  const roomUsers = roomConnections.get(game.roomId)!;\n                  const moveMessage = JSON.stringify({\n                    type: winResult.winner ? 'winning_move' : 'move',\n                    gameId,\n                    roomId: game.roomId,\n                    position,\n                    player: expectedSymbol,\n                    board: newBoard,\n                    currentPlayer: nextPlayer,\n                    winningPositions: winResult.winningPositions || null,\n                    serverTime: new Date().toISOString()\n                  });\n                  \n                  roomUsers.forEach(connectionId => {\n                    const conn = connections.get(connectionId);\n                    if (conn && conn.ws.readyState === WebSocket.OPEN) {\n                      conn.ws.send(moveMessage);\n                    }\n                  });\n                }\n                \n                // Check if the next player is a bot and trigger bot move\n                if (!winResult.winner && !isDraw) {\n                  const nextPlayerId = nextPlayer === 'X' ? game.playerXId : game.playerOId;\n                  //console.log(`ü§ñ Checking bot move: nextPlayer=${nextPlayer}, nextPlayerId=${nextPlayerId}`);\n                  \n                  // Check if next player is a bot (IDs starting with \"player_\")\n                  if (nextPlayerId && nextPlayerId.startsWith('player_')) {\n                    //console.log(`ü§ñ Bot move triggered for ${nextPlayerId} (${nextPlayer})`);\n                    // Trigger bot move after a short delay for realism\n                    setTimeout(async () => {\n                      try {\n                        const { AIPlayer } = await import('./aiPlayer');\n                        \n                        // Get bot difficulty from the bot data (use default medium if not found)\n                        let difficulty = 'medium';\n                        if (nextPlayerId && nextPlayerId.startsWith('player_')) {\n                          const playerNum = parseInt(nextPlayerId.replace('player_', ''));\n                          if (playerNum >= 1 && playerNum <= 30) {\n                            difficulty = 'easy';\n                          } else if (playerNum >= 31 && playerNum <= 70) {\n                            difficulty = 'medium';\n                          } else if (playerNum >= 71 && playerNum <= 100) {\n                            difficulty = 'hard';\n                          }\n                        }\n                        \n                        const ai = new AIPlayer(nextPlayer, difficulty);\n                        const botMove = ai.makeMove(newBoard);\n                        \n                        // Make the bot move\n                        const botNewBoard = { ...newBoard, [botMove]: nextPlayer };\n                        const botNextPlayer = expectedSymbol; // Switch back to human\n                        \n                        // Check for bot win\n                        const { checkWin, checkDraw } = await import('./gameLogic');\n                        const botWinResult = checkWin(botNewBoard, nextPlayer);\n                        const botIsDraw = !botWinResult.winner && checkDraw(botNewBoard);\n                        \n                        // Update database with bot move\n                        await storage.updateGameBoard(gameId, botNewBoard);\n                        await storage.updateCurrentPlayer(gameId, botNextPlayer);\n                        await storage.updateLastMoveTime(gameId);\n                        \n                        if (botWinResult.winner || botIsDraw) {\n                          await storage.updateGameStatus(gameId, 'finished', \n                            botWinResult.winner ? nextPlayerId : undefined, \n                            botIsDraw ? 'draw' : (botWinResult.condition || undefined));\n                        }\n                        \n                        // Broadcast bot move to all players in room\n                        if (game.roomId && roomConnections.has(game.roomId)) {\n                          const roomUsers = roomConnections.get(game.roomId)!;\n                          const botMoveMessage = JSON.stringify({\n                            type: botWinResult.winner ? 'winning_move' : 'move',\n                            gameId,\n                            roomId: game.roomId,\n                            position: botMove,\n                            player: nextPlayer,\n                            board: botNewBoard,\n                            currentPlayer: botNextPlayer,\n                            winningPositions: botWinResult.winningPositions || null,\n                            serverTime: new Date().toISOString(),\n                            isBot: true\n                          });\n                          \n                          //console.log(`ü§ñ Broadcasting bot move: position=${botMove}, player=${nextPlayer}, roomUsers=${roomUsers.size}`);\n                          roomUsers.forEach(connectionId => {\n                            const conn = connections.get(connectionId);\n                            if (conn && conn.ws.readyState === WebSocket.OPEN) {\n                              conn.ws.send(botMoveMessage);\n                            }\n                          });\n                          \n                          // If bot won or game is draw, send game_over message after delay\n                          if (botWinResult.winner || botIsDraw) {\n                            setTimeout(async () => {\n                              const gameOverMessage = JSON.stringify({\n                                type: 'game_over',\n                                gameId,\n                                result: botWinResult.winner ? 'win' : 'draw',\n                                winner: botWinResult.winner ? nextPlayer : null,\n                                condition: botIsDraw ? 'draw' : (botWinResult.condition || undefined),\n                                roomId: game.roomId\n                              });\n                              \n                              roomUsers.forEach(connectionId => {\n                                const conn = connections.get(connectionId);\n                                if (conn && conn.ws.readyState === WebSocket.OPEN) {\n                                  conn.ws.send(gameOverMessage);\n                                }\n                              });\n                            }, 2500); // Same delay as user wins\n                          }\n                        }\n                        \n                      } catch (error) {\n                        console.error('Bot move error:', error);\n                      }\n                    }, 1000 + Math.random() * 2000); // 1-3 second delay for realism\n                  }\n                }\n                \n                // If game ended, handle end game logic\n                if (winResult.winner || isDraw) {\n                  setTimeout(async () => {\n                    if (game.roomId && roomConnections.has(game.roomId)) {\n                      const roomUsers = roomConnections.get(game.roomId)!;\n                      const gameOverMessage = JSON.stringify({\n                        type: 'game_over',\n                        gameId,\n                        result: winResult.winner ? 'win' : 'draw',\n                        winner: winResult.winner ? expectedSymbol : null,\n                        condition: isDraw ? 'draw' : (winResult.condition || undefined),\n                        roomId: game.roomId\n                      });\n                      \n                      roomUsers.forEach(connectionId => {\n                        const conn = connections.get(connectionId);\n                        if (conn && conn.ws.readyState === WebSocket.OPEN) {\n                          conn.ws.send(gameOverMessage);\n                        }\n                      });\n                    }\n                  }, 2500);\n                }\n                \n              } catch (error) {\n                console.error('WebSocket move error:', error);\n                ws.send(JSON.stringify({\n                  type: 'move_error',\n                  gameId: data.gameId,\n                  error: 'Internal server error processing move'\n                }));\n              }\n            }\n            break;\n\n          case 'disable_auto_play':\n            // Handle disabling auto-play when player wants to regain control\n            const disableConnection = connections.get(connectionId);\n            if (disableConnection) {\n              try {\n                const { gameId } = data;\n                //console.log(`üéÆ Disable auto-play requested: gameId=${gameId}, userId=${disableConnection.userId}`);\n                \n                // Get the current game state\n                const game = await storage.getGameById(gameId);\n                if (!game || game.status !== 'active') {\n                  ws.send(JSON.stringify({\n                    type: 'auto_play_error',\n                    gameId,\n                    error: 'Game not active or not found'\n                  }));\n                  break;\n                }\n                \n                // Determine which player the user is\n                const userIsPlayerX = game.playerXId === disableConnection.userId;\n                const userIsPlayerO = game.playerOId === disableConnection.userId;\n                let playerSymbol = '';\n                \n                if (userIsPlayerX) {\n                  playerSymbol = 'X';\n                } else if (userIsPlayerO) {\n                  playerSymbol = 'O';\n                } else {\n                  ws.send(JSON.stringify({\n                    type: 'auto_play_error',\n                    gameId,\n                    error: 'You are not a player in this game'\n                  }));\n                  break;\n                }\n                \n                // Check if the player is currently in auto-play mode\n                const isCurrentlyAutoPlay = playerSymbol === 'X' ? game.playerXAutoPlay : game.playerOAutoPlay;\n                if (!isCurrentlyAutoPlay) {\n                  ws.send(JSON.stringify({\n                    type: 'auto_play_error',\n                    gameId,\n                    error: 'You are not currently in auto-play mode'\n                  }));\n                  break;\n                }\n                \n                // Disable auto-play for the player\n                //console.log(`üéÆ Player ${playerSymbol} manually disabled auto-play in game ${gameId}`);\n                await storage.disableAutoPlay(gameId, playerSymbol as 'X' | 'O');\n                \n                // Notify room about auto-play deactivation\n                if (game.roomId && roomConnections.has(game.roomId)) {\n                  const roomUsers = roomConnections.get(game.roomId)!;\n                  const autoPlayDisabledMessage = JSON.stringify({\n                    type: 'auto_play_disabled',\n                    gameId,\n                    player: playerSymbol,\n                    message: `Player ${playerSymbol} has regained control and is no longer in auto-play mode`\n                  });\n                  \n                  roomUsers.forEach(connectionId => {\n                    const connection = connections.get(connectionId);\n                    if (connection && connection.ws.readyState === WebSocket.OPEN) {\n                      connection.ws.send(autoPlayDisabledMessage);\n                    }\n                  });\n                }\n                \n                // Send success confirmation to the requesting player\n                ws.send(JSON.stringify({\n                  type: 'auto_play_disabled_success',\n                  gameId,\n                  player: playerSymbol,\n                  message: 'Auto-play disabled successfully. You now have control!'\n                }));\n                \n              } catch (error) {\n                console.error('WebSocket disable auto-play error:', error);\n                ws.send(JSON.stringify({\n                  type: 'auto_play_error',\n                  gameId: data.gameId,\n                  error: 'Internal server error disabling auto-play'\n                }));\n              }\n            }\n            break;\n            \n          case 'join_room':\n            const connection = connections.get(connectionId);\n            if (connection) {\n              // User joining room\n              connection.roomId = data.roomId;\n              \n              // Update user's room state\n              const existingState = userRoomStates.get(connection.userId);\n              const activeGame = await storage.getActiveGameByRoomId(data.roomId);\n              \n              userRoomStates.set(connection.userId, {\n                roomId: data.roomId,\n                gameId: activeGame?.id,\n                isInGame: activeGame?.status === 'active'\n              });\n              \n              // Update online user room info\n              const onlineUser = onlineUsers.get(connection.userId);\n              if (onlineUser) {\n                onlineUser.roomId = data.roomId;\n              }\n              \n              if (!roomConnections.has(data.roomId)) {\n                roomConnections.set(data.roomId, new Set());\n              }\n              roomConnections.get(data.roomId)!.add(connectionId);\n              // Room connection updated\n              \n              // If there's an active game in this room, send the game state to the joining user\n              // BUT only if this is NOT a reconnection (to prevent duplicate notifications)\n              if (activeGame && activeGame.status === 'active') {\n                // Check if this is a reconnection (user was recently reconnected)\n                const now = Date.now();\n                const lastReconnection = recentReconnections.get(connection.userId);\n                const isRecentReconnection = lastReconnection && (now - lastReconnection) < 3000; // 3 second window\n                \n                if (!isRecentReconnection) {\n                  // Sending active game state to joining user\n                  \n                  // Get player information with achievements\n                  const [playerXInfo, playerOInfo] = await Promise.all([\n                    storage.getUser(activeGame.playerXId),\n                    activeGame.playerOId && activeGame.playerOId !== 'AI' ? storage.getUser(activeGame.playerOId) : Promise.resolve(null)\n                  ]);\n                  \n                  // Get achievements for both players\n                  const [playerXAchievements, playerOAchievements] = await Promise.all([\n                    playerXInfo ? storage.getUserAchievements(activeGame.playerXId) : Promise.resolve([]),\n                    playerOInfo ? storage.getUserAchievements(activeGame.playerOId) : Promise.resolve([])\n                  ]);\n                  \n                  const gameWithPlayers = {\n                    ...activeGame,\n                    playerXInfo: playerXInfo ? {\n                      ...playerXInfo,\n                      achievements: playerXAchievements.slice(0, 3)\n                    } : playerXInfo,\n                    playerOInfo: playerOInfo ? {\n                      ...playerOInfo,\n                      achievements: playerOAchievements.slice(0, 3)\n                    } : playerOInfo,\n                    gameMode: 'online'\n                  };\n                  \n                  // Send game state to the joining user\n                  connection.ws.send(JSON.stringify({\n                    type: 'game_started',\n                    game: gameWithPlayers,\n                    gameId: activeGame.id,\n                    roomId: data.roomId,\n                  }));\n                } else {\n\n                }\n              }\n              \n              // Notify all participants in the room about the new connection\n              const roomConnIds = roomConnections.get(data.roomId);\n              if (roomConnIds) {\n                // Get user information for the joining user\n                const userInfo = await storage.getUser(connection.userId);\n                \n                for (const connId of roomConnIds) {\n                  const conn = connections.get(connId);\n                  if (conn && conn.ws.readyState === WebSocket.OPEN) {\n                    conn.ws.send(JSON.stringify({\n                      type: 'user_joined',\n                      userId: connection.userId,\n                      roomId: data.roomId,\n                      userInfo: userInfo,\n                    }));\n                  }\n                }\n              }\n            }\n            break;\n            \n          case 'leave_room':\n            const conn = connections.get(connectionId);\n            if (conn && conn.roomId) {\n              const roomId = conn.roomId;\n              // Use userId from connection object instead of message data for security\n              const userId = conn.userId;\n              const playerName = conn.displayName || conn.username || 'Unknown Player';\n              \n              // Processing room leave request\n              \n              // Check if user is in an active game\n              const userState = userRoomStates.get(userId);\n              const activeGame = await storage.getActiveGameByRoomId(roomId);\n              const room = await storage.getRoomById(roomId);\n              \n              // Checking active game for room\n              \n              // Check if the leaving user is actually a player in the active game\n              const isPlayerInActiveGame = activeGame && activeGame.status === 'active' && \n                  (activeGame.playerXId === userId || activeGame.playerOId === userId);\n              const isRoomInPlayingState = room && room.status === 'playing';\n              \n              // Only abandon the game if a PLAYER leaves, not a spectator\n              if (isPlayerInActiveGame || (isRoomInPlayingState && activeGame && \n                  (activeGame.playerXId === userId || activeGame.playerOId === userId))) {\n                // Player leaving active game - determine winner\n                \n                // Determine the winner (the player who didn't leave)\n                const leavingPlayerId = userId;\n                const remainingPlayerId = activeGame.playerXId === leavingPlayerId ? \n                  activeGame.playerOId : activeGame.playerXId;\n                const winnerSymbol = activeGame.playerXId === remainingPlayerId ? 'X' : 'O';\n                \n                // Get player information for the winner\n                const [leavingPlayerInfo, remainingPlayerInfo] = await Promise.all([\n                  storage.getUser(leavingPlayerId),\n                  storage.getUser(remainingPlayerId)\n                ]);\n                \n                // Mark game as finished with winner due to player abandonment\n                await storage.updateGameStatus(activeGame.id, 'finished', remainingPlayerId, 'abandonment');\n                \n                // Remove leaving player from room participants database\n                await storage.removeRoomParticipant(roomId, leavingPlayerId);\n                \n                // Update stats - winner gets a win, leaver gets a loss\n                await storage.updateUserStats(remainingPlayerId, 'win');\n                await storage.updateUserStats(leavingPlayerId, 'loss');\n                \n                // Check and grant achievements for the winner\n                try {\n                  await storage.checkAndGrantAchievements(remainingPlayerId, 'win', leavingPlayerId);\n                } catch (achievementError) {\n                  console.error('Error granting achievements after abandonment win:', achievementError);\n                }\n                \n                // Game permanently ended in database with winner determined\n                \n                // Get all users in the room (players and spectators)\n                const roomUsers = roomConnections.get(roomId);\n                if (roomUsers && roomUsers.size > 0) {\n                  const gameEndMessage = JSON.stringify({\n                    type: 'player_left_win',\n                    roomId,\n                    gameId: activeGame.id,\n                    winner: remainingPlayerId,\n                    winnerSymbol: winnerSymbol,\n                    winnerInfo: remainingPlayerInfo,\n                    leavingPlayer: playerName,\n                    leavingPlayerId: leavingPlayerId,\n                    leavingPlayerInfo: leavingPlayerInfo,\n                    condition: 'abandonment',\n                    message: `${playerName} left the game. ${remainingPlayerInfo?.displayName || remainingPlayerInfo?.username || 'Player'} wins!`,\n                    redirectToAI: true\n                  });\n                  \n                  // Track unique users to prevent duplicate messages\n                  const notifiedUsers = new Set<string>();\n                  const connectionsToSend: string[] = [];\n                  \n                  // Filter to send only one message per unique user\n                  roomUsers.forEach(connectionId => {\n                    const connection = connections.get(connectionId);\n                    if (connection && connection.ws.readyState === WebSocket.OPEN && connection.userId) {\n                      if (!notifiedUsers.has(connection.userId)) {\n                        notifiedUsers.add(connection.userId);\n                        connectionsToSend.push(connectionId);\n                      }\n                    }\n                  });\n                  \n                  //console.log(`üèÜ Broadcasting player left win to ${connectionsToSend.length} unique users in room ${roomId}`);\n                  \n                  // Send to unique users only\n                  connectionsToSend.forEach(connectionId => {\n                    const connection = connections.get(connectionId);\n                    if (connection && connection.ws.readyState === WebSocket.OPEN) {\n                      connection.ws.send(gameEndMessage);\n                      \n                      // Clear their room state immediately\n                      const connUserId = connection.userId;\n                      if (connUserId) {\n                        userRoomStates.delete(connUserId);\n                        const onlineUser = onlineUsers.get(connUserId);\n                        if (onlineUser) {\n                          onlineUser.roomId = undefined;\n                        }\n                      }\n                      \n                      // Clear their connection room info\n                      connection.roomId = undefined;\n                    }\n                  });\n                  \n                  // Clear remaining duplicate connections\n                  roomUsers.forEach(connectionId => {\n                    const connection = connections.get(connectionId);\n                    if (connection) {\n                      connection.roomId = undefined;\n                    }\n                  });\n                  \n                  // Clear the entire room\n                  roomConnections.delete(roomId);\n                  // Room completely cleared\n                }\n                \n                return;\n              }\n              \n              // Handle spectator leave (non-player leaving the room)\n              // Remove from room connections\n              const roomUsers = roomConnections.get(roomId);\n              if (roomUsers) {\n                roomUsers.delete(connectionId);\n                \n                // Update online user room info\n                const onlineUser = onlineUsers.get(userId);\n                if (onlineUser) {\n                  onlineUser.roomId = undefined;\n                }\n                \n                // Remove from user room states\n                userRoomStates.delete(userId);\n                \n                // Check if this was a spectator leaving\n                const participants = await storage.getRoomParticipants(roomId);\n                const leavingUser = participants.find(p => p.userId === userId);\n                const isSpectatorLeaving = leavingUser && leavingUser.role === 'spectator';\n                \n                // Remove participant from database (both spectators and regular players)\n                await storage.removeRoomParticipant(roomId, userId);\n                \n                if (isSpectatorLeaving) {\n                  // For spectators, send them back to home with a reload message\n                  conn.ws.send(JSON.stringify({\n                    type: 'spectator_left',\n                    roomId,\n                    message: 'You have left the room',\n                    redirectToHome: true             \n                  }));\n                  \n                  // Just send a regular notification to other users that spectator left\n                  if (roomUsers.size > 0) {\n                    const spectatorLeftMessage = JSON.stringify({\n                      type: 'user_left',\n                      roomId,\n                      userId,\n                      playerName,\n                      role: 'spectator',\n                      message: `${playerName} (spectator) left the room`\n                    });\n                    \n                    roomUsers.forEach(remainingConnectionId => {\n                      const remainingConnection = connections.get(remainingConnectionId);\n                      if (remainingConnection && remainingConnection.ws.readyState === WebSocket.OPEN) {\n                        remainingConnection.ws.send(spectatorLeftMessage);\n                      }\n                    });\n                  }\n                } else {\n                  // For non-spectators (regular players), send room end notification to all remaining users\n                  if (roomUsers.size > 0) {\n                    const roomEndMessage = JSON.stringify({\n                      type: 'room_ended',\n                      roomId,\n                      userId,\n                      playerName,\n                      message: `${playerName} left the room`\n                    });\n                    \n                    // Broadcasting room end to remaining users\n                    roomUsers.forEach(remainingConnectionId => {\n                      const remainingConnection = connections.get(remainingConnectionId);\n                      if (remainingConnection && remainingConnection.ws.readyState === WebSocket.OPEN) {\n                        remainingConnection.ws.send(roomEndMessage);\n                      }\n                    });\n                  }\n                }\n                \n                // Clear the room if no users left\n                if (roomUsers.size === 0) {\n                  roomConnections.delete(roomId);\n                  // Room cleared - no users remaining\n                }\n              }\n              \n              conn.roomId = undefined;\n            }\n            break;\n            \n          case 'player_reaction':\n            // Handle player reaction and broadcast to all users in the room\n            const { roomId, gameId, userId, playerSymbol, reactionType, emoji, playerInfo } = data;\n            \n            // Player reaction received\n            \n            // Broadcast reaction to all users in the room\n            const roomUsers = roomConnections.get(roomId);\n            if (roomUsers && roomUsers.size > 0) {\n              const reactionMessage = JSON.stringify({\n                type: 'player_reaction',\n                roomId,\n                gameId,\n                userId,\n                playerSymbol,\n                reactionType,\n                emoji,\n                playerInfo,\n                timestamp: Date.now()\n              });\n              \n              //console.log(`üé≠ Broadcasting reaction to ${roomUsers.size} users in room ${roomId}`);\n              let broadcastCount = 0;\n              roomUsers.forEach(connId => {\n                const conn = connections.get(connId);\n                if (conn && conn.ws.readyState === WebSocket.OPEN) {\n                  conn.ws.send(reactionMessage);\n                  broadcastCount++;\n                  // Sent reaction to user\n                }\n              });\n              // Successfully broadcast reaction\n            } else {\n              // No room users found or room is empty\n            }\n            break;\n            \n          case 'player_chat':\n            // Handle player chat message and broadcast to all users in the room\n            const { roomId: chatRoomId, gameId: chatGameId, userId: chatUserId, playerSymbol: chatPlayerSymbol, messageText, playerInfo: chatPlayerInfo } = data;\n            \n            // console.log(`üí¨ Player chat from ${chatUserId} in room ${chatRoomId}: ${messageText} (${chatPlayerSymbol})`);\n            \n            // Broadcast chat message to all users in the room\n            const chatRoomUsers = roomConnections.get(chatRoomId);\n            if (chatRoomUsers && chatRoomUsers.size > 0) {\n              const chatMessage = JSON.stringify({\n                type: 'player_chat',\n                roomId: chatRoomId,\n                gameId: chatGameId,\n                userId: chatUserId,\n                playerSymbol: chatPlayerSymbol,\n                messageText,\n                playerInfo: chatPlayerInfo,\n                timestamp: Date.now()\n              });\n              \n              // console.log(`üí¨ Broadcasting chat to ${chatRoomUsers.size} users in room ${chatRoomId}`);\n              let broadcastCount = 0;\n              chatRoomUsers.forEach(connId => {\n                const conn = connections.get(connId);\n                if (conn && conn.ws.readyState === WebSocket.OPEN) {\n                  conn.ws.send(chatMessage);\n                  broadcastCount++;\n                  // console.log(`üí¨ Sent chat to user: ${conn.userId}`);\n                }\n              });\n              // console.log(`üí¨ Successfully broadcast chat to ${broadcastCount} users`);\n            } else {\n              // No room users found or room is empty\n            }\n            break;\n        }\n      } catch (error) {\n        console.error('WebSocket message error:', error);\n      }\n    });\n\n    ws.on('close', async () => {\n\n      \n      // Get user info before cleaning up\n      const connection = connections.get(connectionId);\n      \n      if (connection) {\n        // Check if user has other active connections\n        const userHasOtherConnections = Array.from(connections.values()).some(\n          conn => conn.userId === connection.userId && conn.ws !== ws\n        );\n        \n        // Only remove from online users if no other connections exist\n        if (!userHasOtherConnections) {\n          // Check if user is in active game by checking both memory state and database\n          const userState = userRoomStates.get(connection.userId);\n          const activeGame = await storage.getActiveGameForUser(connection.userId);\n          const isReallyInActiveGame = activeGame && activeGame.status === 'active';\n          \n          if (userState && userState.isInGame && isReallyInActiveGame) {\n            //console.log(`üè† User ${connection.userId} disconnected but is in active game - keeping in room`);\n            // Update last seen time but don't remove\n            const onlineUser = onlineUsers.get(connection.userId);\n            if (onlineUser) {\n              onlineUser.lastSeen = new Date();\n            }\n          } else {\n            // Only clean up room state if user truly doesn't have an active game\n            const activeGame = await storage.getActiveGameForUser(connection.userId);\n            \n            if (!activeGame || activeGame.status !== 'active') {\n              // No active game - safe to clean up completely\n              \n              // Clean up room participant from database BEFORE deleting room state\n              const userState = userRoomStates.get(connection.userId);\n              if (userState && userState.roomId) {\n                try {\n                  await storage.removeRoomParticipant(userState.roomId, connection.userId);\n                } catch (error) {\n                  console.error('Error removing room participant on disconnect:', error);\n                }\n              }\n              \n              onlineUsers.delete(connection.userId);\n              userRoomStates.delete(connection.userId);\n            } else {\n              // User has active game - preserve room state for reconnection\n              // Only remove from online users but keep room state\n              onlineUsers.delete(connection.userId);\n            }\n            \n            // Broadcast user offline event for chat history cleanup\n            const userOfflineMessage = JSON.stringify({\n              type: 'user_offline',\n              userId: connection.userId\n            });\n            \n            // Broadcast updated online count\n            const onlineCount = onlineUsers.size;\n            const broadcastMessage = JSON.stringify({\n              type: 'online_users_update',\n              count: onlineCount\n            });\n            \n            connections.forEach(conn => {\n              if (conn.ws.readyState === WebSocket.OPEN && conn.ws !== ws) {\n                conn.ws.send(userOfflineMessage);\n                conn.ws.send(broadcastMessage);\n              }\n            });\n          }\n        }\n      }\n      \n      // Check if user has other connections BEFORE deleting this one\n      const userHasOtherConnectionsAfterDelete = connection ? \n        Array.from(connections.values()).some(conn => conn.userId === connection.userId && conn.ws !== ws) : false;\n      \n      // Clean up connection\n      connections.delete(connectionId);\n      \n      // Remove from room connections only if user doesn't have other connections\n      if (connection && !userHasOtherConnectionsAfterDelete) {\n        for (const [roomId, roomUsers] of roomConnections.entries()) {\n          if (roomUsers.has(connectionId)) {\n            roomUsers.delete(connectionId);\n            \n            // Check if user is in active game before notifying room end\n            const userState = userRoomStates.get(connection.userId);\n            const activeGame = await storage.getActiveGameByRoomId(roomId);\n            \n            // Only send room_ended if there's actually an ACTIVE game in progress\n            const isActiveGameInProgress = activeGame && activeGame.status === 'active' && \n                  (activeGame.playerXId === connection.userId || activeGame.playerOId === connection.userId);\n            \n            if (isActiveGameInProgress) {\n              // Player left during active game - this should trigger game abandonment logic elsewhere\n              //console.log(`üö® Player ${connection.userId} left active game in room ${roomId}`);\n            } else {\n              // Game is finished or no game - just clean up room silently for remaining users\n              //console.log(`üßπ Cleaning up room ${roomId} - no active game affected`);\n              \n              // Check if there are still other users in the room\n              const remainingUsers = Array.from(roomUsers).filter(connId => connections.has(connId));\n              \n              if (remainingUsers.length > 0) {\n                // Don't send room_ended message - just clean up silently\n                // The remaining users should be able to start new games or matchmake normally\n                //console.log(`üßπ Room ${roomId} has ${remainingUsers.length} remaining users - keeping room active`);\n              } else {\n                // No remaining users - delete the room\n                roomConnections.delete(roomId);\n                //console.log(`üßπ Room ${roomId} empty - deleted`);\n              }\n              \n              // Clean up the user's room state and database participant\n              userRoomStates.delete(connection.userId);\n              \n              // Remove participant from database on disconnect\n              try {\n                await storage.removeRoomParticipant(roomId, connection.userId);\n              } catch (error) {\n                console.error('Error removing room participant on disconnect:', error);\n              }\n              \n              // Also remove user from matchmaking queue if they were in it\n              const matchmakingIndex = matchmakingQueue.indexOf(connection.userId);\n              if (matchmakingIndex > -1) {\n                matchmakingQueue.splice(matchmakingIndex, 1);\n                //console.log(`üßπ Removed user ${connection.userId} from matchmaking queue`);\n              }\n              \n              // Clear any matchmaking timers for this user\n              if (matchmakingTimers.has(connection.userId)) {\n                clearTimeout(matchmakingTimers.get(connection.userId)!);\n                matchmakingTimers.delete(connection.userId);\n                //console.log(`üßπ Cleared matchmaking timer for user ${connection.userId}`);\n              }\n            }\n          }\n        }\n      }\n    });\n  });\n\n  // Play Again endpoints\n  app.post('/api/play-again/request', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      const { requestedUserId, gameId } = req.body;\n\n      if (!requestedUserId || !gameId) {\n        return res.status(400).json({ error: 'Missing required fields' });\n      }\n\n      // Check if there's already an active request for this game\n      const existingRequest = await storage.getActivePlayAgainRequest(gameId, userId);\n      if (existingRequest) {\n        return res.status(400).json({ error: 'Play again request already exists' });\n      }\n\n      const request = await storage.sendPlayAgainRequest(userId, requestedUserId, gameId);\n\n      // Send real-time notification to the requested player\n      const requestedConnection = Array.from(connections.values())\n        .find(conn => conn.userId === requestedUserId);\n      \n      if (requestedConnection && requestedConnection.ws.readyState === WebSocket.OPEN) {\n        requestedConnection.ws.send(JSON.stringify({\n          type: 'play_again_request',\n          requestId: request.id,\n          requesterId: userId,\n          gameId,\n        }));\n      }\n\n      res.json({ success: true, requestId: request.id });\n    } catch (error) {\n      console.error('Error sending play again request:', error);\n      res.status(500).json({ error: 'Failed to send play again request' });\n    }\n  });\n\n  app.post('/api/play-again/respond', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      const { requestId, response } = req.body;\n\n      if (!requestId || !response || !['accepted', 'rejected'].includes(response)) {\n        return res.status(400).json({ error: 'Invalid request or response' });\n      }\n\n      // Get the request to validate and get requester info\n      const requests = await storage.getPlayAgainRequests(userId);\n      const request = requests.find(r => r.id === requestId);\n      \n      if (!request) {\n        return res.status(404).json({ error: 'Play again request not found' });\n      }\n\n      await storage.respondToPlayAgainRequest(requestId, response);\n\n      // Send real-time response to the requester and responder\n      const requesterConnection = Array.from(connections.values())\n        .find(conn => conn.userId === request.requesterId);\n      const responderConnection = Array.from(connections.values())\n        .find(conn => conn.userId === userId);\n      \n      // If rejected, send redirect to home to both players\n      if (response === 'rejected') {\n        [requesterConnection, responderConnection].forEach(conn => {\n          if (conn && conn.ws.readyState === WebSocket.OPEN) {\n            conn.ws.send(JSON.stringify({\n              type: 'play_again_rejected',\n              requestId,\n              redirectToHome: true\n            }));\n          }\n        });\n      } else {\n        // Send response notification for accepted requests\n        if (requesterConnection && requesterConnection.ws.readyState === WebSocket.OPEN) {\n          requesterConnection.ws.send(JSON.stringify({\n            type: 'play_again_response',\n            requestId,\n            response,\n            responderId: userId,\n          }));\n        }\n      }\n\n      // If accepted, reuse existing room and create new game\n      if (response === 'accepted') {\n        try {\n          // Get the original game's room ID with proper null handling\n          const originalGame = request.game;\n          const existingRoomId = originalGame?.roomId;\n          \n          if (!existingRoomId) {\n            throw new Error('Original game has no room ID - cannot reuse room');\n          }\n          \n          // Get the existing room details\n          const existingRoom = await storage.getRoomById(existingRoomId);\n          \n          if (!existingRoom) {\n            throw new Error('Original room not found');\n          }\n\n          // Collect all connection IDs for both players (handle multiple tabs/connections)\n          const requesterConnIds = Array.from(connections.entries())\n            .filter(([_, conn]) => conn.userId === request.requesterId)\n            .map(([connId, _]) => connId);\n          const responderConnIds = Array.from(connections.entries())\n            .filter(([_, conn]) => conn.userId === userId)\n            .map(([connId, _]) => connId);\n          \n          const allPlayerConnIds = [...requesterConnIds, ...responderConnIds];\n\n          // Create new game regardless of WebSocket connection status\n          // Update user room states first\n          userRoomStates.set(request.requesterId, { roomId: existingRoomId, isInGame: false });\n          userRoomStates.set(userId, { roomId: existingRoomId, isInGame: false });\n\n          // Create new game in the existing room\n          const newGame = await storage.createGame({\n            roomId: existingRoomId,\n            gameMode: 'online',\n            playerXId: request.requesterId,\n            playerOId: userId,\n            status: 'active'\n          });\n\n          // Update user room states to indicate they're in a game\n          userRoomStates.set(request.requesterId, { roomId: existingRoomId, gameId: newGame.id, isInGame: true });\n          userRoomStates.set(userId, { roomId: existingRoomId, gameId: newGame.id, isInGame: true });\n\n          // Ensure room connections exist and add all player connection IDs\n          if (!roomConnections.has(existingRoomId)) {\n            roomConnections.set(existingRoomId, new Set());\n          }\n          \n          const roomConnIds = roomConnections.get(existingRoomId)!;\n          allPlayerConnIds.forEach(connId => roomConnIds.add(connId));\n\n          // Update connection room info for all player connections\n          allPlayerConnIds.forEach(connId => {\n            const connection = connections.get(connId);\n            if (connection) {\n              connection.roomId = existingRoomId;\n            }\n          });\n\n          // Get player information with achievements to include in game_started event\n          const [playerXInfo, playerOInfo] = await Promise.all([\n            storage.getUser(newGame.playerXId!),\n            storage.getUser(newGame.playerOId!)\n          ]);\n\n          // Get achievements for both players\n          const [playerXAchievements, playerOAchievements] = await Promise.all([\n            playerXInfo ? storage.getUserAchievements(newGame.playerXId!) : Promise.resolve([]),\n            playerOInfo ? storage.getUserAchievements(newGame.playerOId!) : Promise.resolve([])\n          ]);\n\n          // Create enhanced game object with player information (like other game_started events)\n          const gameWithPlayers = {\n            ...newGame,\n            playerXInfo: playerXInfo ? {\n              ...playerXInfo,\n              achievements: playerXAchievements.slice(0, 3)\n            } : null,\n            playerOInfo: playerOInfo ? {\n              ...playerOInfo,\n              achievements: playerOAchievements.slice(0, 3)\n            } : null,\n            gameMode: 'online', // Explicitly set as online game\n            serverTime: new Date().toISOString(),\n            timeRemaining: Math.max(0, 10 * 60 * 1000) // Full 10 minutes for new game\n          };\n\n          // Broadcast game_started event to all player connections in the room\n          const gameStartedPayload = {\n            type: 'game_started',\n            game: gameWithPlayers, // Now includes player profile information\n            roomId: existingRoomId,\n            room: existingRoom\n          };\n\n          let onlinePlayersCount = 0;\n          allPlayerConnIds.forEach(connId => {\n            const connection = connections.get(connId);\n            if (connection && connection.ws.readyState === WebSocket.OPEN) {\n              connection.ws.send(JSON.stringify(gameStartedPayload));\n              onlinePlayersCount++;\n            }\n          });\n\n          //console.log(`üéÆ Play again accepted: Created new game ${newGame.id} in room ${existingRoomId}`);\n          //console.log(`üîó Notified ${onlinePlayersCount}/${allPlayerConnIds.length} connections`);\n          \n          if (onlinePlayersCount === 0) {\n            //console.log(`‚ö†Ô∏è Both players are offline - game created but they will need to reconnect`);\n          } else if (onlinePlayersCount < allPlayerConnIds.length) {\n            //console.log(`‚ö†Ô∏è Some player connections are offline - they will need to refresh/reconnect`);\n          }\n        } catch (error) {\n          console.error('Error creating new game for play again:', error);\n          // Still send success response even if game creation fails\n        }\n      }\n\n      res.json({ success: true });\n    } catch (error) {\n      console.error('Error responding to play again request:', error);\n      res.status(500).json({ error: 'Failed to respond to play again request' });\n    }\n  });\n\n  app.get('/api/play-again/requests', requireAuth, async (req: any, res) => {\n    try {\n      const userId = req.session.user.userId;\n      const requests = await storage.getPlayAgainRequests(userId);\n      res.json(requests);\n    } catch (error) {\n      console.error('Error fetching play again requests:', error);\n      res.status(500).json({ error: 'Failed to fetch play again requests' });\n    }\n  });\n\n  // Clean up expired play again requests periodically\n  setInterval(async () => {\n    try {\n      await storage.expireOldPlayAgainRequests();\n    } catch (error) {\n      console.error('Error cleaning up expired play again requests:', error);\n    }\n  }, 60000); // Clean up every minute\n\n  return httpServer;\n}\n","size_bytes":226107},"server/storage.ts":{"content":"import {\n  users,\n  rooms,\n  games,\n  moves,\n  roomParticipants,\n  blockedUsers,\n  achievements,\n  userThemes,\n  friendRequests,\n  friendships,\n  roomInvitations,\n  coinTransactions,\n  playAgainRequests,\n  levelUps,\n  monthlyLeaderboard,\n  monthlyRewards,\n  monthlyResetStatus,\n  type User,\n  type UpsertUser,\n  type Room,\n  type Game,\n  type Move,\n  type RoomParticipant,\n  type BlockedUser,\n  type Achievement,\n  type UserTheme,\n  type FriendRequest,\n  type Friendship,\n  type RoomInvitation,\n  type CoinTransaction,\n  type PlayAgainRequest,\n  type LevelUp,\n  type MonthlyLeaderboard,\n  type MonthlyReward,\n  type MonthlyResetStatus,\n  type InsertRoom,\n  type InsertGame,\n  type InsertMove,\n  type InsertRoomParticipant,\n  type InsertBlockedUser,\n  type InsertAchievement,\n  type InsertUserTheme,\n  type InsertFriendRequest,\n  type InsertFriendship,\n  type InsertRoomInvitation,\n  type InsertCoinTransaction,\n  type InsertPlayAgainRequest,\n  type InsertLevelUp,\n  type InsertMonthlyLeaderboard,\n  type InsertMonthlyReward,\n  type InsertMonthlyResetStatus,\n  type BasicFriendInfo,\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { getLevelFromWins, getWinsToNextLevel } from \"@shared/level\";\nimport { eq, and, desc, count, or, ne, isNull, isNotNull, sql, exists, inArray, lt, gt, not, like, ilike } from \"drizzle-orm\";\n\nexport interface IStorage {\n  // User operations - mandatory for Replit Auth\n  getUser(id: string): Promise<User | undefined>;\n  getUserByEmail(email: string): Promise<User | undefined>;\n  getUsersByName(name: string): Promise<User[]>;\n  upsertUser(user: UpsertUser): Promise<User>;\n  deleteUser(id: string): Promise<void>;\n\n  // Room operations\n  createRoom(room: InsertRoom & { ownerId: string }): Promise<Room>;\n  getRoomByCode(code: string): Promise<Room | undefined>;\n  getRoomById(id: string): Promise<Room | undefined>;\n  updateRoomStatus(id: string, status: string): Promise<void>;\n\n  // Game operations\n  createGame(game: InsertGame): Promise<Game>;\n  getGameById(id: string): Promise<Game | undefined>;\n  getActiveGameByRoomId(roomId: string): Promise<Game | undefined>;\n  updateGameBoard(gameId: string, board: Record<string, string>): Promise<void>;\n  updateGameStatus(gameId: string, status: string, winnerId?: string, winCondition?: string): Promise<void>;\n  updateCurrentPlayer(gameId: string, currentPlayer: string): Promise<void>;\n  getActiveGameForUser(userId: string): Promise<Game | undefined>;\n  updateLastMoveTime(gameId: string): Promise<void>;\n  finishGame(gameId: string, finishData: { status: string; winningPlayer?: string | null; winningPositions?: number[]; updatedAt: Date }): Promise<void>;\n\n  // Auto-play operations\n  enableAutoPlay(gameId: string, player: 'X' | 'O'): Promise<void>;\n  disableAutoPlay(gameId: string, player: 'X' | 'O'): Promise<void>;\n  getGamesWithInactivePlayers(): Promise<Game[]>;\n\n  // Move operations\n  createMove(move: InsertMove): Promise<Move>;\n  getGameMoves(gameId: string): Promise<Move[]>;\n\n  // Room participant operations\n  addRoomParticipant(participant: InsertRoomParticipant): Promise<RoomParticipant>;\n  getRoomParticipants(roomId: string): Promise<(RoomParticipant & { user: User })[]>;\n  removeRoomParticipant(roomId: string, userId: string): Promise<void>;\n\n  // Statistics\n  updateUserStats(userId: string, result: 'win' | 'loss' | 'draw'): Promise<void>;\n  getUserStats(userId: string): Promise<{ wins: number; losses: number; draws: number }>;\n  getOnlineGameStats(userId: string): Promise<{ wins: number; losses: number; draws: number; totalGames: number; currentWinStreak: number; bestWinStreak: number; level: number; winsToNextLevel: number; coins: number }>;\n\n  // Blocked Users\n  blockUser(blockerId: string, blockedId: string): Promise<BlockedUser>;\n  unblockUser(blockerId: string, blockedId: string): Promise<void>;\n  getBlockedUsers(userId: string): Promise<BlockedUser[]>;\n  isUserBlocked(blockerId: string, blockedId: string): Promise<boolean>;\n\n  // Player Rankings\n  getPlayerRankings(sortBy: string): Promise<any[]>;\n\n  // Achievement operations\n  createAchievement(achievement: InsertAchievement): Promise<Achievement>;\n  getUserAchievements(userId: string): Promise<Achievement[]>;\n  hasAchievement(userId: string, achievementType: string): Promise<boolean>;\n  checkAndGrantAchievements(userId: string, gameResult: 'win' | 'loss' | 'draw', gameData?: any): Promise<Achievement[]>;\n\n  // Theme operations\n  unlockTheme(userId: string, themeName: string): Promise<UserTheme>;\n  getUserThemes(userId: string): Promise<UserTheme[]>;\n  isThemeUnlocked(userId: string, themeName: string): Promise<boolean>;\n\n  // Friend operations\n  sendFriendRequest(requesterId: string, requestedId: string): Promise<FriendRequest>;\n  getFriendRequests(userId: string): Promise<(FriendRequest & { requester: User; requested: User })[]>;\n  respondToFriendRequest(requestId: string, response: 'accepted' | 'rejected'): Promise<void>;\n  getFriends(userId: string): Promise<BasicFriendInfo[]>;\n  removeFriend(userId: string, friendId: string): Promise<void>;\n  areFriends(userId: string, friendId: string): Promise<boolean>;\n  cleanupFriendshipData(): Promise<void>;\n  getHeadToHeadStats(userId: string, friendId: string): Promise<{\n    totalGames: number;\n    userWins: number;\n    friendWins: number;\n    draws: number;\n    userWinRate: number;\n    friendWinRate: number;\n  }>;\n\n  // Room Invitation operations\n  createRoomInvitationsTable(): Promise<void>;\n  sendRoomInvitation(roomId: string, inviterId: string, invitedId: string): Promise<RoomInvitation>;\n  getRoomInvitations(userId: string): Promise<(RoomInvitation & { room: Room; inviter: User; invited: User })[]>;\n  respondToRoomInvitation(invitationId: string, response: 'accepted' | 'rejected'): Promise<void>;\n  expireOldInvitations(): Promise<void>;\n\n  // Achievement Border Selection\n  updateSelectedAchievementBorder(userId: string, achievementType: string | null): Promise<void>;\n\n  // Coin operations\n  createCoinTransaction(transaction: InsertCoinTransaction): Promise<CoinTransaction>;\n  getUserCoins(userId: string): Promise<number>;\n  updateUserCoins(userId: string, newBalance: number): Promise<void>;\n  processCoinTransaction(userId: string, amount: number, type: string, gameId?: string): Promise<void>;\n\n  // Play Again operations\n  sendPlayAgainRequest(requesterId: string, requestedId: string, gameId: string): Promise<PlayAgainRequest>;\n  getPlayAgainRequests(userId: string): Promise<(PlayAgainRequest & { requester: User; requested: User; game: Game })[]>;\n  respondToPlayAgainRequest(requestId: string, response: 'accepted' | 'rejected'): Promise<void>;\n  expireOldPlayAgainRequests(): Promise<void>;\n  getActivePlayAgainRequest(gameId: string, requesterId: string): Promise<PlayAgainRequest | undefined>;\n\n  // Monthly Leaderboard operations\n  getOrCreateMonthlyStats(userId: string, month: number, year: number): Promise<MonthlyLeaderboard>;\n  updateMonthlyStats(userId: string, result: 'win' | 'loss' | 'draw', coinsEarned: number): Promise<void>;\n  getMonthlyLeaderboard(month: number, year: number, limit?: number): Promise<Array<MonthlyLeaderboard & { user: User; rank: number }>>;\n  getCurrentMonthLeaderboard(limit?: number): Promise<Array<MonthlyLeaderboard & { user: User; rank: number }>>;\n  getTimeUntilMonthEnd(): Promise<{ days: number; hours: number; minutes: number; seconds: number }>;\n  distributeMonthlyRewards(month: number, year: number): Promise<MonthlyReward[]>;\n  resetMonthlyStats(month: number, year: number): Promise<void>;\n  getMonthlyRewards(userId: string): Promise<MonthlyReward[]>;\n  hasReceivedMonthlyReward(userId: string, month: number, year: number): Promise<boolean>;\n\n  // Monthly Reset Status operations\n  getResetStatus(month: number, year: number): Promise<MonthlyResetStatus | undefined>;\n  createResetStatus(month: number, year: number): Promise<MonthlyResetStatus>;\n  updateResetStatus(id: string, status: 'pending' | 'in_progress' | 'completed' | 'failed', errorMessage?: string): Promise<void>;\n  incrementRetryCount(id: string, nextRetryAt?: Date): Promise<void>;\n  getPendingResets(): Promise<MonthlyResetStatus[]>;\n  getFailedResets(): Promise<MonthlyResetStatus[]>;\n  createMonthlyResetTable(): Promise<void>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // Database initialization\n  async createRoomInvitationsTable(): Promise<void> {\n    // First create the table without foreign key constraints\n    await db.execute(sql`\n      CREATE TABLE IF NOT EXISTS room_invitations (\n        id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n        room_id UUID NOT NULL,\n        inviter_id VARCHAR NOT NULL,\n        invited_id VARCHAR NOT NULL,\n        status VARCHAR(20) DEFAULT 'pending' CHECK (status IN ('pending', 'accepted', 'rejected', 'expired')),\n        invited_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        responded_at TIMESTAMP,\n        expires_at TIMESTAMP DEFAULT (CURRENT_TIMESTAMP + INTERVAL '30 seconds'),\n        UNIQUE(room_id, invited_id)\n      )\n    `);\n\n    // Add foreign key constraints if they don't exist\n    try {\n      await db.execute(sql`\n        ALTER TABLE room_invitations \n        ADD CONSTRAINT room_invitations_room_id_fkey \n        FOREIGN KEY (room_id) REFERENCES rooms(id) ON DELETE CASCADE\n      `);\n    } catch (e) {\n      // Constraint may already exist\n    }\n\n    try {\n      await db.execute(sql`\n        ALTER TABLE room_invitations \n        ADD CONSTRAINT room_invitations_inviter_id_fkey \n        FOREIGN KEY (inviter_id) REFERENCES users(id) ON DELETE CASCADE\n      `);\n    } catch (e) {\n      // Constraint may already exist\n    }\n\n    try {\n      await db.execute(sql`\n        ALTER TABLE room_invitations \n        ADD CONSTRAINT room_invitations_invited_id_fkey \n        FOREIGN KEY (invited_id) REFERENCES users(id) ON DELETE CASCADE\n      `);\n    } catch (e) {\n      // Constraint may already exist\n    }\n  }\n\n  // User operations\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user;\n  }\n\n  async getUserByEmail(email: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.email, email));\n    return user;\n  }\n\n  async getUsersByName(name: string): Promise<User[]> {\n    // Sanitize search term to prevent SQL injection\n    const sanitizedName = name.replace(/[%_]/g, '\\\\$&'); // Escape SQL wildcards\n    const searchTerm = `%${sanitizedName}%`;\n\n    const usersByName = await db.select().from(users).where(\n      or(\n        ilike(users.firstName, searchTerm),\n        ilike(users.lastName, searchTerm),\n        ilike(users.displayName, searchTerm),\n        ilike(users.username, searchTerm),\n        sql`LOWER(CONCAT(${users.firstName}, ' ', ${users.lastName})) LIKE LOWER(${searchTerm})`\n      )\n    ).limit(10);\n    return usersByName;\n  }\n\n  async upsertUser(userData: UpsertUser): Promise<User> {\n    // First check if user exists\n    const existingUser = await this.getUser(userData.id);\n\n    if (existingUser) {\n      // User exists, update only if data is different to avoid foreign key issues\n      const shouldUpdate = \n        existingUser.email !== userData.email ||\n        existingUser.firstName !== userData.firstName ||\n        existingUser.lastName !== userData.lastName ||\n        existingUser.displayName !== userData.displayName ||\n        existingUser.username !== userData.username ||\n        existingUser.profileImageUrl !== userData.profileImageUrl ||\n        existingUser.isGuest !== userData.isGuest ||\n        existingUser.guestSessionExpiry !== userData.guestSessionExpiry;\n\n      if (shouldUpdate) {\n        try {\n          const [user] = await db\n            .update(users)\n            .set({\n              email: userData.email,\n              firstName: userData.firstName,\n              lastName: userData.lastName,\n              displayName: userData.displayName,\n              username: userData.username,\n              profileImageUrl: userData.profileImageUrl,\n              isGuest: userData.isGuest,\n              guestSessionExpiry: userData.guestSessionExpiry,\n              updatedAt: new Date(),\n            })\n            .where(eq(users.id, userData.id))\n            .returning();\n          return user;\n        } catch (error: any) {\n          // If foreign key constraint violation, just return existing user\n          if (error.code === '23503') {\n            //console.log(`‚ö†Ô∏è Foreign key constraint for user ${userData.id}, keeping existing data`);\n            return existingUser;\n          }\n          throw error;\n        }\n      }\n      return existingUser;\n    }\n\n    // User doesn't exist, try to insert\n    try {\n      const [user] = await db\n        .insert(users)\n        .values(userData)\n        .returning();\n      return user;\n    } catch (error: any) {\n      // Handle unique constraint violations\n      if (error.code === '23505') { // Unique constraint violation\n        if (error.detail?.includes('email') && userData.email) {\n          // Email conflict - try to get by email\n          const user = await this.getUserByEmail(userData.email);\n          if (user) return user;\n        }\n        if (error.detail?.includes('username') && userData.username) {\n          // Username conflict - try to get by username\n          const [user] = await db.select().from(users).where(eq(users.username, userData.username));\n          if (user) return user;\n        }\n      }\n      // Re-throw if we couldn't handle the conflict\n      throw error;\n    }\n  }\n\n  async deleteUser(id: string): Promise<void> {\n    await db.delete(users).where(eq(users.id, id));\n  }\n\n  // Room operations\n  async createRoom(roomData: InsertRoom & { ownerId: string }): Promise<Room> {\n    const code = Math.random().toString(36).substring(2, 10).toUpperCase();\n    const [room] = await db\n      .insert(rooms)\n      .values({\n        ...roomData,\n        code,\n      })\n      .returning();\n    return room;\n  }\n\n  async getRoomByCode(code: string): Promise<Room | undefined> {\n    const [room] = await db.select().from(rooms).where(eq(rooms.code, code));\n    return room;\n  }\n\n  async getRoomById(id: string): Promise<Room | undefined> {\n    const [room] = await db.select().from(rooms).where(eq(rooms.id, id));\n    return room;\n  }\n\n  async updateRoomStatus(id: string, status: string): Promise<void> {\n    await db.update(rooms).set({ status }).where(eq(rooms.id, id));\n  }\n\n  // Clean up old rooms (older than 30 minutes) SAFELY - only inactive rooms with no active games\n  async cleanupOldRooms(): Promise<number> {\n    const thirtyMinutesAgo = new Date(Date.now() - 30 * 60 * 1000);\n    \n    try {\n      // SAFELY find old rooms that have NO active games AND no recent activity\n      const safeToDeleteRooms = await db\n        .select({ \n          id: rooms.id, \n          code: rooms.code, \n          createdAt: rooms.createdAt \n        })\n        .from(rooms)\n        .where(\n          and(\n            lt(rooms.createdAt, thirtyMinutesAgo),\n            // Ensure NO active games in this room using NOT EXISTS\n            not(exists(\n              db.select()\n                .from(games)\n                .where(and(\n                  eq(games.roomId, rooms.id),\n                  eq(games.status, 'active')\n                ))\n            )),\n            // Also ensure no recent activity using NOT EXISTS for recent moves\n            not(exists(\n              db.select()\n                .from(games)\n                .where(and(\n                  eq(games.roomId, rooms.id),\n                  gt(games.lastMoveAt, thirtyMinutesAgo)\n                ))\n            ))\n          )\n        );\n\n      if (safeToDeleteRooms.length === 0) {\n        return 0;\n      }\n\n      const roomIds = safeToDeleteRooms.map(r => r.id);\n      \n      // Use transaction for atomic cleanup\n      const deletedCount = await db.transaction(async (tx) => {\n        // Delete related data in correct order to avoid foreign key violations\n        // 1. Delete room participants first\n        await tx.delete(roomParticipants).where(inArray(roomParticipants.roomId, roomIds));\n        \n        // 2. DETACH games from these rooms instead of deleting them (preserves game history)\n        // Extra safety: only detach non-active games\n        await tx.update(games)\n          .set({ roomId: null })\n          .where(and(\n            inArray(games.roomId, roomIds),\n            ne(games.status, 'active') // Never touch active games\n          ));\n        \n        // 3. Finally delete the rooms themselves\n        const deletedRooms = await tx.delete(rooms)\n          .where(inArray(rooms.id, roomIds))\n          .returning({ id: rooms.id });\n\n        return deletedRooms.length;\n      });\n\n      //console.log(`üßπ Safely cleaned up ${deletedCount} inactive rooms (older than 30 minutes, no active games)`);\n      return deletedCount;\n      \n    } catch (error) {\n      console.error('‚ùå Error cleaning up old rooms:', error);\n      return 0;\n    }\n  }\n\n  // Game operations\n  async createGame(gameData: InsertGame): Promise<Game> {\n    const [game] = await db.insert(games).values(gameData).returning();\n    return game;\n  }\n\n  async getGameById(id: string): Promise<Game | undefined> {\n    const [game] = await db.select().from(games).where(eq(games.id, id));\n    return game;\n  }\n\n  async getActiveGameByRoomId(roomId: string): Promise<Game | undefined> {\n    const [game] = await db\n      .select()\n      .from(games)\n      .where(and(eq(games.roomId, roomId), eq(games.status, \"active\")))\n      .orderBy(desc(games.createdAt));\n    return game;\n  }\n\n  async updateGameBoard(gameId: string, board: Record<string, string>): Promise<void> {\n    await db.update(games).set({ board, lastMoveAt: new Date() }).where(eq(games.id, gameId));\n  }\n\n  async updateGameStatus(gameId: string, status: string, winnerId?: string, winCondition?: string): Promise<void> {\n    // Get current game status to check if already finished (idempotency)\n    const [currentGame] = await db.select().from(games).where(eq(games.id, gameId));\n    const wasAlreadyFinished = currentGame?.status === 'finished';\n\n    const updateData: any = { status };\n    if (winnerId) updateData.winnerId = winnerId;\n    if (winCondition) updateData.winCondition = winCondition;\n    if (status === \"finished\") updateData.finishedAt = new Date();\n\n    await db.update(games).set(updateData).where(eq(games.id, gameId));\n\n    // Check for achievements when game is finished (only if not already finished)\n    if (status === 'finished' && !wasAlreadyFinished) {\n      const [game] = await db.select().from(games).where(eq(games.id, gameId));\n      if (game && game.playerXId && game.playerOId) {\n        const gameData = { winCondition, gameId };\n\n        // Check achievements for both players\n        if (winnerId) {\n          // Winner achievements\n          await this.checkAndGrantAchievements(winnerId, 'win', gameData);\n\n          // Loser achievements\n          const loserId = winnerId === game.playerXId ? game.playerOId : game.playerXId;\n          await this.checkAndGrantAchievements(loserId, 'loss', gameData);\n\n          // Update user stats for winner and loser (only for online games)\n          if (game.gameMode === 'online') {\n            await this.updateUserStats(winnerId, 'win');\n            await this.updateUserStats(loserId, 'loss');\n          }\n\n          // Process coin transactions based on game mode\n          try {\n            //console.log(`üí∞ Processing coin transactions for game ${gameId} (mode: ${game.gameMode}):`);\n\n            if (game.gameMode === 'ai') {\n              // AI games: Winner gets 10 coins (smaller reward for AI practice)\n              //console.log(`üí∞ AI game - Winner: ${winnerId} (+10 coins)`);\n              await this.processCoinTransaction(winnerId, 10, 'ai_game_win', gameId);\n              //console.log(`üí∞ Awarded 10 coins to AI game winner: ${winnerId}`);\n            } else if (game.gameMode === 'online') {\n              // Online games: Winner gets 100 coins, loser loses 100 coins (if sufficient balance)\n              //console.log(`üí∞ Online game - Winner: ${winnerId} (+100 coins), Loser: ${loserId} (-100 coins)`);\n\n              // Winner always gets coins\n              await this.processCoinTransaction(winnerId, 100, 'online_game_win', gameId);\n              //console.log(`üí∞ Awarded 100 coins to online game winner: ${winnerId}`);\n\n              // Loser loses coins only if they have enough balance\n              const loserCoins = await this.getUserCoins(loserId);\n              //console.log(`üí∞ Loser ${loserId} current balance: ${loserCoins} coins`);\n\n              let loserCoinsLost = 0;\n              if (loserCoins >= 100) {\n                await this.processCoinTransaction(loserId, -100, 'online_game_loss', gameId);\n                //console.log(`üí∞ Deducted 100 coins from loser: ${loserId}`);\n                loserCoinsLost = -100;\n              } else {\n                //console.log(`üí∞ Loser ${loserId} doesn't have enough coins (${loserCoins}), skipping deduction`);\n              }\n\n              // Track monthly stats for online games only\n              try {\n                await this.updateMonthlyStats(winnerId, 'win', 100);\n                await this.updateMonthlyStats(loserId, 'loss', loserCoinsLost);\n              } catch (error) {\n                //console.error('üìä Error updating monthly stats:', error);\n              }\n            } else {\n              //console.log(`üí∞ No coin transactions for game mode: ${game.gameMode}`);\n            }\n          } catch (error) {\n            //console.error('üí∞ Error processing coin transactions:', error);\n          }\n        } else {\n          // Draw achievements for both players\n          await this.checkAndGrantAchievements(game.playerXId, 'draw', gameData);\n          await this.checkAndGrantAchievements(game.playerOId, 'draw', gameData);\n\n          // Update user stats for both players (draw, only for online games)\n          if (game.gameMode === 'online') {\n            await this.updateUserStats(game.playerXId, 'draw');\n            await this.updateUserStats(game.playerOId, 'draw');\n\n            // Track monthly stats for online draws (no coins earned/lost)\n            try {\n              await this.updateMonthlyStats(game.playerXId, 'draw', 0);\n              await this.updateMonthlyStats(game.playerOId, 'draw', 0);\n            } catch (error) {\n              //console.error('üìä Error updating monthly stats for draw:', error);\n            }\n          }\n\n          // No coin transactions for draws\n          //console.log(`üí∞ Game ${gameId} ended in draw, no coin transactions processed`);\n        }\n      }\n    }\n  }\n\n  async updateCurrentPlayer(gameId: string, currentPlayer: string): Promise<void> {\n    await db.update(games).set({ currentPlayer, lastMoveAt: new Date() }).where(eq(games.id, gameId));\n  }\n\n  async getActiveGameForUser(userId: string): Promise<Game | undefined> {\n    const [game] = await db\n      .select()\n      .from(games)\n      .where(and(\n        eq(games.status, 'active'),\n        or(\n          eq(games.playerXId, userId),\n          eq(games.playerOId, userId)\n        )\n      ))\n      .orderBy(desc(games.createdAt))\n      .limit(1);\n    return game;\n  }\n\n  async updateLastMoveTime(gameId: string): Promise<void> {\n    await db.update(games).set({ lastMoveAt: new Date() }).where(eq(games.id, gameId));\n  }\n\n  async getExpiredGames(): Promise<Game[]> {\n    const tenMinutesAgo = new Date(Date.now() - 10 * 60 * 1000); // 10 minutes ago\n    return await db\n      .select()\n      .from(games)\n      .where(and(\n        eq(games.status, 'active'),\n        lt(games.lastMoveAt, tenMinutesAgo)\n      ));\n  }\n\n  async expireGame(gameId: string): Promise<void> {\n    await db.update(games).set({ \n      status: 'expired',\n      finishedAt: new Date()\n    }).where(eq(games.id, gameId));\n  }\n\n  // Auto-play implementations\n  async enableAutoPlay(gameId: string, player: 'X' | 'O'): Promise<void> {\n    const now = new Date();\n    const updateData = player === 'X' \n      ? { playerXAutoPlay: true, playerXAutoPlaySince: now }\n      : { playerOAutoPlay: true, playerOAutoPlaySince: now };\n\n    await db.update(games).set(updateData).where(eq(games.id, gameId));\n  }\n\n  async disableAutoPlay(gameId: string, player: 'X' | 'O'): Promise<void> {\n    const updateData = player === 'X' \n      ? { playerXAutoPlay: false, playerXAutoPlaySince: null }\n      : { playerOAutoPlay: false, playerOAutoPlaySince: null };\n\n    await db.update(games).set(updateData).where(eq(games.id, gameId));\n  }\n\n  async getGamesWithInactivePlayers(): Promise<Game[]> {\n    const oneMinuteAgo = new Date(Date.now() - 30 * 1000); // 60 seconds ago\n    return await db\n      .select()\n      .from(games)\n      .where(and(\n        eq(games.status, 'active'),\n        eq(games.gameMode, 'online'), // Only online games need auto-play\n        lt(games.lastMoveAt, oneMinuteAgo)\n      ));\n  }\n\n  async finishGame(gameId: string, finishData: { status: string; winningPlayer?: string | null; winningPositions?: number[]; updatedAt: Date }): Promise<void> {\n    // Get current game status to check if already finished (idempotency)\n    const [currentGame] = await db.select().from(games).where(eq(games.id, gameId));\n    const wasAlreadyFinished = currentGame?.status === 'finished';\n\n    const updateData: any = { \n      status: finishData.status,\n      finishedAt: finishData.updatedAt\n    };\n\n    if (finishData.winningPlayer) {\n      updateData.winnerId = finishData.winningPlayer;\n    }\n\n    await db.update(games).set(updateData).where(eq(games.id, gameId));\n\n    // Process achievements, stats, and coins when game is finished (only if not already finished)\n    if (finishData.status === 'finished' && !wasAlreadyFinished) {\n      const [game] = await db.select().from(games).where(eq(games.id, gameId));\n      if (game && game.playerXId && game.playerOId && finishData.winningPlayer) {\n        const winnerId = finishData.winningPlayer;\n        const loserId = winnerId === game.playerXId ? game.playerOId : game.playerXId;\n\n        // Check achievements for both players\n        const gameData = { winCondition: game.winCondition, gameId };\n        await this.checkAndGrantAchievements(winnerId, 'win', gameData);\n        await this.checkAndGrantAchievements(loserId, 'loss', gameData);\n\n        // Update user stats for winner and loser (only for online games)\n        if (game.gameMode === 'online') {\n          await this.updateUserStats(winnerId, 'win');\n          await this.updateUserStats(loserId, 'loss');\n        }\n\n        // Process coin transactions based on game mode\n        try {\n          //console.log(`üí∞ Processing coin transactions for game ${gameId} (mode: ${game.gameMode}):`);\n\n          if (game.gameMode === 'ai') {\n            // AI games: Winner gets 10 coins (smaller reward for AI practice)\n            await this.processCoinTransaction(winnerId, 10, 'ai_game_win', gameId);\n          } else if (game.gameMode === 'online') {\n            // Online games: Winner gets 100 coins, loser loses 100 coins (if sufficient balance)\n            //console.log(`üí∞ Online game - Winner: ${winnerId} (+100 coins), Loser: ${loserId} (-100 coins)`);\n\n            // Winner always gets coins\n            await this.processCoinTransaction(winnerId, 100, 'online_game_win', gameId);\n            //console.log(`üí∞ Awarded 100 coins to winner: ${winnerId}`);\n\n            // Loser loses coins only if they have enough balance\n            const loserCoins = await this.getUserCoins(loserId);\n            //console.log(`üí∞ Loser ${loserId} current balance: ${loserCoins} coins`);\n\n            let loserCoinsLost = 0;\n            if (loserCoins >= 100) {\n              await this.processCoinTransaction(loserId, -100, 'online_game_loss', gameId);\n              //console.log(`üí∞ Deducted 100 coins from loser: ${loserId}`);\n              loserCoinsLost = -100;\n            } else {\n              //console.log(`üí∞ Loser ${loserId} doesn't have enough coins (${loserCoins}), skipping deduction`);\n            }\n\n            // Track monthly stats for online games only\n            try {\n              await this.updateMonthlyStats(winnerId, 'win', 100);\n              await this.updateMonthlyStats(loserId, 'loss', loserCoinsLost);\n            } catch (error) {\n              //console.error('üìä Error updating monthly stats:', error);\n            }\n          }\n        } catch (error) {\n          //console.error('üí∞ Error processing coin transactions:', error);\n        }\n      } else if (game && game.playerXId && game.playerOId && !finishData.winningPlayer) {\n        // Draw - check achievements for both players\n        const gameData = { winCondition: game.winCondition, gameId };\n        await this.checkAndGrantAchievements(game.playerXId, 'draw', gameData);\n        await this.checkAndGrantAchievements(game.playerOId, 'draw', gameData);\n\n        // Update user stats for both players (draw, only for online games)\n        if (game.gameMode === 'online') {\n          await this.updateUserStats(game.playerXId, 'draw');\n          await this.updateUserStats(game.playerOId, 'draw');\n\n          // Track monthly stats for online draws (no coins earned/lost)\n          try {\n            await this.updateMonthlyStats(game.playerXId, 'draw', 0);\n            await this.updateMonthlyStats(game.playerOId, 'draw', 0);\n          } catch (error) {\n            //console.error('üìä Error updating monthly stats for draw:', error);\n          }\n        }\n\n        // No coin transactions for draws\n        //console.log(`üí∞ Game ${gameId} ended in draw, no coin transactions processed`);\n      }\n    }\n  }\n\n  // Move operations\n  async createMove(moveData: InsertMove): Promise<Move> {\n    const [move] = await db.insert(moves).values(moveData).returning();\n    return move;\n  }\n\n  async getGameMoves(gameId: string): Promise<Move[]> {\n    return await db\n      .select()\n      .from(moves)\n      .where(eq(moves.gameId, gameId))\n      .orderBy(moves.moveNumber);\n  }\n\n  // Room participant operations\n  async addRoomParticipant(participantData: InsertRoomParticipant): Promise<RoomParticipant> {\n    // Check if participant already exists to prevent duplicates\n    const existingParticipant = await db\n      .select()\n      .from(roomParticipants)\n      .where(\n        and(\n          eq(roomParticipants.roomId, participantData.roomId),\n          eq(roomParticipants.userId, participantData.userId)\n        )\n      )\n      .limit(1);\n\n    if (existingParticipant.length > 0) {\n      // User is already a participant, return existing record\n      return existingParticipant[0];\n    }\n\n    // User is not a participant yet, add them\n    const [participant] = await db.insert(roomParticipants).values(participantData).returning();\n    return participant;\n  }\n\n  async getRoomParticipants(roomId: string): Promise<(RoomParticipant & { user: User })[]> {\n    return await db\n      .select({\n        id: roomParticipants.id,\n        roomId: roomParticipants.roomId,\n        userId: roomParticipants.userId,\n        role: roomParticipants.role,\n        joinedAt: roomParticipants.joinedAt,\n        user: users,\n      })\n      .from(roomParticipants)\n      .innerJoin(users, eq(roomParticipants.userId, users.id))\n      .where(eq(roomParticipants.roomId, roomId));\n  }\n\n  async removeRoomParticipant(roomId: string, userId: string): Promise<void> {\n    await db\n      .delete(roomParticipants)\n      .where(and(eq(roomParticipants.roomId, roomId), eq(roomParticipants.userId, userId)));\n  }\n\n  // Statistics - for game results\n  async updateUserStatsFromGame(userId: string, result: 'win' | 'loss' | 'draw'): Promise<void> {\n    const user = await this.getUser(userId);\n    if (!user) return;\n\n    // Calculate current level before updating stats\n    const currentLevel = getLevelFromWins(user.wins || 0);\n\n    const updates: any = {};\n\n    // Update basic stats\n    if (result === 'win') {\n      const newWins = (user.wins || 0) + 1;\n      updates.wins = newWins;\n      \n      // Update win streak\n      const currentStreak = (user.currentWinStreak || 0) + 1;\n      updates.currentWinStreak = currentStreak;\n      // Update best win streak if current streak is better\n      if (currentStreak > (user.bestWinStreak || 0)) {\n        updates.bestWinStreak = currentStreak;\n      }\n\n      // Check for level up\n      const newLevel = getLevelFromWins(newWins);\n      if (newLevel > currentLevel) {\n        // User leveled up! Record it in the levelUps table\n        await this.recordLevelUp(userId, currentLevel, newLevel);\n      }\n    } else if (result === 'loss') {\n      updates.losses = (user.losses || 0) + 1;\n      // Reset win streak on loss\n      updates.currentWinStreak = 0;\n    } else if (result === 'draw') {\n      updates.draws = (user.draws || 0) + 1;\n      // Reset win streak on draw\n      updates.currentWinStreak = 0;\n    }\n\n    await db.update(users).set(updates).where(eq(users.id, userId));\n  }\n\n  // Method to update user stats based on game result (matches IStorage interface)\n  async updateUserStats(userId: string, result: 'win' | 'loss' | 'draw'): Promise<void> {\n    //console.log(`üìä Updating user stats: ${userId} -> ${result}`);\n    await this.updateUserStatsFromGame(userId, result);\n    //console.log(`‚úÖ User stats updated successfully: ${userId} -> ${result}`);\n  }\n\n  // Level up management methods\n  async recordLevelUp(userId: string, previousLevel: number, newLevel: number): Promise<void> {\n    await db.insert(levelUps).values({\n      userId,\n      previousLevel,\n      newLevel,\n      acknowledged: false,\n    });\n    console.log(`üéâ Level up recorded for user ${userId}: ${previousLevel} ‚Üí ${newLevel}`);\n  }\n\n  async getPendingLevelUps(userId: string): Promise<LevelUp[]> {\n    return await db\n      .select()\n      .from(levelUps)\n      .where(and(eq(levelUps.userId, userId), eq(levelUps.acknowledged, false)))\n      .orderBy(desc(levelUps.createdAt));\n  }\n\n  async acknowledgeLevelUp(levelUpId: string): Promise<void> {\n    await db\n      .update(levelUps)\n      .set({ acknowledged: true })\n      .where(eq(levelUps.id, levelUpId));\n  }\n\n  async acknowledgeAllLevelUps(userId: string): Promise<void> {\n    await db\n      .update(levelUps)\n      .set({ acknowledged: true })\n      .where(and(eq(levelUps.userId, userId), eq(levelUps.acknowledged, false)));\n  }\n\n  async getLevelUpById(levelUpId: string): Promise<LevelUp | null> {\n    const [levelUp] = await db\n      .select()\n      .from(levelUps)\n      .where(eq(levelUps.id, levelUpId))\n      .limit(1);\n    return levelUp || null;\n  }\n\n  // Helper method to update specific user stats\n  async updateSpecificUserStats(userId: string, statsUpdate: { currentWinStreak?: number; bestWinStreak?: number; wins?: number; losses?: number; draws?: number }): Promise<void> {\n    await db.update(users).set(statsUpdate).where(eq(users.id, userId));\n  }\n\n  // Alias method for getUserGames\n  async getUserGames(userId: string): Promise<Game[]> {\n    return await db\n      .select()\n      .from(games)\n      .where(or(eq(games.playerXId, userId), eq(games.playerOId, userId)));\n  }\n\n  async recalculateUserStats(userId: string): Promise<void> {\n    // Get all finished games for this user ordered by finish time\n    const userGames = await db\n      .select()\n      .from(games)\n      .where(and(\n        eq(games.status, 'finished'),\n        or(\n          eq(games.playerXId, userId),\n          eq(games.playerOId, userId)\n        )\n      ))\n      .orderBy(desc(games.finishedAt));\n\n    let wins = 0;\n    let losses = 0;\n    let draws = 0;\n    let currentWinStreak = 0;\n    let bestWinStreak = 0;\n    let tempStreak = 0;\n\n    // Calculate basic stats and win streaks\n    userGames.forEach(game => {\n      if (game.winnerId === userId) {\n        wins++;\n      } else if (game.winnerId === null) {\n        draws++;\n      } else {\n        losses++;\n      }\n    });\n\n    // Calculate current win streak from most recent games\n    for (const game of userGames) {\n      if (game.winnerId === userId) {\n        currentWinStreak++;\n      } else {\n        break; // Stop at first non-win\n      }\n    }\n\n    // Calculate best win streak by going through all games in chronological order\n    const chronologicalGames = [...userGames].reverse();\n    for (const game of chronologicalGames) {\n      if (game.winnerId === userId) {\n        tempStreak++;\n        if (tempStreak > bestWinStreak) {\n          bestWinStreak = tempStreak;\n        }\n      } else {\n        tempStreak = 0; // Reset streak on loss or draw\n      }\n    }\n\n    // Update user stats in database\n    await db.update(users).set({\n      wins: wins,\n      losses: losses,\n      draws: draws,\n      currentWinStreak: currentWinStreak,\n      bestWinStreak: bestWinStreak\n    }).where(eq(users.id, userId));\n\n    // Skip expensive achievement validation during normal stats updates for performance\n    // Only run during administrative operations\n    // await this.ensureAllAchievementsUpToDate(userId);\n  }\n\n  async recalculateAllUserStats(): Promise<void> {\n    // Get all users who have played games\n    const allUsers = await db\n      .select({ id: users.id })\n      .from(users)\n      .where(\n        exists(\n          db.select().from(games).where(\n            or(\n              eq(games.playerXId, users.id),\n              eq(games.playerOId, users.id)\n            )\n          )\n        )\n      );\n\n    // Recalculating user statistics in background\n    for (const user of allUsers) {\n      await this.recalculateUserStats(user.id);\n    }\n\n    // Recalculating achievements in background\n    for (const user of allUsers) {\n      await this.recalculateUserAchievements(user.id);\n    }\n  }\n\n  async resetAllBotStats(): Promise<void> {\n    // Reset all bot statistics to zero - only actual gameplay should count\n    //console.log('ü§ñ Resetting all bot statistics to zero...');\n\n    const result = await db\n      .update(users)\n      .set({\n        wins: 0,\n        losses: 0,\n        draws: 0\n      })\n      .where(like(users.id, 'player_%'));\n\n    //console.log('ü§ñ All bot statistics reset to zero - only authentic gameplay will count now');\n\n    // Now recalculate stats based on actual games played\n    const botUsers = await db\n      .select({ id: users.id })\n      .from(users)\n      .where(\n        and(\n          like(users.id, 'player_%'),\n          exists(\n            db.select().from(games).where(\n              or(\n                eq(games.playerXId, users.id),\n                eq(games.playerOId, users.id)\n              )\n            )\n          )\n        )\n      );\n\n    //console.log(`üîÑ Recalculating authentic stats for ${botUsers.length} bots who have played games...`);\n\n    for (const bot of botUsers) {\n      await this.recalculateUserStats(bot.id);\n      //console.log(`‚úÖ Updated authentic stats for bot: ${bot.id}`);\n    }\n\n    //console.log('üéâ Bot stats now reflect only authentic gameplay!');\n  }\n\n  async getUserStats(userId: string): Promise<{ wins: number; losses: number; draws: number }> {\n    const user = await this.getUser(userId);\n    return {\n      wins: user?.wins || 0,\n      losses: user?.losses || 0,\n      draws: user?.draws || 0,\n    };\n  }\n\n  async getOnlineGameStats(userId: string): Promise<{ wins: number; losses: number; draws: number; totalGames: number; currentWinStreak: number; bestWinStreak: number; level: number; winsToNextLevel: number; coins: number }> {\n    // Since we're properly updating user stats in the database, just return the user's stats\n    // This represents their online game performance since we only update stats for online games\n    const user = await this.getUser(userId);\n    if (!user) {\n      return { wins: 0, losses: 0, draws: 0, totalGames: 0, currentWinStreak: 0, bestWinStreak: 0, level: 0, winsToNextLevel: 10, coins: 100 };\n    }\n\n    const wins = user.wins || 0;\n    const losses = user.losses || 0;\n    const draws = user.draws || 0;\n    const currentWinStreak = user.currentWinStreak || 0;\n    const bestWinStreak = user.bestWinStreak || 0;\n\n    // Calculate level based on wins (10 wins = 1 level)\n    const level = getLevelFromWins(wins);\n    const winsToNextLevel = getWinsToNextLevel(wins);\n\n    return {\n      wins,\n      losses,\n      draws,\n      totalGames: wins + losses + draws,\n      currentWinStreak,\n      bestWinStreak,\n      level,\n      winsToNextLevel,\n      coins: user.coins ?? 100\n    };\n  }\n\n  // Blocked Users methods\n  async blockUser(blockerId: string, blockedId: string): Promise<BlockedUser> {\n    const [blocked] = await db\n      .insert(blockedUsers)\n      .values({ blockerId, blockedId })\n      .onConflictDoNothing()\n      .returning();\n    return blocked;\n  }\n\n  async unblockUser(blockerId: string, blockedId: string): Promise<void> {\n    await db\n      .delete(blockedUsers)\n      .where(and(eq(blockedUsers.blockerId, blockerId), eq(blockedUsers.blockedId, blockedId)));\n  }\n\n  async getBlockedUsers(userId: string): Promise<BlockedUser[]> {\n    return await db.select().from(blockedUsers).where(eq(blockedUsers.blockerId, userId));\n  }\n\n  async isUserBlocked(blockerId: string, blockedId: string): Promise<boolean> {\n    const [blocked] = await db\n      .select()\n      .from(blockedUsers)\n      .where(and(eq(blockedUsers.blockerId, blockerId), eq(blockedUsers.blockedId, blockedId)));\n    return !!blocked;\n  }\n\n  async getPlayerRankings(sortBy: string): Promise<any[]> {\n    try {\n      // Get all users with their online game stats\n      const usersWithStats = await db.select({\n        userId: users.id,\n        displayName: users.displayName,\n        firstName: users.firstName,\n        lastName: users.lastName,\n        profileImageUrl: users.profileImageUrl,\n        wins: users.wins,\n        losses: users.losses,\n        draws: users.draws,\n        createdAt: users.createdAt\n      })\n      .from(users)\n      .where(\n        sql`${users.wins} + ${users.losses} + ${users.draws} > 0`\n      );\n\n      // Calculate rankings with additional metrics\n      const rankings = await Promise.all(\n        usersWithStats.map(async (user, index) => {\n          const totalGames = user.wins + user.losses + user.draws;\n          const winRate = totalGames > 0 ? (user.wins / totalGames) * 100 : 0;\n\n          // Get recent games for streak calculation\n          const recentGames = await db.select({\n            winnerId: games.winnerId,\n            status: games.status,\n            createdAt: games.createdAt\n          })\n          .from(games)\n          .where(\n            and(\n              or(\n                eq(games.playerXId, user.userId),\n                eq(games.playerOId, user.userId)\n              ),\n              eq(games.gameMode, 'online'),\n              eq(games.status, 'finished')\n            )\n          )\n          .orderBy(desc(games.createdAt))\n          .limit(10);\n\n          // Calculate current streak\n          let streak = 0;\n          let streakType: 'win' | 'loss' | 'draw' = 'win';\n\n          if (recentGames.length > 0) {\n            const latestGame = recentGames[0];\n            if (latestGame.winnerId === user.userId) {\n              streakType = 'win';\n            } else if (latestGame.winnerId === null) {\n              streakType = 'draw';\n            } else {\n              streakType = 'loss';\n            }\n\n            // Count consecutive games with same result\n            for (const game of recentGames) {\n              let gameResult: 'win' | 'loss' | 'draw';\n              if (game.winnerId === user.userId) {\n                gameResult = 'win';\n              } else if (game.winnerId === null) {\n                gameResult = 'draw';\n              } else {\n                gameResult = 'loss';\n              }\n\n              if (gameResult === streakType) {\n                streak++;\n              } else {\n                break;\n              }\n            }\n          }\n\n          return {\n            userId: user.userId,\n            displayName: user.displayName,\n            firstName: user.firstName,\n            lastName: user.lastName,\n            profileImageUrl: user.profileImageUrl,\n            wins: user.wins,\n            losses: user.losses,\n            draws: user.draws,\n            totalGames,\n            winRate,\n            streak,\n            streakType,\n            rankChange: 0, // Would need previous rankings to calculate\n            createdAt: user.createdAt\n          };\n        })\n      );\n\n      // Sort rankings based on sortBy parameter\n      let sortedRankings;\n      switch (sortBy) {\n        case 'wins':\n          sortedRankings = rankings.sort((a, b) => {\n            if (b.wins !== a.wins) return b.wins - a.wins;\n            return b.winRate - a.winRate; // Secondary sort by win rate\n          });\n          break;\n        case 'totalGames':\n          sortedRankings = rankings.sort((a, b) => {\n            if (b.totalGames !== a.totalGames) return b.totalGames - a.totalGames;\n            return b.winRate - a.winRate; // Secondary sort by win rate\n          });\n          break;\n        case 'winRate':\n        default:\n          sortedRankings = rankings.sort((a, b) => {\n            if (b.winRate !== a.winRate) return b.winRate - a.winRate;\n            if (b.totalGames !== a.totalGames) return b.totalGames - a.totalGames; // Secondary sort by total games\n            return b.wins - a.wins; // Tertiary sort by wins\n          });\n          break;\n      }\n\n      // Add rank numbers\n      return sortedRankings.map((player, index) => ({\n        ...player,\n        rank: index + 1\n      }));\n\n    } catch (error) {\n      console.error('Error fetching player rankings:', error);\n      throw error;\n    }\n  }\n\n  // Achievement operations\n  async createAchievement(achievementData: InsertAchievement): Promise<Achievement> {\n    const [achievement] = await db\n      .insert(achievements)\n      .values(achievementData)\n      .onConflictDoNothing()\n      .returning();\n    return achievement;\n  }\n\n  async getUserAchievements(userId: string): Promise<Achievement[]> {\n    // First get current achievements\n    const currentAchievements = await db\n      .select()\n      .from(achievements)\n      .where(eq(achievements.userId, userId))\n      .orderBy(desc(achievements.unlockedAt));\n\n    // Auto-validate achievements if user has any\n    if (currentAchievements.length > 0) {\n      await this.validateUserAchievements(userId);\n\n      // Get updated achievements after validation\n      return await db\n        .select()\n        .from(achievements)\n        .where(eq(achievements.userId, userId))\n        .orderBy(desc(achievements.unlockedAt));\n    }\n\n    return currentAchievements;\n  }\n\n  async hasAchievement(userId: string, achievementType: string): Promise<boolean> {\n    const [achievement] = await db\n      .select()\n      .from(achievements)\n      .where(and(\n        eq(achievements.userId, userId),\n        eq(achievements.achievementType, achievementType)\n      ));\n    return !!achievement;\n  }\n\n  async validateUserAchievements(userId: string): Promise<void> {\n    try {\n      // Get current user stats\n      const userStats = await this.getUserStats(userId);\n      const totalGames = userStats.wins + userStats.losses + userStats.draws;\n\n      // Get user for win streak data\n      const user = await this.getUser(userId);\n      const bestWinStreak = user?.bestWinStreak || 0;\n\n      // Get existing achievements\n      const existingAchievements = await db\n        .select()\n        .from(achievements)\n        .where(eq(achievements.userId, userId));\n\n      // Define what achievements should exist\n      const shouldHaveAchievements: string[] = [];\n\n      if (userStats.wins >= 1) shouldHaveAchievements.push('first_win');\n      if (bestWinStreak >= 5) shouldHaveAchievements.push('win_streak_5');\n      if (bestWinStreak >= 10) shouldHaveAchievements.push('win_streak_10');\n      if (await this.checkDiagonalWins(userId, 3)) shouldHaveAchievements.push('master_of_diagonals');\n      if (await this.checkComebackCondition(userId)) shouldHaveAchievements.push('comeback_king');\n      if (userStats.wins >= 20) shouldHaveAchievements.push('speed_demon');\n      if (userStats.wins >= 50) shouldHaveAchievements.push('legend');\n      if (userStats.wins >= 100) shouldHaveAchievements.push('champion');\n      if (userStats.wins >= 200) shouldHaveAchievements.push('grandmaster');\n      if (totalGames >= 100) shouldHaveAchievements.push('veteran_player');\n      if (totalGames >= 500) shouldHaveAchievements.push('ultimate_veteran');\n\n      // Check for incorrect achievements\n      const incorrectAchievements = existingAchievements.filter(\n        achievement => !shouldHaveAchievements.includes(achievement.achievementType)\n      );\n\n      // Remove incorrect achievements\n      if (incorrectAchievements.length > 0) {\n        // console.log(`üîÑ Auto-removing ${incorrectAchievements.length} incorrect achievements for user: ${userId}`);\n        await db\n          .delete(achievements)\n          .where(and(\n            eq(achievements.userId, userId),\n            inArray(achievements.achievementType, incorrectAchievements.map(a => a.achievementType))\n          ));\n      }\n\n      // Add missing achievements\n      const existingTypes = existingAchievements.map(a => a.achievementType);\n      const missingAchievements = shouldHaveAchievements.filter(\n        type => !existingTypes.includes(type)\n      );\n\n      if (missingAchievements.length > 0) {\n        // console.log(`üîÑ Auto-adding ${missingAchievements.length} missing achievements for user: ${userId}`);\n\n        const achievementData: Record<string, { name: string; description: string; icon: string }> = {\n          'first_win': { name: 'firstVictoryTitle', description: 'winYourVeryFirstGame', icon: 'üèÜ' },\n          'win_streak_5': { name: 'winStreakMaster', description: 'winFiveConsecutiveGames', icon: 'üî•' },\n          'win_streak_10': { name: 'unstoppable', description: 'winTenConsecutiveGames', icon: '‚ö°' },\n          'master_of_diagonals': { name: 'masterOfDiagonals', description: 'winThreeGamesDiagonally', icon: 'üéØ' },\n          'comeback_king': { name: 'comebackKing', description: 'winAfterLosingFive', icon: 'üëë' },\n          'speed_demon': { name: 'speedDemon', description: 'winTwentyTotalGames', icon: '‚ö°' },\n          'legend': { name: 'legend', description: 'achieveFiftyTotalWins', icon: 'üåü' },\n          'champion': { name: 'champion', description: 'achieveOneHundredTotalWins', icon: 'üëë' },\n          'grandmaster': { name: 'grandmaster', description: 'achieveTwoHundredTotalWins', icon: 'üíé' },\n          'veteran_player': { name: 'veteranPlayer', description: 'playOneHundredTotalGames', icon: 'üéñÔ∏è' },\n          'ultimate_veteran': { name: 'ultimateVeteran', description: 'playFiveHundredTotalGames', icon: 'üî•' }\n        };\n\n        for (const type of missingAchievements) {\n          const data = achievementData[type];\n          if (data) {\n            await db\n              .insert(achievements)\n              .values({\n                userId,\n                achievementType: type,\n                achievementName: data.name,\n                description: data.description,\n                icon: data.icon,\n                metadata: {},\n              })\n              .onConflictDoNothing();\n          }\n        }\n      }\n    } catch (error) {\n      console.error('Error validating achievements:', error);\n    }\n  }\n\n  async recalculateUserAchievements(userId: string): Promise<{ removed: number; added: Achievement[] }> {\n    try {\n      // Recalculating achievements for user\n\n      // Get current user stats\n      const userStats = await this.getUserStats(userId);\n      // Processing user statistics\n\n      // Get existing achievements count first\n      const existingAchievements = await db\n        .select()\n        .from(achievements)\n        .where(eq(achievements.userId, userId));\n\n      // Processing existing achievements\n\n      // Remove all existing achievements for this user\n      await db\n        .delete(achievements)\n        .where(eq(achievements.userId, userId));\n\n      const removedCount = existingAchievements.length;\n      // Removed existing achievements\n\n      // Define correct achievement conditions based on current stats only\n      const newAchievements: Achievement[] = [];\n\n      // Only grant achievements that the user actually qualifies for\n      const totalGames = userStats.wins + userStats.losses + userStats.draws;\n      // Processing detailed statistics\n\n      // Get user for win streak data\n      const user = await this.getUser(userId);\n      const bestWinStreak = user?.bestWinStreak || 0;\n\n      // Check special conditions\n      const hasDiagonalWins = await this.checkDiagonalWins(userId, 3);\n      const hasComeback = await this.checkComebackCondition(userId);\n\n      const achievementRules = [\n        {\n          type: 'first_win',\n          name: 'firstVictoryTitle',\n          description: 'winYourVeryFirstGame',\n          icon: 'üèÜ',\n          condition: userStats.wins >= 1,\n        },\n        {\n          type: 'win_streak_5',\n          name: 'winStreakMaster',\n          description: 'winFiveConsecutiveGames',\n          icon: 'üî•',\n          condition: bestWinStreak >= 5,\n        },\n        {\n          type: 'win_streak_10',\n          name: 'unstoppable',\n          description: 'winTenConsecutiveGames',\n          icon: '‚ö°',\n          condition: bestWinStreak >= 10,\n        },\n        {\n          type: 'master_of_diagonals',\n          name: 'masterOfDiagonals',\n          description: 'winThreeGamesDiagonally',\n          icon: 'üéØ',\n          condition: hasDiagonalWins,\n        },\n        {\n          type: 'comeback_king',\n          name: 'comebackKing',\n          description: 'winAfterLosingFive',\n          icon: 'üëë',\n          condition: hasComeback,\n        },\n        {\n          type: 'speed_demon',\n          name: 'speedDemon',\n          description: 'winTwentyTotalGames',\n          icon: '‚ö°',\n          condition: userStats.wins >= 20,\n        },\n        {\n          type: 'legend',\n          name: 'legend',\n          description: 'achieveFiftyTotalWins',\n          icon: 'üåü',\n          condition: userStats.wins >= 50,\n        },\n        {\n          type: 'champion',\n          name: 'champion',\n          description: 'achieveOneHundredTotalWins',\n          icon: 'üëë',\n          condition: userStats.wins >= 100,\n        },\n        {\n          type: 'veteran_player',\n          name: 'veteranPlayer',\n          description: 'playOneHundredTotalGames',\n          icon: 'üéñÔ∏è',\n          condition: totalGames >= 100,\n        },\n        {\n          type: 'grandmaster',\n          name: 'grandmaster',\n          description: 'achieveTwoHundredTotalWins',\n          icon: 'üíé',\n          condition: userStats.wins >= 200,\n        },\n        {\n          type: 'ultimate_veteran',\n          name: 'ultimateVeteran',\n          description: 'playFiveHundredTotalGames',\n          icon: 'üî•',\n          condition: totalGames >= 500,\n        },\n      ];\n\n      // Grant achievements based on current stats\n      for (const rule of achievementRules) {\n        if (rule.condition) {\n          try {\n            // Creating achievement\n\n            // Create achievement with direct database insert instead of using createAchievement\n            const [newAchievement] = await db\n              .insert(achievements)\n              .values({\n                userId,\n                achievementType: rule.type,\n                achievementName: rule.name,\n                description: rule.description,\n                icon: rule.icon,\n                metadata: {},\n              })\n              .returning();\n\n            if (newAchievement) {\n              newAchievements.push(newAchievement);\n              // Achievement created\n            }\n          } catch (error) {\n            console.error(`‚ùå Error creating achievement ${rule.type}:`, error);\n          }\n        }\n      }\n\n      // Achievement processing completed\n      return { removed: removedCount, added: newAchievements };\n    } catch (error) {\n      console.error('‚ùå Error during achievement recalculation:', error);\n      throw error;\n    }\n  }\n\n  async checkAndGrantAchievements(userId: string, gameResult: 'win' | 'loss' | 'draw', gameData?: any): Promise<Achievement[]> {\n    const newAchievements: Achievement[] = [];\n\n    // Get user stats\n    const userStats = await this.getUserStats(userId);\n\n    // Define achievement conditions\n    const achievementConditions = [\n      {\n        type: 'first_win',\n        name: 'firstVictoryTitle',\n        description: 'winYourVeryFirstGame',\n        icon: 'üèÜ',\n        condition: gameResult === 'win' && userStats.wins === 1,\n      },\n      {\n        type: 'win_streak_5',\n        name: 'winStreakMaster',\n        description: 'winFiveConsecutiveGames',\n        icon: 'üî•',\n        condition: gameResult === 'win' && await this.checkWinStreakAchievement(userId, 5),\n      },\n      {\n        type: 'win_streak_10',\n        name: 'unstoppable',\n        description: 'winTenConsecutiveGames',\n        icon: '‚ö°',\n        condition: gameResult === 'win' && await this.checkWinStreakAchievement(userId, 10),\n      },\n      {\n        type: 'master_of_diagonals',\n        name: 'masterOfDiagonals',\n        description: 'winThreeGamesDiagonally',\n        icon: 'üéØ',\n        condition: gameResult === 'win' && gameData?.winCondition === 'diagonal' && await this.checkDiagonalWins(userId, 3),\n      },\n      {\n        type: 'speed_demon',\n        name: 'speedDemon',\n        description: 'winTwentyTotalGames',\n        icon: '‚ö°',\n        condition: gameResult === 'win' && userStats.wins === 20,\n      },\n      {\n        type: 'veteran_player',\n        name: 'veteranPlayer',\n        description: 'playOneHundredTotalGames',\n        icon: 'üéñÔ∏è',\n        condition: (userStats.wins + userStats.losses + userStats.draws) === 100,\n      },\n      {\n        type: 'comeback_king',\n        name: 'comebackKing',\n        description: 'winAfterLosingFive',\n        icon: 'üëë',\n        condition: gameResult === 'win' && await this.checkComebackCondition(userId),\n      },\n      {\n        type: 'legend',\n        name: 'legend',\n        description: 'achieveFiftyTotalWins',\n        icon: 'üåü',\n        condition: gameResult === 'win' && userStats.wins === 50,\n      },\n      {\n        type: 'champion',\n        name: 'champion',\n        description: 'achieveOneHundredTotalWins',\n        icon: 'üëë',\n        condition: gameResult === 'win' && userStats.wins === 100,\n      },\n      {\n        type: 'grandmaster',\n        name: 'grandmaster',\n        description: 'achieveTwoHundredTotalWins',\n        icon: 'üíé',\n        condition: gameResult === 'win' && userStats.wins === 200,\n      },\n      {\n        type: 'ultimate_veteran',\n        name: 'ultimateVeteran',\n        description: 'playFiveHundredTotalGames',\n        icon: 'üî•',\n        condition: (userStats.wins + userStats.losses + userStats.draws) === 500,\n      },\n    ];\n\n    // Check each achievement condition\n    for (const achievement of achievementConditions) {\n      if (achievement.condition && !await this.hasAchievement(userId, achievement.type)) {\n        try {\n          const newAchievement = await this.createAchievement({\n            userId,\n            achievementType: achievement.type,\n            achievementName: achievement.name,\n            description: achievement.description,\n            icon: achievement.icon,\n            metadata: gameData || {},\n          });\n          if (newAchievement) {\n            newAchievements.push(newAchievement);\n            console.log(`üéâ New achievement unlocked for user ${userId}: ${achievement.type}`);\n\n            // Unlock special themes for certain achievements\n            if (achievement.type === 'win_streak_10') {\n              await this.unlockTheme(userId, 'halloween');\n            } else if (achievement.type === 'speed_demon') {\n              await this.unlockTheme(userId, 'christmas');\n            } else if (achievement.type === 'veteran_player') {\n              await this.unlockTheme(userId, 'summer');\n            }\n          }\n        } catch (error) {\n          console.error('Error creating achievement:', error);\n        }\n      }\n    }\n\n    // Only run expensive validation during administrative operations, not during normal gameplay\n    // await this.ensureAllAchievementsUpToDate(userId); // Commented out to improve move performance\n\n    return newAchievements;\n  }\n\n  // New method to ensure all achievements are up to date based on current stats\n  async ensureAllAchievementsUpToDate(userId: string): Promise<void> {\n    try {\n      // console.log(`üîÑ Ensuring achievements are up to date for user: ${userId}`);\n      const userStats = await this.getUserStats(userId);\n      const totalGames = userStats.wins + userStats.losses + userStats.draws;\n\n      // Get user for win streak data\n      const user = await this.getUser(userId);\n      const bestWinStreak = user?.bestWinStreak || 0;\n\n      // Check diagonal wins count\n      const diagonalWinsCount = await this.checkDiagonalWins(userId, 1) ? await this.getDiagonalWinsCount(userId) : 0;\n\n      // Check comeback condition\n      const hasComeback = await this.checkComebackCondition(userId);\n\n      // Define all possible achievements that should exist based on current stats\n      const allPossibleAchievements = [\n        { type: 'first_win', condition: userStats.wins >= 1 },\n        { type: 'win_streak_5', condition: bestWinStreak >= 5 },\n        { type: 'win_streak_10', condition: bestWinStreak >= 10 },\n        { type: 'master_of_diagonals', condition: diagonalWinsCount >= 3 },\n        { type: 'comeback_king', condition: hasComeback },\n        { type: 'speed_demon', condition: userStats.wins >= 20 },\n        { type: 'legend', condition: userStats.wins >= 50 },\n        { type: 'champion', condition: userStats.wins >= 100 },\n        { type: 'grandmaster', condition: userStats.wins >= 200 },\n        { type: 'veteran_player', condition: totalGames >= 100 },\n        { type: 'ultimate_veteran', condition: totalGames >= 500 },\n      ];\n\n      // Track missing achievements\n      let missingCount = 0;\n\n      // Check each achievement and grant if missing\n      for (const achievement of allPossibleAchievements) {\n        if (achievement.condition && !await this.hasAchievement(userId, achievement.type)) {\n          missingCount++;\n        }\n      }\n\n      if (missingCount > 0) {\n        //console.log(`üîÑ Found ${missingCount} missing achievements for user ${userId}. Running validation...`);\n        await this.validateUserAchievements(userId);\n\n        // After validation, check for theme unlocks\n        await this.checkThemeUnlocks(userId);\n\n        // Achievement validation completed\n      } else {\n        // All achievements up to date\n      }\n    } catch (error) {\n      console.error('Error ensuring achievements are up to date:', error);\n    }\n  }\n\n  private async checkWinStreak(userId: string, requiredStreak: number): Promise<boolean> {\n    // First try to get current streak from user record for efficiency\n    const user = await db\n      .select({ currentWinStreak: users.currentWinStreak })\n      .from(users)\n      .where(eq(users.id, userId))\n      .limit(1);\n\n    if (user[0]?.currentWinStreak >= requiredStreak) {\n      return true;\n    }\n\n    // Fallback to calculating from games if needed (for backward compatibility)\n    const recentGames = await db\n      .select()\n      .from(games)\n      .where(or(\n        eq(games.playerXId, userId),\n        eq(games.playerOId, userId)\n      ))\n      .orderBy(desc(games.finishedAt))\n      .limit(requiredStreak);\n\n    if (recentGames.length < requiredStreak) return false;\n\n    let streak = 0;\n    for (const game of recentGames) {\n      if (game.winnerId === userId) {\n        streak++;\n      } else {\n        break;\n      }\n    }\n\n    return streak >= requiredStreak;\n  }\n\n  private async checkWinStreakAchievement(userId: string, requiredStreak: number): Promise<boolean> {\n    // Check both current win streak and best win streak for achievement eligibility\n    const user = await db\n      .select({ \n        currentWinStreak: users.currentWinStreak,\n        bestWinStreak: users.bestWinStreak \n      })\n      .from(users)\n      .where(eq(users.id, userId))\n      .limit(1);\n\n    const userStats = user[0];\n    if (!userStats) return false;\n\n    // User qualifies if they currently have the streak OR have ever achieved it\n    return (userStats.currentWinStreak >= requiredStreak) || (userStats.bestWinStreak >= requiredStreak);\n  }\n\n  private async checkDiagonalWins(userId: string, requiredWins: number): Promise<boolean> {\n    const diagonalWins = await db\n      .select()\n      .from(games)\n      .where(and(\n        eq(games.winnerId, userId),\n        eq(games.winCondition, 'diagonal')\n      ));\n\n    return diagonalWins.length >= requiredWins;\n  }\n\n  private async getDiagonalWinsCount(userId: string): Promise<number> {\n    const diagonalWins = await db\n      .select()\n      .from(games)\n      .where(and(\n        eq(games.winnerId, userId),\n        eq(games.winCondition, 'diagonal')\n      ));\n\n    return diagonalWins.length;\n  }\n\n  private async checkThemeUnlocks(userId: string): Promise<void> {\n    try {\n      // Check if user has achievements that should unlock themes\n      const userAchievements = await db\n        .select()\n        .from(achievements)\n        .where(eq(achievements.userId, userId));\n\n      const achievementTypes = userAchievements.map(a => a.achievementType);\n\n      // Check theme unlock conditions\n      if (achievementTypes.includes('win_streak_10')) {\n        await this.unlockTheme(userId, 'halloween');\n      }\n      if (achievementTypes.includes('speed_demon')) {\n        await this.unlockTheme(userId, 'christmas');\n      }\n      if (achievementTypes.includes('veteran_player')) {\n        await this.unlockTheme(userId, 'summer');\n      }\n    } catch (error) {\n      console.error('Error checking theme unlocks:', error);\n    }\n  }\n\n  private async checkComebackCondition(userId: string): Promise<boolean> {\n    const recentGames = await db\n      .select()\n      .from(games)\n      .where(or(\n        eq(games.playerXId, userId),\n        eq(games.playerOId, userId)\n      ))\n      .orderBy(desc(games.finishedAt))\n      .limit(6);\n\n    if (recentGames.length < 6) return false;\n\n    // Check if latest game is a win\n    const latestGame = recentGames[0];\n    if (latestGame.winnerId !== userId) return false;\n\n    // Check if previous 5 games were losses\n    for (let i = 1; i < 6; i++) {\n      const game = recentGames[i];\n      if (game.winnerId === userId || game.winnerId === null) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  // Theme operations\n  async unlockTheme(userId: string, themeName: string): Promise<UserTheme> {\n    const [theme] = await db\n      .insert(userThemes)\n      .values({\n        userId,\n        themeName,\n        isUnlocked: true,\n      })\n      .onConflictDoUpdate({\n        target: [userThemes.userId, userThemes.themeName],\n        set: {\n          isUnlocked: true,\n          unlockedAt: new Date(),\n        },\n      })\n      .returning();\n    return theme;\n  }\n\n  async getUserThemes(userId: string): Promise<UserTheme[]> {\n    return await db\n      .select()\n      .from(userThemes)\n      .where(and(\n        eq(userThemes.userId, userId),\n        eq(userThemes.isUnlocked, true)\n      ))\n      .orderBy(desc(userThemes.unlockedAt));\n  }\n\n  async isThemeUnlocked(userId: string, themeName: string): Promise<boolean> {\n    const [theme] = await db\n      .select()\n      .from(userThemes)\n      .where(and(\n        eq(userThemes.userId, userId),\n        eq(userThemes.themeName, themeName),\n        eq(userThemes.isUnlocked, true)\n      ));\n    return !!theme;\n  }\n\n  // Friend operations\n  async sendFriendRequest(requesterId: string, requestedId: string): Promise<FriendRequest> {\n    // Check if they're already friends\n    const alreadyFriends = await this.areFriends(requesterId, requestedId);\n    if (alreadyFriends) {\n      throw new Error('Users are already friends');\n    }\n\n    // Check if friend request already exists (in either direction) - check all statuses\n    const existingRequest = await db\n      .select()\n      .from(friendRequests)\n      .where(or(\n        and(\n          eq(friendRequests.requesterId, requesterId),\n          eq(friendRequests.requestedId, requestedId)\n        ),\n        and(\n          eq(friendRequests.requesterId, requestedId),\n          eq(friendRequests.requestedId, requesterId)\n        )\n      ));\n\n    if (existingRequest.length > 0) {\n      const request = existingRequest[0];\n      if (request.status === 'pending') {\n        throw new Error('Friend request already exists');\n      } else if (request.status === 'accepted') {\n        // This should not happen if friendship was properly removed, but clean it up\n        await db\n          .delete(friendRequests)\n          .where(eq(friendRequests.id, request.id));\n        console.log('Cleaned up orphaned accepted friend request');\n      } else if (request.status === 'rejected') {\n        // Allow new request if previous was rejected\n        // Delete the old rejected request first\n        await db\n          .delete(friendRequests)\n          .where(eq(friendRequests.id, request.id));\n      }\n    }\n\n    // Try to insert with error handling for constraint violations\n    try {\n      const [friendRequest] = await db\n        .insert(friendRequests)\n        .values({\n          requesterId,\n          requestedId,\n        })\n        .returning();\n\n      return friendRequest;\n    } catch (error: any) {\n      // Handle constraint violations\n      if (error.code === '23505') {\n        // Unique constraint violation - friend request already exists\n        throw new Error('Friend request already exists');\n      }\n      // Re-throw other errors\n      throw error;\n    }\n  }\n\n  async getFriendRequests(userId: string): Promise<(FriendRequest & { requester: User; requested: User })[]> {\n    return await db\n      .select({\n        id: friendRequests.id,\n        requesterId: friendRequests.requesterId,\n        requestedId: friendRequests.requestedId,\n        status: friendRequests.status,\n        sentAt: friendRequests.sentAt,\n        respondedAt: friendRequests.respondedAt,\n        requester: {\n          id: users.id,\n          email: users.email,\n          firstName: users.firstName,\n          lastName: users.lastName,\n          profileImageUrl: users.profileImageUrl,\n          wins: users.wins,\n          losses: users.losses,\n          draws: users.draws,\n          createdAt: users.createdAt,\n          updatedAt: users.updatedAt,\n        },\n        requested: {\n          id: users.id,\n          email: users.email,\n          firstName: users.firstName,\n          lastName: users.lastName,\n          profileImageUrl: users.profileImageUrl,\n          wins: users.wins,\n          losses: users.losses,\n          draws: users.draws,\n          createdAt: users.createdAt,\n          updatedAt: users.updatedAt,\n        },\n      })\n      .from(friendRequests)\n      .leftJoin(users, eq(friendRequests.requesterId, users.id))\n      .where(and(\n        eq(friendRequests.requestedId, userId),\n        eq(friendRequests.status, 'pending')\n      ))\n      .orderBy(desc(friendRequests.sentAt));\n  }\n\n  async respondToFriendRequest(requestId: string, response: 'accepted' | 'rejected'): Promise<void> {\n    const [request] = await db\n      .select()\n      .from(friendRequests)\n      .where(eq(friendRequests.id, requestId));\n\n    if (!request) {\n      throw new Error('Friend request not found');\n    }\n\n    if (request.status !== 'pending') {\n      throw new Error('Friend request already responded to');\n    }\n\n    // Update friend request status\n    await db\n      .update(friendRequests)\n      .set({\n        status: response,\n        respondedAt: new Date(),\n      })\n      .where(eq(friendRequests.id, requestId));\n\n    // If accepted, create friendship\n    if (response === 'accepted') {\n      const user1Id = request.requesterId < request.requestedId ? request.requesterId : request.requestedId;\n      const user2Id = request.requesterId < request.requestedId ? request.requestedId : request.requesterId;\n\n      await db\n        .insert(friendships)\n        .values({\n          user1Id,\n          user2Id,\n        })\n        .onConflictDoNothing();\n    }\n  }\n\n  async getFriends(userId: string): Promise<BasicFriendInfo[]> {\n    const friends = await db\n      .select({\n        id: users.id,\n        username: users.username,\n        displayName: users.displayName,\n        firstName: users.firstName,\n        lastName: users.lastName,\n        profileImageUrl: users.profileImageUrl,\n      })\n      .from(friendships)\n      .innerJoin(users, or(\n        and(eq(friendships.user1Id, userId), eq(friendships.user2Id, users.id)),\n        and(eq(friendships.user2Id, userId), eq(friendships.user1Id, users.id))\n      ))\n      .where(or(\n        eq(friendships.user1Id, userId),\n        eq(friendships.user2Id, userId)\n      ))\n      .orderBy(desc(friendships.becameFriendsAt));\n\n    return friends.filter(friend => friend.id !== null).map(friend => ({\n      id: friend.id!,\n      username: friend.username,\n      displayName: friend.displayName,\n      firstName: friend.firstName,\n      lastName: friend.lastName,\n      profileImageUrl: friend.profileImageUrl,\n    }));\n  }\n\n  async removeFriend(userId: string, friendId: string): Promise<void> {\n    // Delete the friendship record\n    await db\n      .delete(friendships)\n      .where(or(\n        and(eq(friendships.user1Id, userId), eq(friendships.user2Id, friendId)),\n        and(eq(friendships.user1Id, friendId), eq(friendships.user2Id, userId))\n      ));\n\n    // Also delete any accepted friend requests between these users\n    await db\n      .delete(friendRequests)\n      .where(or(\n        and(\n          eq(friendRequests.requesterId, userId),\n          eq(friendRequests.requestedId, friendId),\n          eq(friendRequests.status, 'accepted')\n        ),\n        and(\n          eq(friendRequests.requesterId, friendId),\n          eq(friendRequests.requestedId, userId),\n          eq(friendRequests.status, 'accepted')\n        )\n      ));\n  }\n\n  async areFriends(userId: string, friendId: string): Promise<boolean> {\n    const [friendship] = await db\n      .select()\n      .from(friendships)\n      .where(or(\n        and(eq(friendships.user1Id, userId), eq(friendships.user2Id, friendId)),\n        and(eq(friendships.user1Id, friendId), eq(friendships.user2Id, userId))\n      ));\n\n    return !!friendship;\n  }\n\n  async cleanupFriendshipData(): Promise<void> {\n    try {\n      // Clean up accepted friend requests that don't have corresponding friendships\n      const acceptedRequests = await db\n        .select()\n        .from(friendRequests)\n        .where(eq(friendRequests.status, 'accepted'));\n\n      for (const request of acceptedRequests) {\n        const friendshipExists = await this.areFriends(request.requesterId, request.requestedId);\n\n        if (!friendshipExists) {\n          // Delete orphaned accepted friend request instead of creating friendship\n          // This prevents the \"already friends\" error when trying to send new requests\n          await db\n            .delete(friendRequests)\n            .where(eq(friendRequests.id, request.id));\n\n          //console.log(`Removed orphaned accepted friend request for users: ${request.requesterId} and ${request.requestedId}`);\n        }\n      }\n\n      // Clean up friend requests that have friendships but are still marked as pending\n      const friendshipsList = await db.select().from(friendships);\n\n      for (const friendship of friendshipsList) {\n        // Check for pending requests between these friends\n        const pendingRequests = await db\n          .select()\n          .from(friendRequests)\n          .where(and(\n            or(\n              and(\n                eq(friendRequests.requesterId, friendship.user1Id),\n                eq(friendRequests.requestedId, friendship.user2Id)\n              ),\n              and(\n                eq(friendRequests.requesterId, friendship.user2Id),\n                eq(friendRequests.requestedId, friendship.user1Id)\n              )\n            ),\n            eq(friendRequests.status, 'pending')\n          ));\n\n        // Update pending requests to accepted since friendship exists\n        for (const request of pendingRequests) {\n          await db\n            .update(friendRequests)\n            .set({\n              status: 'accepted',\n              respondedAt: new Date(),\n            })\n            .where(eq(friendRequests.id, request.id));\n\n          //console.log(`Updated pending request to accepted for users: ${request.requesterId} and ${request.requestedId}`);\n        }\n      }\n\n      console.log('Friendship data cleanup completed');\n    } catch (error) {\n      console.error('Error during friendship data cleanup:', error);\n    }\n  }\n\n  async getHeadToHeadStats(userId: string, friendId: string): Promise<{\n    totalGames: number;\n    userWins: number;\n    friendWins: number;\n    draws: number;\n    userWinRate: number;\n    friendWinRate: number;\n  }> {\n    const headToHeadGames = await db\n      .select()\n      .from(games)\n      .where(and(\n        eq(games.gameMode, 'online'),\n        eq(games.status, 'finished'),\n        or(\n          and(eq(games.playerXId, userId), eq(games.playerOId, friendId)),\n          and(eq(games.playerXId, friendId), eq(games.playerOId, userId))\n        )\n      ));\n\n    const totalGames = headToHeadGames.length;\n    let userWins = 0;\n    let friendWins = 0;\n    let draws = 0;\n\n    headToHeadGames.forEach(game => {\n      if (game.winnerId === userId) {\n        userWins++;\n      } else if (game.winnerId === friendId) {\n        friendWins++;\n      } else {\n        draws++;\n      }\n    });\n\n    const userWinRate = totalGames > 0 ? Math.round((userWins / totalGames) * 100) : 0;\n    const friendWinRate = totalGames > 0 ? Math.round((friendWins / totalGames) * 100) : 0;\n\n    return {\n      totalGames,\n      userWins,\n      friendWins,\n      draws,\n      userWinRate,\n      friendWinRate,\n    };\n  }\n\n  // Room Invitation operations\n  async sendRoomInvitation(roomId: string, inviterId: string, invitedId: string): Promise<RoomInvitation> {\n    // First, clean up expired invitations\n    await this.expireOldInvitations();\n\n    // Remove any existing invitations for this room and user (regardless of status)\n    // This ensures we can always send a new invitation\n    await db\n      .delete(roomInvitations)\n      .where(\n        and(\n          sql`${roomInvitations.roomId}::text = ${roomId}`,\n          sql`${roomInvitations.invitedId} = ${invitedId}`\n        )\n      );\n\n    // Check if active invitation already exists (not expired) - this should now be unnecessary but kept as safety check\n    const existingInvitation = await db\n      .select()\n      .from(roomInvitations)\n      .where(\n        and(\n          sql`${roomInvitations.roomId}::text = ${roomId}`,\n          sql`${roomInvitations.invitedId} = ${invitedId}`,\n          eq(roomInvitations.status, 'pending'),\n          sql`${roomInvitations.expiresAt} > NOW()`\n        )\n      );\n\n    if (existingInvitation.length > 0) {\n      throw new Error('Invitation already sent to this user for this room');\n    }\n\n    // Create expiration date (30 seconds from now)\n    const expiresAt = new Date();\n    expiresAt.setSeconds(expiresAt.getSeconds() + 30);\n\n    const [invitation] = await db\n      .insert(roomInvitations)\n      .values({\n        roomId,\n        inviterId,\n        invitedId,\n        expiresAt,\n      })\n      .returning();\n\n    return invitation;\n  }\n\n  async getRoomInvitations(userId: string): Promise<(RoomInvitation & { room: Room; inviter: User; invited: User })[]> {\n    // First, clean up expired invitations\n    await this.expireOldInvitations();\n    const invitations = await db\n      .select({\n        id: roomInvitations.id,\n        roomId: roomInvitations.roomId,\n        inviterId: roomInvitations.inviterId,\n        invitedId: roomInvitations.invitedId,\n        status: roomInvitations.status,\n        invitedAt: roomInvitations.invitedAt,\n        respondedAt: roomInvitations.respondedAt,\n        expiresAt: roomInvitations.expiresAt,\n        room: rooms,\n        inviter: {\n          id: users.id,\n          email: users.email,\n          firstName: users.firstName,\n          lastName: users.lastName,\n          displayName: users.displayName,\n          username: users.username,\n          profileImageUrl: users.profileImageUrl,\n          wins: users.wins,\n          losses: users.losses,\n          draws: users.draws,\n          createdAt: users.createdAt,\n          updatedAt: users.updatedAt,\n        },\n        invited: {\n          id: users.id,\n          email: users.email,\n          firstName: users.firstName,\n          lastName: users.lastName,\n          displayName: users.displayName,\n          username: users.username,\n          profileImageUrl: users.profileImageUrl,\n          wins: users.wins,\n          losses: users.losses,\n          draws: users.draws,\n          createdAt: users.createdAt,\n          updatedAt: users.updatedAt,\n        }\n      })\n      .from(roomInvitations)\n      .innerJoin(rooms, sql`${roomInvitations.roomId}::text = ${rooms.id}::text`)\n      .innerJoin(users, sql`${roomInvitations.inviterId} = ${users.id}`)\n      .where(\n        and(\n          sql`${roomInvitations.invitedId} = ${userId}`,\n          eq(roomInvitations.status, 'pending'),\n          sql`${roomInvitations.expiresAt} > NOW()`\n        )\n      )\n      .orderBy(desc(roomInvitations.invitedAt));\n\n    return invitations.map(inv => ({\n      ...inv,\n      inviter: inv.inviter,\n      invited: inv.invited\n    }));\n  }\n\n  async respondToRoomInvitation(invitationId: string, response: 'accepted' | 'rejected'): Promise<void> {\n    // Clean up expired invitations first\n    await this.expireOldInvitations();\n\n    await db\n      .update(roomInvitations)\n      .set({\n        status: response,\n        respondedAt: new Date(),\n      })\n      .where(sql`${roomInvitations.id}::text = ${invitationId}`);\n  }\n\n  async expireOldInvitations(): Promise<void> {\n    try {\n      // Update expired invitations to 'expired' status\n      await db\n        .update(roomInvitations)\n        .set({ \n          status: 'expired',\n          respondedAt: sql`NOW()`\n        })\n        .where(\n          and(\n            eq(roomInvitations.status, 'pending'),\n            sql`${roomInvitations.expiresAt} <= NOW()`\n          )\n        );\n    } catch (error) {\n      console.error('Error expiring old invitations:', error);\n    }\n  }\n\n  async updateSelectedAchievementBorder(userId: string, achievementType: string | null): Promise<void> {\n    try {\n      await db\n        .update(users)\n        .set({ \n          selectedAchievementBorder: achievementType,\n          updatedAt: new Date()\n        })\n        .where(eq(users.id, userId));\n    } catch (error) {\n      console.error('Error updating selected achievement border:', error);\n      throw error;\n    }\n  }\n\n  // Coin operations\n  async createCoinTransaction(transaction: InsertCoinTransaction): Promise<CoinTransaction> {\n    const [coinTransaction] = await db.insert(coinTransactions).values(transaction).returning();\n    return coinTransaction;\n  }\n\n  async getUserCoins(userId: string): Promise<number> {\n    const [user] = await db.select({ coins: users.coins }).from(users).where(eq(users.id, userId));\n    return user?.coins || 0;\n  }\n\n  async updateUserCoins(userId: string, newBalance: number): Promise<void> {\n    await db.update(users).set({ \n      coins: newBalance,\n      updatedAt: new Date()\n    }).where(eq(users.id, userId));\n  }\n\n  async processCoinTransaction(userId: string, amount: number, type: string, gameId?: string): Promise<void> {\n    const currentCoins = await this.getUserCoins(userId);\n    const newBalance = currentCoins + amount;\n\n    // Try to create transaction record, but continue if it fails (missing table)\n    try {\n      await this.createCoinTransaction({\n        userId,\n        gameId,\n        amount,\n        type,\n        balanceBefore: currentCoins,\n        balanceAfter: newBalance\n      });\n    } catch (error) {\n      //console.log('Coin transaction record failed (table may not exist), continuing with balance update:', error);\n    }\n\n    // Update user's coin balance\n    await this.updateUserCoins(userId, newBalance);\n  }\n\n\n  async getPlayerProfile(playerId: string): Promise<{\n    id: string;\n    username: string;\n    displayName: string;\n    profileImageUrl?: string;\n    wins: number;\n    losses: number;\n    draws: number;\n    totalGames: number;\n    coins: number;\n    level: number;\n    winsToNextLevel: number;\n    createdAt: string;\n    achievements: Array<{\n      id: string;\n      name: string;\n      description: string;\n      icon: string;\n      unlockedAt: string;\n    }>;\n  } | null> {\n    try {\n      // Get user data\n      const user = await db\n        .select()\n        .from(users)\n        .where(eq(users.id, playerId))\n        .limit(1);\n\n      if (user.length === 0) {\n        return null;\n      }\n\n      const userData = user[0];\n\n      // Get user achievements\n      const userAchievements = await db\n        .select()\n        .from(achievements)\n        .where(eq(achievements.userId, playerId))\n        .orderBy(desc(achievements.unlockedAt));\n\n      const totalGames = (userData.wins || 0) + (userData.losses || 0) + (userData.draws || 0);\n      const wins = userData.wins || 0;\n      const level = getLevelFromWins(wins);\n      const winsToNextLevel = getWinsToNextLevel(wins);\n\n      return {\n        id: userData.id,\n        username: userData.username || 'Unknown',\n        displayName: userData.displayName || userData.username || 'Unknown',\n        profileImageUrl: userData.profileImageUrl || undefined,\n        wins: wins,\n        losses: userData.losses || 0,\n        draws: userData.draws || 0,\n        totalGames,\n        coins: userData.coins ?? 100,\n        level: level,\n        winsToNextLevel: winsToNextLevel,\n        createdAt: userData.createdAt?.toISOString() || new Date().toISOString(),\n        achievements: userAchievements.map(achievement => ({\n          id: achievement.id,\n          name: achievement.achievementName,\n          description: achievement.description,\n          icon: achievement.icon,\n          unlockedAt: achievement.unlockedAt?.toISOString() || new Date().toISOString()\n        }))\n      };\n    } catch (error) {\n      console.error('Error fetching player profile:', error);\n      throw error;\n    }\n  }\n\n  async getHeadToHeadStats(currentUserId: string, targetUserId: string): Promise<{\n    totalGames: number;\n    wins: number;\n    losses: number;\n    draws: number;\n    winRate: number;\n    recentGames: Array<{\n      id: string;\n      result: 'win' | 'loss' | 'draw';\n      playedAt: string;\n    }>;\n  }> {\n    try {\n      // Get all games where both players participated\n      const gamesQuery = await db\n        .select()\n        .from(games)\n        .where(\n          and(\n            eq(games.status, 'finished'),\n            or(\n              and(eq(games.playerXId, currentUserId), eq(games.playerOId, targetUserId)),\n              and(eq(games.playerXId, targetUserId), eq(games.playerOId, currentUserId))\n            )\n          )\n        )\n        .orderBy(desc(games.createdAt))\n        .limit(50); // Get last 50 games for recent games section\n\n      let wins = 0;\n      let losses = 0;\n      let draws = 0;\n      const recentGames: Array<{ id: string; result: 'win' | 'loss' | 'draw'; playedAt: string }> = [];\n\n      for (const game of gamesQuery) {\n        let result: 'win' | 'loss' | 'draw';\n\n        if (!game.winnerId) {\n          result = 'draw';\n          draws++;\n        } else if (game.winnerId === currentUserId) {\n          result = 'win';\n          wins++;\n        } else {\n          result = 'loss';\n          losses++;\n        }\n\n        recentGames.push({\n          id: game.id,\n          result,\n          playedAt: game.createdAt || new Date().toISOString()\n        });\n      }\n\n      const totalGames = wins + losses + draws;\n      const winRate = totalGames > 0 ? Math.round((wins / totalGames) * 100) : 0;\n\n      return {\n        totalGames,\n        wins,\n        losses,\n        draws,\n        winRate,\n        recentGames: recentGames.slice(0, 10) // Return only 10 most recent games\n      };\n    } catch (error) {\n      console.error('Error fetching head-to-head stats:', error);\n      throw error;\n    }\n  }\n\n  // Play Again operations\n  async sendPlayAgainRequest(requesterId: string, requestedId: string, gameId: string): Promise<PlayAgainRequest> {\n    // Clean up any existing requests from this game first to prevent duplicates\n    await db.delete(playAgainRequests).where(\n      and(\n        eq(playAgainRequests.gameId, gameId),\n        eq(playAgainRequests.requesterId, requesterId)\n      )\n    );\n\n    const expiresAt = new Date(Date.now() + 5 * 60 * 1000); // 5 minutes from now\n\n    const [request] = await db.insert(playAgainRequests).values({\n      requesterId,\n      requestedId,\n      gameId,\n      expiresAt,\n    }).returning();\n\n    return request;\n  }\n\n  async getPlayAgainRequests(userId: string): Promise<(PlayAgainRequest & { requester: User; requested: User; game: Game })[]> {\n    const requests = await db\n      .select({\n        id: playAgainRequests.id,\n        requesterId: playAgainRequests.requesterId,\n        requestedId: playAgainRequests.requestedId,\n        gameId: playAgainRequests.gameId,\n        status: playAgainRequests.status,\n        requestedAt: playAgainRequests.requestedAt,\n        respondedAt: playAgainRequests.respondedAt,\n        expiresAt: playAgainRequests.expiresAt,\n        requester: {\n          id: users.id,\n          email: users.email,\n          firstName: users.firstName,\n          lastName: users.lastName,\n          displayName: users.displayName,\n          username: users.username,\n          profileImageUrl: users.profileImageUrl,\n          isGuest: users.isGuest,\n          guestSessionExpiry: users.guestSessionExpiry,\n          wins: users.wins,\n          losses: users.losses,\n          draws: users.draws,\n          coins: users.coins,\n          currentWinStreak: users.currentWinStreak,\n          bestWinStreak: users.bestWinStreak,\n          selectedAchievementBorder: users.selectedAchievementBorder,\n          createdAt: users.createdAt,\n          updatedAt: users.updatedAt,\n        },\n        requested: {\n          id: users.id,\n          email: users.email,\n          firstName: users.firstName,\n          lastName: users.lastName,\n          displayName: users.displayName,\n          username: users.username,\n          profileImageUrl: users.profileImageUrl,\n          isGuest: users.isGuest,\n          guestSessionExpiry: users.guestSessionExpiry,\n          wins: users.wins,\n          losses: users.losses,\n          draws: users.draws,\n          coins: users.coins,\n          currentWinStreak: users.currentWinStreak,\n          bestWinStreak: users.bestWinStreak,\n          selectedAchievementBorder: users.selectedAchievementBorder,\n          createdAt: users.createdAt,\n          updatedAt: users.updatedAt,\n        },\n        game: {\n          id: games.id,\n          roomId: games.roomId,\n          playerXId: games.playerXId,\n          playerOId: games.playerOId,\n          currentPlayer: games.currentPlayer,\n          gameMode: games.gameMode,\n          status: games.status,\n          winnerId: games.winnerId,\n          winCondition: games.winCondition,\n          board: games.board,\n          lastMoveAt: games.lastMoveAt,\n          playerXAutoPlay: games.playerXAutoPlay,\n          playerOAutoPlay: games.playerOAutoPlay,\n          playerXAutoPlaySince: games.playerXAutoPlaySince,\n          playerOAutoPlaySince: games.playerOAutoPlaySince,\n          createdAt: games.createdAt,\n          finishedAt: games.finishedAt,\n        },\n      })\n      .from(playAgainRequests)\n      .leftJoin(users, sql`${playAgainRequests.requesterId}::text = ${users.id}::text`)\n      .leftJoin(games, sql`${playAgainRequests.gameId}::text = ${games.id}::text`)\n      .where(\n        and(\n          or(\n            sql`${playAgainRequests.requesterId}::text = ${userId}`,\n            sql`${playAgainRequests.requestedId}::text = ${userId}`\n          ),\n          eq(playAgainRequests.status, 'pending'),\n          sql`${playAgainRequests.expiresAt} > NOW()`\n        )\n      )\n      .orderBy(desc(playAgainRequests.requestedAt));\n\n    return requests as (PlayAgainRequest & { requester: User; requested: User; game: Game })[];\n  }\n\n  async respondToPlayAgainRequest(requestId: string, response: 'accepted' | 'rejected'): Promise<void> {\n    // Delete the request immediately after processing - no need to keep accepted/rejected requests\n    await db.delete(playAgainRequests).where(eq(playAgainRequests.id, requestId));\n  }\n\n  async expireOldPlayAgainRequests(): Promise<void> {\n    await db.update(playAgainRequests).set({\n      status: 'expired',\n    }).where(\n      and(\n        eq(playAgainRequests.status, 'pending'),\n        sql`${playAgainRequests.expiresAt} <= NOW()`\n      )\n    );\n  }\n\n  async getActivePlayAgainRequest(gameId: string, requesterId: string): Promise<PlayAgainRequest | undefined> {\n    const [request] = await db\n      .select()\n      .from(playAgainRequests)\n      .where(\n        and(\n          eq(playAgainRequests.gameId, gameId),\n          eq(playAgainRequests.requesterId, requesterId),\n          eq(playAgainRequests.status, 'pending'),\n          sql`${playAgainRequests.expiresAt} > NOW()`\n        )\n      );\n\n    return request;\n  }\n\n  // Monthly Leaderboard methods\n  async getOrCreateMonthlyStats(userId: string, month: number, year: number): Promise<MonthlyLeaderboard> {\n    // Use atomic upsert to prevent race conditions\n    // First try to insert, then select if it already exists\n    try {\n      const [newStats] = await db\n        .insert(monthlyLeaderboard)\n        .values({\n          userId,\n          month,\n          year,\n        })\n        .onConflictDoNothing()\n        .returning();\n\n      if (newStats) {\n        return newStats;\n      }\n    } catch (error) {\n      // If there's any error during insert, fall through to select\n    }\n\n    // Record already exists, fetch it\n    const [existing] = await db\n      .select()\n      .from(monthlyLeaderboard)\n      .where(\n        and(\n          eq(monthlyLeaderboard.userId, userId),\n          eq(monthlyLeaderboard.month, month),\n          eq(monthlyLeaderboard.year, year)\n        )\n      );\n\n    if (!existing) {\n      throw new Error(`Failed to create or retrieve monthly stats for user ${userId}, month ${month}, year ${year}`);\n    }\n\n    return existing;\n  }\n\n  async updateMonthlyStats(userId: string, result: 'win' | 'loss' | 'draw', coinsEarned: number): Promise<void> {\n    const now = new Date();\n    const month = now.getMonth() + 1;\n    const year = now.getFullYear();\n\n    // Ensure stats record exists\n    const stats = await this.getOrCreateMonthlyStats(userId, month, year);\n\n    // Use atomic SQL-level increments to prevent race conditions\n    if (result === 'win') {\n      await db.execute(sql`\n        UPDATE monthly_leaderboard \n        SET \n          monthly_games = COALESCE(monthly_games, 0) + 1,\n          monthly_wins = COALESCE(monthly_wins, 0) + 1,\n          monthly_win_streak = COALESCE(monthly_win_streak, 0) + 1,\n          best_monthly_win_streak = GREATEST(COALESCE(best_monthly_win_streak, 0), COALESCE(monthly_win_streak, 0) + 1),\n          coins_earned = COALESCE(coins_earned, 0) + ${coinsEarned},\n          updated_at = ${now}\n        WHERE id = ${stats.id}\n      `);\n    } else if (result === 'loss') {\n      await db.execute(sql`\n        UPDATE monthly_leaderboard \n        SET \n          monthly_games = COALESCE(monthly_games, 0) + 1,\n          monthly_losses = COALESCE(monthly_losses, 0) + 1,\n          monthly_win_streak = 0,\n          coins_earned = COALESCE(coins_earned, 0) + ${coinsEarned},\n          updated_at = ${now}\n        WHERE id = ${stats.id}\n      `);\n    } else if (result === 'draw') {\n      await db.execute(sql`\n        UPDATE monthly_leaderboard \n        SET \n          monthly_games = COALESCE(monthly_games, 0) + 1,\n          monthly_draws = COALESCE(monthly_draws, 0) + 1,\n          monthly_win_streak = 0,\n          coins_earned = COALESCE(coins_earned, 0) + ${coinsEarned},\n          updated_at = ${now}\n        WHERE id = ${stats.id}\n      `);\n    }\n  }\n\n  async getMonthlyLeaderboard(month: number, year: number, limit: number = 50): Promise<Array<MonthlyLeaderboard & { user: User; rank: number }>> {\n    const leaderboard = await db\n      .select({\n        id: monthlyLeaderboard.id,\n        userId: monthlyLeaderboard.userId,\n        month: monthlyLeaderboard.month,\n        year: monthlyLeaderboard.year,\n        monthlyWins: monthlyLeaderboard.monthlyWins,\n        monthlyLosses: monthlyLeaderboard.monthlyLosses,\n        monthlyDraws: monthlyLeaderboard.monthlyDraws,\n        monthlyGames: monthlyLeaderboard.monthlyGames,\n        monthlyWinStreak: monthlyLeaderboard.monthlyWinStreak,\n        bestMonthlyWinStreak: monthlyLeaderboard.bestMonthlyWinStreak,\n        coinsEarned: monthlyLeaderboard.coinsEarned,\n        rewardReceived: monthlyLeaderboard.rewardReceived,\n        finalRank: monthlyLeaderboard.finalRank,\n        rewardAmount: monthlyLeaderboard.rewardAmount,\n        createdAt: monthlyLeaderboard.createdAt,\n        updatedAt: monthlyLeaderboard.updatedAt,\n        user: {\n          id: users.id,\n          email: users.email,\n          firstName: users.firstName,\n          lastName: users.lastName,\n          displayName: users.displayName,\n          username: users.username,\n          profileImageUrl: users.profileImageUrl,\n          isGuest: users.isGuest,\n          guestSessionExpiry: users.guestSessionExpiry,\n          wins: users.wins,\n          losses: users.losses,\n          draws: users.draws,\n          coins: users.coins,\n          currentWinStreak: users.currentWinStreak,\n          bestWinStreak: users.bestWinStreak,\n          selectedAchievementBorder: users.selectedAchievementBorder,\n          createdAt: users.createdAt,\n          updatedAt: users.updatedAt,\n        },\n      })\n      .from(monthlyLeaderboard)\n      .leftJoin(users, eq(monthlyLeaderboard.userId, users.id))\n      .where(\n        and(\n          eq(monthlyLeaderboard.month, month),\n          eq(monthlyLeaderboard.year, year),\n          gt(monthlyLeaderboard.monthlyGames, 0)\n        )\n      )\n      .orderBy(\n        desc(monthlyLeaderboard.monthlyWins),\n        desc(monthlyLeaderboard.monthlyGames),\n        desc(monthlyLeaderboard.bestMonthlyWinStreak),\n        desc(monthlyLeaderboard.coinsEarned),\n        monthlyLeaderboard.userId // Final deterministic tie-breaker\n      )\n      .limit(limit);\n\n    return leaderboard.map((entry, index) => ({\n      ...entry,\n      rank: index + 1,\n    })) as Array<MonthlyLeaderboard & { user: User; rank: number }>;\n  }\n\n  async getCurrentMonthLeaderboard(limit: number = 50): Promise<Array<MonthlyLeaderboard & { user: User; rank: number }>> {\n    const now = new Date();\n    const month = now.getMonth() + 1;\n    const year = now.getFullYear();\n    return this.getMonthlyLeaderboard(month, year, limit);\n  }\n\n  async getTimeUntilMonthEnd(): Promise<{ days: number; hours: number; minutes: number; seconds: number }> {\n    const now = new Date();\n    // Use UTC to avoid timezone issues - consistent with server operations\n    const currentYear = now.getUTCFullYear();\n    const currentMonth = now.getUTCMonth();\n    \n    // First day of next month in UTC\n    const nextMonth = new Date(Date.UTC(currentYear, currentMonth + 1, 1));\n    const timeLeft = nextMonth.getTime() - now.getTime();\n\n    const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));\n    const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n    const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));\n    const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);\n\n    return { days, hours, minutes, seconds };\n  }\n\n  async distributeMonthlyRewards(month: number, year: number): Promise<MonthlyReward[]> {\n    // Use transaction with proper locking and idempotency to prevent race conditions\n    return await db.transaction(async (tx) => {\n      // Use advisory lock to prevent concurrent reward distribution for same month/year\n      const lockKey = month * 10000 + year; // e.g., 202501 for Jan 2025\n      await tx.execute(sql`SELECT pg_advisory_xact_lock(${lockKey})`);\n\n      // Check if rewards have already been distributed for this month/year\n      const existingRewards = await tx\n        .select()\n        .from(monthlyRewards)\n        .where(\n          and(\n            eq(monthlyRewards.month, month),\n            eq(monthlyRewards.year, year)\n          )\n        )\n        .limit(1);\n\n      if (existingRewards.length > 0) {\n        // Rewards already distributed, return existing rewards\n        return await tx\n          .select()\n          .from(monthlyRewards)\n          .where(\n            and(\n              eq(monthlyRewards.month, month),\n              eq(monthlyRewards.year, year)\n            )\n          )\n          .orderBy(monthlyRewards.rank);\n      }\n\n      // Get final leaderboard snapshot for this month/year\n      const topPlayers = await this.getMonthlyLeaderboard(month, year, 3);\n      const rewardAmounts = [50000, 30000, 10000]; // 1st, 2nd, 3rd place rewards\n      const rewards: MonthlyReward[] = [];\n\n      for (let i = 0; i < Math.min(topPlayers.length, 3); i++) {\n        const player = topPlayers[i];\n        const rank = i + 1;\n        const rewardAmount = rewardAmounts[i];\n\n        // Create reward record (idempotent via unique constraint)\n        const [reward] = await tx\n          .insert(monthlyRewards)\n          .values({\n            userId: player.userId,\n            month,\n            year,\n            rank,\n            rewardAmount,\n          })\n          .onConflictDoNothing()\n          .returning();\n\n        if (reward) {\n          // Update user's coins atomically\n          await tx.execute(sql`\n            UPDATE users \n            SET coins = COALESCE(coins, 0) + ${rewardAmount}\n            WHERE id = ${player.userId}\n          `);\n\n          // Update monthly leaderboard record\n          await tx\n            .update(monthlyLeaderboard)\n            .set({\n              rewardReceived: true,\n              finalRank: rank,\n              rewardAmount: rewardAmount,\n            })\n            .where(eq(monthlyLeaderboard.id, player.id));\n\n          // Create coin transaction record\n          await tx\n            .insert(coinTransactions)\n            .values({\n              userId: player.userId,\n              amount: rewardAmount,\n              type: 'monthly_reward',\n              description: `Monthly leaderboard reward for rank ${rank}`,\n            })\n            .onConflictDoNothing();\n\n          rewards.push(reward);\n        }\n      }\n\n      return rewards;\n    });\n  }\n\n  // Monthly Reset Status operations\n  async createMonthlyResetTable(): Promise<void> {\n    await db.execute(sql`\n      CREATE TABLE IF NOT EXISTS monthly_reset_status (\n        id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n        month INTEGER NOT NULL,\n        year INTEGER NOT NULL,\n        status VARCHAR NOT NULL CHECK (status IN ('pending', 'in_progress', 'completed', 'failed')),\n        started_at TIMESTAMP,\n        completed_at TIMESTAMP,\n        error_message TEXT,\n        retry_count INTEGER DEFAULT 0,\n        next_retry_at TIMESTAMP,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n      )\n    `);\n    \n    // Add unique constraint\n    try {\n      await db.execute(sql`\n        CREATE UNIQUE INDEX IF NOT EXISTS unique_monthly_reset \n        ON monthly_reset_status(month, year)\n      `);\n    } catch (e) {\n      // Index may already exist\n    }\n  }\n\n  async getResetStatus(month: number, year: number): Promise<MonthlyResetStatus | undefined> {\n    const [status] = await db\n      .select()\n      .from(monthlyResetStatus)\n      .where(\n        and(\n          eq(monthlyResetStatus.month, month),\n          eq(monthlyResetStatus.year, year)\n        )\n      );\n    return status;\n  }\n\n  async createResetStatus(month: number, year: number): Promise<MonthlyResetStatus> {\n    const [status] = await db\n      .insert(monthlyResetStatus)\n      .values({\n        month,\n        year,\n        status: 'pending',\n      })\n      .onConflictDoNothing()\n      .returning();\n    \n    if (!status) {\n      // Record already exists, return it\n      return (await this.getResetStatus(month, year))!;\n    }\n    \n    return status;\n  }\n\n  async updateResetStatus(id: string, status: 'pending' | 'in_progress' | 'completed' | 'failed', errorMessage?: string): Promise<void> {\n    const updateData: any = {\n      status,\n      updatedAt: new Date(),\n    };\n\n    if (status === 'in_progress') {\n      updateData.startedAt = new Date();\n    } else if (status === 'completed') {\n      updateData.completedAt = new Date();\n      updateData.errorMessage = null; // Clear any previous error\n    } else if (status === 'failed' && errorMessage) {\n      updateData.errorMessage = errorMessage;\n    }\n\n    await db\n      .update(monthlyResetStatus)\n      .set(updateData)\n      .where(eq(monthlyResetStatus.id, id));\n  }\n\n  async incrementRetryCount(id: string, nextRetryAt?: Date): Promise<void> {\n    await db\n      .update(monthlyResetStatus)\n      .set({\n        retryCount: sql`${monthlyResetStatus.retryCount} + 1`,\n        nextRetryAt,\n        updatedAt: new Date(),\n      })\n      .where(eq(monthlyResetStatus.id, id));\n  }\n\n  async getPendingResets(): Promise<MonthlyResetStatus[]> {\n    return await db\n      .select()\n      .from(monthlyResetStatus)\n      .where(\n        or(\n          eq(monthlyResetStatus.status, 'pending'),\n          and(\n            eq(monthlyResetStatus.status, 'failed'),\n            or(\n              isNull(monthlyResetStatus.nextRetryAt),\n              lt(monthlyResetStatus.nextRetryAt, new Date())\n            )\n          )\n        )\n      )\n      .orderBy(monthlyResetStatus.year, monthlyResetStatus.month);\n  }\n\n  async getFailedResets(): Promise<MonthlyResetStatus[]> {\n    return await db\n      .select()\n      .from(monthlyResetStatus)\n      .where(eq(monthlyResetStatus.status, 'failed'))\n      .orderBy(desc(monthlyResetStatus.updatedAt));\n  }\n\n  async resetMonthlyStats(month: number, year: number): Promise<void> {\n    // First distribute rewards for the finishing month\n    await this.distributeMonthlyRewards(month, year);\n\n    // Archive the monthly stats by updating finalRank for all participants\n    const allParticipants = await this.getMonthlyLeaderboard(month, year, 1000);\n    \n    for (const participant of allParticipants) {\n      await db\n        .update(monthlyLeaderboard)\n        .set({\n          finalRank: participant.rank,\n        })\n        .where(eq(monthlyLeaderboard.id, participant.id));\n    }\n\n    // The monthly stats are preserved for historical purposes\n    // New month stats will be created automatically when games are played\n  }\n\n  async getMonthlyRewards(userId: string): Promise<MonthlyReward[]> {\n    return await db\n      .select()\n      .from(monthlyRewards)\n      .where(eq(monthlyRewards.userId, userId))\n      .orderBy(desc(monthlyRewards.distributedAt));\n  }\n\n  async hasReceivedMonthlyReward(userId: string, month: number, year: number): Promise<boolean> {\n    const [reward] = await db\n      .select()\n      .from(monthlyRewards)\n      .where(\n        and(\n          eq(monthlyRewards.userId, userId),\n          eq(monthlyRewards.month, month),\n          eq(monthlyRewards.year, year)\n        )\n      );\n\n    return !!reward;\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","size_bytes":108102},"server/test-email.js":{"content":"import nodemailer from 'nodemailer';\nimport fs from 'fs';\nimport path from 'path';\nimport { fileURLToPath } from 'url';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\n// Load email configuration\nconst emailConfigPath = path.join(__dirname, 'config', 'email.json');\nconst emailConfig = JSON.parse(fs.readFileSync(emailConfigPath, 'utf8'));\n\nasync function testEmailDelivery() {\n  console.log('üîß Testing email delivery to samil000828@gmail.com');\n  \n  // Create transporter\n  const transporter = nodemailer.createTransport({\n    host: emailConfig.smtp.host,\n    port: emailConfig.smtp.port,\n    secure: emailConfig.smtp.secure,\n    auth: {\n      user: emailConfig.smtp.auth.user,\n      pass: emailConfig.smtp.auth.pass\n    }\n  });\n\n  // Verify connection\n  try {\n    await transporter.verify();\n    console.log('‚úÖ SMTP connection verified');\n  } catch (error) {\n    console.error('‚ùå SMTP connection failed:', error);\n    return;\n  }\n\n  // Send test email\n  const mailOptions = {\n    from: emailConfig.fromEmail,\n    to: 'samil000828@gmail.com',\n    subject: 'Test Email - Direct Send',\n    text: 'This is a test email sent directly using nodemailer.',\n    html: `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n        <h2>Test Email</h2>\n        <p>This is a test email sent directly using nodemailer to diagnose delivery issues.</p>\n        <p>Time sent: ${new Date().toISOString()}</p>\n      </div>\n    `\n  };\n\n  try {\n    const info = await transporter.sendMail(mailOptions);\n    console.log('‚úÖ Test email sent successfully:', info);\n  } catch (error) {\n    console.error('‚ùå Failed to send test email:', error);\n  }\n}\n\ntestEmailDelivery();","size_bytes":1741},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\nimport { fileURLToPath } from 'url';\n\n// Proper __dirname in ESM\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(__dirname, \"..\", \"client\", \"index.html\");\n\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(__dirname, \"..\", \"dist\", \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2246},"shared/level.ts":{"content":"/**\n * Level system utilities\n * Level is calculated as: level = Math.floor(wins / 60)\n * Each level requires 60 wins\n */\n\nexport const WINS_PER_LEVEL = 60;\n\nexport const getLevelFromWins = (wins: number): number => {\n  return Math.floor((wins ?? 0) / 60);\n};\n\nexport const getWinsToNextLevel = (wins: number): number => {\n  const currentWins = wins ?? 0;\n  return 60 - (currentWins % 60);\n};\n\nexport const getProgressInCurrentLevel = (wins: number): number => {\n  const currentWins = wins ?? 0;\n  return currentWins % 60;\n};\n\nexport const getTotalWinsForLevel = (level: number): number => {\n  return level * 60;\n};","size_bytes":615},"shared/schema.ts":{"content":"import {\n  pgTable,\n  text,\n  varchar,\n  timestamp,\n  jsonb,\n  index,\n  uniqueIndex,\n  serial,\n  integer,\n  boolean,\n  uuid,\n  bigint,\n} from \"drizzle-orm/pg-core\";\nimport { relations } from \"drizzle-orm\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Session storage table - mandatory for Replit Auth\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\n// User storage table - mandatory for Replit Auth\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().notNull(),\n  email: varchar(\"email\").unique(),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  displayName: varchar(\"display_name\"),\n  username: varchar(\"username\").unique(),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  isGuest: boolean(\"is_guest\").default(false), // Flag to identify guest users\n  guestSessionExpiry: timestamp(\"guest_session_expiry\"), // Expiry time for guest sessions\n  wins: integer(\"wins\").default(0),\n  losses: integer(\"losses\").default(0),\n  draws: integer(\"draws\").default(0),\n  coins: bigint(\"coins\", { mode: 'number' }).default(100), // Starting coins for new users\n  currentWinStreak: integer(\"current_win_streak\").default(0), // Current consecutive wins\n  bestWinStreak: integer(\"best_win_streak\").default(0), // Best win streak ever achieved\n  selectedAchievementBorder: varchar(\"selected_achievement_border\"), // Store the selected achievement type for border display\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const rooms = pgTable(\"rooms\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  code: varchar(\"code\", { length: 8 }).notNull().unique(),\n  name: varchar(\"name\").notNull(),\n  maxPlayers: integer(\"max_players\").default(2),\n  isPrivate: boolean(\"is_private\").default(false),\n  ownerId: varchar(\"owner_id\").references(() => users.id),\n  status: varchar(\"status\").default(\"waiting\"), // waiting, playing, finished\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const games = pgTable(\"games\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  roomId: uuid(\"room_id\").references(() => rooms.id),\n  playerXId: varchar(\"player_x_id\").references(() => users.id),\n  playerOId: varchar(\"player_o_id\").references(() => users.id),\n  currentPlayer: varchar(\"current_player\").default(\"X\"), // X or O\n  gameMode: varchar(\"game_mode\").notNull(), // ai, pass-play, online\n  status: varchar(\"status\").default(\"active\"), // active, finished, abandoned\n  winnerId: varchar(\"winner_id\").references(() => users.id),\n  winCondition: varchar(\"win_condition\"), // horizontal, diagonal, draw\n  board: jsonb(\"board\").default('{}'), // position -> player mapping\n  lastMoveAt: timestamp(\"last_move_at\").defaultNow(), // Track last move/game update time for expiration\n  playerXAutoPlay: boolean(\"player_x_auto_play\").default(false), // Is player X in auto-play mode\n  playerOAutoPlay: boolean(\"player_o_auto_play\").default(false), // Is player O in auto-play mode\n  playerXAutoPlaySince: timestamp(\"player_x_auto_play_since\"), // When player X auto-play started\n  playerOAutoPlaySince: timestamp(\"player_o_auto_play_since\"), // When player O auto-play started\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  finishedAt: timestamp(\"finished_at\"),\n});\n\nexport const roomParticipants = pgTable(\"room_participants\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  roomId: uuid(\"room_id\").references(() => rooms.id),\n  userId: varchar(\"user_id\").references(() => users.id),\n  role: varchar(\"role\").notNull(), // player, spectator\n  joinedAt: timestamp(\"joined_at\").defaultNow(),\n});\n\nexport const moves = pgTable(\"moves\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  gameId: uuid(\"game_id\").references(() => games.id),\n  playerId: varchar(\"player_id\").references(() => users.id),\n  position: integer(\"position\").notNull(),\n  symbol: varchar(\"symbol\").notNull(), // X or O\n  moveNumber: integer(\"move_number\").notNull(),\n  timestamp: timestamp(\"timestamp\").defaultNow(),\n});\n\nexport const blockedUsers = pgTable(\"blocked_users\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  blockerId: varchar(\"blocker_id\").references(() => users.id).notNull(),\n  blockedId: varchar(\"blocked_id\").references(() => users.id).notNull(),\n  timestamp: timestamp(\"timestamp\").defaultNow(),\n}, (table) => [\n  // Prevent duplicate blocks\n  index(\"unique_block\").on(table.blockerId, table.blockedId),\n]);\n\nexport const achievements = pgTable(\"achievements\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  userId: varchar(\"user_id\").references(() => users.id).notNull(),\n  achievementType: varchar(\"achievement_type\").notNull(), // first_win, win_streak_5, win_streak_10, master_of_diagonals, speed_demon, etc.\n  achievementName: varchar(\"achievement_name\").notNull(),\n  description: varchar(\"description\").notNull(),\n  icon: varchar(\"icon\").notNull(), // emoji or icon name\n  unlockedAt: timestamp(\"unlocked_at\").defaultNow(),\n  metadata: jsonb(\"metadata\").default('{}'), // additional data like streak count, game time, etc.\n}, (table) => [\n  // Prevent duplicate achievements\n  index(\"unique_achievement\").on(table.userId, table.achievementType),\n]);\n\nexport const userThemes = pgTable(\"user_themes\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  userId: varchar(\"user_id\").references(() => users.id).notNull(),\n  themeName: varchar(\"theme_name\").notNull(), // halloween, christmas, summer, etc.\n  unlockedAt: timestamp(\"unlocked_at\").defaultNow(),\n  isUnlocked: boolean(\"is_unlocked\").default(true),\n}, (table) => [\n  // Prevent duplicate theme unlocks\n  index(\"unique_user_theme\").on(table.userId, table.themeName),\n]);\n\nexport const friendRequests = pgTable(\"friend_requests\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  requesterId: varchar(\"requester_id\").references(() => users.id).notNull(),\n  requestedId: varchar(\"requested_id\").references(() => users.id).notNull(),\n  status: varchar(\"status\").default(\"pending\"), // pending, accepted, rejected\n  sentAt: timestamp(\"sent_at\").defaultNow(),\n  respondedAt: timestamp(\"responded_at\"),\n}, (table) => [\n  // Prevent duplicate friend requests\n  index(\"unique_friend_request\").on(table.requesterId, table.requestedId),\n]);\n\nexport const friendships = pgTable(\"friendships\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  user1Id: varchar(\"user1_id\").references(() => users.id).notNull(),\n  user2Id: varchar(\"user2_id\").references(() => users.id).notNull(),\n  becameFriendsAt: timestamp(\"became_friends_at\").defaultNow(),\n}, (table) => [\n  // Prevent duplicate friendships\n  index(\"unique_friendship\").on(table.user1Id, table.user2Id),\n]);\n\nexport const roomInvitations = pgTable(\"room_invitations\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  roomId: uuid(\"room_id\").references(() => rooms.id).notNull(),\n  inviterId: varchar(\"inviter_id\").references(() => users.id).notNull(),\n  invitedId: varchar(\"invited_id\").references(() => users.id).notNull(),\n  status: varchar(\"status\").default(\"pending\"), // pending, accepted, rejected, expired\n  invitedAt: timestamp(\"invited_at\").defaultNow(),\n  respondedAt: timestamp(\"responded_at\"),\n  expiresAt: timestamp(\"expires_at\").notNull(), // Invitations expire after 24 hours\n}, (table) => [\n  // Prevent duplicate room invitations\n  index(\"unique_room_invitation\").on(table.roomId, table.invitedId),\n]);\n\nexport const coinTransactions = pgTable(\"coins\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  userId: varchar(\"user_id\").references(() => users.id).notNull(),\n  gameId: uuid(\"game_id\").references(() => games.id),\n  amount: bigint(\"amount\", { mode: 'number' }).notNull(), // positive for earned, negative for lost\n  type: varchar(\"type\").notNull(), // game_win, game_loss, game_draw\n  balanceBefore: bigint(\"balance_before\", { mode: 'number' }).notNull(),\n  balanceAfter: bigint(\"balance_after\", { mode: 'number' }).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const playAgainRequests = pgTable(\"play_again_requests\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  requesterId: varchar(\"requester_id\").references(() => users.id).notNull(),\n  requestedId: varchar(\"requested_id\").references(() => users.id).notNull(),\n  gameId: uuid(\"game_id\").references(() => games.id).notNull(), // The finished game that prompted this request\n  status: varchar(\"status\").default(\"pending\"), // pending, accepted, rejected, expired\n  requestedAt: timestamp(\"requested_at\").defaultNow(),\n  respondedAt: timestamp(\"responded_at\"),\n  expiresAt: timestamp(\"expires_at\").notNull(), // Request expires after 5 minutes\n}, (table) => [\n  // Prevent duplicate play again requests for the same game\n  index(\"unique_play_again_request\").on(table.gameId, table.requesterId),\n]);\n\n// Level up notifications table\nexport const levelUps = pgTable(\"level_ups\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  userId: varchar(\"user_id\").references(() => users.id).notNull(),\n  previousLevel: integer(\"previous_level\").notNull(),\n  newLevel: integer(\"new_level\").notNull(),\n  acknowledged: boolean(\"acknowledged\").default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Monthly leaderboard table for tracking monthly statistics\nexport const monthlyLeaderboard = pgTable(\"monthly_leaderboard\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  userId: varchar(\"user_id\").references(() => users.id).notNull(),\n  month: integer(\"month\").notNull(), // 1-12\n  year: integer(\"year\").notNull(),\n  monthlyWins: integer(\"monthly_wins\").default(0),\n  monthlyLosses: integer(\"monthly_losses\").default(0),\n  monthlyDraws: integer(\"monthly_draws\").default(0),\n  monthlyGames: integer(\"monthly_games\").default(0),\n  monthlyWinStreak: integer(\"monthly_win_streak\").default(0),\n  bestMonthlyWinStreak: integer(\"best_monthly_win_streak\").default(0),\n  coinsEarned: bigint(\"coins_earned\", { mode: 'number' }).default(0), // Coins earned this month\n  rewardReceived: boolean(\"reward_received\").default(false),\n  finalRank: integer(\"final_rank\"), // Final rank at month end\n  rewardAmount: bigint(\"reward_amount\", { mode: 'number' }).default(0),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n}, (table) => [\n  // Ensure one record per user per month\n  uniqueIndex(\"unique_user_month\").on(table.userId, table.month, table.year),\n]);\n\n// Monthly rewards history table\nexport const monthlyRewards = pgTable(\"monthly_rewards\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  userId: varchar(\"user_id\").references(() => users.id).notNull(),\n  month: integer(\"month\").notNull(),\n  year: integer(\"year\").notNull(),\n  rank: integer(\"rank\").notNull(), // 1, 2, or 3\n  rewardAmount: bigint(\"reward_amount\", { mode: 'number' }).notNull(),\n  distributedAt: timestamp(\"distributed_at\").defaultNow(),\n}, (table) => [\n  // Ensure one reward per rank per month and one reward per user per month\n  uniqueIndex(\"unique_month_rank\").on(table.year, table.month, table.rank),\n  uniqueIndex(\"unique_user_month_reward\").on(table.userId, table.year, table.month),\n]);\n\nexport const monthlyResetStatus = pgTable(\"monthly_reset_status\", {\n  id: uuid(\"id\").primaryKey().defaultRandom(),\n  month: integer(\"month\").notNull(), // 1-12\n  year: integer(\"year\").notNull(),\n  status: varchar(\"status\").notNull(), // 'pending', 'in_progress', 'completed', 'failed'\n  startedAt: timestamp(\"started_at\"),\n  completedAt: timestamp(\"completed_at\"),\n  errorMessage: text(\"error_message\"),\n  retryCount: integer(\"retry_count\").default(0),\n  nextRetryAt: timestamp(\"next_retry_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n}, (table) => [\n  // Unique constraint - one reset record per month/year\n  uniqueIndex(\"unique_monthly_reset\").on(table.month, table.year),\n]);\n\n// Relations\nexport const usersRelations = relations(users, ({ many }) => ({\n  ownedRooms: many(rooms),\n  gameParticipations: many(roomParticipants),\n  gamesAsX: many(games, { relationName: \"playerX\" }),\n  gamesAsO: many(games, { relationName: \"playerO\" }),\n  wonGames: many(games, { relationName: \"winner\" }),\n  moves: many(moves),\n  blockedUsers: many(blockedUsers, { relationName: \"blocker\" }),\n  blockedByUsers: many(blockedUsers, { relationName: \"blocked\" }),\n  achievements: many(achievements),\n  unlockedThemes: many(userThemes),\n  sentFriendRequests: many(friendRequests, { relationName: \"requester\" }),\n  receivedFriendRequests: many(friendRequests, { relationName: \"requested\" }),\n  friendshipsAsUser1: many(friendships, { relationName: \"user1\" }),\n  friendshipsAsUser2: many(friendships, { relationName: \"user2\" }),\n  sentRoomInvitations: many(roomInvitations, { relationName: \"inviter\" }),\n  receivedRoomInvitations: many(roomInvitations, { relationName: \"invited\" }),\n  coinTransactions: many(coinTransactions),\n  sentPlayAgainRequests: many(playAgainRequests, { relationName: \"requester\" }),\n  receivedPlayAgainRequests: many(playAgainRequests, { relationName: \"requested\" }),\n  levelUps: many(levelUps),\n  monthlyStats: many(monthlyLeaderboard),\n  monthlyRewards: many(monthlyRewards),\n}));\n\nexport const roomsRelations = relations(rooms, ({ one, many }) => ({\n  owner: one(users, { fields: [rooms.ownerId], references: [users.id] }),\n  participants: many(roomParticipants),\n  games: many(games),\n  invitations: many(roomInvitations),\n}));\n\nexport const gamesRelations = relations(games, ({ one, many }) => ({\n  room: one(rooms, { fields: [games.roomId], references: [rooms.id] }),\n  playerX: one(users, { fields: [games.playerXId], references: [users.id], relationName: \"playerX\" }),\n  playerO: one(users, { fields: [games.playerOId], references: [users.id], relationName: \"playerO\" }),\n  winner: one(users, { fields: [games.winnerId], references: [users.id], relationName: \"winner\" }),\n  moves: many(moves),\n  playAgainRequests: many(playAgainRequests),\n}));\n\nexport const roomParticipantsRelations = relations(roomParticipants, ({ one }) => ({\n  room: one(rooms, { fields: [roomParticipants.roomId], references: [rooms.id] }),\n  user: one(users, { fields: [roomParticipants.userId], references: [users.id] }),\n}));\n\nexport const movesRelations = relations(moves, ({ one }) => ({\n  game: one(games, { fields: [moves.gameId], references: [games.id] }),\n  player: one(users, { fields: [moves.playerId], references: [users.id] }),\n}));\n\nexport const blockedUsersRelations = relations(blockedUsers, ({ one }) => ({\n  blocker: one(users, { fields: [blockedUsers.blockerId], references: [users.id], relationName: \"blocker\" }),\n  blocked: one(users, { fields: [blockedUsers.blockedId], references: [users.id], relationName: \"blocked\" }),\n}));\n\nexport const achievementsRelations = relations(achievements, ({ one }) => ({\n  user: one(users, { fields: [achievements.userId], references: [users.id] }),\n}));\n\nexport const userThemesRelations = relations(userThemes, ({ one }) => ({\n  user: one(users, { fields: [userThemes.userId], references: [users.id] }),\n}));\n\nexport const friendRequestsRelations = relations(friendRequests, ({ one }) => ({\n  requester: one(users, { fields: [friendRequests.requesterId], references: [users.id], relationName: \"requester\" }),\n  requested: one(users, { fields: [friendRequests.requestedId], references: [users.id], relationName: \"requested\" }),\n}));\n\nexport const friendshipsRelations = relations(friendships, ({ one }) => ({\n  user1: one(users, { fields: [friendships.user1Id], references: [users.id], relationName: \"user1\" }),\n  user2: one(users, { fields: [friendships.user2Id], references: [users.id], relationName: \"user2\" }),\n}));\n\nexport const roomInvitationsRelations = relations(roomInvitations, ({ one }) => ({\n  room: one(rooms, { fields: [roomInvitations.roomId], references: [rooms.id] }),\n  inviter: one(users, { fields: [roomInvitations.inviterId], references: [users.id], relationName: \"inviter\" }),\n  invited: one(users, { fields: [roomInvitations.invitedId], references: [users.id], relationName: \"invited\" }),\n}));\n\nexport const coinTransactionsRelations = relations(coinTransactions, ({ one }) => ({\n  user: one(users, { fields: [coinTransactions.userId], references: [users.id] }),\n  game: one(games, { fields: [coinTransactions.gameId], references: [games.id] }),\n}));\n\nexport const playAgainRequestsRelations = relations(playAgainRequests, ({ one }) => ({\n  requester: one(users, { fields: [playAgainRequests.requesterId], references: [users.id], relationName: \"requester\" }),\n  requested: one(users, { fields: [playAgainRequests.requestedId], references: [users.id], relationName: \"requested\" }),\n  game: one(games, { fields: [playAgainRequests.gameId], references: [games.id] }),\n}));\n\nexport const monthlyLeaderboardRelations = relations(monthlyLeaderboard, ({ one }) => ({\n  user: one(users, { fields: [monthlyLeaderboard.userId], references: [users.id] }),\n}));\n\nexport const monthlyRewardsRelations = relations(monthlyRewards, ({ one }) => ({\n  user: one(users, { fields: [monthlyRewards.userId], references: [users.id] }),\n}));\n\n// Schemas\nexport const insertRoomSchema = createInsertSchema(rooms).pick({\n  name: true,\n  maxPlayers: true,\n  isPrivate: true,\n});\n\nexport const insertRoomInvitationSchema = createInsertSchema(roomInvitations).pick({\n  roomId: true,\n  invitedId: true,\n});\n\nexport const insertGameSchema = createInsertSchema(games).pick({\n  roomId: true,\n  gameMode: true,\n}).extend({\n  playerXId: z.string().optional(),\n  playerOId: z.string().optional(),\n}).transform((data) => {\n  // Remove null values, keep undefined for optional fields\n  const cleaned = { ...data };\n  Object.keys(cleaned).forEach(key => {\n    if (cleaned[key as keyof typeof cleaned] === null) {\n      delete cleaned[key as keyof typeof cleaned];\n    }\n  });\n  return cleaned;\n});\n\nexport const insertMoveSchema = createInsertSchema(moves).pick({\n  gameId: true,\n  playerId: true,\n  position: true,\n  symbol: true,\n  moveNumber: true,\n});\n\nexport const insertRoomParticipantSchema = createInsertSchema(roomParticipants).pick({\n  roomId: true,\n  userId: true,\n  role: true,\n});\n\nexport const insertBlockedUserSchema = createInsertSchema(blockedUsers).pick({\n  blockerId: true,\n  blockedId: true,\n});\n\nexport const insertAchievementSchema = createInsertSchema(achievements).pick({\n  userId: true,\n  achievementType: true,\n  achievementName: true,\n  description: true,\n  icon: true,\n  metadata: true,\n});\n\nexport const insertUserThemeSchema = createInsertSchema(userThemes).pick({\n  userId: true,\n  themeName: true,\n  isUnlocked: true,\n});\n\nexport const insertFriendRequestSchema = createInsertSchema(friendRequests).pick({\n  requesterId: true,\n  requestedId: true,\n});\n\nexport const insertFriendshipSchema = createInsertSchema(friendships).pick({\n  user1Id: true,\n  user2Id: true,\n});\n\nexport const insertCoinTransactionSchema = createInsertSchema(coinTransactions).pick({\n  userId: true,\n  gameId: true,\n  amount: true,\n  type: true,\n  balanceBefore: true,\n  balanceAfter: true,\n});\n\nexport const insertPlayAgainRequestSchema = createInsertSchema(playAgainRequests).pick({\n  requesterId: true,\n  requestedId: true,\n  gameId: true,\n  expiresAt: true,\n});\n\nexport const insertLevelUpSchema = createInsertSchema(levelUps).pick({\n  userId: true,\n  previousLevel: true,\n  newLevel: true,\n  acknowledged: true,\n});\n\nexport const insertMonthlyLeaderboardSchema = createInsertSchema(monthlyLeaderboard).pick({\n  userId: true,\n  month: true,\n  year: true,\n}).extend({\n  month: z.number().min(1).max(12),\n  year: z.number().min(2000).max(3000),\n});\n\nexport const insertMonthlyRewardSchema = createInsertSchema(monthlyRewards).pick({\n  userId: true,\n  month: true,\n  year: true,\n  rank: true,\n  rewardAmount: true,\n}).extend({\n  month: z.number().min(1).max(12),\n  year: z.number().min(2000).max(3000),\n  rank: z.number().min(1).max(3),\n  rewardAmount: z.number().positive(),\n});\n\nexport const insertMonthlyResetStatusSchema = createInsertSchema(monthlyResetStatus).pick({\n  month: true,\n  year: true,\n  status: true,\n  startedAt: true,\n  completedAt: true,\n  errorMessage: true,\n  retryCount: true,\n  nextRetryAt: true,\n}).extend({\n  month: z.number().min(1).max(12),\n  year: z.number().min(2000).max(3000),\n  status: z.enum(['pending', 'in_progress', 'completed', 'failed']),\n  retryCount: z.number().min(0).default(0),\n});\n\n// Types\nexport type UpsertUser = typeof users.$inferInsert;\nexport type User = typeof users.$inferSelect;\nexport type Room = typeof rooms.$inferSelect;\nexport type Game = typeof games.$inferSelect;\nexport type RoomInvitation = typeof roomInvitations.$inferSelect;\nexport type Move = typeof moves.$inferSelect;\nexport type RoomParticipant = typeof roomParticipants.$inferSelect;\nexport type BlockedUser = typeof blockedUsers.$inferSelect;\nexport type Achievement = typeof achievements.$inferSelect;\nexport type UserTheme = typeof userThemes.$inferSelect;\nexport type FriendRequest = typeof friendRequests.$inferSelect;\nexport type Friendship = typeof friendships.$inferSelect;\n\n// Basic friend info type with only essential fields for fast loading\nexport type BasicFriendInfo = {\n  id: string;\n  username: string | null;\n  displayName: string | null;\n  firstName: string | null;\n  lastName: string | null;\n  profileImageUrl: string | null;\n};\n\nexport type InsertFriendRequest = z.infer<typeof insertFriendRequestSchema>;\nexport type InsertFriendship = z.infer<typeof insertFriendshipSchema>;\nexport type InsertRoom = z.infer<typeof insertRoomSchema>;\nexport type InsertGame = z.infer<typeof insertGameSchema>;\nexport type InsertMove = z.infer<typeof insertMoveSchema>;\nexport type InsertRoomParticipant = z.infer<typeof insertRoomParticipantSchema>;\nexport type InsertBlockedUser = z.infer<typeof insertBlockedUserSchema>;\nexport type InsertAchievement = z.infer<typeof insertAchievementSchema>;\nexport type InsertUserTheme = z.infer<typeof insertUserThemeSchema>;\nexport type InsertRoomInvitation = z.infer<typeof insertRoomInvitationSchema>;\nexport type CoinTransaction = typeof coinTransactions.$inferSelect;\nexport type InsertCoinTransaction = z.infer<typeof insertCoinTransactionSchema>;\n\nexport type PlayAgainRequest = typeof playAgainRequests.$inferSelect;\nexport type InsertPlayAgainRequest = z.infer<typeof insertPlayAgainRequestSchema>;\nexport type LevelUp = typeof levelUps.$inferSelect;\nexport type InsertLevelUp = z.infer<typeof insertLevelUpSchema>;\nexport type MonthlyLeaderboard = typeof monthlyLeaderboard.$inferSelect;\nexport type InsertMonthlyLeaderboard = z.infer<typeof insertMonthlyLeaderboardSchema>;\nexport type MonthlyReward = typeof monthlyRewards.$inferSelect;\nexport type InsertMonthlyReward = z.infer<typeof insertMonthlyRewardSchema>;\nexport type MonthlyResetStatus = typeof monthlyResetStatus.$inferSelect;\nexport type InsertMonthlyResetStatus = z.infer<typeof insertMonthlyResetStatusSchema>;\n","size_bytes":23002},"client/src/App.tsx":{"content":"import { Switch, Route, useLocation } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { ThemeProvider } from \"@/contexts/ThemeContext\";\nimport { ChatProvider } from \"@/contexts/ChatContext\";\nimport { LanguageProvider } from \"@/contexts/LanguageContext\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport Landing from \"@/pages/landing\";\nimport Home from \"@/pages/home\";\nimport Auth from \"@/pages/auth\";\nimport VerifyEmail from \"@/pages/verify-email\";\nimport ResetPassword from \"@/pages/reset-password\";\nimport NotFound from \"@/pages/not-found\";\nimport LoadingScreen from \"@/components/LoadingScreen\";\nimport { Component, useState, useEffect } from \"react\";\n\n// Error boundary to catch white screen crashes\nclass ErrorBoundary extends Component<\n  { children: React.ReactNode },\n  { hasError: boolean }\n> {\n  constructor(props: { children: React.ReactNode }) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError() {\n    return { hasError: true };\n  }\n\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\n    console.error('Error caught by boundary:', error, errorInfo);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center\">\n          <div className=\"text-white text-center\">\n            <h1 className=\"text-2xl font-bold mb-4\">Something went wrong</h1>\n            <button \n              onClick={() => this.setState({ hasError: false })} \n              className=\"bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded\"\n            >\n              Try Again\n            </button>\n          </div>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\nfunction Router() {\n  const { isAuthenticated, isLoading, user } = useAuth();\n  const [location, setLocation] = useLocation();\n  const [hasInitiallyLoaded, setHasInitiallyLoaded] = useState(false);\n  const [isInitialLoad, setIsInitialLoad] = useState(true);\n\n // Global navigation handler\n  useEffect(() => {\n    const handleNavigate = (event: CustomEvent) => {\n      setLocation(event.detail.path);\n    };\n    window.addEventListener('navigate', handleNavigate as EventListener);\n    \n    return () => window.removeEventListener('navigate', handleNavigate as EventListener);\n     }, [setLocation]);\n  // Router render state tracking\n\n  // Define public routes that don't require authentication\n  const publicRoutes = ['/reset-password', '/verify-email', '/auth', '/'];\n\n  // Check if current route is public\n  const isPublicRoute = publicRoutes.includes(location) || location.startsWith('/reset-password') || location.startsWith('/verify-email');\n\n  // Mark as initially loaded once we get the first auth response (success or failure)\n  useEffect(() => {\n    if (!isLoading && !hasInitiallyLoaded) {\n      setHasInitiallyLoaded(true);\n      // Set a flag to indicate we've moved past the initial load - faster for better performance\n      setTimeout(() => {\n        setIsInitialLoad(false);\n      }, 100);\n    }\n  }, [isLoading, hasInitiallyLoaded]);\n\n  // Force loading to complete after 1.5 seconds to prevent infinite loading - faster startup\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      if (!hasInitiallyLoaded) {\n        setHasInitiallyLoaded(true);\n        setIsInitialLoad(false);\n      }\n    }, 1500);\n\n    return () => clearTimeout(timer);\n  }, [hasInitiallyLoaded]);\n\n  // Prevent loading screen from showing on navigations (room exits, page refreshes, etc)\n  useEffect(() => {\n    // If we've already shown the initial loading screen once, don't show it again\n    if (hasInitiallyLoaded) {\n      setIsInitialLoad(false);\n    }\n  }, [location, hasInitiallyLoaded]);\n\n  // Show loading screen during authentication check (but only for a limited time)\n  if (isLoading && !hasInitiallyLoaded && isInitialLoad) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center relative overflow-hidden\">\n        {/* Background animated particles */}\n        <div className=\"absolute inset-0 overflow-hidden\">\n          <div className=\"absolute -top-40 -right-40 w-80 h-80 bg-primary/10 rounded-full blur-3xl animate-pulse\"></div>\n          <div className=\"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500/10 rounded-full blur-3xl animate-pulse animation-delay-1000\"></div>\n          <div className=\"absolute top-1/3 left-1/4 w-60 h-60 bg-purple-500/5 rounded-full blur-3xl animate-pulse animation-delay-2000\"></div>\n        </div>\n\n        {/* Main content */}\n        <div className=\"relative text-center space-y-4\">\n          {/* Made By DarkLayer Studios with enhanced styling */}\n          <div className=\"relative group\">\n            <div className=\"text-2xl md:text-3xl font-bold tracking-wide\">\n              <span className=\"bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent animate-pulse\">\n                Made By\n              </span>\n              <br />\n              <span className=\"bg-gradient-to-r from-pink-400 via-blue-400 to-cyan-400 bg-clip-text text-transparent font-black text-3xl md:text-4xl tracking-wider animate-fade-in animation-delay-500\">\n                DarkLayer Studios\n              </span>\n            </div>\n            \n            {/* Glowing border effect */}\n            <div className=\"absolute inset-0 -z-10 bg-gradient-to-r from-blue-500/20 via-purple-500/20 to-pink-500/20 rounded-lg blur-xl animate-pulse group-hover:blur-2xl transition-all duration-300\"></div>\n            \n            {/* Sparkle effects */}\n            <div className=\"absolute -top-2 -right-2 w-3 h-3 bg-blue-400 rounded-full animate-ping\"></div>\n            <div className=\"absolute -bottom-2 -left-2 w-2 h-2 bg-purple-400 rounded-full animate-ping animation-delay-500\"></div>\n            <div className=\"absolute top-1/2 -left-4 w-1 h-1 bg-pink-400 rounded-full animate-ping animation-delay-1000\"></div>\n          </div>\n\n          {/* Subtitle */}\n          <p className=\"text-slate-400 text-sm md:text-base font-medium animate-fade-in animation-delay-1000 tracking-wide\">\n            Crafting Digital Experiences\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  // About to render content\n\n  // Handle public routes without authentication check\n  if (isPublicRoute) {\n    return (\n      <Switch>\n        <Route path=\"/reset-password\" component={ResetPassword} />\n        <Route path=\"/verify-email\" component={VerifyEmail} />\n        <Route path=\"/auth\">\n          <Auth />\n        </Route>\n        <Route path=\"/\">\n          {isAuthenticated && user ? (\n            (user as any).isEmailVerified ? (\n              <ChatProvider currentUser={user}>\n                <Home />\n              </ChatProvider>\n            ) : <Auth />\n          ) : (\n            <Auth />\n          )}\n        </Route>\n        <Route component={NotFound} />\n      </Switch>\n    );\n  }\n\n  // For protected routes, check authentication\n  if (!isAuthenticated) {\n    // Rendering Auth component - user not authenticated\n    return <Auth />;\n  }\n\n  // If user is authenticated but email is not verified, redirect to auth for verification\n  if (isAuthenticated && user && !(user as any).isEmailVerified) {\n    // Rendering Auth component - email not verified\n    return <Auth />;\n  }\n\n  // User is authenticated and verified, show main app\n  // Rendering main app content\n  const content = (\n    <Switch>\n      <Route path=\"/auth\">\n        <Home />\n      </Route>\n      <Route path=\"/verify-email\" component={VerifyEmail} />\n      <Route path=\"/reset-password\" component={ResetPassword} />\n      <Route path=\"/not-found\" component={NotFound} />\n      <Route path=\"/\">\n        <Home />\n      </Route>\n      <Route component={NotFound} />\n    </Switch>\n  );\n\n  return (\n    <ChatProvider currentUser={user}>\n      {content}\n    </ChatProvider>\n  );\n}\n\nfunction App() {\n  const [showLoading, setShowLoading] = useState(true);\n\n  useEffect(() => {\n    // Show loading screen for 2.5 seconds (same as auth loading)\n    const timer = setTimeout(() => {\n      setShowLoading(false);\n    }, 2500);\n\n    return () => clearTimeout(timer);\n  }, []);\n\n  if (showLoading) {\n    return (\n      <ErrorBoundary>\n        <QueryClientProvider client={queryClient}>\n          <LanguageProvider>\n            <ThemeProvider>\n              <TooltipProvider>\n                <LoadingScreen />\n              </TooltipProvider>\n            </ThemeProvider>\n          </LanguageProvider>\n        </QueryClientProvider>\n      </ErrorBoundary>\n    );\n  }\n\n  return (\n    <ErrorBoundary>\n      <QueryClientProvider client={queryClient}>\n        <LanguageProvider>\n          <ThemeProvider>\n            <TooltipProvider>\n              <Toaster />\n              <Router />\n            </TooltipProvider>\n          </ThemeProvider>\n        </LanguageProvider>\n      </QueryClientProvider>\n    </ErrorBoundary>\n  );\n}\n\nexport default App;","size_bytes":9197},"client/src/index.css":{"content":"@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@400;500;600;700&family=Cairo:wght@400;500;600;700&display=swap');\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* Epic Gaming Profile Animations */\n@keyframes floating-particles {\n  0%, 100% {\n    transform: translateY(0px) rotate(0deg);\n    opacity: 0.7;\n  }\n  50% {\n    transform: translateY(-10px) rotate(180deg);\n    opacity: 1;\n  }\n}\n\n@keyframes glow-pulse {\n  0%, 100% {\n    box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);\n  }\n  50% {\n    box-shadow: 0 0 30px rgba(59, 130, 246, 0.8), 0 0 40px rgba(147, 51, 234, 0.4);\n  }\n}\n\n@keyframes rank-shine {\n  0% {\n    background-position: -200% center;\n  }\n  100% {\n    background-position: 200% center;\n  }\n}\n\n.animation-delay-500 {\n  animation-delay: 500ms;\n}\n\n.animation-delay-1000 {\n  animation-delay: 1000ms;\n}\n\n.animation-delay-1500 {\n  animation-delay: 1500ms;\n}\n\n.floating-particle {\n  animation: floating-particles 3s ease-in-out infinite;\n}\n\n.glow-effect {\n  animation: glow-pulse 2s ease-in-out infinite;\n}\n\n.rank-badge-shine {\n  background: linear-gradient(90deg, #fbbf24, #f59e0b, #fbbf24, #f59e0b);\n  background-size: 200% 100%;\n  animation: rank-shine 2s linear infinite;\n}\n\n/* Animated border for occupied cells */\n@keyframes pulse-border-blue {\n  0%, 100% { border-color: transparent; }\n  50% { border-color: rgb(59, 130, 246); }\n}\n\n@keyframes pulse-border-red {\n  0%, 100% { border-color: transparent; }\n  50% { border-color: rgb(239, 68, 68); }\n}\n\n.animate-pulse-border-x {\n  animation: pulse-border-blue 2s ease-in-out infinite;\n}\n\n.animate-pulse-border-o {\n  animation: pulse-border-red 2s ease-in-out infinite;\n}\n\n/* Aurora Theme Animations */\n@keyframes aurora-shimmer {\n  0%, 100% { \n    background-position: 0% 50%; \n    box-shadow: 0 0 20px rgba(168, 85, 247, 0.4);\n  }\n  50% { \n    background-position: 100% 50%; \n    box-shadow: 0 0 30px rgba(168, 85, 247, 0.8);\n  }\n}\n\n@keyframes aurora-glow {\n  0%, 100% { \n    text-shadow: 0 0 10px rgba(249, 168, 212, 0.8), 0 0 20px rgba(249, 168, 212, 0.6);\n  }\n  50% { \n    text-shadow: 0 0 20px rgba(249, 168, 212, 1), 0 0 30px rgba(249, 168, 212, 0.8);\n  }\n}\n\n.aurora-board {\n  background: linear-gradient(-45deg, #581c87, #3730a3, #1e3a8a, #581c87);\n  background-size: 400% 400%;\n  animation: aurora-shimmer 4s ease-in-out infinite;\n}\n\n.aurora-cell {\n  background: linear-gradient(45deg, #7c3aed, #4f46e5, #3b82f6);\n  background-size: 200% 200%;\n  animation: aurora-shimmer 3s ease-in-out infinite;\n}\n\n.aurora-text {\n  animation: aurora-glow 2s ease-in-out infinite;\n}\n\n/* Loading Screen Animations */\n@keyframes fade-in {\n  0% { \n    opacity: 0; \n    transform: translateY(20px); \n  }\n  100% { \n    opacity: 1; \n    transform: translateY(0); \n  }\n}\n\n.animate-fade-in {\n  animation: fade-in 0.8s ease-out forwards;\n  opacity: 0;\n}\n\n.animation-delay-200 {\n  animation-delay: 0.2s;\n}\n\n.animation-delay-400 {\n  animation-delay: 0.4s;\n}\n\n.animation-delay-500 {\n  animation-delay: 0.5s;\n}\n\n.animation-delay-1000 {\n  animation-delay: 1s;\n}\n\n.animation-delay-2000 {\n  animation-delay: 2s;\n}\n\n/* Fix modal white screen issue */\n[data-radix-dialog-content] {\n  background-color: #1e293b !important;\n}\n\n/* Ensure dropdown menus appear above all other content */\n[data-radix-dropdown-menu-content] {\n  z-index: 9999 !important;\n  position: fixed !important;\n  background-color: #1e293b !important;\n  color: white !important;\n  border: 1px solid #475569 !important;\n  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8) !important;\n  transform: translateZ(0) !important;\n}\n\n/* Ensure the dropdown portal container has highest z-index */\n[data-radix-portal] {\n  z-index: 9999 !important;\n}\n\n/* Arabic Font Support */\n\n.font-arabic {\n  font-family: 'Noto Sans Arabic', 'Cairo', 'Tajawal', system-ui, sans-serif;\n  font-feature-settings: \"kern\" 1, \"liga\" 1, \"calt\" 1;\n}\n\n.arabic-numbers {\n  font-variant-numeric: lining-nums;\n  direction: ltr;\n  unicode-bidi: embed;\n}\n\n/* RTL Language Support */\n[dir=\"rtl\"] {\n  direction: rtl;\n  text-align: right;\n}\n\n[dir=\"rtl\"] .leaderboard-content {\n  direction: ltr;\n  text-align: left;\n}\n\n[dir=\"rtl\"] .arabic-text {\n  direction: rtl;\n  text-align: right;\n}\n\n[dir=\"rtl\"] .flex {\n  flex-direction: row-reverse;\n}\n\n[dir=\"rtl\"] .space-x-2 > * + * {\n  margin-left: 0;\n  margin-right: 0.5rem;\n}\n\n[dir=\"rtl\"] .space-x-3 > * + * {\n  margin-left: 0;\n  margin-right: 0.75rem;\n}\n\n[dir=\"rtl\"] .space-x-4 > * + * {\n  margin-left: 0;\n  margin-right: 1rem;\n}\n\n[dir=\"rtl\"] .ml-auto {\n  margin-left: 0;\n  margin-right: auto;\n}\n\n[dir=\"rtl\"] .mr-auto {\n  margin-right: 0;\n  margin-left: auto;\n}\n\n[dir=\"rtl\"] .text-left {\n  text-align: right;\n}\n\n[dir=\"rtl\"] .text-right {\n  text-align: left;\n}\n\n[dir=\"rtl\"] .justify-start {\n  justify-content: flex-end;\n}\n\n[dir=\"rtl\"] .justify-end {\n  justify-content: flex-start;\n}\n\n/* Font support for different languages */\n[lang=\"ar\"] {\n  font-family: \"Amiri\", \"Noto Sans Arabic\", \"Scheherazade New\", serif;\n}\n\n[lang=\"bn\"] {\n  font-family: \"Noto Sans Bengali\", \"Hind Siliguri\", \"Mukti\", sans-serif;\n}\n\n[lang=\"hi\"] {\n  font-family: \"Noto Sans Devanagari\", \"Hind\", \"Mangal\", sans-serif;\n}\n\n[lang=\"es\"] {\n  font-family: \"Inter\", \"Roboto\", \"Helvetica Neue\", sans-serif;\n}\n\n[lang=\"id\"] {\n  font-family: \"Inter\", \"Roboto\", \"Helvetica Neue\", sans-serif;\n}\n\n:root {\n  --background: hsl(0, 0%, 100%);\n  --foreground: hsl(20, 14.3%, 4.1%);\n  --muted: hsl(60, 4.8%, 95.9%);\n  --muted-foreground: hsl(25, 5.3%, 44.7%);\n  --popover: hsl(0, 0%, 100%);\n  --popover-foreground: hsl(20, 14.3%, 4.1%);\n  --card: hsl(0, 0%, 100%);\n  --card-foreground: hsl(20, 14.3%, 4.1%);\n  --border: hsl(20, 5.9%, 90%);\n  --input: hsl(20, 5.9%, 90%);\n  --primary: hsl(263, 85%, 63%);\n  --primary-foreground: hsl(210, 40%, 98%);\n  --secondary: hsl(60, 4.8%, 95.9%);\n  --secondary-foreground: hsl(24, 9.8%, 10%);\n  --accent: hsl(142, 76%, 36%);\n  --accent-foreground: hsl(355, 7%, 97%);\n  --destructive: hsl(0, 84.2%, 60.2%);\n  --destructive-foreground: hsl(60, 9.1%, 97.8%);\n  --ring: hsl(20, 14.3%, 4.1%);\n  --radius: 0.5rem;\n}\n\n.dark {\n  --background: hsl(222, 84%, 4.9%);\n  --foreground: hsl(210, 40%, 98%);\n  --muted: hsl(217, 32.6%, 17.5%);\n  --muted-foreground: hsl(215, 20.2%, 65.1%);\n  --popover: hsl(222, 84%, 4.9%);\n  --popover-foreground: hsl(210, 40%, 98%);\n  --card: hsl(222, 84%, 4.9%);\n  --card-foreground: hsl(210, 40%, 98%);\n  --border: hsl(217, 32.6%, 17.5%);\n  --input: hsl(217, 32.6%, 17.5%);\n  --primary: hsl(263, 85%, 63%);\n  --primary-foreground: hsl(210, 40%, 98%);\n  --secondary: hsl(217, 32.6%, 17.5%);\n  --secondary-foreground: hsl(210, 40%, 98%);\n  --accent: hsl(142, 76%, 36%);\n  --accent-foreground: hsl(355, 7%, 97%);\n  --destructive: hsl(0, 62.8%, 30.6%);\n  --destructive-foreground: hsl(210, 40%, 98%);\n  --ring: hsl(212, 12%, 84.3%);\n  --radius: 0.5rem;\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/* Game-specific styles */\n.game-cell {\n  transition: all 0.2s ease;\n}\n\n.game-cell:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);\n}\n\n.pulse-ring {\n  animation: pulse-ring 1.5s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;\n}\n\n@keyframes pulse-ring {\n  0% { transform: scale(0.33); }\n  40%, 50% { opacity: 1; }\n  100% { opacity: 0; transform: scale(1.2); }\n}\n\n/* Ultimate Veteran Achievement Animations */\n@keyframes gradient-shift {\n  0% { background-position: 0% 50%; }\n  50% { background-position: 100% 50%; }\n  100% { background-position: 0% 50%; }\n}\n\n@keyframes shimmer {\n  0% { transform: translateX(-100%); }\n  50% { transform: translateX(100%); }\n  100% { transform: translateX(300%); }\n}\n\n.animate-shimmer {\n  animation: shimmer 2s ease-in-out infinite;\n}\n\n/* Player Profile Modal Styling */\n.player-profile-modal {\n  z-index: 9998 !important;\n  opacity: 1 !important;\n  position: fixed !important;\n}\n\n.player-profile-modal [data-radix-popper-content-wrapper] {\n  z-index: 9998 !important;\n}\n\n.player-profile-modal .bg-background {\n  opacity: 1 !important;\n  background-color: var(--background) !important;\n}\n\n/* Dialog overlay styling */\n[data-radix-dialog-overlay] {\n  z-index: 9997 !important;\n  opacity: 0.8 !important;\n  background-color: rgba(0, 0, 0, 0.8) !important;\n}\n\n[data-radix-dialog-content] {\n  z-index: 9998 !important;\n  opacity: 1 !important;\n}\n","size_bytes":8347},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\n// Handle unhandled promise rejections\nwindow.addEventListener('unhandledrejection', (event) => {\n  console.error('Unhandled promise rejection:', event.reason);\n  // Prevent the default console error\n  event.preventDefault();\n});\n\n// Handle uncaught errors\nwindow.addEventListener('error', (event) => {\n  console.error('Uncaught error:', event.error);\n});\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":514},"server/config/README.md":{"content":"# Email Configuration\n\nThis directory contains the email service configuration for TicTac 3x5.\n\n## Configuration Methods\n\nThe application supports two ways to configure SMTP settings:\n\n### 1. Config File (Recommended)\nCreate `email.json` in this directory with your SMTP credentials:\n\n```json\n{\n  \"smtp\": {\n    \"host\": \"smtp.your-domain.com\",\n    \"port\": 465,\n    \"secure\": true,\n    \"auth\": {\n      \"user\": \"your-email@your-domain.com\",\n      \"pass\": \"your_smtp_password\"\n    }\n  },\n  \"fromEmail\": \"your-email@your-domain.com\"\n}\n```\n\n### 2. Environment Variables (Fallback)\nIf no config file exists, the system will use these environment secrets:\n- `SMTP_HOST`\n- `SMTP_PORT` \n- `SMTP_USER`\n- `SMTP_PASS`\n- `FROM_EMAIL`\n\n## Security\n\n- The `email.json` file is automatically ignored by git (see `.gitignore`)\n- Use `email.json.example` as a template\n- Never commit actual credentials to version control\n\n## Common SMTP Settings\n\n### Gmail\n```json\n{\n  \"smtp\": {\n    \"host\": \"smtp.gmail.com\",\n    \"port\": 587,\n    \"secure\": false,\n    \"auth\": {\n      \"user\": \"your-email@gmail.com\",\n      \"pass\": \"your_app_password\"\n    }\n  },\n  \"fromEmail\": \"your-email@gmail.com\"\n}\n```\n\n### Custom Domain (SSL)\n```json\n{\n  \"smtp\": {\n    \"host\": \"smtp.your-domain.com\",\n    \"port\": 465,\n    \"secure\": true,\n    \"auth\": {\n      \"user\": \"admin@your-domain.com\",\n      \"pass\": \"your_password\"\n    }\n  },\n  \"fromEmail\": \"admin@your-domain.com\"\n}\n```","size_bytes":1428},"client/public/audio/README.md":{"content":"# Audio Files\n\nPlace your audio files in this folder:\n\n- `celebration.wav` - Plays when someone wins a game\n\nThe audio system will automatically play `celebration.wav` when the sparkle explosion happens.\n\n## Supported formats:\n- WAV files (recommended)\n- MP3 files\n- OGG files\n\n## File naming:\n- Make sure your file is named exactly `celebration.wav`\n- Keep file size under 1MB for faster loading","size_bytes":396},"client/src/components/AchievementBadge.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { useTranslation } from \"@/contexts/LanguageContext\";\n\ninterface AchievementBadgeProps {\n  achievement: {\n    id: string;\n    achievementType: string;\n    achievementName: string;\n    description: string;\n    icon: string;\n    unlockedAt: string;\n    metadata?: any;\n  };\n  size?: 'sm' | 'md' | 'lg';\n}\n\nexport function AchievementBadge({ achievement, size = 'md' }: AchievementBadgeProps) {\n  const { t } = useTranslation();\n\n  // Helper function to get translated achievement name\n  const getTranslatedName = (achievementType: string, originalName: string): string => {\n    // Check if the original name is a translation key\n    if (originalName && !originalName.includes(' ')) {\n      return t(originalName);\n    }\n    \n    // Fallback for existing achievement names\n    switch (achievementType) {\n      case 'first_win':\n        return t('firstVictoryTitle');\n      case 'win_streak_5':\n        return t('winStreakMaster');\n      case 'win_streak_10':\n        return t('unstoppable');\n      case 'master_of_diagonals':\n        return t('masterOfDiagonals');\n      case 'speed_demon':\n        return t('speedDemon');\n      case 'veteran_player':\n        return t('veteranPlayer');\n      case 'comeback_king':\n        return t('comebackKing');\n      case 'legend':\n        return t('legend');\n      case 'champion':\n        return t('champion');\n      case 'grandmaster':\n        return t('grandmaster');\n      case 'ultimate_veteran':\n        return t('ultimateVeteran');\n      default:\n        return originalName;\n    }\n  };\n\n  const getTranslatedDescription = (achievementType: string, originalDescription: string): string => {\n    // Check if the original description is a translation key\n    if (originalDescription && !originalDescription.includes(' ')) {\n      return t(originalDescription);\n    }\n    \n    // Fallback for existing achievement descriptions\n    switch (achievementType) {\n      case 'first_win':\n        return t('winYourVeryFirstGame');\n      case 'win_streak_5':\n        return t('winFiveConsecutiveGames');\n      case 'win_streak_10':\n        return t('winTenConsecutiveGames');\n      case 'master_of_diagonals':\n        return t('winThreeGamesDiagonally');\n      case 'speed_demon':\n        return t('winTwentyTotalGames');\n      case 'veteran_player':\n        return t('playOneHundredTotalGames');\n      case 'comeback_king':\n        return t('winAfterLosingFive');\n      case 'legend':\n        return t('achieveFiftyTotalWins');\n      case 'champion':\n        return t('achieveOneHundredTotalWins');\n      case 'grandmaster':\n        return t('achieveTwoHundredTotalWins');\n      case 'ultimate_veteran':\n        return t('playFiveHundredTotalGames');\n      default:\n        return originalDescription;\n    }\n  };\n  const sizeClasses = {\n    sm: 'w-20 h-20 text-xs',\n    md: 'w-28 h-28 text-sm',\n    lg: 'w-32 h-32 text-base'\n  };\n\n  const iconSizes = {\n    sm: 'text-xl',\n    md: 'text-3xl',\n    lg: 'text-4xl'\n  };\n\n  return (\n    <Card className={`${sizeClasses[size]} relative group cursor-pointer hover:shadow-xl transition-all duration-300 hover:scale-110 bg-gradient-to-br from-amber-50 to-orange-100 dark:from-amber-900/20 dark:to-orange-900/20 border-2 border-amber-200 dark:border-amber-700/50`}>\n      <CardContent className=\"p-3 flex flex-col items-center justify-center h-full\">\n        <div className={`${iconSizes[size]} mb-2 transform transition-transform duration-300 group-hover:scale-110`}>\n          {achievement.icon}\n        </div>\n        <div className=\"text-center leading-tight\">\n          <div className=\"font-bold text-amber-800 dark:text-amber-200 text-xs truncate w-full\">{getTranslatedName(achievement.achievementType, achievement.achievementName)}</div>\n        </div>\n        \n        {/* Tooltip on hover */}\n        <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-3 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-50 shadow-2xl border border-gray-700 w-44 max-w-[90vw] pointer-events-none\">\n          <div className=\"font-bold text-amber-300 mb-1 text-center text-xs\">{getTranslatedName(achievement.achievementType, achievement.achievementName)}</div>\n          <div className=\"text-gray-200 text-xs text-center leading-tight\">{getTranslatedDescription(achievement.achievementType, achievement.description)}</div>\n          {/* Arrow pointing down */}\n          <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-3 border-r-3 border-t-3 border-transparent border-t-gray-900\"></div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":4704},"client/src/components/AchievementBorderSelector.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Palette, Check, X } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\nimport { useTranslation } from \"@/contexts/LanguageContext\";\n\ninterface Achievement {\n  id: string;\n  achievementType: string;\n  achievementName: string;\n  description: string;\n  icon: string;\n  unlockedAt: string;\n}\n\ninterface User {\n  id: string;\n  selectedAchievementBorder?: string;\n}\n\ninterface AchievementBorderSelectorProps {\n  user: User;\n}\n\nexport function AchievementBorderSelector({ user }: AchievementBorderSelectorProps) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [selectedBorder, setSelectedBorder] = useState<string | null>(user.selectedAchievementBorder || null);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const { t } = useTranslation();\n\n  // Update selectedBorder when user prop changes (when selectedAchievementBorder is loaded from database)\n  useEffect(() => {\n    setSelectedBorder(user.selectedAchievementBorder || null);\n  }, [user.selectedAchievementBorder]);\n\n  // Fetch user's achievements\n  const { data: achievements, isLoading } = useQuery<Achievement[]>({\n    queryKey: ['/api/achievements'],\n  });\n\n  // Update selected border mutation\n  const updateBorderMutation = useMutation({\n    mutationFn: async (achievementType: string | null) => {\n      return apiRequest('/api/achievement-border/select', {\n        method: 'POST',\n        body: { achievementType },\n      });\n    },\n    onSuccess: () => {\n      toast({\n        title: t('borderUpdated') || 'Border Updated',\n        description: t('borderUpdateSuccess') || 'Your achievement border has been updated successfully!',\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/user'] });\n      setIsOpen(false);\n    },\n    onError: (error: any) => {\n      toast({\n        title: t('error') || 'Error',\n        description: error.message || 'Failed to update achievement border',\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleBorderSelect = (achievementType: string | null) => {\n    setSelectedBorder(achievementType);\n    updateBorderMutation.mutate(achievementType);\n  };\n\n  const getBorderPreview = (achievementType: string) => {\n    switch (achievementType) {\n      case 'ultimate_veteran':\n        return (\n          <motion.div\n            animate={{\n              boxShadow: [\n                \"0 0 8px #ff6347, 0 0 16px #ff4500, 0 0 24px #ff8c00\",\n                \"0 0 12px #ff1493, 0 0 24px #dc143c, 0 0 36px #b22222\",\n                \"0 0 10px #ff6600, 0 0 20px #ff3300, 0 0 30px #ff0000\"\n              ],\n              scale: [1, 1.02, 1],\n            }}\n            transition={{\n              duration: 1.5,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n            className=\"px-3 py-2 rounded-lg border-3 border-double border-orange-600 bg-gradient-to-r from-red-900/30 via-orange-800/30 to-red-900/30\"\n          >\n            <span className=\"text-sm font-black text-white\">üî• Ultimate Veteran</span>\n          </motion.div>\n        );\n      case 'grandmaster':\n        return (\n          <motion.div\n            animate={{\n              boxShadow: [\n                \"0 0 10px #e0e7ff, 0 0 20px #c7d2fe, 0 0 30px #a5b4fc\",\n                \"0 0 12px #f3f4f6, 0 0 24px #e5e7eb, 0 0 36px #d1d5db\",\n                \"0 0 11px #ddd6fe, 0 0 22px #c4b5fd, 0 0 33px #a78bfa\"\n              ],\n              scale: [1, 1.02, 1],\n            }}\n            transition={{\n              duration: 2,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n            className=\"px-3 py-2 rounded-lg border-2 border-indigo-400 bg-gradient-to-r from-indigo-900/25 via-gray-800/25 to-indigo-900/25\"\n          >\n            <span className=\"text-sm font-bold text-white\">üíé Grandmaster</span>\n          </motion.div>\n        );\n      case 'champion':\n        return (\n          <motion.div\n            animate={{\n              boxShadow: [\n                \"0 0 8px #8a2be2, 0 0 16px #4b0082, 0 0 24px #9932cc\",\n                \"0 0 10px #00bfff, 0 0 20px #1e90ff, 0 0 30px #4169e1\",\n                \"0 0 9px #ffd700, 0 0 18px #ffff00, 0 0 27px #ffa500\"\n              ],\n              scale: [1, 1.01, 1],\n            }}\n            transition={{\n              duration: 2.5,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n            className=\"px-3 py-2 rounded-lg border-2 border-purple-500 bg-gradient-to-r from-purple-900/20 via-blue-900/20 to-purple-900/20\"\n          >\n            <span className=\"text-sm font-bold text-white\">üëë Champion</span>\n          </motion.div>\n        );\n      case 'legend':\n        return (\n          <motion.div\n            animate={{\n              boxShadow: [\n                \"0 0 6px #ff4500, 0 0 12px #ff6600, 0 0 18px #ff8800\",\n                \"0 0 8px #ff0000, 0 0 16px #ff3300, 0 0 24px #ff6600\",\n                \"0 0 7px #ff8800, 0 0 14px #ffaa00, 0 0 21px #ffcc00\"\n              ],\n            }}\n            transition={{\n              duration: 1.2,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n            className=\"px-3 py-2 rounded-md border-2 border-orange-500 bg-orange-900/20\"\n          >\n            <span className=\"text-sm font-bold text-white\">üåü Legend</span>\n          </motion.div>\n        );\n      default:\n        return (\n          <div className=\"px-3 py-2 rounded-md bg-gray-100 dark:bg-gray-800\">\n            <span className=\"text-sm text-gray-700 dark:text-gray-300\">Default (No Border)</span>\n          </div>\n        );\n    }\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={setIsOpen}>\n      <DialogTrigger asChild>\n        <Button variant=\"outline\" size=\"sm\" className=\"flex items-center gap-2\">\n          <Palette className=\"w-4 h-4\" />\n          {t('chooseBorder') || 'Choose Border'}\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"max-w-2xl max-h-[80vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Palette className=\"w-5 h-5\" />\n            {t('selectAchievementBorder') || 'Select Achievement Border'}\n          </DialogTitle>\n          <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n            {t('chooseBorderDescription') || 'Choose which achievement border to display around your name in games. You can only use borders from achievements you have unlocked.'}\n          </p>\n        </DialogHeader>\n        \n        <div className=\"space-y-4\">\n          {/* Current Selection */}\n          <div>\n            <h4 className=\"text-sm font-medium mb-2\">{t('currentSelection') || 'Current Selection'}:</h4>\n            {getBorderPreview(selectedBorder || 'default')}\n          </div>\n\n          {/* Default Option */}\n          <Card className={`cursor-pointer transition-all ${selectedBorder === null ? 'ring-2 ring-blue-500' : 'hover:bg-gray-50 dark:hover:bg-gray-800'}`}>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"w-12 h-12 bg-gray-200 dark:bg-gray-700 rounded-full flex items-center justify-center\">\n                    <X className=\"w-6 h-6 text-gray-500\" />\n                  </div>\n                  <div>\n                    <h3 className=\"font-medium\">{t('defaultNoBorder') || 'Default (No Border)'}</h3>\n                    <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                      {t('defaultBorderDescription') || 'Display your name without any special border effects'}\n                    </p>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  {selectedBorder === null && <Check className=\"w-5 h-5 text-green-500\" />}\n                  <Button\n                    variant={selectedBorder === null ? \"default\" : \"outline\"}\n                    size=\"sm\"\n                    onClick={() => handleBorderSelect(null)}\n                    disabled={updateBorderMutation.isPending}\n                  >\n                    {selectedBorder === null ? t('selected') || 'Selected' : t('select') || 'Select'}\n                  </Button>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Achievement Borders */}\n          {isLoading ? (\n            <div className=\"text-center py-8 text-gray-500\">\n              {t('loadingAchievements') || 'Loading achievements...'}\n            </div>\n          ) : achievements && achievements.length > 0 ? (\n            <div className=\"space-y-3\">\n              <h4 className=\"text-sm font-medium\">{t('unlockedBorders') || 'Unlocked Borders'}:</h4>\n              {achievements\n                .filter(achievement => \n                  ['legend', 'champion', 'grandmaster', 'ultimate_veteran'].includes(achievement.achievementType)\n                )\n                .map((achievement) => (\n                  <Card \n                    key={achievement.id} \n                    className={`cursor-pointer transition-all ${\n                      selectedBorder === achievement.achievementType \n                        ? 'ring-2 ring-blue-500' \n                        : 'hover:bg-gray-50 dark:hover:bg-gray-800'\n                    }`}\n                  >\n                    <CardContent className=\"p-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"w-12 h-12 bg-gradient-to-br from-amber-400 to-orange-500 rounded-full flex items-center justify-center text-white text-xl font-bold shadow-lg\">\n                            {achievement.icon}\n                          </div>\n                          <div className=\"flex-1\">\n                            <h3 className=\"font-medium\">{achievement.achievementName}</h3>\n                            <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-2\">\n                              {achievement.description}\n                            </p>\n                            <div className=\"scale-90 origin-left\">\n                              {getBorderPreview(achievement.achievementType)}\n                            </div>\n                          </div>\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                          {selectedBorder === achievement.achievementType && (\n                            <Check className=\"w-5 h-5 text-green-500\" />\n                          )}\n                          <Button\n                            variant={selectedBorder === achievement.achievementType ? \"default\" : \"outline\"}\n                            size=\"sm\"\n                            onClick={() => handleBorderSelect(achievement.achievementType)}\n                            disabled={updateBorderMutation.isPending}\n                          >\n                            {selectedBorder === achievement.achievementType \n                              ? t('selected') || 'Selected' \n                              : t('select') || 'Select'}\n                          </Button>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n            </div>\n          ) : (\n            <div className=\"text-center py-8 text-gray-500\">\n              <Palette className=\"w-16 h-16 mx-auto mb-4 opacity-50\" />\n              <p>{t('noAchievementBorders') || 'No achievement borders available yet. Unlock achievements like Legend, Champion, Grandmaster, or Ultimate Veteran to access special borders!'}</p>\n            </div>\n          )}\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":12339},"client/src/components/AchievementModal.tsx":{"content":"import { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { AchievementBadge } from \"./AchievementBadge\";\nimport { AchievementBorderSelector } from \"./AchievementBorderSelector\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Loader2, Trophy, Target, Star } from \"lucide-react\";\nimport { useTranslation } from \"@/contexts/LanguageContext\";\nimport { useEffect } from \"react\";\n\ninterface AchievementModalProps {\n  open: boolean;\n  onClose: () => void;\n  userId?: string;\n  user?: any;\n}\n\nexport function AchievementModal({ open, onClose, userId, user }: AchievementModalProps) {\n  const { t } = useTranslation();\n  \n  // Helper function to get translated achievement name and description\n  const getTranslatedName = (achievementType: string, originalName: string): string => {\n    // Check if the original name is a translation key\n    if (originalName && !originalName.includes(' ')) {\n      return t(originalName);\n    }\n    \n    // Fallback for existing achievement names\n    switch (achievementType) {\n      case 'first_win':\n        return t('firstVictoryTitle');\n      case 'win_streak_5':\n        return t('winStreakMaster');\n      case 'win_streak_10':\n        return t('unstoppable');\n      case 'master_of_diagonals':\n        return t('masterOfDiagonals');\n      case 'speed_demon':\n        return t('speedDemon');\n      case 'veteran_player':\n        return t('veteranPlayer');\n      case 'comeback_king':\n        return t('comebackKing');\n      case 'legend':\n        return t('legend');\n      case 'champion':\n        return t('champion');\n      case 'grandmaster':\n        return t('grandmaster');\n      case 'ultimate_veteran':\n        return t('ultimateVeteran');\n      default:\n        return originalName;\n    }\n  };\n\n  const getTranslatedDescription = (achievementType: string, originalDescription: string): string => {\n    // Check if the original description is a translation key\n    if (originalDescription && !originalDescription.includes(' ')) {\n      return t(originalDescription);\n    }\n    \n    // Fallback for existing achievement descriptions\n    switch (achievementType) {\n      case 'first_win':\n        return t('winYourVeryFirstGame');\n      case 'win_streak_5':\n        return t('winFiveConsecutiveGames');\n      case 'win_streak_10':\n        return t('winTenConsecutiveGames');\n      case 'master_of_diagonals':\n        return t('winThreeGamesDiagonally');\n      case 'speed_demon':\n        return t('winTwentyTotalGames');\n      case 'veteran_player':\n        return t('playOneHundredTotalGames');\n      case 'comeback_king':\n        return t('winAfterLosingFive');\n      case 'legend':\n        return t('achieveFiftyTotalWins');\n      case 'champion':\n        return t('achieveOneHundredTotalWins');\n      case 'grandmaster':\n        return t('achieveTwoHundredTotalWins');\n      case 'ultimate_veteran':\n        return t('playFiveHundredTotalGames');\n      default:\n        return originalDescription;\n    }\n  };\n  const { data: achievements, isLoading, refetch } = useQuery({\n    queryKey: userId ? ['/api/users', userId, 'achievements'] : ['/api/achievements'],\n    enabled: open,\n    staleTime: 0, // Always fetch fresh data\n    cacheTime: 0, // Don't cache achievement data\n  });\n\n  // Auto-sync achievements when modal opens for current user\n  useEffect(() => {\n    const syncAchievements = async () => {\n      if (open && !userId && user) { // Only for current user viewing their own achievements\n        try {\n          const response = await fetch('/api/achievements/sync', {\n            method: 'POST',\n            credentials: 'include',\n            headers: {\n              'Content-Type': 'application/json'\n            }\n          });\n          \n          if (response.ok) {\n            console.log('üéâ Achievements synced successfully');\n            // Force multiple refetches to ensure cache is cleared\n            setTimeout(() => refetch(), 100);\n            setTimeout(() => refetch(), 500);\n            setTimeout(() => refetch(), 1000);\n          }\n        } catch (error) {\n          console.error('Failed to sync achievements:', error);\n        }\n      }\n    };\n\n    syncAchievements();\n  }, [open, userId, user, refetch]);\n\n  // Force refetch when modal opens\n  useEffect(() => {\n    if (open) {\n      refetch();\n    }\n  }, [open, refetch]);\n\n\n\n  const achievementCategories = [\n    {\n      title: t('victoryAchievements'),\n      icon: <Trophy className=\"w-5 h-5\" />,\n      types: ['first_win', 'win_streak_5', 'win_streak_10', 'speed_demon', 'legend', 'champion', 'grandmaster']\n    },\n    {\n      title: t('skillAchievements'), \n      icon: <Target className=\"w-5 h-5\" />,\n      types: ['master_of_diagonals', 'comeback_king']\n    },\n    {\n      title: t('experienceAchievements'),\n      icon: <Star className=\"w-5 h-5\" />,\n      types: ['veteran_player', 'ultimate_veteran']\n    }\n  ];\n\n  const getAchievementsByCategory = (types: string[]) => {\n    if (!achievements) return [];\n    return achievements.filter((achievement: any) => types.includes(achievement.achievementType));\n  };\n\n  const allPossibleAchievements = [\n    { type: 'first_win', name: t('firstVictoryTitle'), description: t('winYourVeryFirstGame'), icon: 'üèÜ' },\n    { type: 'win_streak_5', name: t('winStreakMaster'), description: t('winFiveConsecutiveGames'), icon: 'üî•' },\n    { type: 'win_streak_10', name: t('unstoppable'), description: t('winTenConsecutiveGames'), icon: '‚ö°' },\n    { type: 'master_of_diagonals', name: t('masterOfDiagonals'), description: t('winThreeGamesDiagonally'), icon: 'üéØ' },\n    { type: 'speed_demon', name: t('speedDemon'), description: t('winTwentyTotalGames'), icon: '‚ö°' },\n    { type: 'veteran_player', name: t('veteranPlayer'), description: t('playOneHundredTotalGames'), icon: 'üéñÔ∏è' },\n    { type: 'comeback_king', name: t('comebackKing'), description: t('winAfterLosingFive'), icon: 'üëë' },\n    { type: 'legend', name: t('legend'), description: t('achieveFiftyTotalWins'), icon: 'üåü' },\n    { type: 'champion', name: t('champion'), description: t('achieveOneHundredTotalWins'), icon: 'üëë' },\n    { type: 'grandmaster', name: t('grandmaster'), description: t('achieveTwoHundredTotalWins'), icon: 'üíé' },\n    { type: 'ultimate_veteran', name: t('ultimateVeteran'), description: t('playFiveHundredTotalGames'), icon: 'üî•' },\n  ];\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-4xl max-h-[90vh] w-[95vw] sm:w-full mx-auto flex flex-col overflow-hidden\">\n        <DialogHeader className=\"flex-shrink-0 pb-4\">\n          <DialogTitle className=\"flex items-center gap-2 text-lg sm:text-xl\">\n            <Trophy className=\"w-5 h-5 sm:w-6 sm:h-6\" />\n            {userId ? t('playerAchievements') : t('yourAchievements')}\n          </DialogTitle>\n        </DialogHeader>\n\n        {isLoading ? (\n          <div className=\"flex items-center justify-center py-8 flex-1\">\n            <Loader2 className=\"w-8 h-8 animate-spin\" />\n          </div>\n        ) : (\n          <div className=\"flex-1 min-h-0 overflow-y-auto overflow-x-hidden\" style={{ WebkitOverflowScrolling: 'touch' }}>\n            <div className=\"space-y-6 pb-6 pr-4\">\n              {achievementCategories.map((category) => {\n                const categoryAchievements = getAchievementsByCategory(category.types);\n                const possibleAchievements = allPossibleAchievements.filter(a => category.types.includes(a.type));\n                \n                return (\n                  <div key={category.title} className=\"space-y-3\">\n                    <div className=\"flex items-center gap-2 text-lg font-semibold\">\n                      {category.icon}\n                      {category.title}\n                      <span className=\"text-sm text-gray-500\">\n                        ({categoryAchievements.length}/{possibleAchievements.length})\n                      </span>\n                    </div>\n                    \n                    <div className=\"space-y-3\">\n                      {possibleAchievements.map((possible) => {\n                        const earned = categoryAchievements.find((a: any) => a.achievementType === possible.type);\n                        \n                        if (earned) {\n                          return (\n                            <div\n                              key={earned.id}\n                              className=\"flex items-center gap-4 p-3 rounded-lg bg-gradient-to-r from-amber-50 to-orange-100 dark:from-amber-900/20 dark:to-orange-900/20 border border-amber-200 dark:border-amber-700/50\"\n                            >\n                              <div className=\"flex-shrink-0\">\n                                <div className=\"w-12 h-12 bg-gradient-to-br from-amber-400 to-orange-500 rounded-full flex items-center justify-center text-white text-xl font-bold shadow-lg\">\n                                  {earned.icon}\n                                </div>\n                              </div>\n                              <div className=\"flex-1 min-w-0\">\n                                <div className=\"font-semibold text-amber-800 dark:text-amber-200 text-sm\">\n                                  {getTranslatedName(earned.achievementType, earned.achievementName)}\n                                </div>\n                                <div className=\"text-xs text-amber-700 dark:text-amber-300 mt-1 leading-tight\">\n                                  {getTranslatedDescription(earned.achievementType, earned.description)}\n                                </div>\n                              </div>\n                            </div>\n                          );\n                        } else {\n                          // Show locked achievement\n                          return (\n                            <div\n                              key={possible.type}\n                              className=\"flex items-center gap-4 p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50 border border-dashed border-gray-300 dark:border-gray-600 opacity-60\"\n                            >\n                              <div className=\"flex-shrink-0\">\n                                <div className=\"w-12 h-12 bg-gray-300 dark:bg-gray-700 rounded-full flex items-center justify-center text-gray-500 dark:text-gray-400 text-xl grayscale\">\n                                  {possible.icon}\n                                </div>\n                              </div>\n                              <div className=\"flex-1 min-w-0\">\n                                <div className=\"font-semibold text-gray-600 dark:text-gray-400 text-sm flex items-center gap-2\">\n                                  <span>üîí</span>\n                                  {possible.name}\n                                </div>\n                                <div className=\"text-xs text-gray-500 dark:text-gray-500 mt-1 leading-tight\">\n                                  {getTranslatedDescription(possible.type, possible.description)}\n                                </div>\n                              </div>\n                            </div>\n                          );\n                        }\n                      })}\n                    </div>\n                  </div>\n                );\n              })}\n              \n              {achievements && achievements.length === 0 && (\n                <div className=\"text-center py-8 text-gray-500\">\n                  <Trophy className=\"w-16 h-16 mx-auto mb-4 opacity-50\" />\n                  <p>No achievements yet. Start playing to earn your first badge!</p>\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Achievement Border Selector - Only show for current user (not viewing other players) */}\n        {!userId && user && (\n          <div className=\"pt-6 border-t border-gray-200 dark:border-gray-700\">\n            <AchievementBorderSelector user={user} />\n          </div>\n        )}\n\n        <div className=\"flex justify-end pt-4 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n          <Button onClick={onClose} variant=\"default\">Close</Button>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":12250},"client/src/components/AchievementNotification.tsx":{"content":"import { useEffect, useState } from 'react';\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { X, Trophy } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\n\ninterface AchievementNotificationProps {\n  achievement: {\n    id: string;\n    achievementType: string;\n    achievementName: string;\n    description: string;\n    icon: string;\n    unlockedAt: string;\n  };\n  onClose: () => void;\n}\n\nexport function AchievementNotification({ achievement, onClose }: AchievementNotificationProps) {\n  const [isVisible, setIsVisible] = useState(false);\n\n  useEffect(() => {\n    // Show notification with animation\n    const timer = setTimeout(() => setIsVisible(true), 100);\n    \n    // Auto-hide after 5 seconds\n    const autoHide = setTimeout(() => {\n      setIsVisible(false);\n      setTimeout(onClose, 300);\n    }, 5000);\n\n    return () => {\n      clearTimeout(timer);\n      clearTimeout(autoHide);\n    };\n  }, [onClose]);\n\n  const handleClose = () => {\n    setIsVisible(false);\n    setTimeout(onClose, 300);\n  };\n\n  return (\n    <div className={`fixed top-4 right-4 z-50 transition-all duration-300 ${\n      isVisible ? 'opacity-100 transform translate-y-0' : 'opacity-0 transform -translate-y-4'\n    }`}>\n      <Card className=\"w-80 bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500 border-0 shadow-lg\">\n        <CardContent className=\"p-4\">\n          <div className=\"flex items-start justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"text-2xl\">{achievement.icon}</div>\n              <div>\n                <div className=\"flex items-center space-x-2\">\n                  <Trophy className=\"w-4 h-4 text-white\" />\n                  <Badge variant=\"secondary\" className=\"bg-white/20 text-white border-white/30\">\n                    Achievement Unlocked!\n                  </Badge>\n                </div>\n                <h3 className=\"font-semibold text-white mt-1\">{achievement.achievementName}</h3>\n                <p className=\"text-sm text-white/90\">{achievement.description}</p>\n              </div>\n            </div>\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={handleClose}\n              className=\"text-white hover:bg-white/20 p-1 h-6 w-6\"\n            >\n              <X className=\"h-3 w-3\" />\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":2486},"client/src/components/AudioControls.tsx":{"content":"import { useAudio } from \"@/hooks/useAudio\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Slider } from \"@/components/ui/slider\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Label } from \"@/components/ui/label\";\nimport { Volume2, VolumeX, Music, Zap } from \"lucide-react\";\n\nexport function AudioControls() {\n  const { settings, toggleBackgroundMusic, toggleSoundEffects, setVolume } = useAudio();\n\n  return (\n    <Card className=\"bg-slate-800 border-slate-700\">\n      <CardHeader>\n        <CardTitle className=\"text-lg flex items-center space-x-2\">\n          <Volume2 className=\"w-5 h-5\" />\n          <span>Audio Settings</span>\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        {/* Background Music Toggle */}\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-2\">\n            <Music className=\"w-4 h-4 text-blue-500\" />\n            <Label htmlFor=\"background-music\" className=\"text-sm\">\n              Background Music\n            </Label>\n          </div>\n          <Switch\n            id=\"background-music\"\n            checked={settings.backgroundMusic}\n            onCheckedChange={toggleBackgroundMusic}\n          />\n        </div>\n\n        {/* Sound Effects Toggle */}\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-2\">\n            <Zap className=\"w-4 h-4 text-yellow-500\" />\n            <Label htmlFor=\"sound-effects\" className=\"text-sm\">\n              Sound Effects\n            </Label>\n          </div>\n          <Switch\n            id=\"sound-effects\"\n            checked={settings.soundEffects}\n            onCheckedChange={toggleSoundEffects}\n          />\n        </div>\n\n        {/* Volume Control */}\n        <div className=\"space-y-2\">\n          <div className=\"flex items-center space-x-2\">\n            {settings.volume === 0 ? (\n              <VolumeX className=\"w-4 h-4 text-gray-500\" />\n            ) : (\n              <Volume2 className=\"w-4 h-4 text-gray-300\" />\n            )}\n            <Label className=\"text-sm\">Volume</Label>\n            <span className=\"text-xs text-gray-400 ml-auto\">\n              {Math.round(settings.volume * 100)}%\n            </span>\n          </div>\n          <Slider\n            value={[settings.volume]}\n            onValueChange={(value) => setVolume(value[0])}\n            max={1}\n            min={0}\n            step={0.1}\n            className=\"w-full\"\n          />\n        </div>\n\n        {/* Quick Actions */}\n        <div className=\"flex space-x-2 pt-2\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setVolume(0)}\n            className=\"flex-1\"\n          >\n            <VolumeX className=\"w-3 h-3 mr-1\" />\n            Mute\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setVolume(0.5)}\n            className=\"flex-1\"\n          >\n            <Volume2 className=\"w-3 h-3 mr-1\" />\n            50%\n          </Button>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":3225},"client/src/components/AuthRedirectHandler.tsx":{"content":"import { useEffect } from \"react\";\nimport { getRedirectResult, GoogleAuthProvider } from \"firebase/auth\";\nimport { auth } from \"@/lib/firebase\";\n\nexport function AuthRedirectHandler() {\n  useEffect(() => {\n    const handleRedirect = async () => {\n      try {\n        const result = await getRedirectResult(auth);\n        if (result) {\n          // User successfully signed in\n          const credential = GoogleAuthProvider.credentialFromResult(result);\n          console.log(\"User signed in:\", result.user);\n        }\n      } catch (error) {\n        console.error(\"Error during redirect:\", error);\n      }\n    };\n\n    handleRedirect();\n  }, []);\n\n  return null;\n}","size_bytes":664},"client/src/components/ChatPopup.tsx":{"content":"import React, { useState, useEffect, useRef } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport { Badge } from '@/components/ui/badge';\nimport { MessageCircle, Send, X, Minimize2, Maximize2, User } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { apiRequest } from '@/lib/queryClient';\nimport { useMutation } from '@tanstack/react-query';\nimport { useTranslation } from '@/contexts/LanguageContext';\nimport { useOnlineStatus } from '@/hooks/useOnlineStatus';\n\ninterface ChatMessage {\n  id: string;\n  senderId: string;\n  senderName: string;\n  message: string;\n  timestamp: string;\n  fromMe: boolean;\n}\n\ninterface ChatPopupProps {\n  isOpen: boolean;\n  onClose: () => void;\n  currentUser: any;\n  initialSender?: {\n    userId: string;\n    displayName: string;\n  };\n  initialMessage?: string;\n}\n\nexport function ChatPopup({ \n  isOpen, \n  onClose, \n  currentUser, \n  initialSender, \n  initialMessage \n}: ChatPopupProps) {\n  const [messages, setMessages] = useState<ChatMessage[]>([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [isMinimized, setIsMinimized] = useState(false);\n  const [activeChatUser, setActiveChatUser] = useState(initialSender || null);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const { t } = useTranslation();\n  const { toast } = useToast();\n  const { isOnline } = useOnlineStatus();\n\n  // Auto-scroll to bottom when new messages arrive\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  // Add initial message if provided and handle updates\n  useEffect(() => {\n    if (initialMessage && initialSender) {\n      const message: ChatMessage = {\n        id: `${initialSender.userId}-${Date.now()}`,\n        senderId: initialSender.userId,\n        senderName: initialSender.displayName,\n        message: initialMessage,\n        timestamp: new Date().toLocaleTimeString(),\n        fromMe: false\n      };\n      \n      // Check if this exact message already exists to avoid duplicates\n      setMessages(prev => {\n        const exists = prev.some(msg => \n          msg.senderId === message.senderId && \n          msg.message === message.message &&\n          Math.abs(new Date(msg.timestamp).getTime() - new Date(message.timestamp).getTime()) < 5000 // Within 5 seconds\n        );\n        \n        if (!exists) {\n          return [...prev, message];\n        }\n        return prev;\n      });\n      \n      setActiveChatUser(initialSender);\n    }\n  }, [initialMessage, initialSender]);\n\n  // No WebSocket listener needed - ChatPopup only handles the initial message through props\n  // New messages from the same user will trigger a new popup instance\n\n  const sendMessageMutation = useMutation({\n    mutationFn: async ({ targetUserId, message }: { targetUserId: string; message: string }) => {\n      return await apiRequest('/api/chat/send', { method: 'POST', body: { targetUserId, message } });\n    },\n    onSuccess: () => {\n      if (activeChatUser) {\n        // Add the sent message to chat\n        const sentMessage: ChatMessage = {\n          id: Date.now().toString(),\n          senderId: currentUser?.userId || currentUser?.id,\n          senderName: currentUser?.displayName || t('you'),\n          message: newMessage,\n          timestamp: new Date().toLocaleTimeString(),\n          fromMe: true\n        };\n        \n        setMessages(prev => [...prev, sentMessage]);\n      }\n      setNewMessage('');\n    },\n    onError: (error: any) => {\n      console.error('Chat message error:', error);\n      toast({\n        title: t('error'),\n        description: error.message || t('failedToSendMessage'),\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSendMessage = () => {\n    if (!newMessage.trim() || !activeChatUser) return;\n    \n    sendMessageMutation.mutate({ \n      targetUserId: activeChatUser.userId, \n      message: newMessage.trim() \n    });\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  const handleClose = () => {\n    setMessages([]);\n    setActiveChatUser(null);\n    onClose();\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <AnimatePresence>\n      {isOpen && (\n        <motion.div\n          initial={{ opacity: 0, scale: 0.8, y: 20 }}\n          animate={{ opacity: 1, scale: 1, y: 0 }}\n          exit={{ opacity: 0, scale: 0.8, y: 20 }}\n          transition={{ duration: 0.2 }}\n          className=\"w-80 max-w-sm md:w-80 sm:w-[calc(100vw-40px)] sm:max-w-[350px] pointer-events-auto\"\n        >\n            <Card className=\"shadow-xl border-2 border-blue-200 dark:border-blue-700\">\n              <CardHeader className=\"p-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white\">\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle className=\"text-sm font-medium flex items-center gap-2\">\n                    <MessageCircle className=\"h-4 w-4\" />\n                    {activeChatUser ? (\n                      <span className=\"flex items-center gap-2\">\n                        <User className=\"h-3 w-3\" />\n                        {activeChatUser.displayName}\n                      </span>\n                    ) : (\n                      t('chat')\n                    )}\n                  </CardTitle>\n                  <div className=\"flex items-center gap-1\">\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => setIsMinimized(!isMinimized)}\n                      className=\"h-6 w-6 p-0 text-white hover:bg-white/20\"\n                    >\n                      {isMinimized ? <Maximize2 className=\"h-3 w-3\" /> : <Minimize2 className=\"h-3 w-3\" />}\n                    </Button>\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={handleClose}\n                      className=\"h-6 w-6 p-0 text-white hover:bg-white/20\"\n                    >\n                      <X className=\"h-3 w-3\" />\n                    </Button>\n                  </div>\n                </div>\n              </CardHeader>\n              \n              {!isMinimized && (\n                <CardContent className=\"p-0\">\n                  <div className=\"h-64 sm:h-48 flex flex-col\">\n                    <ScrollArea className=\"flex-1 p-3 sm:p-2\">\n                      <div className=\"space-y-2\">\n                        {messages.length === 0 ? (\n                          <div className=\"text-center text-gray-500 text-sm py-8\">\n{t('noMessagesYet')}\n                          </div>\n                        ) : (\n                          messages.map((message) => (\n                            <div\n                              key={message.id}\n                              className={`flex ${message.fromMe ? 'justify-end' : 'justify-start'}`}\n                            >\n                              <div\n                                className={`max-w-xs px-3 py-2 rounded-lg text-sm ${\n                                  message.fromMe\n                                    ? 'bg-blue-500 text-white'\n                                    : 'bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-gray-100'\n                                }`}\n                              >\n                                <div className=\"font-medium text-xs opacity-70 mb-1\">\n                                  {message.fromMe ? t('you') : message.senderName}\n                                </div>\n                                <div>{message.message}</div>\n                                <div className=\"text-xs opacity-70 mt-1\">\n                                  {message.timestamp}\n                                </div>\n                              </div>\n                            </div>\n                          ))\n                        )}\n                        <div ref={messagesEndRef} />\n                      </div>\n                    </ScrollArea>\n                    \n                    <div className=\"p-3 sm:p-2 border-t bg-gray-50 dark:bg-gray-800\">\n                      <div className=\"flex gap-2\">\n                        <Input\n                          placeholder={t('typeMessage')}\n                          value={newMessage}\n                          onChange={(e) => setNewMessage(e.target.value)}\n                          onKeyPress={handleKeyPress}\n                          className=\"flex-1 text-sm sm:text-base\"\n                          disabled={!activeChatUser || sendMessageMutation.isPending}\n                        />\n                        <Button\n                          onClick={handleSendMessage}\n                          disabled={!newMessage.trim() || !activeChatUser || sendMessageMutation.isPending}\n                          size=\"sm\"\n                          className=\"px-3 sm:px-4 sm:py-2\"\n                        >\n                          <Send className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                </CardContent>\n              )}\n          </Card>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n}","size_bytes":9548},"client/src/components/ConfettiExplosion.tsx":{"content":"import React, { useEffect, useState } from 'react';\n\ninterface ConfettiPiece {\n  id: number;\n  x: number;\n  y: number;\n  vx: number;\n  vy: number;\n  rotation: number;\n  rotationSpeed: number;\n  color: string;\n  size: number;\n  gravity: number;\n}\n\ninterface ConfettiExplosionProps {\n  active: boolean;\n  duration?: number;\n  particleCount?: number;\n  colors?: string[];\n}\n\n// Move default colors outside component to prevent re-creation on every render\nconst DEFAULT_COLORS = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#f9ca24', '#f0932b', '#eb4d4b', '#6c5ce7', '#a29bfe'];\n\nexport function ConfettiExplosion({ \n  active, \n  duration = 3000, \n  particleCount = 100,\n  colors = DEFAULT_COLORS\n}: ConfettiExplosionProps) {\n  const [particles, setParticles] = useState<ConfettiPiece[]>([]);\n  const [isVisible, setIsVisible] = useState(false);\n\n  useEffect(() => {\n    if (active && typeof window !== 'undefined') {\n      // Create confetti pieces\n      const newParticles: ConfettiPiece[] = [];\n      \n      // Safe window dimensions with fallbacks\n      const centerX = window.innerWidth ? window.innerWidth / 2 : 400;\n      const centerY = window.innerHeight ? window.innerHeight / 2 : 300;\n      \n      for (let i = 0; i < particleCount; i++) {\n        const angle = (Math.PI * 2 * i) / particleCount;\n        const velocity = 5 + Math.random() * 10;\n        \n        newParticles.push({\n          id: i,\n          x: centerX,\n          y: centerY,\n          vx: Math.cos(angle) * velocity,\n          vy: Math.sin(angle) * velocity - Math.random() * 5,\n          rotation: Math.random() * 360,\n          rotationSpeed: (Math.random() - 0.5) * 10,\n          color: colors[Math.floor(Math.random() * colors.length)],\n          size: 4 + Math.random() * 6,\n          gravity: 0.3 + Math.random() * 0.2\n        });\n      }\n      \n      setParticles(newParticles);\n      setIsVisible(true);\n      \n      // Animation loop\n      let animationId: number;\n      let isAnimating = true;\n      \n      const animate = () => {\n        if (!isAnimating) return;\n        \n        setParticles(prevParticles => \n          prevParticles.map(particle => ({\n            ...particle,\n            x: particle.x + particle.vx,\n            y: particle.y + particle.vy,\n            vx: particle.vx * 0.99,\n            vy: particle.vy + particle.gravity,\n            rotation: particle.rotation + particle.rotationSpeed\n          }))\n        );\n        \n        animationId = requestAnimationFrame(animate);\n      };\n      \n      animate();\n      \n      // Clean up after duration\n      const timeout = setTimeout(() => {\n        isAnimating = false;\n        setIsVisible(false);\n        if (animationId) {\n          cancelAnimationFrame(animationId);\n        }\n        setTimeout(() => setParticles([]), 1000);\n      }, duration);\n      \n      return () => {\n        isAnimating = false;\n        clearTimeout(timeout);\n        if (animationId) {\n          cancelAnimationFrame(animationId);\n        }\n      };\n    }\n  }, [active, duration, particleCount, colors]);\n\n  if (!isVisible || particles.length === 0) return null;\n\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        width: '100%',\n        height: '100%',\n        pointerEvents: 'none',\n        zIndex: 10000\n      }}\n    >\n      {particles.map(particle => (\n        <div\n          key={particle.id}\n          style={{\n            position: 'absolute',\n            left: particle.x,\n            top: particle.y,\n            width: particle.size,\n            height: particle.size,\n            backgroundColor: particle.color,\n            transform: `rotate(${particle.rotation}deg)`,\n            borderRadius: Math.random() > 0.5 ? '50%' : '0%',\n            opacity: isVisible ? 1 : 0,\n            transition: 'opacity 1s ease-out'\n          }}\n        />\n      ))}\n    </div>\n  );\n}","size_bytes":3862},"client/src/components/CreateRoomModal.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport { showUserFriendlyError } from \"@/lib/errorUtils\";\nimport { useTranslation } from \"@/contexts/LanguageContext\";\n\ninterface CreateRoomModalProps {\n  open: boolean;\n  onClose: () => void;\n  onRoomCreated: (room: any) => void;\n}\n\nexport function CreateRoomModal({ open, onClose, onRoomCreated }: CreateRoomModalProps) {\n  const { t } = useTranslation();\n  const [roomName, setRoomName] = useState(\"\");\n  const [maxPlayers, setMaxPlayers] = useState(\"2\");\n  const [isPrivate, setIsPrivate] = useState(false);\n  const { toast } = useToast();\n\n  const createRoomMutation = useMutation({\n    mutationFn: async (roomData: any) => {\n      const response = await apiRequest('/api/rooms', { method: 'POST', body: roomData });\n      return response.json();\n    },\n    onSuccess: (room) => {\n      onRoomCreated(room);\n      onClose();\n      resetForm();\n      toast({\n        title: t('roomCreated'),\n        description: t('roomCodeCreated').replace('%s', room.code),\n      });\n    },\n    onError: (error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: t('unauthorized'),\n          description: t('loggedOutLoggingIn'),\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      \n      // Handle insufficient coins error\n      if (error.status === 403 && error.message?.includes('coins')) {\n        toast({\n          title: 'üí∞ Insufficient Coins',\n          description: error.message || 'You need 100 coins to create a room. Win AI games to earn coins!',\n          variant: \"destructive\",\n        });\n        return;\n      }\n      \n      showUserFriendlyError(error, toast);\n    },\n  });\n\n  const resetForm = () => {\n    setRoomName(\"\");\n    setMaxPlayers(\"2\");\n    setIsPrivate(false);\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!roomName.trim()) {\n      toast({\n        title: t('error'),\n        description: t('roomNameRequired'),\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    createRoomMutation.mutate({\n      name: roomName.trim(),\n      maxPlayers: parseInt(maxPlayers),\n      isPrivate,\n    });\n  };\n\n  const handleClose = () => {\n    if (!createRoomMutation.isPending) {\n      onClose();\n      resetForm();\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={handleClose}>\n      <DialogContent className=\"bg-slate-800 border-slate-700 text-white\">\n        <DialogHeader>\n          <DialogTitle className=\"text-xl\">{t('createNewRoom')}</DialogTitle>\n        </DialogHeader>\n        \n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <div>\n            <Label htmlFor=\"roomName\" className=\"text-sm font-medium text-gray-300\">\n              {t('roomName')}\n            </Label>\n            <Input\n              id=\"roomName\"\n              placeholder={t('enterRoomName')}\n              value={roomName}\n              onChange={(e) => setRoomName(e.target.value)}\n              className=\"bg-slate-700 border-slate-600 text-white mt-1\"\n              disabled={createRoomMutation.isPending}\n            />\n          </div>\n          \n          <div>\n            <Label htmlFor=\"maxPlayers\" className=\"text-sm font-medium text-gray-300\">\n              {t('maxPlayers')}\n            </Label>\n            <Select \n              value={maxPlayers} \n              onValueChange={setMaxPlayers}\n              disabled={createRoomMutation.isPending}\n            >\n              <SelectTrigger className=\"bg-slate-700 border-slate-600 text-white mt-1\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent className=\"bg-slate-700 border-slate-600\">\n                <SelectItem value=\"2\">{t('twoPlayers')}</SelectItem>\n                <SelectItem value=\"52\">{t('twoPlayersSpectators')}</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n          \n          <div className=\"flex items-center space-x-2\">\n            <Checkbox\n              id=\"private\"\n              checked={isPrivate}\n              onCheckedChange={setIsPrivate}\n              className=\"border-slate-600\"\n              disabled={createRoomMutation.isPending}\n            />\n            <Label htmlFor=\"private\" className=\"text-sm text-gray-300\">\n              {t('private')}\n            </Label>\n          </div>\n          \n          <div className=\"flex justify-end space-x-3 pt-4\">\n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              onClick={handleClose}\n              disabled={createRoomMutation.isPending}\n              className=\"border-slate-600 text-gray-300 hover:bg-slate-700\"\n            >\n              {t('cancel')}\n            </Button>\n            <Button\n              type=\"submit\"\n              disabled={createRoomMutation.isPending}\n              className=\"bg-primary hover:bg-primary/90\"\n            >\n              {createRoomMutation.isPending ? t('creating') : t('createRoom')}\n            </Button>\n          </div>\n        </form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":5741},"client/src/components/CustomLanguageSelector.tsx":{"content":"import React, { useState, useRef, useEffect } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Languages, ChevronDown } from 'lucide-react';\nimport { useLanguage, useTranslation } from '@/contexts/LanguageContext';\nimport { languages, Language } from '@/lib/i18n';\n\nexport function CustomLanguageSelector() {\n  const { language, setLanguage } = useLanguage();\n  const { t } = useTranslation();\n  const [isOpen, setIsOpen] = useState(false);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n  const buttonRef = useRef<HTMLButtonElement>(null);\n\n  const handleLanguageChange = (newLang: Language) => {\n    setLanguage(newLang);\n    setIsOpen(false);\n  };\n\n  const handleToggle = () => {\n    setIsOpen(!isOpen);\n  };\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, []);\n\n  return (\n    <div className=\"relative\" ref={dropdownRef}>\n      <Button \n        ref={buttonRef}\n        variant=\"outline\" \n        size=\"sm\" \n        className=\"gap-2\"\n        onClick={handleToggle}\n      >\n        <Languages className=\"w-4 h-4\" />\n        <span className=\"text-sm\">{languages[language].flag}</span>\n        <span className=\"hidden sm:inline\">{languages[language].name}</span>\n        <ChevronDown className=\"w-4 h-4\" />\n      </Button>\n      \n      {isOpen && (\n        <div \n          className=\"absolute right-0 top-full mt-2 w-56 bg-slate-800 border border-slate-600 rounded-lg shadow-2xl overflow-hidden\"\n          style={{ \n            zIndex: 10000,\n          }}\n        >\n          <div className=\"p-1\">\n            {Object.entries(languages).map(([code, info]) => (\n              <div\n                key={code}\n                onClick={() => handleLanguageChange(code as Language)}\n                className={`flex items-center gap-2 cursor-pointer px-2 py-1.5 text-sm rounded-sm transition-colors hover:bg-slate-700 ${\n                  language === code ? 'bg-slate-700' : ''\n                }`}\n              >\n                <span className=\"text-lg\">{info.flag}</span>\n                <span className=\"flex-1 text-white\">{info.name}</span>\n                {language === code && (\n                  <span className=\"text-xs text-gray-400\">‚úì</span>\n                )}\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}","size_bytes":2658},"client/src/components/DebugAchievements.tsx":{"content":"import { useState } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Loader2, Trophy, AlertCircle, CheckCircle, RefreshCw } from 'lucide-react';\nimport { queryClient } from '@/lib/queryClient';\n\nexport function DebugAchievements() {\n  const [isLoading, setIsLoading] = useState(false);\n  const [result, setResult] = useState<any>(null);\n\n  const handleRefreshCache = async () => {\n    try {\n      await queryClient.invalidateQueries({ queryKey: ['/api/achievements'] });\n      await queryClient.refetchQueries({ queryKey: ['/api/achievements'] });\n      console.log('Achievement cache invalidated and refetched');\n    } catch (error) {\n      console.error('Error refreshing cache:', error);\n    }\n  };\n\n  const handleRecalculate = async () => {\n    setIsLoading(true);\n    setResult(null);\n    try {\n      console.log('Making request to debug endpoint...');\n      const response = await fetch('/api/debug/recalculate-achievements', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include'\n      });\n      \n      console.log('Response status:', response.status);\n      console.log('Response headers:', response.headers);\n      \n      const responseText = await response.text();\n      console.log('Raw response:', responseText);\n      \n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText} - ${responseText}`);\n      }\n      \n      let data;\n      try {\n        data = JSON.parse(responseText);\n      } catch (parseError) {\n        throw new Error(`Invalid JSON response: ${responseText.substring(0, 100)}...`);\n      }\n      \n      console.log('Parsed response:', data);\n      setResult(data);\n      \n      // Auto-refresh cache after successful recalculation\n      if (data.success) {\n        setTimeout(async () => {\n          await handleRefreshCache();\n          // Invalidate all queries to refresh data\n          await queryClient.invalidateQueries();\n        }, 500);\n      }\n    } catch (error) {\n      console.error('Error recalculating achievements:', error);\n      setResult({ error: `${error.message}` });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleFixWinStreaks = async () => {\n    setIsLoading(true);\n    setResult(null);\n    try {\n      console.log('Making request to fix win streak achievements...');\n      const response = await fetch('/api/debug/fix-win-streak-achievements', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include'\n      });\n      \n      const data = await response.json();\n      console.log('Win streak fix response:', data);\n      setResult(data);\n      \n      // Auto-refresh cache after successful fix\n      if (data.success) {\n        setTimeout(async () => {\n          await handleRefreshCache();\n          // Invalidate all queries to refresh data\n          await queryClient.invalidateQueries();\n        }, 500);\n      }\n    } catch (error) {\n      console.error('Error fixing win streak achievements:', error);\n      setResult({ error: `${error.message}` });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <Card className=\"w-96 bg-slate-800 border-slate-700 text-white\">\n      <CardHeader className=\"pb-3\">\n        <CardTitle className=\"text-lg flex items-center gap-2\">\n          <Trophy className=\"w-5 h-5\" />\n          Debug Achievements\n        </CardTitle>\n        <CardDescription className=\"text-gray-400\">\n          Fix missing win streak achievements\n        </CardDescription>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <div className=\"space-y-2\">\n          <Button \n            onClick={handleRecalculate} \n            disabled={isLoading}\n            className=\"w-full bg-primary hover:bg-primary/90\"\n          >\n            {isLoading ? (\n              <>\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                Recalculating...\n              </>\n            ) : (\n              'Recalculate Achievements'\n            )}\n          </Button>\n          \n          <Button \n            onClick={handleFixWinStreaks} \n            disabled={isLoading}\n            className=\"w-full bg-orange-600 hover:bg-orange-700\"\n          >\n            {isLoading ? (\n              <>\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                Fixing...\n              </>\n            ) : (\n              'üî• Fix Win Streak Achievements'\n            )}\n          </Button>\n          \n          <Button \n            onClick={handleRefreshCache} \n            variant=\"outline\"\n            className=\"w-full\"\n            disabled={isLoading}\n          >\n            <RefreshCw className=\"w-4 h-4 mr-2\" />\n            Refresh Achievement Cache\n          </Button>\n        </div>\n        \n        {result && (\n          <div className=\"space-y-3\">\n            {result.error ? (\n              <div className=\"p-3 bg-red-900/20 border border-red-500/30 rounded-lg\">\n                <div className=\"flex items-center gap-2 text-red-400\">\n                  <AlertCircle className=\"w-4 h-4\" />\n                  <span className=\"font-medium\">Error</span>\n                </div>\n                <p className=\"text-sm mt-1\">{result.error}</p>\n              </div>\n            ) : (\n              <div className=\"space-y-3\">\n                <div className=\"p-3 bg-green-900/20 border border-green-500/30 rounded-lg\">\n                  <div className=\"flex items-center gap-2 text-green-400\">\n                    <CheckCircle className=\"w-4 h-4\" />\n                    <span className=\"font-medium\">Success</span>\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <h4 className=\"font-medium text-sm\">User Stats:</h4>\n                  <div className=\"flex gap-2 flex-wrap\">\n                    <Badge variant=\"outline\">Wins: {result.userStats?.wins}</Badge>\n                    <Badge variant=\"outline\">Losses: {result.userStats?.losses}</Badge>\n                    <Badge variant=\"outline\">Draws: {result.userStats?.draws}</Badge>\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <h4 className=\"font-medium text-sm\">Win Streaks:</h4>\n                  <div className=\"flex gap-2\">\n                    <Badge variant=\"outline\">Current: {result.winStreaks?.current || 0}</Badge>\n                    <Badge variant=\"outline\">Best: {result.winStreaks?.best || 0}</Badge>\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <h4 className=\"font-medium text-sm\">Achievements:</h4>\n                  <div className=\"flex gap-2 flex-wrap\">\n                    <Badge variant={result.hasWinStreak5 ? \"default\" : \"secondary\"}>\n                      Win Streak 5: {result.hasWinStreak5 ? \"‚úì\" : \"‚úó\"}\n                    </Badge>\n                    <Badge variant={result.hasWinStreak10 ? \"default\" : \"secondary\"}>\n                      Win Streak 10: {result.hasWinStreak10 ? \"‚úì\" : \"‚úó\"}\n                    </Badge>\n                  </div>\n                </div>\n\n                <details className=\"text-xs\">\n                  <summary className=\"cursor-pointer text-gray-400 hover:text-white\">\n                    Show Raw Data\n                  </summary>\n                  <pre className=\"mt-2 p-2 bg-slate-900 rounded text-xs overflow-auto\">\n                    {JSON.stringify(result, null, 2)}\n                  </pre>\n                </details>\n              </div>\n            )}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":7853},"client/src/components/EmailVerificationModal.tsx":{"content":"import { useState } from 'react';\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Mail, CheckCircle } from \"lucide-react\";\n\ninterface EmailVerificationModalProps {\n  email: string;\n  onClose: () => void;\n}\n\nexport function EmailVerificationModal({ email, onClose }: EmailVerificationModalProps) {\n  const [isResending, setIsResending] = useState(false);\n  const [resendSuccess, setResendSuccess] = useState(false);\n  const { toast } = useToast();\n\n  const handleResendVerification = async () => {\n    setIsResending(true);\n    try {\n      const response = await fetch('/api/auth/resend-verification', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email })\n      });\n\n      if (response.ok) {\n        setResendSuccess(true);\n        toast({\n          title: \"Email Sent\",\n          description: \"Verification email has been resent successfully.\",\n        });\n      } else {\n        const errorData = await response.json();\n        toast({\n          title: \"Error\",\n          description: errorData.error || \"Failed to resend verification email.\",\n          variant: \"destructive\",\n        });\n      }\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to resend verification email. Please try again.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsResending(false);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <Card className=\"w-full max-w-md mx-4 bg-slate-800 border-slate-700\">\n        <CardHeader className=\"text-center\">\n          <div className=\"mx-auto mb-4 p-3 bg-blue-100 rounded-full w-fit\">\n            <Mail className=\"h-8 w-8 text-blue-600\" />\n          </div>\n          <CardTitle className=\"text-white text-xl\">Email Verification Required</CardTitle>\n          <CardDescription className=\"text-slate-300\">\n            Please verify your email address to continue\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <Alert className=\"bg-slate-700 border-slate-600\">\n            <CheckCircle className=\"h-4 w-4 text-green-400\" />\n            <AlertDescription className=\"text-slate-300\">\n              A 6-digit verification code has been sent to <strong className=\"text-white\">{email}</strong>\n            </AlertDescription>\n          </Alert>\n          \n          <div className=\"text-sm text-slate-400 text-center\">\n            Check your email inbox for the verification code and enter it on the verification page.\n          </div>\n          \n          {resendSuccess && (\n            <Alert className=\"bg-green-900 border-green-700\">\n              <CheckCircle className=\"h-4 w-4 text-green-400\" />\n              <AlertDescription className=\"text-green-300\">\n                Verification email has been resent successfully!\n              </AlertDescription>\n            </Alert>\n          )}\n          \n          <div className=\"flex flex-col gap-2\">\n            <Button\n              onClick={() => window.dispatchEvent(new CustomEvent('navigate', { detail: { path: '/verify-email' } }))}\n              className=\"w-full bg-primary hover:bg-primary/90\"\n            >\n              Enter Verification Code\n            </Button>\n            \n            <Button\n              onClick={handleResendVerification}\n              disabled={isResending}\n              variant=\"outline\"\n              className=\"w-full border-slate-600 text-slate-300 hover:bg-slate-700\"\n            >\n              {isResending ? 'Resending...' : 'Resend Verification Code'}\n            </Button>\n            \n            <Button\n              onClick={onClose}\n              variant=\"secondary\"\n              className=\"w-full bg-slate-700 hover:bg-slate-600 text-white\"\n            >\n              Back to Login\n            </Button>\n          </div>\n          \n          <div className=\"text-xs text-slate-500 text-center\">\n            Didn't receive the code? Check your spam folder or try resending.\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":4352},"client/src/components/ErrorModal.tsx":{"content":"import { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { AlertTriangle, Coins, X } from \"lucide-react\";\n\ninterface ErrorModalProps {\n  open: boolean;\n  onClose: () => void;\n  title: string;\n  message: string;\n  type?: 'error' | 'coins' | 'warning';\n}\n\nexport function ErrorModal({ open, onClose, title, message, type = 'error' }: ErrorModalProps) {\n  const getIcon = () => {\n    switch (type) {\n      case 'coins':\n        return <Coins className=\"w-8 h-8 text-yellow-500\" />;\n      case 'warning':\n        return <AlertTriangle className=\"w-8 h-8 text-orange-500\" />;\n      default:\n        return <AlertTriangle className=\"w-8 h-8 text-red-500\" />;\n    }\n  };\n\n  const getHeaderColor = () => {\n    switch (type) {\n      case 'coins':\n        return 'text-yellow-600 dark:text-yellow-400';\n      case 'warning':\n        return 'text-orange-600 dark:text-orange-400';\n      default:\n        return 'text-red-600 dark:text-red-400';\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"sm:max-w-md bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700\">\n        <DialogHeader className=\"text-center space-y-4\">\n          <button\n            onClick={onClose}\n            className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\"\n          >\n            <X className=\"h-4 w-4\" />\n            <span className=\"sr-only\">Close</span>\n          </button>\n          \n          <div className=\"flex justify-center\">\n            {getIcon()}\n          </div>\n          \n          <DialogTitle className={`text-xl font-semibold ${getHeaderColor()}`}>\n            {title}\n          </DialogTitle>\n        </DialogHeader>\n        \n        <div className=\"space-y-4\">\n          <p className=\"text-center text-gray-600 dark:text-gray-300 leading-relaxed\">\n            {message}\n          </p>\n          \n          <div className=\"flex justify-center pt-2\">\n            <Button \n              onClick={onClose}\n              className=\"px-8 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors\"\n            >\n              Got it\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":2515},"client/src/components/ForgotPasswordModal.tsx":{"content":"import { useState } from 'react';\nimport { useLocation } from 'wouter';\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { KeyRound, CheckCircle, AlertTriangle, Mail } from \"lucide-react\";\n\ninterface ForgotPasswordModalProps {\n  onClose: () => void;\n}\n\nexport function ForgotPasswordModal({ onClose }: ForgotPasswordModalProps) {\n  const [email, setEmail] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [isSuccess, setIsSuccess] = useState(false);\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n\n    try {\n      const response = await fetch('/api/auth/forgot-password', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email })\n      });\n\n      const data = await response.json();\n\n      if (response.ok) {\n        setIsSuccess(true);\n        toast({\n          title: \"Reset Code Sent\",\n          description: data.message,\n        });\n      } else {\n        toast({\n          title: \"Error\",\n          description: data.error || \"Failed to send reset email.\",\n          variant: \"destructive\",\n        });\n      }\n    } catch (error) {\n      toast({\n        title: \"Connection Error\",\n        description: \"Failed to send reset email. Please check your internet connection.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <Card className=\"w-full max-w-md mx-4 bg-slate-800 border-slate-700\">\n        <CardHeader className=\"text-center\">\n          <div className=\"mx-auto mb-4 p-3 bg-red-100 rounded-full w-fit\">\n            <KeyRound className=\"h-8 w-8 text-red-600\" />\n          </div>\n          <CardTitle className=\"text-white text-xl\">\n            {isSuccess ? \"Reset Email Sent\" : \"Forgot Password\"}\n          </CardTitle>\n          <CardDescription className=\"text-slate-300\">\n            {isSuccess \n              ? \"Check your email for your password reset code\"\n              : \"Enter your email address to receive a password reset code\"\n            }\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {isSuccess ? (\n            <>\n              <Alert className=\"bg-green-900 border-green-700\">\n                <CheckCircle className=\"h-4 w-4 text-green-400\" />\n                <AlertDescription className=\"text-green-300\">\n                  If an account with this email exists, a password reset code has been sent.\n                </AlertDescription>\n              </Alert>\n              \n              <div className=\"text-sm text-slate-400 text-center\">\n                Check your email inbox for your 6-digit reset code.\n              </div>\n              \n              <div className=\"flex flex-col gap-2\">\n                <Button\n                  onClick={() => {\n                    onClose();\n                    setLocation('/reset-password');\n                  }}\n                  className=\"w-full bg-primary hover:bg-primary/90\"\n                >\n                  Enter Reset Code\n                </Button>\n                \n                <Button\n                  onClick={onClose}\n                  variant=\"outline\"\n                  className=\"w-full border-slate-600 text-slate-300 hover:bg-slate-700\"\n                >\n                  Back to Login\n                </Button>\n              </div>\n            </>\n          ) : (\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"reset-email\" className=\"text-slate-300\">Email Address</Label>\n                <Input\n                  id=\"reset-email\"\n                  type=\"email\"\n                  placeholder=\"Enter your email address\"\n                  value={email}\n                  onChange={(e) => setEmail(e.target.value)}\n                  required\n                  className=\"bg-slate-700 border-slate-600 text-white\"\n                />\n              </div>\n              \n              <div className=\"flex flex-col gap-2\">\n                <Button\n                  type=\"submit\"\n                  disabled={isLoading}\n                  className=\"w-full bg-red-600 hover:bg-red-700\"\n                >\n                  {isLoading ? 'Sending...' : 'Send Reset Code'}\n                </Button>\n                \n                <Button\n                  type=\"button\"\n                  onClick={onClose}\n                  variant=\"secondary\"\n                  className=\"w-full bg-slate-700 hover:bg-slate-600 text-white\"\n                >\n                  Cancel\n                </Button>\n              </div>\n              \n\n            </form>\n          )}\n          \n          <div className=\"text-xs text-slate-500 text-center\">\n            Remember your password? Return to login to sign in.\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":5411},"client/src/components/Friends.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { useAuth } from '@/hooks/useAuth';\nimport { useOnlineStatus } from '@/hooks/useOnlineStatus';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle,  DialogTrigger } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport { Users, UserPlus, UserCheck, UserX, Trophy, TrendingUp, Calendar, Loader2, MessageCircle, Send } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { apiRequest } from '@/lib/queryClient';\nimport { User } from '@shared/schema';\nimport { showUserFriendlyError } from '@/lib/errorUtils';\nimport { useTranslation } from '@/contexts/LanguageContext';\n\ninterface FriendRequest {\n  id: string;\n  requesterId: string;\n  requestedId: string;\n  status: string;\n  sentAt: string;\n  respondedAt: string | null;\n  requester: User;\n  requested: User;\n}\n\ninterface HeadToHeadStats {\n  totalGames: number;\n  wins: number;\n  losses: number;\n  draws: number;\n  winRate: number;\n  recentGames: Array<{\n    id: string;\n    result: 'win' | 'loss' | 'draw';\n    playedAt: string;\n  }>;\n}\n\nexport function Friends() {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  const { isOnline } = useOnlineStatus();\n  const [isOpen, setIsOpen] = useState(false);\n  const [searchName, setSearchName] = useState('');\n  const [selectedFriend, setSelectedFriend] = useState<User | null>(null);\n  const [selectedChatFriend, setSelectedChatFriend] = useState<User | null>(null);\n  const [chatMessage, setChatMessage] = useState(\"\");\n  const [chatHistory, setChatHistory] = useState<Map<string, any[]>>(new Map());\n  const [unreadMessages, setUnreadMessages] = useState<Map<string, number>>(new Map());\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // Fetch friends list\n  const { data: friends = [], isLoading: friendsLoading } = useQuery<User[]>({\n    queryKey: ['/api/friends'],\n    enabled: isOpen,\n  });\n\n  // Fetch friend requests\n  const { data: friendRequests = [], isLoading: requestsLoading } = useQuery<FriendRequest[]>({\n    queryKey: ['/api/friends/requests'],\n    enabled: isOpen,\n  });\n\n  // Fetch head-to-head stats for selected friend\n  const { data: headToHeadStats, isLoading: headToHeadLoading, error: headToHeadError } = useQuery<HeadToHeadStats>({\n    queryKey: ['/api/head-to-head', (user as any)?.userId, selectedFriend?.id],\n    enabled: !!selectedFriend && !!selectedFriend?.id && !!(user as any)?.userId,\n    retry: 1,\n  });\n\n  // Fetch online users for online status indicators\n  const { data: onlineUsersData } = useQuery<{ total: number; users: any[] }>({\n    queryKey: ['/api/users/online'],\n    enabled: isOpen,\n    refetchInterval: 30000, // Refresh every 30 seconds\n  });\n\n  // Send friend request mutation\n  const sendFriendRequest = useMutation({\n    mutationFn: async (requestedId: string) => {\n      return await apiRequest('/api/friends/request', { method: 'POST', body: { requestedId } });\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Friend request sent successfully\",\n      });\n      setSearchName('');\n      setSearchResults([]);\n      queryClient.invalidateQueries({ queryKey: ['/api/friends/requests'] });\n    },\n    onError: (error: any) => {\n      showUserFriendlyError(error, toast);\n    },\n  });\n\n  // Respond to friend request mutation\n  const respondToFriendRequest = useMutation({\n    mutationFn: async ({ requestId, response }: { requestId: string; response: 'accepted' | 'rejected' }) => {\n      return await apiRequest('/api/friends/respond', { method: 'POST', body: { requestId, response } });\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Friend request responded to successfully\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/friends/requests'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/friends'] });\n    },\n    onError: (error: any) => {\n      showUserFriendlyError(error, toast);\n    },\n  });\n\n  // Remove friend mutation\n  const removeFriend = useMutation({\n    mutationFn: async (friendId: string) => {\n      return await apiRequest(`/api/friends/${friendId}`, { method: 'DELETE' });\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Friend removed successfully\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/friends'] });\n      setSelectedFriend(null);\n    },\n    onError: (error: any) => {\n      showUserFriendlyError(error, toast);\n    },\n  });\n\n  // State for search results\n  const [searchResults, setSearchResults] = useState<User[]>([]);\n  const [isSearching, setIsSearching] = useState(false);\n\n  // Chat functionality\n  const sendMessageMutation = useMutation({\n    mutationFn: async ({ targetUserId, message }: { targetUserId: string; message: string }) => {\n      return await apiRequest('/api/chat/send', { method: 'POST', body: { targetUserId, message } });\n    },\n    onSuccess: (data, variables) => {\n      if (selectedChatFriend) {\n        // Add the sent message to chat history for this user\n        const newMessage = {\n          fromMe: true,\n          message: chatMessage,\n          timestamp: new Date().toLocaleTimeString(),\n          userId: variables.targetUserId\n        };\n        \n        setChatHistory(prev => {\n          const newHistory = new Map(prev);\n          const userMessages = newHistory.get(selectedChatFriend.id) || [];\n          newHistory.set(selectedChatFriend.id, [...userMessages, newMessage]);\n          return newHistory;\n        });\n      }\n      setChatMessage(\"\");\n    },\n    onError: (error: any) => {\n      console.error('Chat message error:', error);\n      showUserFriendlyError(error, toast);\n    },\n  });\n\n  // Handle incoming chat messages\n  useEffect(() => {\n    const handleChatMessage = (event: CustomEvent) => {\n      const data = event.detail;\n      \n      if (data.type === 'chat_message_received') {\n        const incomingMessage = {\n          fromMe: false,\n          message: data.message.message,\n          timestamp: new Date(data.message.timestamp).toLocaleTimeString(),\n          userId: data.message.senderId,\n          senderName: data.message.senderName\n        };\n        \n        // Always add to chat history for this sender, regardless of dialog state\n        setChatHistory(prev => {\n          const newHistory = new Map(prev);\n          const userMessages = newHistory.get(data.message.senderId) || [];\n          newHistory.set(data.message.senderId, [...userMessages, incomingMessage]);\n          return newHistory;\n        });\n        \n        // Update unread count if Friends modal is not open or friend not selected\n        if (!isOpen || !selectedChatFriend || selectedChatFriend.id !== data.message.senderId) {\n          setUnreadMessages(prev => {\n            const newUnread = new Map(prev);\n            const currentUnread = newUnread.get(data.message.senderId) || 0;\n            newUnread.set(data.message.senderId, currentUnread + 1);\n            return newUnread;\n          });\n        }\n      }\n    };\n\n    const handleOnlineStatusUpdate = (event: CustomEvent) => {\n      const data = event.detail;\n      \n      // Refresh online users data when users come online/offline\n      if (data.type === 'online_users_update' || data.type === 'user_offline') {\n        queryClient.invalidateQueries({ queryKey: ['/api/users/online'] });\n      }\n      \n      // Clear chat history for users who go offline\n      if (data.type === 'user_offline' && data.userId) {\n        setChatHistory(prev => {\n          const newHistory = new Map(prev);\n          newHistory.delete(data.userId);\n          return newHistory;\n        });\n        \n        // Clear unread messages for the offline user\n        setUnreadMessages(prev => {\n          const newUnread = new Map(prev);\n          newUnread.delete(data.userId);\n          return newUnread;\n        });\n        \n        // Close chat dialog if currently chatting with the offline user\n        if (selectedChatFriend && selectedChatFriend.id === data.userId) {\n          setSelectedChatFriend(null);\n        }\n        \n        console.log(`üí¨ Friends: Cleared chat history for offline user: ${data.userId}`);\n      }\n    };\n\n    // Always listen for events to maintain chat history\n    window.addEventListener('chat_message_received', handleChatMessage as EventListener);\n    window.addEventListener('online_status_update', handleOnlineStatusUpdate as EventListener);\n    \n    return () => {\n      window.removeEventListener('chat_message_received', handleChatMessage as EventListener);\n      window.removeEventListener('online_status_update', handleOnlineStatusUpdate as EventListener);\n    };\n  }, [selectedChatFriend, queryClient]);\n\n  const handleSendMessage = () => {\n    if (!chatMessage.trim() || !selectedChatFriend) return;\n    \n    sendMessageMutation.mutate({ \n      targetUserId: selectedChatFriend.id, \n      message: chatMessage.trim() \n    });\n  };\n\n  const startChatWithFriend = (friend: User) => {\n    setSelectedChatFriend(friend);\n    // Clear unread messages for this friend\n    setUnreadMessages(prev => {\n      const newUnread = new Map(prev);\n      newUnread.delete(friend.id);\n      return newUnread;\n    });\n  };\n\n  // Get current chat messages for selected friend\n  const currentChatMessages = selectedChatFriend ? chatHistory.get(selectedChatFriend.id) || [] : [];\n\n  // Helper function to check if a friend is online\n  const isUserOnline = (friendId: string) => {\n    return onlineUsersData?.users?.some(onlineUser => onlineUser.userId === friendId) || false;\n  };\n\n  // Find users by name for friend requests\n  const findUsersByName = async () => {\n    if (!searchName.trim()) return;\n\n    setIsSearching(true);\n    try {\n      const response = await apiRequest('/api/users/search', { method: 'POST', body: { name: searchName.trim() } });\n      \n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.error || errorData.message || `HTTP ${response.status}`);\n      }\n      \n      const data = await response.json();\n      \n      if (data.users) {\n        setSearchResults(data.users);\n      } else {\n        setSearchResults([]);\n      }\n    } catch (error: any) {\n      console.error(\"Friend search error:\", error);\n      showUserFriendlyError(error, toast);\n      setSearchResults([]);\n    } finally {\n      setIsSearching(false);\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString();\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={setIsOpen}>\n      <DialogTrigger asChild>\n        <Button variant=\"ghost\" size=\"sm\" className=\"w-full justify-start\">\n          <Users className=\"h-4 w-4 mr-2\" />\n          {t('friends')}\n          {friendRequests.length > 0 && (\n            <Badge variant=\"destructive\" className=\"ml-auto\">\n              {friendRequests.length}\n            </Badge>\n          )}\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"sm:max-w-[600px] max-h-[80vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>{t('friends')}</DialogTitle>\n        </DialogHeader>\n        \n        <Tabs defaultValue=\"friends\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-3\">\n            <TabsTrigger value=\"friends\">\n              {t('friends')} ({friends.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"requests\">\n              {t('requests')}\n              {friendRequests.length > 0 && (\n                <Badge variant=\"destructive\" className=\"ml-1\">\n                  {friendRequests.length}\n                </Badge>\n              )}\n            </TabsTrigger>\n            <TabsTrigger value=\"add\">{t('addFriend')}</TabsTrigger>\n          </TabsList>\n          \n          <TabsContent value=\"friends\" className=\"space-y-4\">\n            {friendsLoading ? (\n              <div className=\"text-center py-8\">{t('loadingFriends')}</div>\n            ) : friends.length === 0 ? (\n              <div className=\"text-center py-8 text-muted-foreground\">\n                {t('noFriends')}\n              </div>\n            ) : (\n              <div className=\"space-y-2\">\n                {friends\n                  .sort((a, b) => {\n                    // Sort online friends first\n                    const aOnline = isUserOnline(a.id);\n                    const bOnline = isUserOnline(b.id);\n                    if (aOnline && !bOnline) return -1;\n                    if (!aOnline && bOnline) return 1;\n                    return 0;\n                  })\n                  .map((friend) => (\n                  <div\n                    key={friend.id}\n                    className=\"flex items-center justify-between p-3 border rounded-lg hover:bg-accent cursor-pointer\"\n                    onClick={() => setSelectedFriend(friend)}\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"relative\">\n                        {friend.profileImageUrl ? (\n                          <img\n                            src={friend.profileImageUrl}\n                            alt={friend.displayName || `${friend.firstName} ${friend.lastName || ''}`.trim()}\n                            className=\"w-10 h-10 rounded-full\"\n                          />\n                        ) : (\n                          <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-medium\">\n                            {friend.firstName?.[0] || '?'}{friend.lastName?.[0] || ''}\n                          </div>\n                        )}\n                        {/* Online status indicator */}\n                        {isUserOnline(friend.id) && (\n                          <div className=\"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-500 border-2 border-white dark:border-gray-800 rounded-full\"></div>\n                        )}\n                      </div>\n                      <div>\n                        <div className=\"font-medium flex items-center gap-2\">\n                          {friend.displayName || `${friend.firstName} ${friend.lastName || ''}`.trim()}\n                          {isUserOnline(friend.id) && (\n                            <Badge variant=\"secondary\" className=\"text-xs px-1.5 py-0.5 bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300\">\n                              Online\n                            </Badge>\n                          )}\n                        </div>\n                        <div className=\"text-sm text-muted-foreground\">\n                          {friend.wins}W-{friend.losses}L-{friend.draws}D\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"flex gap-2\">\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          startChatWithFriend(friend);\n                        }}\n                        className=\"relative\"\n                      >\n                        <MessageCircle className=\"h-4 w-4 mr-1\" />\n                        {t('chat')}\n                        {unreadMessages.get(friend.id) && (\n                          <span className=\"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center\">\n                            {unreadMessages.get(friend.id)}\n                          </span>\n                        )}\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          removeFriend.mutate(friend.id);\n                        }}\n                      >\n                        <UserX className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </TabsContent>\n          \n          <TabsContent value=\"requests\" className=\"space-y-4\">\n            {requestsLoading ? (\n              <div className=\"text-center py-8\">{t('loadingFriends')}</div>\n            ) : friendRequests.length === 0 ? (\n              <div className=\"text-center py-8 text-muted-foreground\">\n                {t('noPendingRequests')}\n              </div>\n            ) : (\n              <div className=\"space-y-2\">\n                {friendRequests.map((request) => (\n                  <div\n                    key={request.id}\n                    className=\"flex items-center justify-between p-3 border rounded-lg\"\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      {request.requester.profileImageUrl ? (\n                        <img\n                          src={request.requester.profileImageUrl}\n                          alt={request.requester.displayName || `${request.requester.firstName} ${request.requester.lastName || ''}`.trim()}\n                          className=\"w-10 h-10 rounded-full\"\n                        />\n                      ) : (\n                        <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-medium\">\n                          {request.requester.firstName?.[0] || '?'}{request.requester.lastName?.[0] || ''}\n                        </div>\n                      )}\n                      <div>\n                        <div className=\"font-medium\">\n                          {request.requester.displayName || `${request.requester.firstName} ${request.requester.lastName || ''}`.trim()}\n                        </div>\n                        <div className=\"text-sm text-muted-foreground\">\n                          {t('sentOn')} {formatDate(request.sentAt)}\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"flex gap-2\">\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => respondToFriendRequest.mutate({ requestId: request.id, response: 'accepted' })}\n                      >\n                        <UserCheck className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => respondToFriendRequest.mutate({ requestId: request.id, response: 'rejected' })}\n                      >\n                        <UserX className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </TabsContent>\n          \n          <TabsContent value=\"add\" className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <label htmlFor=\"name\" className=\"text-sm font-medium\">\n                {t('searchFriends')}\n              </label>\n              <div className=\"flex gap-2\">\n                <Input\n                  id=\"name\"\n                  type=\"text\"\n                  placeholder={t('searchFriends')}\n                  value={searchName}\n                  onChange={(e) => setSearchName(e.target.value)}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter') {\n                      findUsersByName();\n                    }\n                  }}\n                />\n                <Button\n                  onClick={findUsersByName}\n                  disabled={!searchName.trim() || isSearching}\n                >\n                  {isSearching ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : <UserPlus className=\"h-4 w-4\" />}\n                </Button>\n              </div>\n            </div>\n            \n            {/* Search Results */}\n            {searchResults.length > 0 && (\n              <div className=\"space-y-2\">\n                <div className=\"text-sm font-medium\">{t('searchResults')}:</div>\n                {searchResults.map((user) => (\n                  <div\n                    key={user.id}\n                    className=\"flex items-center justify-between p-3 border rounded-lg hover:bg-accent\"\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      {user.profileImageUrl ? (\n                        <img\n                          src={user.profileImageUrl}\n                          alt={user.displayName || `${user.firstName} ${user.lastName || ''}`.trim()}\n                          className=\"w-10 h-10 rounded-full\"\n                        />\n                      ) : (\n                        <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-medium\">\n                          {user.firstName?.[0] || '?'}{user.lastName?.[0] || ''}\n                        </div>\n                      )}\n                      <div>\n                        <div className=\"font-medium\">\n                          {user.displayName || `${user.firstName} ${user.lastName || ''}`.trim()}\n                        </div>\n                        <div className=\"text-sm text-muted-foreground\">\n                          {user.wins}W-{user.losses}L-{user.draws}D\n                        </div>\n                      </div>\n                    </div>\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => sendFriendRequest.mutate(user.id)}\n                      disabled={sendFriendRequest.isPending}\n                    >\n                      <UserPlus className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                ))}\n              </div>\n            )}\n          </TabsContent>\n        </Tabs>\n        \n        {/* Head-to-head stats modal */}\n        {selectedFriend && (\n          <Dialog open={!!selectedFriend} onOpenChange={() => setSelectedFriend(null)}>\n            <DialogContent className=\"sm:max-w-[500px]\">\n              <DialogHeader>\n                <DialogTitle>\n                  {t('headToHeadStats')} with {selectedFriend.displayName || `${selectedFriend.firstName} ${selectedFriend.lastName || ''}`.trim()}\n                </DialogTitle>\n              </DialogHeader>\n              \n              {headToHeadLoading ? (\n                <div className=\"flex items-center justify-center py-8\">\n                  <Loader2 className=\"w-6 h-6 animate-spin mr-2\" />\n                  <span>{t('loadingStats')}</span>\n                </div>\n              ) : headToHeadError ? (\n                <div className=\"text-center py-8\">\n                  <p className=\"text-red-500 mb-2\">Failed to load head-to-head stats</p>\n                  <p className=\"text-sm text-muted-foreground\">\n                    {headToHeadError.message}\n                  </p>\n                </div>\n              ) : headToHeadStats ? (\n                <div className=\"space-y-4\">\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div className=\"text-center p-4 border rounded-lg\">\n                      <div className=\"text-2xl font-bold text-blue-600\">\n                        {headToHeadStats.wins}\n                      </div>\n                      <div className=\"text-sm text-muted-foreground\">{t('youWon')}</div>\n                    </div>\n                    <div className=\"text-center p-4 border rounded-lg\">\n                      <div className=\"text-2xl font-bold text-red-600\">\n                        {headToHeadStats.losses}\n                      </div>\n                      <div className=\"text-sm text-muted-foreground\">{t('theyWon')}</div>\n                    </div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-3 gap-4\">\n                    <div className=\"text-center p-3 border rounded-lg\">\n                      <div className=\"text-lg font-bold\">\n                        {headToHeadStats.totalGames}\n                      </div>\n                      <div className=\"text-sm text-muted-foreground\">{t('totalGames')}</div>\n                    </div>\n                    <div className=\"text-center p-3 border rounded-lg\">\n                      <div className=\"text-lg font-bold\">\n                        {headToHeadStats.draws}\n                      </div>\n                      <div className=\"text-sm text-muted-foreground\">{t('draws')}</div>\n                    </div>\n                    <div className=\"text-center p-3 border rounded-lg\">\n                      <div className=\"text-lg font-bold\">\n                        {headToHeadStats.winRate}%\n                      </div>\n                      <div className=\"text-sm text-muted-foreground\">{t('yourWinRate')}</div>\n                    </div>\n                  </div>\n                </div>\n              ) : (\n                <div className=\"text-center py-8\">No games played yet</div>\n              )}\n            </DialogContent>\n          </Dialog>\n        )}\n\n        {/* Chat modal */}\n        {selectedChatFriend && (\n          <Dialog open={!!selectedChatFriend} onOpenChange={() => setSelectedChatFriend(null)}>\n            <DialogContent className=\"sm:max-w-[500px]\">\n              <DialogHeader>\n                <DialogTitle className=\"flex items-center gap-3\">\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={() => setSelectedChatFriend(null)}\n                  >\n                    ‚Üê {t('back')}\n                  </Button>\n                  <div className=\"flex items-center gap-3\">\n                    {selectedChatFriend.profileImageUrl ? (\n                      <img\n                        src={selectedChatFriend.profileImageUrl}\n                        alt={selectedChatFriend.displayName || `${selectedChatFriend.firstName} ${selectedChatFriend.lastName || ''}`.trim()}\n                        className=\"h-8 w-8 rounded-full object-cover\"\n                      />\n                    ) : (\n                      <div className=\"h-8 w-8 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-medium\">\n                        {selectedChatFriend.firstName?.[0] || '?'}{selectedChatFriend.lastName?.[0] || ''}\n                      </div>\n                    )}\n                    <span className=\"font-medium\">\n                      {t('chatWith')} {selectedChatFriend.displayName || `${selectedChatFriend.firstName} ${selectedChatFriend.lastName || ''}`.trim()}\n                    </span>\n                  </div>\n                </DialogTitle>\n              </DialogHeader>\n              \n              <div className=\"space-y-4\">\n                <ScrollArea className=\"h-[300px] w-full\">\n                  <div className=\"space-y-2\">\n                    {currentChatMessages.length > 0 ? (\n                      currentChatMessages.map((msg, index) => (\n                        <div key={index} className={`p-2 rounded-lg ${msg.fromMe ? 'bg-blue-100 dark:bg-blue-900 ml-4' : 'bg-gray-100 dark:bg-gray-800 mr-4'}`}>\n                          <div className=\"text-sm font-medium\">{msg.fromMe ? t('you') : selectedChatFriend.displayName || selectedChatFriend.firstName || selectedChatFriend.username}</div>\n                          <div className=\"text-sm\">{msg.message}</div>\n                          <div className=\"text-xs text-muted-foreground mt-1\">{msg.timestamp}</div>\n                        </div>\n                      ))\n                    ) : (\n                      <div className=\"text-center py-8 text-muted-foreground\">\n                        {t('noMessages')}\n                      </div>\n                    )}\n                  </div>\n                </ScrollArea>\n                \n                <div className=\"flex gap-2\">\n                  <Input\n                    value={chatMessage}\n                    onChange={(e) => setChatMessage(e.target.value)}\n                    placeholder={t('typeMessage')}\n                    onKeyPress={(e) => e.key === 'Enter' && handleSendMessage()}\n                  />\n                  <Button\n                    size=\"sm\"\n                    onClick={handleSendMessage}\n                    disabled={!chatMessage.trim() || sendMessageMutation.isPending}\n                  >\n                    <Send className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n            </DialogContent>\n          </Dialog>\n        )}\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":29165},"client/src/components/GameBoard.tsx":{"content":"import { useState, useEffect, useMemo } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useToast } from \"@/hooks/use-toast\";\n// useAudio hook removed as sound effects are removed\n// Removed useWebSocket import - messages now come from parent component\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport { motion, AnimatePresence } from \"framer-motion\"; // Added back for winning line animation\nimport { useTheme } from \"@/contexts/ThemeContext\";\nimport { User, MessageCircle } from \"lucide-react\";\nimport { QuickChatPanel } from '@/components/QuickChatPanel';\nimport { useTranslation } from \"@/contexts/LanguageContext\";\nimport { PlayerProfileModal } from '@/components/PlayerProfileModal';\n\nconst VALID_POSITIONS = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15];\n\n// Player quick chat system\ninterface PlayerMessage {\n  text: string;\n  duration: number;\n}\n\nconst QUICK_CHAT_MESSAGES = [\n  { text: 'Good luck!', duration: 4000 },\n  { text: 'Well played!', duration: 3500 },\n  { text: 'Nice move!', duration: 3000 },\n  { text: 'Great strategy!', duration: 3500 },\n  { text: 'Play faster!', duration: 3000 },\n  { text: 'Take your time', duration: 3500 },\n  { text: 'Good game!', duration: 4000 },\n  { text: 'Thanks for the game!', duration: 3000 },\n  { text: 'One more?', duration: 3000 },\n  { text: 'Impressive!', duration: 3500 },\n  { text: 'Thinking...', duration: 4000 },\n  { text: 'Ready to play!', duration: 3000 }\n];\n\n// Helper function to check if player has Legend achievement\nconst hasLegendAchievement = (achievements: any[]): boolean => {\n  return achievements?.some(achievement => achievement.achievementType === 'legend') || false;\n};\n\n// Helper function to check if player has Champion achievement (100 wins)\nconst hasChampionAchievement = (achievements: any[]): boolean => {\n  return achievements?.some(achievement => achievement.achievementType === 'champion') || false;\n};\n\n// Helper function to check if player has Grandmaster achievement (200 wins)\nconst hasGrandmasterAchievement = (achievements: any[]): boolean => {\n  return achievements?.some(achievement => achievement.achievementType === 'grandmaster') || false;\n};\n\n// Helper function to check if player has Ultimate Veteran achievement (500 games)\nconst hasUltimateVeteranAchievement = (achievements: any[]): boolean => {\n  return achievements?.some(achievement => achievement.achievementType === 'ultimate_veteran') || false;\n};\n\n// Helper function to get the selected achievement border for display\nconst getSelectedAchievementBorder = (playerInfo: any): string | null => {\n  // If player has selectedAchievementBorder, use that (including null for no border)\n  if (playerInfo?.selectedAchievementBorder !== undefined) {\n    return playerInfo.selectedAchievementBorder;\n  }\n  \n  // Fallback to auto-detection of highest achievement for legacy users\n  const achievements = playerInfo?.achievements || [];\n  if (hasUltimateVeteranAchievement(achievements)) return 'ultimate_veteran';\n  if (hasGrandmasterAchievement(achievements)) return 'grandmaster';\n  if (hasChampionAchievement(achievements)) return 'champion';\n  if (hasLegendAchievement(achievements)) return 'legend';\n  \n  return null; // No border\n};\n\n// Helper function to render achievement borders based on selected type\nconst renderAchievementBorder = (borderType: string | null, playerName: string, theme: any) => {\n  switch (borderType) {\n    case 'ultimate_veteran':\n      return (\n        <motion.div\n          animate={{\n            boxShadow: [\n              \"0 0 15px #ff6347, 0 0 30px #ff4500, 0 0 45px #ff8c00, 0 0 60px #ffd700, 0 0 75px #ff6347\",\n              \"0 0 20px #ff1493, 0 0 40px #dc143c, 0 0 60px #b22222, 0 0 80px #8b0000, 0 0 100px #ff1493\",\n              \"0 0 18px #ff6600, 0 0 36px #ff3300, 0 0 54px #ff0000, 0 0 72px #cc0000, 0 0 90px #ff6600\",\n              \"0 0 25px #ffa500, 0 0 50px #ff8c00, 0 0 75px #ff7f50, 0 0 100px #ff6347, 0 0 125px #ffa500\"\n            ],\n            scale: [1, 1.05, 1.03, 1.07, 1],\n            rotate: [0, 2, -1, 3, 0],\n            filter: [\n              \"brightness(1) saturate(1)\",\n              \"brightness(1.2) saturate(1.3)\",\n              \"brightness(1.1) saturate(1.1)\",\n              \"brightness(1.3) saturate(1.4)\",\n              \"brightness(1) saturate(1)\"\n            ]\n          }}\n          transition={{\n            duration: 2,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }}\n          className=\"px-2 py-1 rounded-lg border-3 border-double border-orange-600 bg-gradient-to-r from-red-900/30 via-orange-800/30 to-red-900/30 relative overflow-hidden\"\n          style={{\n            background: \"linear-gradient(45deg, rgba(255, 69, 0, 0.2), rgba(255, 140, 0, 0.15), rgba(255, 99, 71, 0.2), rgba(255, 165, 0, 0.15))\",\n            backgroundSize: \"400% 400%\",\n            animation: \"gradient-shift 3s ease infinite\"\n          }}\n        >\n          <motion.span \n            className={`text-sm ${theme.textColor} max-w-24 truncate font-black relative z-10`}\n            animate={{\n              textShadow: [\n                \"0 0 8px #ff6347, 0 0 12px #ff4500, 0 0 16px #ffd700\",\n                \"0 0 10px #ff1493, 0 0 15px #dc143c, 0 0 20px #8b0000\",\n                \"0 0 9px #ff6600, 0 0 13px #ff3300, 0 0 17px #cc0000\",\n                \"0 0 12px #ffa500, 0 0 18px #ff8c00, 0 0 24px #ff7f50\"\n              ]\n            }}\n            transition={{\n              duration: 2,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n          >\n            {playerName}\n          </motion.span>\n          <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-orange-400/20 to-transparent animate-shimmer\"></div>\n        </motion.div>\n      );\n    case 'grandmaster':\n      return (\n        <motion.div\n          animate={{\n            boxShadow: [\n              \"0 0 12px #e0e7ff, 0 0 24px #c7d2fe, 0 0 36px #a5b4fc, 0 0 48px #818cf8\",\n              \"0 0 16px #f3f4f6, 0 0 32px #e5e7eb, 0 0 48px #d1d5db, 0 0 64px #9ca3af\",\n              \"0 0 14px #ddd6fe, 0 0 28px #c4b5fd, 0 0 42px #a78bfa, 0 0 56px #8b5cf6\",\n              \"0 0 18px #fef3c7, 0 0 36px #fde68a, 0 0 54px #fcd34d, 0 0 72px #f59e0b\"\n            ],\n            scale: [1, 1.03, 1.01, 1.04, 1],\n            rotate: [0, 1, -0.5, 1.5, 0]\n          }}\n          transition={{\n            duration: 2.5,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }}\n          className=\"px-2 py-1 rounded-lg border-2 border-indigo-400 bg-gradient-to-r from-indigo-900/25 via-gray-800/25 to-indigo-900/25 relative\"\n          style={{\n            background: \"linear-gradient(45deg, rgba(99, 102, 241, 0.15), rgba(156, 163, 175, 0.1), rgba(139, 92, 246, 0.15), rgba(245, 158, 11, 0.1))\",\n            backgroundSize: \"300% 300%\",\n          }}\n        >\n          <motion.span \n            className={`text-sm ${theme.textColor} max-w-24 truncate font-bold`}\n            animate={{\n              textShadow: [\n                \"0 0 6px #818cf8\",\n                \"0 0 8px #9ca3af\",\n                \"0 0 7px #8b5cf6\",\n                \"0 0 9px #f59e0b\"\n              ]\n            }}\n            transition={{\n              duration: 2.5,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n          >\n            {playerName}\n          </motion.span>\n        </motion.div>\n      );\n    case 'champion':\n      return (\n        <motion.div\n          animate={{\n            boxShadow: [\n              \"0 0 10px #8a2be2, 0 0 20px #4b0082, 0 0 30px #9932cc, 0 0 40px #8a2be2\",\n              \"0 0 15px #00bfff, 0 0 30px #1e90ff, 0 0 45px #4169e1, 0 0 60px #00bfff\",\n              \"0 0 12px #ffd700, 0 0 24px #ffff00, 0 0 36px #ffa500, 0 0 48px #ffd700\",\n              \"0 0 18px #ff69b4, 0 0 36px #ff1493, 0 0 54px #dc143c, 0 0 72px #ff69b4\",\n              \"0 0 10px #8a2be2, 0 0 20px #4b0082, 0 0 30px #9932cc, 0 0 40px #8a2be2\"\n            ],\n            scale: [1, 1.02, 1, 1.01, 1],\n            rotate: [0, 1, 0, -1, 0]\n          }}\n          transition={{\n            duration: 3,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }}\n          className=\"px-2 py-1 rounded-lg border-2 border-purple-500 bg-gradient-to-r from-purple-900/20 via-blue-900/20 to-purple-900/20\"\n          style={{\n            background: \"linear-gradient(45deg, rgba(138, 43, 226, 0.1), rgba(30, 144, 255, 0.1), rgba(255, 105, 180, 0.1), rgba(138, 43, 226, 0.1))\",\n            backgroundSize: \"300% 300%\",\n          }}\n        >\n          <motion.span \n            className={`text-sm ${theme.textColor} max-w-24 truncate font-bold`}\n            animate={{\n              textShadow: [\n                \"0 0 5px #8a2be2\",\n                \"0 0 10px #00bfff\",\n                \"0 0 5px #ffd700\",\n                \"0 0 10px #ff69b4\",\n                \"0 0 5px #8a2be2\"\n              ]\n            }}\n            transition={{\n              duration: 3,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n          >\n            {playerName}\n          </motion.span>\n        </motion.div>\n      );\n    case 'legend':\n      return (\n        <motion.div\n          animate={{\n            boxShadow: [\n              \"0 0 8px #ff4500, 0 0 16px #ff6600, 0 0 24px #ff8800\",\n              \"0 0 12px #ff0000, 0 0 24px #ff3300, 0 0 36px #ff6600\",\n              \"0 0 8px #ff8800, 0 0 16px #ffaa00, 0 0 24px #ffcc00\",\n              \"0 0 10px #ff4500, 0 0 20px #ff6600, 0 0 30px #ff8800\"\n            ]\n          }}\n          transition={{\n            duration: 1.5,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }}\n          className=\"px-2 py-1 rounded-md border-2 border-orange-500\"\n        >\n          <span className={`text-sm ${theme.textColor} max-w-24 truncate font-bold`}>\n            {playerName}\n          </span>\n        </motion.div>\n      );\n    default:\n      return (\n        <span className={`text-sm ${theme.textColor} max-w-24 truncate`}>\n          {playerName}\n        </span>\n      );\n  }\n};\n\n// Function to get winning positions for highlighting\nconst getWinningPositions = (board: Record<string, string>, player: string): number[] => {\n  // Check horizontal wins\n  const rows = [\n    [1, 2, 3, 4, 5],\n    [6, 7, 8, 9, 10],\n    [11, 12, 13, 14, 15]\n  ];\n  \n  for (const row of rows) {\n    for (let i = 0; i <= row.length - 4; i++) {\n      const positions = row.slice(i, i + 4);\n      if (positions.every(pos => board[pos.toString()] === player)) {\n        return positions;\n      }\n    }\n  }\n  \n  // Check vertical wins\n  const columns = [\n    [1, 6, 11], [2, 7, 12], [3, 8, 13], [4, 9, 14], [5, 10, 15]\n  ];\n  \n  for (const column of columns) {\n    if (column.every(pos => board[pos.toString()] === player)) {\n      return column;\n    }\n  }\n  \n  // Check diagonal wins\n  const diagonals = [\n    [1, 7, 13], [2, 8, 14], [3, 7, 11], [4, 8, 12]\n  ];\n  \n  for (const diagonal of diagonals) {\n    if (diagonal.every(pos => board[pos.toString()] === player)) {\n      return diagonal;\n    }\n  }\n  \n  return [];\n};\n\n// AI helper functions for different difficulty levels\nconst findBestMove = (board: Record<string, string>, availableMoves: number[]): number | null => {\n  // Try to win first\n  for (const move of availableMoves) {\n    const testBoard = { ...board, [move.toString()]: 'O' };\n    if (checkWinSimple(testBoard, 'O')) {\n      return move;\n    }\n  }\n  \n  // Try to block player win\n  for (const move of availableMoves) {\n    const testBoard = { ...board, [move.toString()]: 'X' };\n    if (checkWinSimple(testBoard, 'X')) {\n      return move;\n    }\n  }\n  \n  return null;\n};\n\nconst findBestMoveHard = (board: Record<string, string>, availableMoves: number[]): number | null => {\n  // Try to win first\n  for (const move of availableMoves) {\n    const testBoard = { ...board, [move.toString()]: 'O' };\n    if (checkWinSimple(testBoard, 'O')) {\n      return move;\n    }\n  }\n  \n  // Try to block player win\n  for (const move of availableMoves) {\n    const testBoard = { ...board, [move.toString()]: 'X' };\n    if (checkWinSimple(testBoard, 'X')) {\n      return move;\n    }\n  }\n  \n  // Strategic positioning: prefer center and corners\n  const strategicMoves = [8, 1, 3, 11, 13, 7, 9]; // Center first, then corners and edges\n  for (const move of strategicMoves) {\n    if (availableMoves.includes(move)) {\n      return move;\n    }\n  }\n  \n  return null;\n};\n\nconst checkWinSimple = (board: Record<string, string>, player: string): boolean => {\n  // Check horizontal (4 in a row)\n  const rows = [\n    [1, 2, 3, 4, 5],\n    [6, 7, 8, 9, 10],\n    [11, 12, 13, 14, 15]\n  ];\n  \n  for (const row of rows) {\n    for (let i = 0; i <= row.length - 4; i++) {\n      const positions = row.slice(i, i + 4);\n      if (positions.every(pos => board[pos.toString()] === player)) {\n        return true;\n      }\n    }\n  }\n  \n  // Check vertical (3 in a column)\n  const columns = [\n    [1, 6, 11], [2, 7, 12], [3, 8, 13], [4, 9, 14], [5, 10, 15]\n  ];\n  \n  for (const column of columns) {\n    if (column.every(pos => board[pos.toString()] === player)) {\n      return true;\n    }\n  }\n  \n  // Check diagonal (3 in diagonal, excluding columns 5, 10, 15)\n  const diagonals = [\n    [1, 7, 13], [2, 8, 14], [3, 7, 11], [4, 8, 12]\n  ];\n  \n  for (const diagonal of diagonals) {\n    if (diagonal.every(pos => board[pos.toString()] === player)) {\n      return true;\n    }\n  }\n  \n  return false;\n};\n\ninterface GameBoardProps {\n  game: any;\n  onGameOver: (result: any) => void;\n  gameMode: 'ai' | 'pass-play' | 'online';\n  user: any;\n  lastMessage?: any;\n  sendMessage?: (message: any) => void;\n  isSpectator?: boolean;\n}\n\nexport function GameBoard({ game, onGameOver, gameMode, user, lastMessage, sendMessage, isSpectator = false }: GameBoardProps) {\n  const [board, setBoard] = useState<Record<string, string>>({});\n  const [currentPlayer, setCurrentPlayer] = useState<'X' | 'O'>('X');\n  // Removed winningLine state - now derived from game prop\n  const [lastMove, setLastMove] = useState<number | null>(null);\n  \n  const [opponent, setOpponent] = useState<any>(null);\n  \n  // Player chat message state\n  const [playerXMessage, setPlayerXMessage] = useState<PlayerMessage | null>(null);\n  const [playerOMessage, setPlayerOMessage] = useState<PlayerMessage | null>(null);\n  const [messageTimeouts, setMessageTimeouts] = useState<{ X?: NodeJS.Timeout; O?: NodeJS.Timeout }>({});\n  const [showChatPanel, setShowChatPanel] = useState(false);\n  \n  // Profile modal state\n  const [selectedPlayerId, setSelectedPlayerId] = useState<string | null>(null);\n  const [showProfileModal, setShowProfileModal] = useState(false);\n\n  // Handle profile picture click\n  const handleProfileClick = (playerId: string) => {\n    // Profile click handler called\n    // Current selectedPlayerId state and setting modal\n    \n    // Force close first if already open, then open with new player\n    if (showProfileModal) {\n      setShowProfileModal(false);\n      setSelectedPlayerId(null);\n      // Use setTimeout to ensure state is updated before opening with new player\n      setTimeout(() => {\n        setSelectedPlayerId(playerId);\n        setShowProfileModal(true);\n        // Modal reopened with playerId\n      }, 100);\n    } else {\n      setSelectedPlayerId(playerId);\n      setShowProfileModal(true);\n      // Modal opened with playerId\n    }\n  };\n\n  const handleCloseProfileModal = () => {\n    setShowProfileModal(false);\n    setSelectedPlayerId(null);\n  };\n  \n  // Derive winning line from game state using useMemo to prevent infinite loops\n  const derivedWinningLine = useMemo(() => {\n    return game?.winningPositions || [];\n  }, [game?.winningPositions?.join('-')]);\n\n  // Auto-close profile modal when game ends  \n  useEffect(() => {\n    if (game?.status === 'finished' || game?.status === 'abandoned') {\n      if (showProfileModal) {\n        // Auto-closing profile modal due to game end\n        setShowProfileModal(false);\n        setSelectedPlayerId(null);\n      }\n    }\n  }, [game?.status]);\n\n  // Handle player left win event from WebSocket\n  useEffect(() => {\n    const handlePlayerLeftWin = (event: CustomEvent) => {\n      const message = event.detail;\n      console.log('üèÜ GameBoard: Player left win event received:', message);\n      \n      // Show popup in game board area (not room management)\n      const winMessage = message.message || \"Opponent left the game.\";\n      const notificationDiv = document.createElement('div');\n      notificationDiv.innerHTML = `\n        <div style=\"\n          position: fixed;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          background: linear-gradient(135deg, #10b981, #059669);\n          color: white;\n          padding: 24px;\n          border-radius: 12px;\n          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\n          z-index: 9999;\n          max-width: 400px;\n          text-align: center;\n          font-family: system-ui, -apple-system, sans-serif;\n        \">\n          <div style=\"font-size: 16px; opacity: 0.9; margin-bottom: 16px;\">${winMessage}</div>\n          <div style=\"font-size: 14px; opacity: 0.8;\">Switching to AI mode in 3 seconds...</div>\n        </div>\n      `;\n      document.body.appendChild(notificationDiv);\n      \n      // Smooth transition to AI mode after 3 seconds (no reload)\n      setTimeout(() => {\n        notificationDiv.remove();\n        \n        // Clear game state\n        localStorage.removeItem('currentGameState');\n        sessionStorage.removeItem('currentGameState');\n        \n        // Trigger smooth navigation to AI mode using React state\n        const navigationEvent = new CustomEvent('navigate_to_ai_mode');\n        window.dispatchEvent(navigationEvent);\n      }, 3000);\n    };\n\n    window.addEventListener('player_left_win', handlePlayerLeftWin as EventListener);\n    \n    return () => {\n      window.removeEventListener('player_left_win', handlePlayerLeftWin as EventListener);\n    };\n  }, []);\n\n  // Debug effect to track modal state changes\n  useEffect(() => {\n    // Modal state changed\n  }, [showProfileModal, selectedPlayerId]);\n  const { toast } = useToast();\n  const { currentTheme, themes } = useTheme();\n  const { t } = useTranslation();\n  // Sound effects removed as requested\n  // WebSocket now handled by parent component\n  const queryClient = useQueryClient();\n\n  // Determine opponent for online games\n  useEffect(() => {\n    if (gameMode === 'online' && game && user) {\n      const userIsPlayerX = game.playerXId === (user.userId || user.id);\n      const userIsPlayerO = game.playerOId === (user.userId || user.id);\n      \n      if (userIsPlayerX && game.playerOInfo) {\n        setOpponent(game.playerOInfo);\n      } else if (userIsPlayerO && game.playerXInfo) {\n        setOpponent(game.playerXInfo);\n      }\n    }\n  }, [game, user, gameMode]);\n\n  // Player message functions\n  const setPlayerMessage = (player: 'X' | 'O', messageText: string) => {\n    const message = QUICK_CHAT_MESSAGES.find(msg => msg.text === messageText) || { text: messageText, duration: 3000 };\n    \n    // Clear existing timeout\n    if (messageTimeouts[player]) {\n      clearTimeout(messageTimeouts[player]);\n    }\n    \n    // Set new message\n    if (player === 'X') {\n      setPlayerXMessage(message);\n    } else {\n      setPlayerOMessage(message);\n    }\n    \n    // Clear message after duration\n    const timeout = setTimeout(() => {\n      if (player === 'X') {\n        setPlayerXMessage(null);\n      } else {\n        setPlayerOMessage(null);\n      }\n      setMessageTimeouts(prev => ({ ...prev, [player]: undefined }));\n    }, message.duration);\n    \n    setMessageTimeouts(prev => ({ ...prev, [player]: timeout }));\n  };\n\n  const handleMessageClick = (messageText: string) => {\n    if (gameMode === 'online' && user) {\n      const userId = user.userId || user.id;\n      const isPlayerX = game.playerXId === userId;\n      const isPlayerO = game.playerOId === userId;\n      \n      // Check if user is actually a player (not a spectator)\n      if (!isPlayerX && !isPlayerO) {\n        console.log('‚ùå Spectator cannot use quick chat');\n        return;\n      }\n      \n      const playerSymbol = isPlayerX ? 'X' : 'O';\n      \n      // Show message locally first\n      setPlayerMessage(playerSymbol, messageText);\n      \n      // Broadcast message to all players and spectators in the room\n      const chatMessage = {\n        type: 'player_chat',\n        roomId: game.roomId,\n        gameId: game.id,\n        userId: userId,\n        playerSymbol: playerSymbol,\n        messageText: messageText,\n        playerInfo: isPlayerX ? game.playerXInfo : game.playerOInfo\n      };\n      \n      // Send via WebSocket\n      if (sendMessage) {\n        sendMessage(chatMessage);\n      }\n    } else {\n      // For local games, current player uses message\n      setPlayerMessage(currentPlayer, messageText);\n    }\n    setShowChatPanel(false);\n  };\n\n  // Cleanup timeouts on unmount\n  useEffect(() => {\n    return () => {\n      Object.values(messageTimeouts).forEach(timeout => {\n        if (timeout) clearTimeout(timeout);\n      });\n    };\n  }, [messageTimeouts]);\n\n\n\n\n\n  useEffect(() => {\n    if (game) {\n      // Game prop changed\n      // Game board from prop\n      \n      const gameBoard = game.board || {};\n      const isNewGame = Object.keys(gameBoard).length === 0;\n      \n      // For local games, only set board if it's truly empty (new game)\n      if (game.id.startsWith('local-game')) {\n        if (isNewGame) {\n          console.log('üìã Initializing new local game board');\n          setBoard({});\n          // Winning line now derived from game state\n          setLastMove(null);\n        }\n        // Always sync currentPlayer for local games\n        setCurrentPlayer(game.currentPlayer || 'X');\n        // Don't overwrite board state for local games with existing moves\n      } else {\n        // For online games, always sync with server state\n        console.log('üìã Syncing online game board to:', gameBoard);\n        setBoard(gameBoard);\n        setCurrentPlayer(game.currentPlayer || 'X');\n        if (game.lastMove) {\n          setLastMove(game.lastMove);\n        }\n      }\n    }\n  }, [game?.id, game?.board, game?.currentPlayer]); // Removed timestamp dependencies to prevent infinite loops\n\n  // Remove WebSocket handling from GameBoard - it's now handled in Home component\n  // This prevents double handling and state conflicts\n\n  // Handle incoming WebSocket messages for chat and moves\n  useEffect(() => {\n    if (lastMessage?.type === 'player_chat') {\n      // Handle player chat message\n      \n      if (lastMessage.gameId === game?.id || lastMessage.roomId === game?.roomId) {\n        const messageText = lastMessage.messageText;\n        const playerSymbol = lastMessage.playerSymbol;\n        \n        // Message matches current game/room\n        \n        // Show the message for the specified player\n        if (messageText) {\n          setPlayerMessage(playerSymbol, messageText);\n          // Set player message\n        }\n      } else {\n        // Message doesn't match current game/room\n      }\n    }\n    \n    // Handle move error messages from WebSocket\n    if (lastMessage?.type === 'move_error' && lastMessage?.gameId === game?.id) {\n      toast({\n        title: \"Move Error\",\n        description: lastMessage.error || \"Invalid move\",\n        variant: \"destructive\",\n      });\n    }\n  }, [lastMessage, game?.id, game?.roomId, toast]);\n\n  // Track board state changes for game synchronization and visual feedback\n  const [isMoveProcessing, setIsMoveProcessing] = useState(false);\n  \n  useEffect(() => {\n    // Show processing indicator when board changes (any player's move)\n    setIsMoveProcessing(true);\n    const timer = setTimeout(() => setIsMoveProcessing(false), 1500); // Blink for 1.5 seconds\n    return () => clearTimeout(timer);\n  }, [JSON.stringify(board)]);\n\n  const makeMoveMutation = useMutation({\n    mutationFn: async (position: number) => {\n      if (!game) {\n        throw new Error('No active game');\n      }\n      \n      // For local games (AI and pass-play), handle moves locally\n      if (game.id.startsWith('local-game')) {\n        return handleLocalMove(position);\n      }\n      \n      // Making move with current game state\n      \n      // Additional safety check - ensure we have the latest game state\n      if (game.status === 'finished') {\n        // Attempting to move on finished game\n        throw new Error('Game is finished');\n      }\n      \n      // For online games, use WebSocket for instant synchronization\n      if (sendMessage && gameMode === 'online') {\n        // Send move via WebSocket for real-time sync\n        sendMessage({\n          type: 'move',\n          gameId: game.id,\n          position: position\n        });\n        \n        // Return immediately - WebSocket will handle the response\n        return Promise.resolve({ success: true });\n      }\n      \n      // Fallback to HTTP API if WebSocket not available\n      return await apiRequest(`/api/games/${game.id}/moves`, { method: 'POST', body: { position } });\n    },\n    onSuccess: (data) => {\n      // Move successful\n      if (game && !game.id.startsWith('local-game')) {\n        // For online games, the Home component will handle WebSocket updates\n        // No need to update local state here\n        // WebSocket will handle board update\n        \n\n      }\n      // For online games, don't force board update since WebSocket handles it\n      // For local games, board is already updated in handleLocalMove\n    },\n    onError: (error) => {\n      // Move error occurred\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n\n\n  const handleLocalMove = (position: number) => {\n    if (!game) return;\n    \n    // HandleLocalMove called\n    // Position, current player, and board state\n    \n    // Sound effects removed as requested\n    const newBoard = { ...board };\n    newBoard[position.toString()] = currentPlayer;\n    setLastMove(position);\n    \n    console.log('  - New board after move:', newBoard);\n    \n    // Check for win condition with winning line detection\n    const checkWin = (board: Record<string, string>, player: string) => {\n      // Check horizontal (4 consecutive)\n      const rows = [\n        [1, 2, 3, 4, 5],\n        [6, 7, 8, 9, 10],\n        [11, 12, 13, 14, 15]\n      ];\n      \n      for (const row of rows) {\n        for (let i = 0; i <= row.length - 4; i++) {\n          const positions = row.slice(i, i + 4);\n          if (positions.every(pos => board[pos.toString()] === player)) {\n            // Winning line now derived from game state\n            return true;\n          }\n        }\n      }\n      \n      // Check vertical (3 consecutive)\n      const columns = [\n        [1, 6, 11], [2, 7, 12], [3, 8, 13], [4, 9, 14], [5, 10, 15]\n      ];\n      \n      for (const column of columns) {\n        if (column.every(pos => board[pos.toString()] === player)) {\n          // Winning line now derived from game state\n          return true;\n        }\n      }\n      \n      // Check diagonal (3 consecutive, excluding columns 5,10,15)\n      const diagonals = [\n        [1, 7, 13], [2, 8, 14], // Main diagonals (excluding [3,9,15])\n        [3, 7, 11], [4, 8, 12], // Anti-diagonals (excluding [5,9,13])\n        [11, 7, 3], [12, 8, 4]  // Additional patterns (excluding those with 5,10,15)\n      ];\n      \n      for (const diagonal of diagonals) {\n        if (diagonal.every(pos => board[pos.toString()] === player)) {\n          return true;\n        }\n      }\n      \n      return false;\n    };\n    \n    const checkDraw = (board: Record<string, string>) => {\n      return VALID_POSITIONS.every(pos => board[pos.toString()]);\n    };\n    \n    // Update board state and force render\n    // LocalMove: Updating board\n    setBoard(newBoard);\n    \n    if (checkWin(newBoard, currentPlayer)) {\n      const winnerInfo = currentPlayer === 'X' \n        ? (game?.playerXInfo?.firstName || game?.playerXInfo?.displayName || game?.playerXInfo?.username || 'Player X')\n        : (game?.playerOInfo?.firstName || game?.playerOInfo?.displayName || game?.playerOInfo?.username || (gameMode === 'ai' ? 'AI' : 'Player O'));\n      \n      // Show winning positions before game over  \n      const winningPositions = getWinningPositions(newBoard, currentPlayer);\n      // Winning line now derived from game state\n      \n      // Add delay before showing game over for AI and pass-play\n      setTimeout(() => {\n        try {\n          if (onGameOver) {\n            const winnerName = currentPlayer === 'X' ? 'Player X' : (gameMode === 'ai' ? 'AI' : 'Player O');\n            // GameBoard sending win result\n            onGameOver({\n              winner: currentPlayer,\n              winnerName,\n              condition: 'diagonal'\n            });\n          }\n        } catch (error) {\n          console.error('üö® Error in game over handler:', error);\n        }\n      }, gameMode === 'ai' || gameMode === 'pass-play' ? 2500 : 0);\n      return;\n    }\n    \n    if (checkDraw(newBoard)) {\n      if (onGameOver) {\n        try {\n          // GameBoard sending draw result\n          onGameOver({\n            winner: null,\n            winnerName: null,\n            condition: 'draw'\n          });\n        } catch (error) {\n          console.error('üö® Error in draw handler:', error);\n        }\n      }\n      return;\n    }\n    \n    // Switch player\n    const nextPlayer = currentPlayer === 'X' ? 'O' : 'X';\n    setCurrentPlayer(nextPlayer);\n    \n\n    \n    // Handle AI move\n    if (gameMode === 'ai' && nextPlayer === 'O') {\n\n      setTimeout(() => {\n        makeAIMove(newBoard);\n      }, 1000); // Increased delay to reduce blinking\n    }\n  };\n\n  const makeAIMove = (currentBoard: Record<string, string>) => {\n    const availableMoves = VALID_POSITIONS.filter(pos => !currentBoard[pos.toString()]);\n    if (availableMoves.length === 0) return;\n    \n    // AI difficulty-based move selection\n    const difficulty = game?.aiDifficulty || 'medium';\n    let selectedMove;\n    \n    if (difficulty === 'easy') {\n      // Easy: Random move\n      selectedMove = availableMoves[Math.floor(Math.random() * availableMoves.length)];\n    } else if (difficulty === 'medium') {\n      // Medium: Try to win or block, otherwise random\n      selectedMove = findBestMove(currentBoard, availableMoves) || availableMoves[Math.floor(Math.random() * availableMoves.length)];\n    } else {\n      // Hard: More strategic play\n      selectedMove = findBestMoveHard(currentBoard, availableMoves) || availableMoves[Math.floor(Math.random() * availableMoves.length)];\n    }\n    \n    // Sound effects removed as requested\n    const newBoard = { ...currentBoard };\n    newBoard[selectedMove.toString()] = 'O';\n    \n    // AI Move: Updating board\n    setBoard(newBoard);\n    setLastMove(selectedMove);\n    \n\n    \n    // Check for AI win using same logic\n    const checkWin = (board: Record<string, string>, player: string) => {\n      // Check horizontal (4 consecutive)\n      const rows = [\n        [1, 2, 3, 4, 5],\n        [6, 7, 8, 9, 10],\n        [11, 12, 13, 14, 15]\n      ];\n      \n      for (const row of rows) {\n        for (let i = 0; i <= row.length - 4; i++) {\n          const positions = row.slice(i, i + 4);\n          if (positions.every(pos => board[pos.toString()] === player)) {\n            return true;\n          }\n        }\n      }\n      \n      // Check vertical (3 consecutive)\n      const columns = [\n        [1, 6, 11], [2, 7, 12], [3, 8, 13], [4, 9, 14], [5, 10, 15]\n      ];\n      \n      for (const column of columns) {\n        if (column.every(pos => board[pos.toString()] === player)) {\n          return true;\n        }\n      }\n      \n      // Check diagonal (3 consecutive, excluding columns 5,10,15)\n      const diagonals = [\n        [1, 7, 13], [2, 8, 14], // Main diagonals (excluding [3,9,15])\n        [3, 7, 11], [4, 8, 12], // Anti-diagonals (excluding [5,9,13])\n        [11, 7, 3], [12, 8, 4]  // Additional patterns (excluding those with 5,10,15)\n      ];\n      \n      return diagonals.some(diagonal => \n        diagonal.every(pos => board[pos.toString()] === player)\n      );\n    };\n    \n    const checkDraw = (board: Record<string, string>) => {\n      return VALID_POSITIONS.every(pos => board[pos.toString()]);\n    };\n    \n    if (checkWin(newBoard, 'O')) {\n      \n      // Show winning positions before game over\n      const winningPositions = getWinningPositions(newBoard, 'O');\n      if (winningPositions.length > 0) {\n        // Winning line now derived from game state\n      }\n      \n      // Add delay before showing game over for AI mode\n      setTimeout(() => {\n        if (onGameOver) {\n          try {\n            console.log('üéÆ GameBoard sending AI win result:', {\n              winner: 'O',\n              winnerName: 'AI',\n              condition: 'diagonal'\n            });\n            onGameOver({\n              winner: 'O',\n              winnerName: 'AI',\n              condition: 'diagonal'\n            });\n          } catch (error) {\n            console.error('üö® Error in AI win handler:', error);\n          }\n        }\n      }, 2500);\n      return;\n    }\n    \n    if (checkDraw(newBoard)) {\n\n      \n      if (onGameOver) {\n        try {\n          onGameOver({\n            winner: null,\n            winnerName: null,\n            condition: 'draw'\n          });\n        } catch (error) {\n          console.error('üö® Error in AI draw handler:', error);\n        }\n      }\n      return;\n    }\n    \n    setCurrentPlayer('X');\n  };\n\n  const handleCellClick = (position: number) => {\n    // Handle cell click for game move\n    \n    if (!game || (game.status && game.status !== 'active')) {\n      // Game not active\n      toast({\n        title: \"Game not active\",\n        description: \"Start a new game to play\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (board[position.toString()]) {\n      // Position already occupied\n      \n\n      \n      toast({\n        title: t('invalidMove'),\n        description: t('positionOccupied'),\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    // Check if it's the player's turn\n    if (gameMode === 'online') {\n      const userId = user?.userId || user?.id;\n      const isPlayerX = game.playerXId === userId;\n      const isPlayerO = game.playerOId === userId;\n      \n      // Validate turn\n      \n      if (!isPlayerX && !isPlayerO) {\n        // User is not a player in this game\n        toast({\n          title: t('notAPlayer'),\n          description: t('notPlayerInGame'),\n          variant: \"destructive\",\n        });\n        return;\n      }\n      \n      const playerSymbol = isPlayerX ? 'X' : 'O';\n      // Check player symbol and turn\n      \n      if (currentPlayer !== playerSymbol) {\n        // Not your turn\n        \n\n        \n        const currentPlayerName = currentPlayer === 'X' ? \n          (game.playerXInfo?.firstName || 'Player X') : \n          (game.playerOInfo?.firstName || 'Player O');\n        toast({\n          title: t('notYourTurn'),\n          description: `${t('waitingFor')} ${currentPlayerName} ${t('toMakeMove')}`,\n          variant: \"destructive\",\n        });\n        return;\n      }\n    }\n\n    // Making move on position\n    // Sound effects removed as requested\n    makeMoveMutation.mutate(position);\n  };\n\n  const resetGame = () => {\n    setBoard({});\n    setCurrentPlayer('X');\n    // Winning line now derived from game state\n    setLastMove(null);\n  };\n\n  const renderCell = (position: number) => {\n    const symbol = board[position.toString()];\n    const isEmpty = !symbol;\n    const isWinningCell = derivedWinningLine?.includes(position);\n    const isLastMove = lastMove === position;\n    \n    return (\n      <motion.div\n        key={position}\n        className={`\n          w-10 h-10 sm:w-12 sm:h-12 md:w-16 md:h-16 ${theme.cellStyle} rounded-lg flex items-center justify-center cursor-pointer \n          ${isEmpty ? theme.cellHoverStyle : 'cursor-not-allowed'}\n          ${makeMoveMutation.isPending ? 'opacity-50' : ''}\n          ${isWinningCell ? theme.winningCellStyle : ''}\n          ${isLastMove ? 'ring-2 ring-yellow-400' : ''}\n          ${!isEmpty && !isWinningCell && symbol === 'X' ? 'animate-pulse-border-x' : ''}\n          ${!isEmpty && !isWinningCell && symbol === 'O' ? 'animate-pulse-border-o' : ''}\n        `}\n        onClick={() => handleCellClick(position)}\n        animate={isWinningCell ? {\n          scale: [1, 1.05, 1.1, 1.05, 1],\n          backgroundColor: [\n            'rgb(51, 65, 85)', // slate-700\n            'rgb(34, 197, 94)', // green-500\n            'rgb(16, 185, 129)', // emerald-500\n            'rgb(34, 197, 94)', // green-500\n            'rgb(51, 65, 85)'  // slate-700\n          ],\n          boxShadow: [\n            '0 0 0 rgba(34, 197, 94, 0)',\n            '0 0 30px rgba(34, 197, 94, 0.8)',\n            '0 0 40px rgba(16, 185, 129, 0.9)',\n            '0 0 30px rgba(34, 197, 94, 0.8)',\n            '0 0 0 rgba(34, 197, 94, 0)'\n          ],\n          borderColor: [\n            'transparent',\n            'rgb(34, 197, 94)',\n            'rgb(16, 185, 129)',\n            'rgb(34, 197, 94)',\n            'transparent'\n          ]\n        } : {}}\n        transition={isWinningCell ? {\n          duration: 1.5,\n          repeat: Infinity,\n          ease: \"easeInOut\"\n        } : {}}\n      >\n        {symbol && (\n          <span\n            className={`text-lg sm:text-xl md:text-2xl font-bold ${\n              symbol === 'X' ? theme.playerXColor : theme.playerOColor\n            }`}\n          >\n            {symbol}\n          </span>\n        )}\n        <span className={`text-xs ${theme.textColor} opacity-50 absolute mt-8 sm:mt-10 md:mt-12`}>{position}</span>\n      </motion.div>\n    );\n  };\n\n  const getLineCoordinates = (positions: number[]) => {\n    // Get grid coordinates for line drawing\n    const getGridPosition = (pos: number) => {\n      const row = Math.floor((pos - 1) / 5);\n      const col = (pos - 1) % 5;\n      return { x: col * 20 + 10, y: row * 33.33 + 16.67 };\n    };\n    \n    const start = getGridPosition(positions[0]);\n    const end = getGridPosition(positions[positions.length - 1]);\n    \n    return {\n      x1: start.x,\n      y1: start.y,\n      x2: end.x,\n      y2: end.y\n    };\n  };\n\n  const getSparklePosition = (position: number) => {\n    const row = Math.floor((position - 1) / 5);\n    const col = (position - 1) % 5;\n    return { \n      x: col * 20 + 10,\n      y: row * 33.33 + 16.67 \n    };\n  };\n\n  const theme = themes[currentTheme];\n  \n  return (\n    <Card className={`${theme.boardStyle}`}>\n      <CardHeader>\n        <div className=\"flex items-start justify-between\">\n          <div className=\"flex flex-col space-y-2\">\n            <CardTitle className={`text-2xl ${theme.textColor}`}>{t('gameBoard')}</CardTitle>\n          </div>\n          \n          {/* Connection Status and Refresh Controls */}\n          <div className=\"flex items-center space-x-2\">\n            {gameMode === 'online' && (\n              <>\n                {/* Connection Quality Indicator */}\n                <div className=\"flex items-center space-x-1\">\n                  <div \n                    className={`w-2 h-2 rounded-full ${\n                      lastMessage ? 'bg-green-500' : 'bg-red-500'\n                    }`}\n                    title={lastMessage ? 'Connected' : 'Disconnected'}\n                  />\n                  <span className=\"text-xs text-gray-500\">\n                    {lastMessage ? 'Online' : 'Offline'}\n                  </span>\n                </div>\n                \n              </>\n            )}\n          </div>\n          <div className=\"flex flex-col space-y-3 text-right\">\n            {/* Player X - Top */}\n            <div className=\"flex items-center justify-end space-x-2\">\n              {/* Chat Message for Player X */}\n              <AnimatePresence>\n                {playerXMessage && (\n                  <motion.div\n                    initial={{ opacity: 0, scale: 0.5, y: 20 }}\n                    animate={{ \n                      opacity: 1, \n                      scale: [1, 1.05, 1], \n                      y: 0\n                    }}\n                    exit={{ opacity: 0, scale: 0.5, y: -20 }}\n                    transition={{ \n                      duration: 0.4,\n                      scale: { duration: 0.6, ease: \"easeInOut\" }\n                    }}\n                    className=\"relative max-w-32\"\n                    title={playerXMessage.text}\n                  >\n                    <motion.div \n                      className=\"text-xs bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-2 py-1 rounded-md shadow-sm\"\n                      animate={{ \n                        scale: [1, 1.02, 1]\n                      }}\n                      transition={{ \n                        duration: 2,\n                        repeat: Infinity,\n                        ease: \"easeInOut\"\n                      }}\n                    >\n                      {playerXMessage.text}\n                    </motion.div>\n                  </motion.div>\n                )}\n              </AnimatePresence>\n              \n              <div className=\"flex flex-col items-end\">\n                {renderAchievementBorder(\n                  getSelectedAchievementBorder(game?.playerXInfo),\n                  gameMode === 'online' \n                    ? (game?.playerXInfo?.firstName || game?.playerXInfo?.displayName || game?.playerXInfo?.username || 'Player X')\n                    : 'Player X',\n                  theme\n                )}\n\n                {gameMode === 'online' && game?.playerXInfo?.achievements && game.playerXInfo.achievements.length > 0 && (\n                  <div className=\"flex items-center gap-1 mt-1\">\n                    {/* Show only the most recent achievement (latest badge replaces old one) */}\n                    {game.playerXInfo.achievements.slice(-1).map((achievement: any) => (\n                      <span\n                        key={achievement.id}\n                        className=\"text-xs text-gray-700 dark:text-gray-300 px-1 py-0.5\"\n                        title={achievement.description}\n                      >\n                        {achievement.icon}\n                      </span>\n                    ))}\n                  </div>\n                )}\n              </div>\n              {(gameMode === 'online' && (game?.playerXInfo?.profileImageUrl || game?.playerXInfo?.profilePicture)) ? (\n                <div\n                  className=\"w-6 h-6 cursor-pointer hover:ring-2 hover:ring-blue-400 rounded-full transition-all duration-200 hover:scale-110 relative z-50\"\n                  onClick={() => {\n                    console.log('üéÆ Player X profile DIV clicked:', game.playerXInfo.id);\n                    setSelectedPlayerId(game.playerXInfo.id);\n                    setShowProfileModal(true);\n                  }}\n                  title=\"Click to view player profile\"\n                >\n                  <img \n                    src={game.playerXInfo.profileImageUrl || game.playerXInfo.profilePicture} \n                    alt=\"Player X\" \n                    className=\"w-6 h-6 rounded-full object-cover\"\n                  />\n                </div>\n              ) : (\n                <div className=\"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center\">\n                  <span className=\"text-xs text-white font-bold\">X</span>\n                </div>\n              )}\n              <div className=\"w-3 h-3 bg-blue-500 rounded-full\"></div>\n            </div>\n            \n            {/* Player O - Bottom */}\n            <div className=\"flex items-center justify-end space-x-2\">\n              {/* Chat Message for Player O */}\n              <AnimatePresence>\n                {playerOMessage && (\n                  <motion.div\n                    initial={{ opacity: 0, scale: 0.5, y: 20 }}\n                    animate={{ \n                      opacity: 1, \n                      scale: [1, 1.05, 1], \n                      y: 0\n                    }}\n                    exit={{ opacity: 0, scale: 0.5, y: -20 }}\n                    transition={{ \n                      duration: 0.4,\n                      scale: { duration: 0.6, ease: \"easeInOut\" }\n                    }}\n                    className=\"relative max-w-32\"\n                    title={playerOMessage.text}\n                  >\n                    <motion.div \n                      className=\"text-xs bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 px-2 py-1 rounded-md shadow-sm\"\n                      animate={{ \n                        scale: [1, 1.02, 1]\n                      }}\n                      transition={{ \n                        duration: 2,\n                        repeat: Infinity,\n                        ease: \"easeInOut\"\n                      }}\n                    >\n                      {playerOMessage.text}\n                    </motion.div>\n                  </motion.div>\n                )}\n              </AnimatePresence>\n              \n              <div className=\"flex flex-col items-end\">\n                {renderAchievementBorder(\n                  getSelectedAchievementBorder(game?.playerOInfo),\n                  gameMode === 'online' \n                    ? (game?.playerOInfo?.firstName || game?.playerOInfo?.displayName || game?.playerOInfo?.username || 'Player O')\n                    : (gameMode === 'ai' ? 'AI' : 'Player O'),\n                  theme\n                )}\n\n                {gameMode === 'online' && game?.playerOInfo?.achievements && game.playerOInfo.achievements.length > 0 && (\n                  <div className=\"flex items-center gap-1 mt-1\">\n                    {/* Show only the most recent achievement (latest badge replaces old one) */}\n                    {game.playerOInfo.achievements.slice(-1).map((achievement: any) => (\n                      <span\n                        key={achievement.id}\n                        className=\"text-xs text-gray-700 dark:text-gray-300 px-1 py-0.5\"\n                        title={achievement.description}\n                      >\n                        {achievement.icon}\n                      </span>\n                    ))}\n                  </div>\n                )}\n              </div>\n              {(gameMode === 'online' && (game?.playerOInfo?.profileImageUrl || game?.playerOInfo?.profilePicture)) ? (\n                <div\n                  className=\"w-6 h-6 cursor-pointer hover:ring-2 hover:ring-red-400 rounded-full transition-all duration-200 hover:scale-110 relative z-50\"\n                  onClick={() => {\n                    console.log('üéÆ Player O profile DIV clicked:', game.playerOInfo.id);\n                    setSelectedPlayerId(game.playerOInfo.id);\n                    setShowProfileModal(true);\n                  }}\n                  title=\"Click to view player profile\"\n                >\n                  <img \n                    src={game.playerOInfo.profileImageUrl || game.playerOInfo.profilePicture} \n                    alt=\"Player O\" \n                    className=\"w-6 h-6 rounded-full object-cover\"\n                  />\n                </div>\n              ) : (\n                <div className=\"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center\">\n                  <span className=\"text-xs text-white font-bold\">O</span>\n                </div>\n              )}\n              <div className=\"w-3 h-3 bg-red-500 rounded-full\"></div>\n            </div>\n          </div>\n        </div>\n      </CardHeader>\n      \n      <CardContent>\n        {/* Current Player Indicator */}\n        <div className={`mb-6 p-4 ${theme.cellStyle.split(' ')[0]} ${theme.borderColor} border rounded-lg`}>\n          <div className=\"flex items-center justify-center space-x-3\">\n            <div className={`w-4 h-4 rounded-full ${\n              currentPlayer === 'X' ? 'bg-blue-500' : 'bg-red-500'\n            }`}></div>\n            <span className={`text-lg font-medium ${theme.textColor}`}>\n              {gameMode === 'online' \n                ? (currentPlayer === 'X' \n                    ? (game?.playerXInfo?.firstName || game?.playerXInfo?.displayName || game?.playerXInfo?.username || 'Player X')\n                    : (game?.playerOInfo?.firstName || game?.playerOInfo?.displayName || game?.playerOInfo?.username || 'Player O'))\n                : (currentPlayer === 'X' \n                    ? 'Player X'\n                    : (gameMode === 'ai' ? 'AI' : 'Player O'))\n              }'s Turn\n            </span>\n          </div>\n        </div>\n\n        {/* Auto-Play Indicator */}\n        {game?.autoPlayActive && gameMode === 'online' && (\n          <div className=\"mb-4 p-3 bg-orange-100 dark:bg-orange-900/30 border border-orange-300 dark:border-orange-700 rounded-lg\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center space-x-2\">\n                <div className=\"w-3 h-3 rounded-full bg-orange-500 animate-pulse\"></div>\n                <span className=\"text-sm font-medium text-orange-700 dark:text-orange-300\">\n                  ü§ñ Player {game.autoPlayActive} is in Auto-Play mode\n                </span>\n              </div>\n              {/* Show \"Take Control\" button only if current user is the auto-playing player */}\n              {((game.autoPlayActive === 'X' && game.playerXInfo?.userId === user?.userId) ||\n                (game.autoPlayActive === 'O' && game.playerOInfo?.userId === user?.userId)) && (\n                <Button\n                  onClick={() => {\n                    // Send WebSocket message to disable auto-play\n                    if (sendMessage && game) {\n                      sendMessage({\n                        type: 'disable_auto_play',\n                        gameId: game.id\n                      });\n                      toast({\n                        title: \"Taking Control...\",\n                        description: \"Disabling auto-play mode...\",\n                      });\n                    }\n                  }}\n                  size=\"sm\"\n                  variant=\"outline\"\n                  className=\"text-xs px-2 py-1 bg-blue-500 hover:bg-blue-600 text-white border-blue-500\"\n                  data-testid=\"button-take-control\"\n                >\n                  Take Control\n                </Button>\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* 3x5 Game Grid */}\n        <div \n          className=\"relative grid grid-cols-5 gap-2 sm:gap-3 md:gap-4 max-w-xs sm:max-w-md md:max-w-lg mx-auto\"\n        >\n          {/* Row 1: 1,2,3,4,5 */}\n          {[1, 2, 3, 4, 5].map(renderCell)}\n          \n          {/* Row 2: 6,7,8,9,10 */}\n          {[6, 7, 8, 9, 10].map(renderCell)}\n          \n          {/* Row 3: 11,12,13,14,15 */}\n          {[11, 12, 13, 14, 15].map(renderCell)}\n          \n          {/* Winning line animation removed - keeping only box blink */}\n        </div>\n\n        {/* Game Controls */}\n        <div className=\"mt-8 flex justify-center space-x-4\">\n          {/* Only show chat button for players, not spectators */}\n          {!isSpectator && (\n            <Button \n              variant=\"outline\"\n              onClick={() => setShowChatPanel(!showChatPanel)}\n              className=\"flex items-center space-x-2\"\n            >\n              <MessageCircle className=\"w-4 h-4\" />\n              <span>{t('chat')}</span>\n            </Button>\n          )}\n          \n\n          \n          {/* Only show Reset Game button for non-online modes */}\n          {gameMode !== 'online' && (\n            <Button \n              variant=\"destructive\"\n              onClick={resetGame}\n              disabled={makeMoveMutation.isPending}\n            >\n              {t('resetGame')}\n            </Button>\n          )}\n        </div>\n        \n        {/* Quick Chat Panel */}\n        <div className=\"relative\">\n          <QuickChatPanel\n            isOpen={showChatPanel}\n            onMessageClick={handleMessageClick}\n            onClose={() => setShowChatPanel(false)}\n          />\n        </div>\n      </CardContent>\n\n      {/* Player Profile Modal */}\n      {showProfileModal && selectedPlayerId && (\n        <PlayerProfileModal\n          playerId={selectedPlayerId}\n          open={showProfileModal}\n          onClose={handleCloseProfileModal}\n          currentUserId={user?.userId || user?.id}\n        />\n      )}\n\n    </Card>\n  );\n}\n","size_bytes":52861},"client/src/components/GameExpirationTimer.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Clock, AlertTriangle } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\ninterface GameExpirationTimerProps {\n  lastMoveAt: string | Date;\n  createdAt: string | Date;\n  onExpired?: () => void;\n  serverTime?: string; // Server timestamp for sync\n  timeRemaining?: number; // Pre-calculated time remaining from server\n}\n\nexport function GameExpirationTimer({ lastMoveAt, createdAt, onExpired, serverTime, timeRemaining: serverTimeRemaining }: GameExpirationTimerProps) {\n  const [timeRemaining, setTimeRemaining] = useState<number>(0);\n  const [isExpired, setIsExpired] = useState(false);\n  \n  // Store the reference point for timer calculations\n  const [referenceTime, setReferenceTime] = useState<{ \n    lastActivity: Date; \n    clientTime: number; \n    serverRemaining?: number; \n  }>(() => {\n    const lastActivity = new Date(lastMoveAt || createdAt);\n    return {\n      lastActivity,\n      clientTime: Date.now(),\n      serverRemaining: serverTimeRemaining\n    };\n  });\n\n  // Update reference time when we get new server data\n  useEffect(() => {\n    if (serverTimeRemaining !== undefined) {\n      console.log('‚è±Ô∏è Timer: Updating reference with server time remaining:', serverTimeRemaining);\n      setReferenceTime({\n        lastActivity: new Date(lastMoveAt || createdAt),\n        clientTime: Date.now(),\n        serverRemaining: serverTimeRemaining\n      });\n    }\n  }, [serverTimeRemaining]); // Removed lastMoveAt and createdAt from dependencies to prevent timer reset on moves\n\n  useEffect(() => {\n    const updateTimer = () => {\n      const now = Date.now();\n      let remaining: number;\n      \n      if (referenceTime.serverRemaining !== undefined) {\n        // Use server-provided time as baseline\n        const elapsedSinceReference = now - referenceTime.clientTime;\n        remaining = Math.max(0, referenceTime.serverRemaining - elapsedSinceReference);\n        console.log('‚è±Ô∏è Timer calculation:', {\n          serverRemaining: referenceTime.serverRemaining,\n          elapsedSinceReference,\n          finalRemaining: remaining\n        });\n      } else {\n        // Fallback to client calculation\n        const tenMinutes = 10 * 60 * 1000;\n        const elapsed = now - referenceTime.lastActivity.getTime();\n        remaining = Math.max(0, tenMinutes - elapsed);\n      }\n      \n      setTimeRemaining(remaining);\n      \n      if (remaining === 0 && !isExpired) {\n        setIsExpired(true);\n        onExpired?.();\n      }\n    };\n\n    // Update immediately\n    updateTimer();\n\n    // Update every second\n    const interval = setInterval(updateTimer, 1000);\n\n    return () => clearInterval(interval);\n  }, [referenceTime, onExpired, isExpired]);\n\n  const formatTime = (milliseconds: number) => {\n    const minutes = Math.floor(milliseconds / 60000);\n    const seconds = Math.floor((milliseconds % 60000) / 1000);\n    return `${minutes}:${seconds.toString().padStart(2, '0')}`;\n  };\n\n  const getTimeColor = () => {\n    const percentage = (timeRemaining / (10 * 60 * 1000)) * 100;\n    if (percentage > 50) return 'text-green-500';\n    if (percentage > 25) return 'text-yellow-500';\n    if (percentage > 10) return 'text-orange-500';\n    return 'text-red-500';\n  };\n\n  const getProgressColor = () => {\n    const percentage = (timeRemaining / (10 * 60 * 1000)) * 100;\n    if (percentage > 50) return 'bg-green-500';\n    if (percentage > 25) return 'bg-yellow-500';\n    if (percentage > 10) return 'bg-orange-500';\n    return 'bg-red-500';\n  };\n\n  const isWarning = timeRemaining < 2 * 60 * 1000; // Last 2 minutes\n  const isCritical = timeRemaining < 1 * 60 * 1000; // Last 1 minute\n\n  if (isExpired) {\n    return (\n      <motion.div\n        initial={{ opacity: 0, scale: 0.8 }}\n        animate={{ opacity: 1, scale: 1 }}\n        className=\"flex items-center space-x-2 px-3 py-2 bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-700 rounded-lg\"\n      >\n        <AlertTriangle className=\"w-4 h-4 text-red-600 dark:text-red-400\" />\n        <span className=\"text-sm font-medium text-red-600 dark:text-red-400\">\n          Game Expired\n        </span>\n      </motion.div>\n    );\n  }\n\n  return (\n    <AnimatePresence>\n      <motion.div\n        initial={{ opacity: 0, y: -10 }}\n        animate={{ \n          opacity: 1, \n          y: 0,\n          scale: isCritical ? [1, 1.05, 1] : 1\n        }}\n        transition={{\n          scale: {\n            duration: 0.5,\n            repeat: isCritical ? Infinity : 0,\n            repeatType: \"reverse\"\n          }\n        }}\n        className={`flex items-center space-x-2 px-3 py-2 rounded-lg border transition-all duration-300 ${\n          isCritical \n            ? 'bg-red-50 dark:bg-red-900/20 border-red-300 dark:border-red-700' \n            : isWarning \n            ? 'bg-yellow-50 dark:bg-yellow-900/20 border-yellow-300 dark:border-yellow-700' \n            : 'bg-gray-50 dark:bg-gray-800/50 border-gray-200 dark:border-gray-700'\n        }`}\n      >\n        <motion.div\n          animate={isCritical ? { rotate: [0, 10, -10, 0] } : {}}\n          transition={{ duration: 0.3, repeat: isCritical ? Infinity : 0 }}\n        >\n          <Clock className={`w-4 h-4 ${getTimeColor()}`} />\n        </motion.div>\n        \n        <div className=\"flex flex-col space-y-1\">\n          <span className={`text-sm font-mono font-medium ${getTimeColor()}`}>\n            {formatTime(timeRemaining)}\n          </span>\n          \n          {/* Progress bar */}\n          <div className=\"w-16 h-1 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden\">\n            <motion.div\n              className={`h-full ${getProgressColor()} transition-all duration-300`}\n              style={{ \n                width: `${(timeRemaining / (10 * 60 * 1000)) * 100}%` \n              }}\n              animate={isCritical ? { opacity: [1, 0.5, 1] } : {}}\n              transition={{ \n                duration: 0.5, \n                repeat: isCritical ? Infinity : 0,\n                repeatType: \"reverse\" \n              }}\n            />\n          </div>\n        </div>\n        \n        {isWarning && (\n          <motion.span\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            className=\"text-xs text-gray-500 dark:text-gray-400\"\n          >\n            until expiry\n          </motion.span>\n        )}\n      </motion.div>\n    </AnimatePresence>\n  );\n}","size_bytes":6414},"client/src/components/GameModeSelector.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Bot, Users, GamepadIcon, Zap, Brain, Cpu } from \"lucide-react\";\nimport { useTranslation } from \"@/contexts/LanguageContext\";\n\ninterface GameModeSelectorProps {\n  selectedMode: 'ai' | 'pass-play' | 'online';\n  onModeChange: (mode: 'ai' | 'pass-play' | 'online') => void;\n  aiDifficulty: 'easy' | 'medium' | 'hard';\n  onDifficultyChange: (difficulty: 'easy' | 'medium' | 'hard') => void;\n}\n\nexport function GameModeSelector({ selectedMode, onModeChange, aiDifficulty, onDifficultyChange }: GameModeSelectorProps) {\n  const { t } = useTranslation();\n  \n  const modes = [\n    {\n      id: 'ai' as const,\n      name: t('aiMode'),\n      icon: Bot,\n      description: t('challengeComputer')\n    },\n    {\n      id: 'pass-play' as const,\n      name: t('passPlayMode'),\n      icon: GamepadIcon,\n      description: t('localMultiplayer')\n    },\n    {\n      id: 'online' as const,\n      name: t('onlineMode'),\n      icon: Users,\n      description: t('playWithFriends')\n    }\n  ];\n\n  return (\n    <Card className=\"bg-slate-800 border-slate-700\">\n      <CardHeader>\n        <CardTitle className=\"text-lg\">{t('gameMode')}</CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-3\">\n        {modes.map((mode) => {\n          const Icon = mode.icon;\n          const isSelected = selectedMode === mode.id;\n          \n          return (\n            <div key={mode.id} className=\"space-y-2\">\n              <Button\n                variant={isSelected ? \"default\" : \"outline\"}\n                className={`w-full justify-start p-4 h-auto ${\n                  isSelected \n                    ? 'bg-primary hover:bg-primary/90 text-white' \n                    : 'bg-slate-700 hover:bg-slate-600 border-slate-600'\n                }`}\n                onClick={() => onModeChange(mode.id)}\n              >\n                <Icon className=\"w-5 h-5 mr-3\" />\n                <div className=\"text-left\">\n                  <div className=\"font-medium\">{mode.name}</div>\n                  <div className=\"text-sm opacity-75\">{mode.description}</div>\n                </div>\n                {isSelected && (\n                  <div className=\"ml-auto w-2 h-2 bg-white rounded-full\"></div>\n                )}\n              </Button>\n              \n              {mode.id === 'ai' && isSelected && (\n                <div className=\"ml-4 mr-4 mt-2\">\n                  <Select value={aiDifficulty} onValueChange={onDifficultyChange}>\n                    <SelectTrigger className=\"w-full bg-slate-700 border-slate-600 text-white\">\n                      <SelectValue placeholder={t('difficulty')} />\n                    </SelectTrigger>\n                    <SelectContent className=\"bg-slate-800 border-slate-600\">\n                      <SelectItem value=\"easy\" className=\"text-white hover:bg-slate-700\">\n                        <div className=\"flex items-center space-x-2\">\n                          <Zap className=\"w-4 h-4 text-green-400\" />\n                          <span>{t('easy')}</span>\n                        </div>\n                      </SelectItem>\n                      <SelectItem value=\"medium\" className=\"text-white hover:bg-slate-700\">\n                        <div className=\"flex items-center space-x-2\">\n                          <Brain className=\"w-4 h-4 text-yellow-400\" />\n                          <span>{t('medium')}</span>\n                        </div>\n                      </SelectItem>\n                      <SelectItem value=\"hard\" className=\"text-white hover:bg-slate-700\">\n                        <div className=\"flex items-center space-x-2\">\n                          <Cpu className=\"w-4 h-4 text-red-400\" />\n                          <span>{t('hard')}</span>\n                        </div>\n                      </SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </CardContent>\n    </Card>\n  );\n}\n","size_bytes":4161},"client/src/components/GameOverModal.tsx":{"content":"import React, { useState, useEffect } from \"react\";\nimport { Bot, RefreshCw, Send } from \"lucide-react\";\nimport { useTranslation } from '../contexts/LanguageContext';\nimport { ShareButton } from './ShareButton';\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface GameOverModalProps {\n  open: boolean;\n  onClose: () => void;\n  result: any;\n  onPlayAgain: () => void;\n  isCreatingGame?: boolean;\n  onPlayWithAI?: () => void;\n  isSpectator?: boolean;\n  currentUser?: {\n    userId: string;\n    username: string;\n    displayName?: string;\n  } | null;\n}\n\nexport function GameOverModal({ open, onClose, result, onPlayAgain, isCreatingGame = false, onPlayWithAI, isSpectator = false, currentUser }: GameOverModalProps) {\n  const { t } = useTranslation();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isRequestingSent, setIsRequestingSent] = useState(false);\n\n  const playAgainRequestMutation = useMutation({\n    mutationFn: async ({ requestedUserId, gameId }: { requestedUserId: string; gameId: string }) => {\n      return apiRequest(`/api/play-again/request`, {\n        method: 'POST',\n        body: { requestedUserId, gameId },\n      });\n    },\n    onSuccess: () => {\n      toast({\n        description: \"Play again request sent! Waiting for response...\",\n      });\n      setIsRequestingSent(true);\n      queryClient.invalidateQueries({ queryKey: ['/api/play-again/requests'] });\n    },\n    onError: (error: any) => {\n      console.error('Error sending play again request:', error);\n      toast({\n        variant: \"destructive\",\n        description: error?.message?.includes('already exists') ? \n          \"You've already sent a play again request for this game\" :\n          \"Failed to send play again request\",\n      });\n    },\n  });\n\n  // Reset the request sent state when play again request is processed\n  useEffect(() => {\n    const handlePlayAgainAccepted = () => {\n      // Request was accepted, reset the button state so it can be used again\n      setIsRequestingSent(false);\n    };\n\n    const handlePlayAgainRejected = () => {\n      // Request was rejected, reset the button state so it can be used again\n      setIsRequestingSent(false);\n    };\n\n    const handleGameStarted = () => {\n      // New game started (means request was accepted), reset the button state\n      setIsRequestingSent(false);\n    };\n\n    // Listen for play again events\n    window.addEventListener('play_again_rejected_received', handlePlayAgainRejected);\n    window.addEventListener('game_started_received', handleGameStarted);\n    \n    // Also listen for generic game_started events from useWebSocket\n    const handleMessage = (event: any) => {\n      if (event.detail?.type === 'game_started') {\n        setIsRequestingSent(false);\n      }\n    };\n    window.addEventListener('matchmaking_message_received', handleMessage);\n\n    return () => {\n      window.removeEventListener('play_again_rejected_received', handlePlayAgainRejected);\n      window.removeEventListener('game_started_received', handleGameStarted);\n      window.removeEventListener('matchmaking_message_received', handleMessage);\n    };\n  }, []);\n\n  // Helper function to get the opponent's user ID\n  const getOpponentId = () => {\n    if (!currentUser || !result?.game) return null;\n    \n    const { playerXId, playerOId } = result.game;\n    if (playerXId === currentUser.userId) {\n      return playerOId;\n    } else if (playerOId === currentUser.userId) {\n      return playerXId;\n    }\n    return null;\n  };\n\n  // Helper function to determine if this is an online game with a real opponent\n  const isOnlineGameWithOpponent = () => {\n    const opponentId = getOpponentId();\n    // Check if it's online mode AND has an opponent AND the opponent is not a bot\n    return result?.game?.gameMode === 'online' && \n           opponentId && \n           opponentId !== 'ai' && \n           !opponentId.startsWith('player_'); // Bot IDs start with 'player_'\n  };\n\n  // Handle play again - either send request for online games or direct play again for others\n  const handlePlayAgainClick = () => {\n    if (isOnlineGameWithOpponent()) {\n      const opponentId = getOpponentId();\n      if (opponentId && result?.game?.id) {\n        playAgainRequestMutation.mutate({\n          requestedUserId: opponentId,\n          gameId: result.game.id\n        });\n      }\n    } else {\n      // For AI games and pass-play, use the existing play again functionality\n      onPlayAgain();\n    }\n  };\n  \n  // Simple safety checks\n  if (!open) return null;\n  if (!result) {\n    console.error('GameOverModal: No result provided');\n    return null;\n  }\n  \n  console.log('GameOverModal rendering with result:', result);\n\n  // Super simple logic - no complex conditionals\n  const isDraw = result.condition === 'draw';\n  const winner = result.winner;\n  \n  // Get proper player names and info - only for online games\n  const isOnlineGame = result.game?.gameMode === 'online';\n  \n  const getPlayerDisplayName = (symbol: string) => {\n    if (!isOnlineGame) {\n      // For AI and pass-play modes, use simple names\n      if (symbol === 'X') return 'Player X';\n      if (symbol === 'O') return result.game?.gameMode === 'ai' ? 'AI' : 'Player O';\n      return 'Unknown';\n    }\n    \n    // For online games, use actual player info\n    if (symbol === 'X') {\n      const playerX = result.playerXInfo;\n      return playerX?.displayName || playerX?.firstName || playerX?.username || 'Player X';\n    } else if (symbol === 'O') {\n      const playerO = result.playerOInfo;\n      return playerO?.displayName || playerO?.firstName || playerO?.username || 'Player O';\n    }\n    return 'Unknown';\n  };\n  \n  const winnerName = winner ? getPlayerDisplayName(winner) : null;\n  const winnerInfo = isOnlineGame && winner ? (winner === 'X' ? result.playerXInfo : result.playerOInfo) : null;\n  \n  // Get loser information - only for games with winners\n  const loser = winner ? (winner === 'X' ? 'O' : 'X') : null;\n  const loserName = loser ? getPlayerDisplayName(loser) : null;\n  const loserInfo = isOnlineGame && loser ? (loser === 'X' ? result.playerXInfo : result.playerOInfo) : null;\n\n  return (\n    <>\n      {/* Sparkle explosion effect for wins */}\n      {open && !isDraw && winner && (\n        <div style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          width: '100%',\n          height: '100%',\n          pointerEvents: 'none',\n          zIndex: 10000\n        }}>\n          {/* Generate 60 sparkles that explode outward from center */}\n          {Array.from({ length: 60 }, (_, i) => {\n            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#f9ca24', '#f0932b', '#eb4d4b', '#6c5ce7', '#a29bfe', '#00b894', '#e17055'];\n            const size = Math.random() * 10 + 3; // 3-13px\n            const angle = (360 / 60) * i + Math.random() * 20; // Spread around 360 degrees\n            const distance = Math.random() * 300 + 150; // 150-450px from center\n            const duration = Math.random() * 1.5 + 1.5; // 1.5-3s animation\n            const delay = Math.random() * 0.3; // 0-0.3s delay\n            \n            // Calculate final position based on angle and distance\n            const radian = (angle * Math.PI) / 180;\n            const dx = Math.cos(radian) * distance;\n            const dy = Math.sin(radian) * distance;\n            \n            return (\n              <div\n                key={i}\n                style={{\n                  position: 'absolute',\n                  left: '50%',\n                  top: '50%',\n                  width: `${size}px`,\n                  height: `${size}px`,\n                  backgroundColor: colors[Math.floor(Math.random() * colors.length)],\n                  borderRadius: '50%',\n                  animation: `sparkle-explode ${duration}s ease-out ${delay}s forwards`,\n                  boxShadow: `0 0 ${size * 2}px ${colors[Math.floor(Math.random() * colors.length)]}`,\n                  transform: 'translate(-50%, -50%)',\n                  '--dx': `${dx}px`,\n                  '--dy': `${dy}px`\n                } as React.CSSProperties}\n              />\n            );\n          })}\n        </div>\n      )}\n      \n      <div \n        style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          backgroundColor: 'rgba(0, 0, 0, 0.9)',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          zIndex: 9999,\n          padding: '16px'\n        }}\n        onClick={onClose}\n      >\n      <div \n        style={{\n          backgroundColor: '#1e293b',\n          borderRadius: '8px',\n          padding: '24px',\n          maxWidth: '400px',\n          width: '100%',\n          boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.25)',\n          border: '1px solid #475569',\n          color: 'white',\n          textAlign: 'center'\n        }}\n        onClick={(e) => e.stopPropagation()}\n      >\n        <style>{`\n          @keyframes winner-pulse {\n            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(251, 191, 36, 0.7); }\n            100% { transform: scale(1.1); box-shadow: 0 0 0 10px rgba(251, 191, 36, 0); }\n          }\n          @keyframes sparkle-explode {\n            0% {\n              transform: translate(-50%, -50%) scale(0);\n              opacity: 1;\n            }\n            20% {\n              transform: translate(-50%, -50%) scale(1.5);\n              opacity: 1;\n            }\n            100% {\n              transform: translate(calc(-50% + var(--dx)), calc(-50% + var(--dy))) scale(0.3);\n              opacity: 0;\n            }\n          }\n        `}</style>\n        <h2 style={{ fontSize: '24px', fontWeight: 'bold', marginBottom: '24px', color: 'white' }}>\n          {t('gameOver')}\n        </h2>\n        \n        <div style={{ marginBottom: '24px' }}>\n          {isDraw ? (\n            <div>\n              <div \n                style={{\n                  width: '80px',\n                  height: '80px',\n                  margin: '0 auto 16px',\n                  backgroundColor: '#eab308',\n                  borderRadius: '50%',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center'\n                }}\n              >\n                <span style={{ fontSize: '32px' }}>ü§ù</span>\n              </div>\n              <p style={{ fontSize: '20px', color: '#d1d5db' }}>{t('itsADraw')}</p>\n            </div>\n          ) : (\n            <div>\n              {/* Winner vs Loser display */}\n              <div style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', gap: '20px', marginBottom: '16px' }}>\n                {/* Winner */}\n                <div style={{ textAlign: 'center' }}>\n                  <div \n                    style={{\n                      width: '80px',\n                      height: '80px',\n                      margin: '0 auto 8px',\n                      backgroundColor: winner === 'X' ? '#3b82f6' : '#ef4444',\n                      borderRadius: '50%',\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'center',\n                      overflow: 'hidden',\n                      border: '4px solid #fbbf24',\n                      animation: 'winner-pulse 1s ease-in-out infinite alternate'\n                    }}\n                  >\n                    {isOnlineGame && (winnerInfo?.profilePicture || winnerInfo?.profileImageUrl) ? (\n                      <img \n                        src={winnerInfo.profilePicture || winnerInfo.profileImageUrl} \n                        alt={winnerName}\n                        style={{\n                          width: '100%',\n                          height: '100%',\n                          objectFit: 'cover'\n                        }}\n                      />\n                    ) : (\n                      <span style={{ fontSize: '32px', color: 'white', fontWeight: 'bold' }}>\n                        {winner}\n                      </span>\n                    )}\n                  </div>\n                  <p style={{ fontSize: '14px', color: '#10b981', fontWeight: 'bold', margin: 0 }}>\n                    üëë {winnerName}\n                  </p>\n                  <p style={{ fontSize: '12px', color: '#10b981', margin: 0 }}>\n                    Winner\n                  </p>\n                </div>\n\n                {/* VS */}\n                <div style={{ fontSize: '24px', color: '#9ca3af', fontWeight: 'bold' }}>\n                  VS\n                </div>\n\n                {/* Loser */}\n                <div style={{ textAlign: 'center' }}>\n                  <div \n                    style={{\n                      width: '80px',\n                      height: '80px',\n                      margin: '0 auto 8px',\n                      backgroundColor: loser === 'X' ? '#3b82f6' : '#ef4444',\n                      borderRadius: '50%',\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'center',\n                      overflow: 'hidden',\n                      border: '3px solid #6b7280',\n                      opacity: 0.7\n                    }}\n                  >\n                    {isOnlineGame && (loserInfo?.profilePicture || loserInfo?.profileImageUrl) ? (\n                      <img \n                        src={loserInfo.profilePicture || loserInfo.profileImageUrl} \n                        alt={loserName}\n                        style={{\n                          width: '100%',\n                          height: '100%',\n                          objectFit: 'cover'\n                        }}\n                      />\n                    ) : (\n                      <span style={{ fontSize: '32px', color: 'white', fontWeight: 'bold' }}>\n                        {loser}\n                      </span>\n                    )}\n                  </div>\n                  <p style={{ fontSize: '14px', color: '#ef4444', fontWeight: 'bold', margin: 0 }}>\n                    {loserName}\n                  </p>\n                  <p style={{ fontSize: '12px', color: '#ef4444', margin: 0 }}>\n                    Loser\n                  </p>\n                </div>\n              </div>\n              \n              <p style={{ fontSize: '20px', color: 'white', marginBottom: '16px' }}>\n                {result.isAbandonmentWin && result.abandonmentMessage ? \n                  result.abandonmentMessage : \n                  winnerName ? t('playerWins').replace('{player}', winnerName) : t('itsADraw')\n                }\n              </p>\n              \n              <p style={{ fontSize: '14px', color: '#9ca3af' }}>\n                {result.condition === 'abandonment' ? \n                  'Opponent left the game' : \n                  result.condition === 'horizontal' ? t('horizontalLine') : t('diagonalLine')\n                }\n              </p>\n            </div>\n          )}\n        </div>\n        \n        <div style={{ display: 'flex', justifyContent: 'center', gap: '12px', flexWrap: 'wrap' }}>\n          <button\n            onClick={() => {\n              console.log('ü§ñ Play with AI button clicked from GameOverModal');\n              onClose();\n              if (onPlayWithAI) {\n                console.log('ü§ñ Calling onPlayWithAI from GameOverModal');\n                onPlayWithAI();\n              }\n            }}\n            style={{\n              padding: '8px 16px',\n              borderRadius: '8px',\n              backgroundColor: '#374151',\n              color: 'white',\n              border: '1px solid #6b7280',\n              cursor: 'pointer',\n              display: 'flex',\n              alignItems: 'center',\n              gap: '8px'\n            }}\n          >\n            <Bot style={{ width: '16px', height: '16px' }} />\n            Home\n          </button>\n          \n          {/* Only show Play Again button if user is not a spectator */}\n          {!isSpectator && (\n            <button\n              onClick={() => {\n                if (!isCreatingGame && !playAgainRequestMutation.isPending && !isRequestingSent) {\n                  handlePlayAgainClick();\n                }\n              }}\n              disabled={isCreatingGame || playAgainRequestMutation.isPending || isRequestingSent}\n              data-testid=\"button-play-again\"\n              style={{\n                padding: '8px 16px',\n                borderRadius: '8px',\n                backgroundColor: (isCreatingGame || playAgainRequestMutation.isPending || isRequestingSent) ? '#6b7280' : '#3b82f6',\n                color: 'white',\n                border: (isCreatingGame || playAgainRequestMutation.isPending || isRequestingSent) ? '1px solid #6b7280' : '1px solid #2563eb',\n                cursor: (isCreatingGame || playAgainRequestMutation.isPending || isRequestingSent) ? 'not-allowed' : 'pointer',\n                display: 'flex',\n                alignItems: 'center',\n                gap: '8px',\n                opacity: (isCreatingGame || playAgainRequestMutation.isPending || isRequestingSent) ? 0.6 : 1\n              }}\n            >\n              {isOnlineGameWithOpponent() ? (\n                <>\n                  <Send style={{ width: '16px', height: '16px' }} />\n                  {isRequestingSent ? 'Request Sent' : \n                   playAgainRequestMutation.isPending ? 'Sending...' : \n                   'Request Play Again'}\n                </>\n              ) : (\n                <>\n                  <RefreshCw style={{ width: '16px', height: '16px' }} />\n                  {t('playAgain')}\n                </>\n              )}\n            </button>\n          )}\n          \n          {/* Share button for victories */}\n          {!isDraw && winner && (\n            <div style={{ marginTop: '8px' }}>\n              <ShareButton\n                title=\"TicTac 3x5 Victory!\"\n                text={`üéâ I just won a game in TicTac 3x5! ${winnerName} wins! Check out this strategic tic-tac-toe game.`}\n                variant=\"default\"\n                size=\"sm\"\n                className=\"bg-green-600 hover:bg-green-700 text-white border-green-600\"\n              />\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n    </>\n  );\n}","size_bytes":18337},"client/src/components/InvitationNotification.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { User, Check, X, Clock } from \"lucide-react\";\n\ninterface InvitationNotificationProps {\n  invitation: {\n    senderId: string;\n    senderName: string;\n    roomId: string;\n    roomName: string;\n    timestamp: string;\n  };\n  onAccept: (roomId: string) => void;\n  onDismiss: () => void;\n}\n\nexport function InvitationNotification({ invitation, onAccept, onDismiss }: InvitationNotificationProps) {\n  const { toast } = useToast();\n  const [isAccepting, setIsAccepting] = useState(false);\n\n  const handleAccept = async () => {\n    setIsAccepting(true);\n    try {\n      // Join the room\n      await apiRequest(`/api/rooms/${invitation.roomId}/join`, {\n        method: 'POST',\n        body: { role: 'player' }\n      });\n      \n      onAccept(invitation.roomId);\n      \n      toast({\n        title: \"Invitation accepted\",\n        description: `You joined ${invitation.roomName}`,\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to join room\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsAccepting(false);\n    }\n  };\n\n  const formatTime = (timestamp: string) => {\n    return new Date(timestamp).toLocaleTimeString([], { \n      hour: '2-digit', \n      minute: '2-digit' \n    });\n  };\n\n  return (\n    <Card className=\"w-80 border-blue-200 bg-blue-50 dark:bg-blue-950 dark:border-blue-800\">\n      <CardHeader className=\"pb-3\">\n        <CardTitle className=\"text-sm flex items-center gap-2\">\n          <User className=\"h-4 w-4 text-blue-600\" />\n          Room Invitation\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-3\">\n        <div>\n          <p className=\"font-medium\">{invitation.senderName}</p>\n          <p className=\"text-sm text-muted-foreground\">\n            invited you to join \"{invitation.roomName}\"\n          </p>\n        </div>\n        \n        <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n          <Clock className=\"h-3 w-3\" />\n          {formatTime(invitation.timestamp)}\n        </div>\n        \n        <div className=\"flex gap-2\">\n          <Button\n            size=\"sm\"\n            onClick={handleAccept}\n            disabled={isAccepting}\n            className=\"flex-1\"\n          >\n            <Check className=\"h-4 w-4 mr-1\" />\n            {isAccepting ? \"Joining...\" : \"Accept\"}\n          </Button>\n          <Button\n            size=\"sm\"\n            variant=\"outline\"\n            onClick={onDismiss}\n            className=\"flex-1\"\n          >\n            <X className=\"h-4 w-4 mr-1\" />\n            Decline\n          </Button>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":2970},"client/src/components/InvitationPopup.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { UserPlus, X, Check, Clock } from \"lucide-react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { useTranslation } from \"@/contexts/LanguageContext\";\n\ninterface InvitationPopupProps {\n  onRoomJoin: (room: any) => void;\n}\n\nexport function InvitationPopup({ onRoomJoin }: InvitationPopupProps) {\n  const { t } = useTranslation();\n  const [visibleInvitation, setVisibleInvitation] = useState<any>(null);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const { isAuthenticated } = useAuth();\n\n  // Fetch room invitations only when authenticated\n  // Use longer polling interval to reduce unnecessary API calls\n  const { data: invitations = [] } = useQuery({\n    queryKey: ['/api/room-invitations'],\n    refetchInterval: isAuthenticated ? 15000 : false, // Increased to 15s to reduce load\n    enabled: isAuthenticated,\n    staleTime: 12000, // Consider data fresh for 12 seconds\n    refetchOnWindowFocus: false,\n    refetchOnMount: false,\n  });\n\n  // Show the first pending invitation as a popup\n  useEffect(() => {\n    const pendingInvitation = invitations.find((inv: any) => inv.status === 'pending');\n    if (pendingInvitation && (!visibleInvitation || visibleInvitation.id !== pendingInvitation.id)) {\n      setVisibleInvitation(pendingInvitation);\n    } else if (!pendingInvitation && visibleInvitation) {\n      setVisibleInvitation(null);\n    }\n  }, [invitations]);\n\n  const respondToInvitationMutation = useMutation({\n    mutationFn: async (data: { invitationId: string, response: 'accepted' | 'rejected' }) => {\n      const response = await apiRequest(`/api/room-invitations/${data.invitationId}/respond`, {\n        method: 'POST',\n        body: { response: data.response }\n      });\n      return response.json();\n    },\n    onSuccess: (data, variables) => {\n      if (variables.response === 'accepted') {\n        onRoomJoin(data.room);\n        toast({\n          title: t('invitationAccepted'),\n          description: t('joinedRoomSuccessfully'),\n        });\n      } else {\n        toast({\n          title: t('invitationDeclined'),\n          description: t('youDeclinedInvitation'),\n        });\n      }\n      queryClient.invalidateQueries({ queryKey: ['/api/room-invitations'] });\n      setVisibleInvitation(null);\n    },\n    onError: (error) => {\n      toast({\n        title: t('error'),\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleAccept = () => {\n    if (visibleInvitation) {\n      respondToInvitationMutation.mutate({\n        invitationId: visibleInvitation.id,\n        response: 'accepted'\n      });\n    }\n  };\n\n  const handleDecline = () => {\n    if (visibleInvitation) {\n      respondToInvitationMutation.mutate({\n        invitationId: visibleInvitation.id,\n        response: 'rejected'\n      });\n    }\n  };\n\n  const handleDismiss = () => {\n    setVisibleInvitation(null);\n  };\n\n  if (!visibleInvitation) return null;\n\n  return (\n    <AnimatePresence>\n      <motion.div\n        initial={{ opacity: 0, scale: 0.8, y: 50 }}\n        animate={{ opacity: 1, scale: 1, y: 0 }}\n        exit={{ opacity: 0, scale: 0.8, y: 50 }}\n        transition={{ duration: 0.3, ease: \"easeOut\" }}\n        className=\"fixed inset-0 z-50 flex items-center justify-center\"\n      >\n        <Card className=\"bg-gradient-to-br from-blue-900/95 to-purple-900/95 border-blue-500/50 shadow-2xl backdrop-blur-sm max-w-sm w-full mx-4\">\n          <CardHeader className=\"pb-3\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <UserPlus className=\"w-5 h-5 text-blue-400\" />\n                <CardTitle className=\"text-lg text-white\">{t('roomInvitation')}</CardTitle>\n              </div>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={handleDismiss}\n                className=\"h-6 w-6 p-0 text-gray-400 hover:text-white hover:bg-white/10\"\n              >\n                <X className=\"h-4 w-4\" />\n              </Button>\n            </div>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"text-center space-y-2\">\n              <div className=\"text-white font-medium\">\n{t('invitedYouToJoinRoom', { inviterName: visibleInvitation.inviterName || visibleInvitation.inviter?.displayName || visibleInvitation.inviter?.username || 'Unknown' })}\n              </div>\n              <div className=\"text-blue-200 text-sm\">\n{t('room')}: {visibleInvitation.roomCode}\n              </div>\n              <Badge variant=\"secondary\" className=\"bg-blue-600/30 text-blue-200 border-blue-400/30\">\n                <Clock className=\"w-3 h-3 mr-1\" />\n{t('gameRoom')}\n              </Badge>\n            </div>\n            \n            <div className=\"flex gap-2\">\n              <Button\n                onClick={handleAccept}\n                disabled={respondToInvitationMutation.isPending}\n                className=\"flex-1 bg-green-600 hover:bg-green-700 text-white\"\n              >\n                <Check className=\"w-4 h-4 mr-2\" />\n{t('accept')}\n              </Button>\n              <Button\n                onClick={handleDecline}\n                disabled={respondToInvitationMutation.isPending}\n                variant=\"outline\"\n                className=\"flex-1 border-red-500/50 text-red-300 hover:bg-red-500/20\"\n              >\n                <X className=\"w-4 h-4 mr-2\" />\n{t('decline')}\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      </motion.div>\n    </AnimatePresence>\n  );\n}","size_bytes":6028},"client/src/components/InviteFriendsModal.tsx":{"content":"import { useState } from 'react';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { useToast } from '@/hooks/use-toast';\nimport { apiRequest } from '@/lib/queryClient';\nimport { UserPlus, Users, Send, Check } from 'lucide-react';\nimport { useTranslation } from '@/contexts/LanguageContext';\n\ninterface InviteFriendsModalProps {\n  open: boolean;\n  onClose: () => void;\n  roomId: string;\n  roomName: string;\n}\n\nexport function InviteFriendsModal({ open, onClose, roomId, roomName }: InviteFriendsModalProps) {\n  const { t } = useTranslation();\n  const [invitedFriends, setInvitedFriends] = useState<Set<string>>(new Set());\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // Fetch friends list\n  const { data: friends = [], isLoading: friendsLoading } = useQuery({\n    queryKey: ['/api/friends'],\n    enabled: open,\n  });\n\n  // Send invitation mutation\n  const sendInvitationMutation = useMutation({\n    mutationFn: async (friendId: string) => {\n      const response = await apiRequest(`/api/rooms/${roomId}/invite`, {\n        method: 'POST',\n        body: { invitedId: friendId }\n      });\n      return response.json();\n    },\n    onSuccess: (_, friendId) => {\n      setInvitedFriends(prev => new Set([...Array.from(prev), friendId]));\n      toast({\n        title: t('invitationSent'),\n        description: t('friendInvitedToRoom'),\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: t('error'),\n        description: error.message || t('failedToSendInvitation'),\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleInviteFriend = (friendId: string) => {\n    sendInvitationMutation.mutate(friendId);\n  };\n\n  const handleClose = () => {\n    setInvitedFriends(new Set());\n    onClose();\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={handleClose}>\n      <DialogContent className=\"sm:max-w-md max-h-[80vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <UserPlus className=\"h-5 w-5 text-blue-500\" />\n{t('inviteFriendsTo')} {roomName}\n          </DialogTitle>\n        </DialogHeader>\n        \n        <div className=\"space-y-4\">\n          {friendsLoading ? (\n            <div className=\"text-center py-8\">\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto\"></div>\n              <p className=\"text-sm text-gray-600 dark:text-gray-300 mt-2\">{t('loadingFriends')}</p>\n            </div>\n          ) : (friends as any[]).length === 0 ? (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              <Users className=\"h-12 w-12 mx-auto text-gray-400 mb-3\" />\n              <h3 className=\"font-medium text-lg mb-2\">{t('noFriendsFound')}</h3>\n              <p className=\"text-sm\">\n                {t('addFriendsFirstToInvite')}\n              </p>\n            </div>\n          ) : (\n            <div className=\"space-y-3\">\n              <div className=\"text-sm text-gray-600 dark:text-gray-300 mb-3\">\n                {t('selectFriendsToInvite')}\n              </div>\n              \n              {(friends as any[]).map((friend: any) => {\n                const isInvited = invitedFriends.has(friend.id);\n                const isInviting = sendInvitationMutation.isPending;\n                \n                return (\n                  <Card key={friend.id} className=\"border border-gray-200 dark:border-gray-700\">\n                    <CardContent className=\"p-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center space-x-3\">\n                          {friend.profilePicture || friend.profileImageUrl ? (\n                            <img\n                              src={friend.profilePicture || friend.profileImageUrl}\n                              alt={friend.displayName || friend.username}\n                              className=\"w-10 h-10 rounded-full object-cover\"\n                            />\n                          ) : (\n                            <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-semibold\">\n                              {(friend.displayName || friend.username || '?').charAt(0).toUpperCase()}\n                            </div>\n                          )}\n                          <div>\n                            <p className=\"font-medium text-sm\">\n                              {friend.displayName || friend.username}\n                            </p>\n                            <div className=\"flex items-center gap-2 text-xs text-gray-500\">\n                              <span>@{friend.username}</span>\n                              <Badge variant=\"outline\" className=\"px-2 py-0 text-xs\">\n                                {friend.wins}W-{friend.losses}L\n                              </Badge>\n                            </div>\n                          </div>\n                        </div>\n                        \n                        <div>\n                          {isInvited ? (\n                            <Button\n                              size=\"sm\"\n                              variant=\"outline\"\n                              disabled\n                              className=\"bg-green-50 border-green-200 text-green-700 dark:bg-green-900/20 dark:border-green-700 dark:text-green-400\"\n                            >\n                              <Check className=\"h-4 w-4 mr-1\" />\n                              {t('invited')}\n                            </Button>\n                          ) : (\n                            <Button\n                              size=\"sm\"\n                              onClick={() => handleInviteFriend(friend.id)}\n                              disabled={isInviting}\n                              className=\"bg-blue-500 hover:bg-blue-600 text-white\"\n                            >\n                              <Send className=\"h-4 w-4 mr-1\" />\n                              {isInviting ? t('sending') : t('invite')}\n                            </Button>\n                          )}\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                );\n              })}\n            </div>\n          )}\n          \n          <div className=\"flex justify-end space-x-2 pt-4 border-t\">\n            <Button\n              variant=\"outline\"\n              onClick={handleClose}\n            >\n              {t('close')}\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":6917},"client/src/components/LanguageSelector.tsx":{"content":"import React from 'react';\nimport { Button } from '@/components/ui/button';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu';\nimport { Languages, ChevronDown } from 'lucide-react';\nimport { useLanguage, useTranslation } from '@/contexts/LanguageContext';\nimport { languages, Language } from '@/lib/i18n';\n\nexport function LanguageSelector() {\n  const { language, setLanguage } = useLanguage();\n  const { t } = useTranslation();\n\n  const handleLanguageChange = (newLang: Language) => {\n    setLanguage(newLang);\n  };\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <Button variant=\"outline\" size=\"sm\" className=\"gap-2\">\n          <Languages className=\"w-4 h-4\" />\n          <span className=\"text-sm\">{languages[language].flag}</span>\n          <span className=\"hidden sm:inline\">{languages[language].name}</span>\n          <ChevronDown className=\"w-4 h-4\" />\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent \n        align=\"end\" \n        className=\"w-56 z-[9999] bg-slate-800 border border-slate-600 shadow-2xl\"\n        style={{ zIndex: 9999 }}\n        sideOffset={8}\n      >\n        {Object.entries(languages).map(([code, info]) => (\n          <DropdownMenuItem\n            key={code}\n            onClick={() => handleLanguageChange(code as Language)}\n            className={`flex items-center gap-2 cursor-pointer ${\n              language === code ? 'bg-accent' : ''\n            }`}\n          >\n            <span className=\"text-lg\">{info.flag}</span>\n            <span className=\"flex-1\">{info.name}</span>\n            {language === code && (\n              <span className=\"text-xs text-muted-foreground\">‚úì</span>\n            )}\n          </DropdownMenuItem>\n        ))}\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}","size_bytes":1864},"client/src/components/Leaderboard.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { PlayerProfileModal } from \"./PlayerProfileModal\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport { Trophy, Medal, Award, Crown, TrendingUp, Users, Target, Loader2, Calendar, Clock, Coins } from \"lucide-react\";\nimport { useTranslation } from \"@/contexts/LanguageContext\";\nimport { motion } from \"framer-motion\";\nimport { formatNumber } from \"@/lib/utils\";\n\ninterface MonthlyLeaderboardUser {\n  id: string;\n  userId: string;\n  monthlyWins: number;\n  user: {\n    id: string;\n    username: string;\n    displayName: string;\n    profileImageUrl: string;\n    selectedAchievementBorder: string;\n  };\n}\n\ninterface MonthlyReward {\n  id: string;\n  month: number;\n  year: number;\n  position: number;\n  coins: number;\n  claimedAt: string;\n}\n\ninterface TimeLeft {\n  days: number;\n  hours: number;\n  minutes: number;\n  seconds: number;\n}\n\ninterface LeaderboardProps {\n  trigger?: React.ReactNode;\n  open?: boolean;\n  onClose?: () => void;\n}\n\nexport function Leaderboard({ trigger, open, onClose }: LeaderboardProps) {\n  const [isOpen, setIsOpen] = useState(false);\n  \n  // Use external open state if provided, otherwise use internal state\n  const modalOpen = open !== undefined ? open : isOpen;\n  const handleClose = onClose || (() => setIsOpen(false));\n  const [selectedPlayerId, setSelectedPlayerId] = useState<string | null>(null);\n  const [showPlayerProfile, setShowPlayerProfile] = useState(false);\n  const [timeLeft, setTimeLeft] = useState<TimeLeft>({ days: 0, hours: 0, minutes: 0, seconds: 0 });\n  const { t, language } = useTranslation();\n  const queryClient = useQueryClient();\n  const isArabic = language === 'ar';\n\n  // Monthly leaderboard query\n  const { data: monthlyLeaderboard, isLoading: monthlyLoading, error: monthlyError, refetch: refetchMonthly } = useQuery<MonthlyLeaderboardUser[]>({\n    queryKey: ['/api/leaderboard/monthly', language],\n    queryFn: async () => {\n      const response = await fetch('/api/leaderboard/monthly?limit=50', {\n        credentials: 'include'\n      });\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      return await response.json();\n    },\n    enabled: modalOpen, // Always enabled when modal is open\n    retry: 3,\n    staleTime: 0, // Always fetch fresh data\n    refetchOnMount: true,\n    refetchOnWindowFocus: true, // Refresh when window gets focus\n    refetchInterval: 30000, // Refresh every 30 seconds\n  });\n\n  // Time until month end query\n  const { data: timeUntilEnd } = useQuery<TimeLeft>({\n    queryKey: ['/api/leaderboard/time-left'],\n    queryFn: async () => {\n      const response = await fetch('/api/leaderboard/time-left');\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      return await response.json();\n    },\n    enabled: modalOpen,\n    refetchInterval: 1000, // Update every second for countdown\n    staleTime: 0,\n  });\n\n  // Monthly rewards query\n  const { data: monthlyRewards } = useQuery<MonthlyReward[]>({\n    queryKey: ['/api/rewards/monthly'],\n    queryFn: async () => {\n      const response = await fetch('/api/rewards/monthly', {\n        credentials: 'include'\n      });\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      return await response.json();\n    },\n    enabled: modalOpen,\n    retry: 3,\n    staleTime: 60000,\n  });\n\n  // Force refresh when modal opens or language changes\n  useEffect(() => {\n    if (modalOpen) {\n      console.log(`Modal opened (${language}) - forcing monthly leaderboard refresh`);\n      // Clear cache and force fresh data\n      queryClient.invalidateQueries({ queryKey: ['/api/leaderboard/monthly'] });\n      refetchMonthly();\n    }\n  }, [modalOpen, language, refetchMonthly, queryClient]);\n\n  // Update local countdown timer state when data changes\n  useEffect(() => {\n    if (timeUntilEnd) {\n      setTimeLeft(timeUntilEnd);\n    }\n  }, [timeUntilEnd]);\n\n  // Listen for external trigger to open leaderboard\n  useEffect(() => {\n    const handleOpenLeaderboard = () => {\n      setIsOpen(true);\n    };\n\n    window.addEventListener('openLeaderboard', handleOpenLeaderboard);\n    return () => window.removeEventListener('openLeaderboard', handleOpenLeaderboard);\n  }, []);\n\n  const getRankIcon = (position: number) => {\n    switch (position) {\n      case 1:\n        return (\n          <motion.div\n            animate={{ \n              rotate: [0, 5, -5, 0],\n              scale: [1, 1.1, 1]\n            }}\n            transition={{ \n              duration: 2,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n            className=\"relative\"\n          >\n            <Crown className=\"w-7 h-7 text-yellow-500 drop-shadow-lg filter brightness-110\" />\n            <motion.div \n              className=\"absolute -top-0.5 -right-0.5 w-2 h-2 bg-yellow-400 rounded-full\"\n              animate={{ \n                scale: [0.5, 1, 0.5],\n                opacity: [0.5, 1, 0.5]\n              }}\n              transition={{ \n                duration: 1.5,\n                repeat: Infinity,\n                ease: \"easeInOut\"\n              }}\n            />\n          </motion.div>\n        );\n      case 2:\n        return <Medal className=\"w-6 h-6 text-gray-400\" />;\n      case 3:\n        return <Award className=\"w-6 h-6 text-amber-600\" />;\n      default:\n        return <span className=\"w-6 h-6 flex items-center justify-center text-sm font-bold text-gray-600\">#{position}</span>;\n    }\n  };\n\n  const getRankColor = (position: number) => {\n    switch (position) {\n      case 1:\n        return \"from-yellow-400 to-yellow-600 text-white\";\n      case 2:\n        return \"from-gray-300 to-gray-500 text-white\";\n      case 3:\n        return \"from-amber-400 to-amber-600 text-white\";\n      default:\n        if (position <= 10) return \"from-blue-100 to-blue-200 text-blue-800 dark:from-blue-900/50 dark:to-blue-800/50 dark:text-blue-200\";\n        return \"from-gray-50 to-gray-100 text-gray-700 dark:from-gray-800/50 dark:to-gray-700/50 dark:text-gray-300\";\n    }\n  };\n\n  // Get achievement border styling for profile pictures\n  const getAchievementBorderStyle = (entry: MonthlyLeaderboardUser, position: number) => {\n    // Always show golden border for top 3 positions\n    if (position <= 3) {\n      switch (position) {\n        case 1:\n          return {\n            borderClass: \"ring-2 ring-yellow-400\",\n            glowEffect: \"shadow-[0_0_12px_rgba(234,179,8,0.4)]\",\n            animation: \"animate-pulse\"\n          };\n        case 2:\n          return {\n            borderClass: \"ring-2 ring-gray-400\",\n            glowEffect: \"shadow-[0_0_12px_rgba(156,163,175,0.4)]\",\n            animation: \"animate-pulse\"\n          };\n        case 3:\n          return {\n            borderClass: \"ring-2 ring-amber-400\",\n            glowEffect: \"shadow-[0_0_12px_rgba(245,158,11,0.4)]\",\n            animation: \"animate-pulse\"\n          };\n      }\n    }\n\n    // Apply achievement-specific styling for users with achievement borders\n    if (!entry.user.selectedAchievementBorder) {\n      return {\n        borderClass: \"ring-1 ring-gray-200 dark:ring-gray-600\",\n        glowEffect: \"\",\n        animation: \"\"\n      };\n    }\n\n    switch (entry.user.selectedAchievementBorder) {\n      case 'ultimate_veteran':\n        return {\n          borderClass: \"ring-2 ring-orange-500\",\n          glowEffect: \"shadow-[0_0_15px_rgba(255,99,71,0.5)]\",\n          animation: \"animate-pulse\"\n        };\n      case 'grandmaster':\n        return {\n          borderClass: \"ring-2 ring-indigo-400\",\n          glowEffect: \"shadow-[0_0_15px_rgba(165,180,252,0.5)]\",\n          animation: \"animate-pulse\"\n        };\n      case 'champion':\n        return {\n          borderClass: \"ring-2 ring-purple-400\",\n          glowEffect: \"shadow-[0_0_15px_rgba(196,181,253,0.5)]\",\n          animation: \"animate-pulse\"\n        };\n      case 'legend':\n        return {\n          borderClass: \"ring-2 ring-orange-400\",\n          glowEffect: \"shadow-[0_0_15px_rgba(251,146,60,0.5)]\",\n          animation: \"animate-pulse\"\n        };\n      default:\n        return {\n          borderClass: \"ring-1 ring-gray-200 dark:ring-gray-600\",\n          glowEffect: \"\",\n          animation: \"\"\n        };\n    }\n  };\n\n  const renderAchievementBorder = (entry: MonthlyLeaderboardUser, position: number) => {\n    if (!entry.user.selectedAchievementBorder) {\n      return (\n        <span className=\"font-semibold text-sm truncate\">\n          {entry.user.displayName}\n        </span>\n      );\n    }\n\n    switch (entry.user.selectedAchievementBorder) {\n      case 'ultimate_veteran':\n        return (\n          <motion.span\n            animate={{\n              textShadow: [\n                \"0 0 8px #ff6347, 0 0 12px #ff4500, 0 0 16px #ffd700\",\n                \"0 0 10px #ff1493, 0 0 15px #dc143c, 0 0 20px #8b0000\",\n                \"0 0 9px #ff6600, 0 0 13px #ff3300, 0 0 17px #cc0000\",\n              ]\n            }}\n            transition={{\n              duration: 1.5,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n            className=\"font-black text-sm sm:text-base truncate text-orange-500\"\n          >\n            üî• {entry.user.displayName}\n          </motion.span>\n        );\n      case 'grandmaster':\n        return (\n          <motion.span\n            animate={{\n              textShadow: [\n                \"0 0 8px #e0e7ff, 0 0 12px #c7d2fe, 0 0 16px #a5b4fc\",\n                \"0 0 10px #f3f4f6, 0 0 15px #e5e7eb, 0 0 20px #d1d5db\",\n                \"0 0 9px #ddd6fe, 0 0 13px #c4b5fd, 0 0 17px #a78bfa\"\n              ]\n            }}\n            transition={{\n              duration: 2,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n            className=\"font-bold text-sm sm:text-base truncate text-indigo-400\"\n          >\n            üíé {entry.user.displayName}\n          </motion.span>\n        );\n      case 'champion':\n        return (\n          <motion.span\n            animate={{\n              textShadow: [\n                \"0 0 8px #8a2be2, 0 0 12px #4b0082, 0 0 16px #9932cc\",\n                \"0 0 10px #00bfff, 0 0 15px #1e90ff, 0 0 20px #4169e1\",\n                \"0 0 9px #ffd700, 0 0 13px #ffff00, 0 0 17px #ffa500\"\n              ]\n            }}\n            transition={{\n              duration: 2.5,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n            className=\"font-bold text-sm sm:text-base truncate text-purple-400\"\n          >\n            üëë {entry.user.displayName}\n          </motion.span>\n        );\n      case 'legend':\n        return (\n          <motion.span\n            animate={{\n              textShadow: [\n                \"0 0 6px #ff4500, 0 0 12px #ff6600, 0 0 18px #ff8800\",\n                \"0 0 8px #ff0000, 0 0 16px #ff3300, 0 0 24px #ff6600\",\n                \"0 0 7px #ff8800, 0 0 14px #ffaa00, 0 0 21px #ffcc00\"\n              ]\n            }}\n            transition={{\n              duration: 1.2,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n            className=\"font-bold text-sm sm:text-base truncate text-orange-400\"\n          >\n            üåü {entry.user.displayName}\n          </motion.span>\n        );\n      default:\n        return (\n          <span className=\"font-semibold text-sm sm:text-base truncate\">\n            {entry.user.displayName}\n          </span>\n        );\n    }\n  };\n\n  const defaultTrigger = (\n    <Button variant=\"outline\" size=\"sm\" className=\"flex items-center gap-2\" data-testid=\"button-leaderboard\">\n      <Trophy className=\"w-4 h-4\" />\n      {t('leaderboard') || 'Leaderboard'}\n    </Button>\n  );\n\n  return (\n    <Dialog open={modalOpen} onOpenChange={handleClose}>\n      <DialogTrigger asChild>\n        <div onClick={(e) => {\n          e.stopPropagation();\n          if (open !== undefined) {\n            // External control - don't use internal state\n            onClose?.();\n          } else {\n            setIsOpen(true);\n          }\n        }} data-testid=\"trigger-leaderboard\">\n          {trigger || defaultTrigger}\n        </div>\n      </DialogTrigger>\n      <DialogContent \n        className={`max-w-[98vw] sm:max-w-3xl md:max-w-4xl lg:max-w-5xl max-h-[90vh] w-full mx-auto flex flex-col overflow-hidden bg-gradient-to-br from-purple-100/95 via-blue-50/98 to-indigo-100/90 dark:from-slate-900/95 dark:via-purple-900/50 dark:to-indigo-900/95 backdrop-blur-md border border-purple-200/30 dark:border-purple-700/30 shadow-2xl ${isArabic ? 'font-arabic' : ''}`}\n        style={isArabic ? { \n          fontFamily: \"'Noto Sans Arabic', 'Cairo', 'Tajawal', system-ui, sans-serif\",\n          direction: 'rtl'\n        } : {}}\n        data-testid=\"dialog-leaderboard\"\n      >\n        <DialogHeader className=\"flex-shrink-0 pb-2 sm:pb-3 border-b bg-gradient-to-r from-transparent via-gray-200/50 to-transparent dark:via-gray-600/30 relative overflow-hidden\">\n          {/* Enhanced Background Effects */}\n          <div className=\"absolute inset-0 bg-gradient-to-br from-yellow-50/30 via-orange-50/20 to-red-50/30 dark:from-yellow-900/10 dark:via-orange-900/5 dark:to-red-900/10\"></div>\n          <div className=\"absolute top-0 left-1/2 transform -translate-x-1/2 w-full h-32 bg-gradient-to-b from-yellow-100/20 to-transparent dark:from-yellow-800/10 blur-3xl\"></div>\n          \n          <div className=\"text-center space-y-1 sm:space-y-2 relative z-10\">\n            <motion.div\n              initial={{ scale: 0.8, opacity: 0 }}\n              animate={{ scale: 1, opacity: 1 }}\n              transition={{ duration: 0.5, ease: \"easeOut\" }}\n            >\n              <DialogTitle className={`flex items-center justify-center gap-1 sm:gap-2 text-lg sm:text-xl md:text-2xl font-bold ${isArabic ? 'font-arabic' : ''}`}>\n                <motion.div\n                  animate={{ \n                    rotate: [0, 5, -5, 0],\n                    scale: [1, 1.1, 1]\n                  }}\n                  transition={{ \n                    duration: 3,\n                    repeat: Infinity,\n                    ease: \"easeInOut\"\n                  }}\n                >\n                  <Trophy className=\"w-5 h-5 sm:w-6 sm:h-6 md:w-7 md:h-7 text-yellow-500 drop-shadow-2xl filter brightness-110\" />\n                </motion.div>\n                <span className={`bg-gradient-to-r from-yellow-600 via-orange-500 to-red-500 bg-clip-text text-transparent drop-shadow-sm ${isArabic ? 'font-arabic' : ''}`}>\n                  {t('monthlyLeaderboard') || 'Monthly Leaderboard'}\n                </span>\n              </DialogTitle>\n            </motion.div>\n          </div>\n        </DialogHeader>\n\n        <div className=\"flex-1 min-h-0 flex flex-col overflow-hidden\">\n\n          {/* Compact Timer & Rewards */}\n          <div className=\"mb-2 bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 p-2 rounded border border-purple-200/50 dark:border-purple-700/30\">\n            <div className=\"text-center space-y-2\">\n              {/* Compact Timer */}\n              <div className=\"flex items-center justify-center gap-2 text-xs\">\n                <Clock className=\"w-3 h-3 text-orange-500\" />\n                <div className=\"flex gap-1 font-mono\" data-testid=\"countdown-timer\">\n                  <span className=\"bg-orange-100 dark:bg-orange-900/30 px-1 py-0.5 rounded text-orange-700 dark:text-orange-300\">{timeLeft.days}d</span>\n                  <span className=\"bg-orange-100 dark:bg-orange-900/30 px-1 py-0.5 rounded text-orange-700 dark:text-orange-300\">{timeLeft.hours}h</span>\n                  <span className=\"bg-orange-100 dark:bg-orange-900/30 px-1 py-0.5 rounded text-orange-700 dark:text-orange-300\">{timeLeft.minutes}m</span>\n                </div>\n              </div>\n              \n              {/* Compact Rewards */}\n              <div className=\"flex justify-center gap-1 text-xs\" data-testid=\"rewards-display\">\n                <div className=\"flex items-center gap-0.5 bg-yellow-100 dark:bg-yellow-900/30 px-1 py-0.5 rounded\">\n                  <Crown className=\"w-2.5 h-2.5 text-yellow-600\" />\n                  <span className=\"text-yellow-700 dark:text-yellow-300\">50k</span>\n                </div>\n                <div className=\"flex items-center gap-0.5 bg-gray-100 dark:bg-gray-800/50 px-1 py-0.5 rounded\">\n                  <Medal className=\"w-2.5 h-2.5 text-gray-600\" />\n                  <span className=\"text-gray-700 dark:text-gray-300\">30k</span>\n                </div>\n                <div className=\"flex items-center gap-0.5 bg-amber-100 dark:bg-amber-900/30 px-1 py-0.5 rounded\">\n                  <Award className=\"w-2.5 h-2.5 text-amber-600\" />\n                  <span className=\"text-amber-700 dark:text-amber-300\">10k</span>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {monthlyLoading ? (\n            <div className=\"flex items-center justify-center py-8 flex-1\" data-testid=\"loading-state\">\n              <Loader2 className=\"w-8 h-8 animate-spin\" />\n              <span className=\"ml-2\">{t('loadingMonthlyLeaderboard') || 'Loading monthly leaderboard...'}</span>\n            </div>\n          ) : monthlyError ? (\n            <div className=\"flex flex-col items-center justify-center py-8 flex-1 text-red-500\" data-testid=\"error-state\">\n              <span>{t('errorLoadingMonthlyLeaderboard') || 'Error loading monthly leaderboard. Please try again.'}</span>\n            </div>\n          ) : (\n            <div className=\"flex-1 min-h-0 overflow-y-auto px-1 sm:px-2 scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-gray-600 scrollbar-track-transparent\" style={{ WebkitOverflowScrolling: 'touch' }} data-testid=\"leaderboard-container\">\n              <div className=\"space-y-1 py-1\">\n                {monthlyLeaderboard && monthlyLeaderboard.length > 0 ? (\n                  monthlyLeaderboard.map((entry, index) => {\n                    const position = index + 1;\n                    const user = entry.user;\n                    \n                    return (\n                      <motion.div\n                        key={entry.id}\n                        initial={{ opacity: 0, y: 20 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        transition={{ delay: index * 0.05 }}\n                        data-testid={`player-card-${entry.id}`}\n                      >\n                        <motion.div\n                          whileHover={{ scale: 1.02, y: -2 }}\n                          transition={{ type: \"spring\", stiffness: 300, damping: 20 }}\n                        >\n                          <Card \n                            className={`relative cursor-pointer overflow-hidden ${\n                            position <= 3 ? 'border-2 shadow-xl' : 'border shadow-lg'} ${\n                            position === 1 ? 'border-yellow-400/60 bg-gradient-to-br from-yellow-50/90 via-amber-50/80 to-yellow-100/70 dark:from-yellow-900/30 dark:via-amber-900/25 dark:to-yellow-800/30 shadow-yellow-200/60 shadow-2xl' :\n                            position === 2 ? 'border-gray-400/50 bg-gradient-to-br from-gray-50/80 via-white to-gray-100/60 dark:from-gray-700/20 dark:via-slate-800 dark:to-gray-600/20 shadow-gray-200/40' :\n                            position === 3 ? 'border-amber-400/50 bg-gradient-to-br from-amber-50/80 via-white to-amber-100/60 dark:from-amber-900/20 dark:via-slate-800 dark:to-amber-800/20 shadow-amber-200/40' : \n                            'bg-gradient-to-br from-slate-50/90 via-white to-blue-50/40 dark:from-slate-800/90 dark:via-slate-750 dark:to-slate-700/90 border-gray-200/60 dark:border-gray-600/40 shadow-gray-100/60'\n                          } ${position === 1 ? 'ring-4 ring-yellow-300/50 shadow-yellow-300/40 shadow-2xl' : position <= 3 ? 'ring-2 ring-opacity-30 shadow-2xl ' + (position === 2 ? 'ring-gray-300/40' : 'ring-amber-300/40') : 'ring-1 ring-gray-200/30 dark:ring-gray-600/30'} backdrop-blur-sm ${position === 1 ? 'animate-pulse' : ''}`}\n                            onClick={() => {\n                              setSelectedPlayerId(user.id);\n                              setShowPlayerProfile(true);\n                            }}>\n                              <CardContent className={`${isArabic ? 'p-2 sm:p-3' : 'p-2 sm:p-3'} relative`}>\n                                {position === 1 && (\n                                  <>\n                                    {/* Golden Sparkles Animation for #1 */}\n                                    <motion.div \n                                      className=\"absolute top-1 left-1 w-2 h-2 bg-yellow-400 rounded-full opacity-70\"\n                                      animate={{ \n                                        scale: [0, 1, 0],\n                                        opacity: [0, 1, 0]\n                                      }}\n                                      transition={{ \n                                        duration: 2,\n                                        repeat: Infinity,\n                                        delay: 0\n                                      }}\n                                    />\n                                    <motion.div \n                                      className=\"absolute top-3 right-4 w-1.5 h-1.5 bg-amber-300 rounded-full opacity-60\"\n                                      animate={{ \n                                        scale: [0, 1, 0],\n                                        opacity: [0, 1, 0]\n                                      }}\n                                      transition={{ \n                                        duration: 2.5,\n                                        repeat: Infinity,\n                                        delay: 0.8\n                                      }}\n                                    />\n                                  </>\n                                )}\n                                \n                                <div className=\"flex items-center gap-3 mb-3\">\n                                  {/* Rank Icon/Number */}\n                                  <div className=\"flex-shrink-0 relative\">\n                                    {getRankIcon(position)}\n                                  </div>\n                                  \n                                  {/* Avatar with achievement border styling */}\n                                  {(() => {\n                                    const borderStyle = getAchievementBorderStyle(entry, position);\n                                    return (\n                                      <div className={`relative group ${borderStyle.animation}`}>\n                                        <div \n                                          className={`w-12 h-12 rounded-full ${borderStyle.borderClass} ${borderStyle.glowEffect} transition-all duration-300 group-hover:scale-105 overflow-hidden bg-gradient-to-br from-white to-gray-100 dark:from-gray-700 dark:to-gray-800 flex items-center justify-center font-bold text-lg`}\n                                          style={{\n                                            backgroundImage: user.profileImageUrl ? `url(${user.profileImageUrl})` : undefined,\n                                            backgroundSize: 'cover',\n                                            backgroundPosition: 'center'\n                                          }}\n                                          data-testid={`avatar-${user.id}`}\n                                        >\n                                          {!user.profileImageUrl && (\n                                            <span className=\"text-gray-600 dark:text-gray-300 text-base\">\n                                              {user.displayName?.charAt(0)?.toUpperCase() || '?'}\n                                            </span>\n                                          )}\n                                        </div>\n                                        \n                                        {/* Subtle Rank position indicator for top 3 */}\n                                        {position <= 3 && (\n                                          <motion.div \n                                            className={`absolute -top-0.5 -right-0.5 w-5 h-5 rounded-full border border-white dark:border-gray-900 flex items-center justify-center text-xs font-bold bg-gradient-to-br ${getRankColor(position)} shadow-lg z-30`}\n                                            animate={{ \n                                              scale: position === 1 ? [1, 1.1, 1] : 1,\n                                            }}\n                                            transition={{ \n                                              duration: 2,\n                                              repeat: position === 1 ? Infinity : 0,\n                                              ease: \"easeInOut\"\n                                            }}\n                                            data-testid={`rank-badge-${position}`}\n                                            style={{\n                                              filter: 'drop-shadow(0 2px 4px rgba(0,0,0,0.2))'\n                                            }}\n                                          >\n                                            <span className=\"text-white drop-shadow-sm font-bold text-xs\">{position}</span>\n                                          </motion.div>\n                                        )}\n                                      </div>\n                                    );\n                                  })()}\n                                  \n                                  {/* Player Info */}\n                                  <div className=\"flex-1 min-w-0\">\n                                    <div data-testid={`player-name-${user.id}`}>\n                                      {renderAchievementBorder(entry, position)}\n                                    </div>\n                                  </div>\n                                  \n                                  {/* Monthly Wins Display */}\n                                  <div className=\"text-right\" data-testid={`wins-${user.id}`}>\n                                    <div className=\"text-lg font-bold text-green-600 dark:text-green-400\">\n                                      {entry.monthlyWins}\n                                    </div>\n                                    <div className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                      monthly wins\n                                    </div>\n                                  </div>\n                                </div>\n                              </CardContent>\n                            </Card>\n                          </motion.div>\n                        </motion.div>\n                      );\n                    })\n                  ) : (\n                    <div className=\"text-center py-8 text-gray-500\" data-testid=\"no-data-state\">\n                      <Calendar className=\"w-16 h-16 mx-auto mb-4 opacity-50\" />\n                      <p>{t('noMonthlyDataYet') || 'No monthly data yet. Start playing to compete!'}</p>\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n          </div>\n\n        <div className=\"flex justify-between items-center pt-1 pb-1 sm:pt-1.5 sm:pb-1.5 border-t border-gradient-to-r from-transparent via-gray-200 to-transparent dark:via-gray-700 flex-shrink-0 bg-gradient-to-r from-slate-50 via-white to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900\">\n          <div className={`flex items-center gap-2 ${isArabic ? 'font-arabic' : ''}`}>\n            <div className=\"w-2 h-2 bg-green-400 rounded-full animate-pulse\"></div>\n            <span className=\"text-xs font-medium text-gray-600 dark:text-gray-400\" data-testid=\"player-count\">\n              {monthlyLeaderboard?.length ? \n                `${t('showing') || 'Showing'} ${monthlyLeaderboard.length} ${t('players') || 'players'}` :\n                ''\n              }\n            </span>\n          </div>\n          <Button \n            onClick={handleClose} \n            variant=\"default\" \n            className={`bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white border-0 shadow-lg px-2 sm:px-3 text-xs ${isArabic ? 'font-arabic' : ''}`}\n            data-testid=\"button-close\"\n          >\n            {t('close') || 'Close'}\n          </Button>\n        </div>\n      </DialogContent>\n\n      {/* Player Profile Modal */}\n      <PlayerProfileModal\n        playerId={selectedPlayerId}\n        open={showPlayerProfile}\n        onClose={() => {\n          setShowPlayerProfile(false);\n          setSelectedPlayerId(null);\n        }}\n        currentUserId={undefined} // TODO: Get current user ID from context\n      />\n    </Dialog>\n  );\n}","size_bytes":29195},"client/src/components/LevelUpModal.tsx":{"content":"import { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Trophy, Star, Sparkles } from \"lucide-react\";\nimport { useTranslation } from \"@/contexts/LanguageContext\";\nimport { motion } from \"framer-motion\";\n\ninterface LevelUpModalProps {\n  open: boolean;\n  onClose: () => void;\n  userDisplayName: string;\n  newLevel: number;\n  previousLevel: number;\n  userProfilePicture?: string;\n}\n\nexport function LevelUpModal({ open, onClose, userDisplayName, newLevel, previousLevel, userProfilePicture }: LevelUpModalProps) {\n  const { t } = useTranslation();\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"sm:max-w-md bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 border-2 border-yellow-400 text-white overflow-hidden\">\n        {/* Background sparkles animation */}\n        <div className=\"absolute inset-0 overflow-hidden\">\n          {[...Array(20)].map((_, i) => (\n            <motion.div\n              key={i}\n              className=\"absolute w-2 h-2 bg-yellow-300 rounded-full opacity-70\"\n              initial={{ \n                x: Math.random() * 400,\n                y: Math.random() * 300,\n                opacity: 0,\n                scale: 0\n              }}\n              animate={{ \n                opacity: [0, 1, 0],\n                scale: [0, 1, 0],\n                rotate: 360\n              }}\n              transition={{\n                duration: 2,\n                delay: Math.random() * 2,\n                repeat: Infinity,\n                repeatDelay: Math.random() * 3\n              }}\n            >\n              <Star className=\"w-2 h-2\" />\n            </motion.div>\n          ))}\n        </div>\n\n        <DialogHeader className=\"relative z-10 text-center space-y-4\">\n          {/* Trophy Animation */}\n          <motion.div\n            className=\"flex justify-center\"\n            initial={{ scale: 0, rotate: -180 }}\n            animate={{ scale: 1, rotate: 0 }}\n            transition={{ duration: 0.8, type: \"spring\", bounce: 0.6 }}\n          >\n            <div className=\"relative\">\n              <Trophy className=\"w-20 h-20 text-yellow-400\" />\n              <motion.div\n                className=\"absolute -inset-2 rounded-full border-2 border-yellow-400\"\n                animate={{ \n                  scale: [1, 1.2, 1],\n                  opacity: [0.8, 0.4, 0.8]\n                }}\n                transition={{ \n                  duration: 2,\n                  repeat: Infinity\n                }}\n              />\n            </div>\n          </motion.div>\n\n          {/* Congratulations Title */}\n          <motion.div\n            initial={{ opacity: 0, y: -20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.3, duration: 0.6 }}\n          >\n            <DialogTitle className=\"text-3xl font-bold text-yellow-400 mb-2\">\n              üéâ {t('congratulations')}! üéâ\n            </DialogTitle>\n          </motion.div>\n\n          {/* User Info */}\n          <motion.div\n            initial={{ opacity: 0, scale: 0.8 }}\n            animate={{ opacity: 1, scale: 1 }}\n            transition={{ delay: 0.5, duration: 0.5 }}\n            className=\"space-y-3\"\n          >\n            {/* Profile Picture */}\n            {userProfilePicture && (\n              <div className=\"flex justify-center\">\n                <motion.div\n                  className=\"relative\"\n                  initial={{ scale: 0, rotate: -90 }}\n                  animate={{ scale: 1, rotate: 0 }}\n                  transition={{ delay: 0.6, duration: 0.5, type: \"spring\" }}\n                >\n                  <img\n                    src={userProfilePicture}\n                    alt={userDisplayName}\n                    className=\"w-16 h-16 rounded-full border-4 border-yellow-400 shadow-lg object-cover\"\n                  />\n                  <motion.div\n                    className=\"absolute -inset-1 rounded-full border-2 border-yellow-300\"\n                    animate={{ \n                      scale: [1, 1.1, 1],\n                      opacity: [0.6, 0.3, 0.6]\n                    }}\n                    transition={{ \n                      duration: 2,\n                      repeat: Infinity\n                    }}\n                  />\n                </motion.div>\n              </div>\n            )}\n            \n            <div className=\"text-xl font-semibold text-white\">\n              {userDisplayName}\n            </div>\n            \n            {/* Level Up Text */}\n            <div className=\"text-lg text-blue-200\">\n              {t('youHaveReachedLevel')} {previousLevel} ‚Üí \n              <motion.span\n                className=\"text-2xl font-bold text-yellow-400 ml-2\"\n                initial={{ scale: 1 }}\n                animate={{ scale: [1, 1.3, 1] }}\n                transition={{ \n                  delay: 0.8,\n                  duration: 0.6,\n                  repeat: 2\n                }}\n              >\n                {newLevel}\n              </motion.span>\n            </div>\n          </motion.div>\n\n          {/* Level Badge Animation */}\n          <motion.div\n            className=\"flex justify-center items-center space-x-4\"\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.7, duration: 0.6 }}\n          >\n            <div className=\"relative\">\n              <motion.div\n                className=\"w-24 h-24 bg-gradient-to-r from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center shadow-lg border-4 border-yellow-300\"\n                animate={{ \n                  boxShadow: [\n                    \"0 0 20px rgba(250, 204, 21, 0.5)\",\n                    \"0 0 40px rgba(250, 204, 21, 0.8)\",\n                    \"0 0 20px rgba(250, 204, 21, 0.5)\"\n                  ]\n                }}\n                transition={{ \n                  duration: 2,\n                  repeat: Infinity\n                }}\n              >\n                <span className=\"text-2xl font-bold text-purple-900\">\n                  {newLevel}\n                </span>\n              </motion.div>\n              \n              {/* Sparkles around the badge */}\n              <motion.div\n                className=\"absolute -top-2 -right-2\"\n                animate={{ rotate: 360 }}\n                transition={{ duration: 3, repeat: Infinity, ease: \"linear\" }}\n              >\n                <Sparkles className=\"w-6 h-6 text-yellow-300\" />\n              </motion.div>\n            </div>\n          </motion.div>\n\n          {/* Motivational Text */}\n          <motion.div\n            className=\"text-center text-blue-200 text-sm space-y-1\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            transition={{ delay: 1, duration: 0.6 }}\n          >\n            <div>{t('keepUpTheGreatWork')}</div>\n            <div className=\"text-yellow-300 font-semibold\">\n              {t('yourSkillsAreImproving')}\n            </div>\n          </motion.div>\n\n          {/* Continue Button */}\n          <motion.div\n            className=\"pt-4\"\n            initial={{ opacity: 0, scale: 0.8 }}\n            animate={{ opacity: 1, scale: 1 }}\n            transition={{ delay: 1.2, duration: 0.5 }}\n          >\n            <Button\n              onClick={onClose}\n              className=\"bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-purple-900 font-bold px-8 py-2 transform hover:scale-105 transition-all duration-200\"\n            >\n              <Trophy className=\"w-4 h-4 mr-2\" />\n              {t('continue')}\n            </Button>\n          </motion.div>\n        </DialogHeader>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":7766},"client/src/components/LoadingScreen.tsx":{"content":"import { GamepadIcon } from \"lucide-react\";\n\nexport default function LoadingScreen() {\n\n  return (\n    <div className=\"fixed inset-0 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center z-50\">\n      {/* Background animated particles */}\n      <div className=\"absolute inset-0 overflow-hidden\">\n        <div className=\"absolute -top-40 -right-40 w-80 h-80 bg-primary/10 rounded-full blur-3xl animate-pulse\"></div>\n        <div className=\"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500/10 rounded-full blur-3xl animate-pulse animation-delay-1000\"></div>\n        <div className=\"absolute top-1/3 left-1/4 w-60 h-60 bg-purple-500/5 rounded-full blur-3xl animate-pulse animation-delay-2000\"></div>\n      </div>\n\n      {/* Main content */}\n      <div className=\"relative flex flex-col items-center justify-center space-y-8\">\n        {/* Game logo with animations */}\n        <div className=\"relative\">\n          {/* Outer rotating ring */}\n          <div className=\"absolute inset-0 w-32 h-32 border-4 border-primary/30 rounded-full animate-spin\"></div>\n          \n          {/* Middle pulsing ring */}\n          <div className=\"absolute inset-2 w-28 h-28 border-2 border-blue-400/40 rounded-full animate-pulse\"></div>\n          \n          {/* Logo container */}\n          <div className=\"relative w-32 h-32 bg-gradient-to-br from-primary to-blue-600 rounded-full flex items-center justify-center shadow-2xl transform hover:scale-105 transition-transform duration-300\">\n            {/* Inner glow effect */}\n            <div className=\"absolute inset-2 bg-gradient-to-br from-white/20 to-transparent rounded-full\"></div>\n            \n            {/* Game icon */}\n            <GamepadIcon className=\"w-16 h-16 text-white drop-shadow-lg animate-pulse\" />\n          </div>\n\n          {/* Sparkle effects */}\n          <div className=\"absolute -top-2 -right-2 w-4 h-4 bg-yellow-400 rounded-full animate-ping\"></div>\n          <div className=\"absolute -bottom-2 -left-2 w-3 h-3 bg-blue-400 rounded-full animate-ping animation-delay-500\"></div>\n          <div className=\"absolute top-4 -left-4 w-2 h-2 bg-purple-400 rounded-full animate-ping animation-delay-1000\"></div>\n        </div>\n\n        {/* Game title */}\n        <div className=\"text-center space-y-2\">\n          <h1 className=\"text-4xl font-bold text-white tracking-wide animate-fade-in\">\n            TicTac 3x5\n          </h1>\n          <p className=\"text-slate-300 text-lg animate-fade-in animation-delay-500\">\n            Strategic Tic-Tac-Toe Experience\n          </p>\n        </div>\n\n        {/* Loading dots */}\n        <div className=\"flex space-x-2\">\n          <div className=\"w-3 h-3 bg-primary rounded-full animate-bounce\"></div>\n          <div className=\"w-3 h-3 bg-primary rounded-full animate-bounce animation-delay-200\"></div>\n          <div className=\"w-3 h-3 bg-primary rounded-full animate-bounce animation-delay-400\"></div>\n        </div>\n\n        {/* Loading text */}\n        <p className=\"text-slate-400 text-sm animate-pulse\">\n          Loading your gaming experience...\n        </p>\n\n        {/* Made by text */}\n        <p className=\"text-slate-300 text-sm font-semibold animate-fade-in animation-delay-1000 mt-4 bg-gradient-to-r from-primary to-blue-400 bg-clip-text text-transparent\">\n          Made By DarkLayer Studios\n        </p>\n      </div>\n    </div>\n  );\n}","size_bytes":3382},"client/src/components/MatchmakingModal.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport { Loader2, Users, X, Zap } from \"lucide-react\";\nimport { useTranslation } from \"@/contexts/LanguageContext\";\nimport { useWebSocket } from \"@/hooks/useWebSocket\";\nimport { useOnlineStatus } from \"@/hooks/useOnlineStatus\";\nimport { ErrorModal } from \"./ErrorModal\";\n\ninterface MatchmakingModalProps {\n  open: boolean;\n  onClose: () => void;\n  onMatchFound: (room: any) => void;\n  user: any;\n  isWebSocketConnected?: boolean;\n  refreshWebSocketConnection?: () => void;\n}\n\nexport function MatchmakingModal({ open, onClose, onMatchFound, user, isWebSocketConnected = true, refreshWebSocketConnection }: MatchmakingModalProps) {\n  const { t } = useTranslation();\n  const [isSearching, setIsSearching] = useState(false);\n  const [searchTime, setSearchTime] = useState(0);\n  const [queuePosition, setQueuePosition] = useState(0);\n  const [searchStartTime, setSearchStartTime] = useState<number | null>(null);\n  const [isWebSocketHandlingEnabled, setIsWebSocketHandlingEnabled] = useState(false);\n  const [errorModal, setErrorModal] = useState<{open: boolean, title: string, message: string, type?: 'error' | 'coins' | 'warning'}>({\n    open: false,\n    title: '',\n    message: '',\n    type: 'error'\n  });\n  const { toast } = useToast();\n  const { lastMessage } = useWebSocket();\n  const { isOnline } = useOnlineStatus();\n\n  useEffect(() => {\n    let interval: NodeJS.Timeout;\n    if (isSearching) {\n      //console.log('üéÆ MatchmakingModal: Starting timer');\n      interval = setInterval(() => {\n        setSearchTime(prev => {\n          const newTime = prev + 1;\n          //console.log('üéÆ MatchmakingModal: Timer tick:', newTime);\n          return newTime;\n        });\n      }, 1000);\n    } else {\n      // Stopping timer\n    }\n    return () => {\n      if (interval) {\n        //console.log('üéÆ MatchmakingModal: Cleaning up timer');\n        clearInterval(interval);\n      }\n    };\n  }, [isSearching]);\n\n  // Reset timer when modal opens to prevent double counting\n  useEffect(() => {\n    if (open) {\n      //console.log('üéÆ MatchmakingModal: Modal opened, resetting timer');\n      setSearchTime(0);\n    }\n  }, [open]);\n\n  // Simplified: No complex WebSocket handling states needed\n\n  // AGGRESSIVE: Listen for ANY matchmaking message and close modal immediately\n  useEffect(() => {\n    if (lastMessage) {\n      // Handle WebSocket messages\n      \n      // CRITICAL FIX: Process game_started messages even if modal shows as closed\n      if (lastMessage) {\n        // SIMPLIFIED: Only listen for essential matchmaking messages\n        const isMatchmakingSuccess = ['matchmaking_success', 'game_started'].includes(lastMessage.type);\n        \n        if (isMatchmakingSuccess) {\n          //console.log('üéÆ MatchmakingModal: CRITICAL FIX - Received matchmaking message:', lastMessage.type);\n          //console.log('üéÆ MatchmakingModal: Current state:', { open, isSearching });\n          \n          // Special handling for game_started - always close modal regardless of state\n          if (lastMessage.type === 'game_started') {\n            // Game started - force closing modal\n            setIsSearching(false);\n            setSearchTime(0);\n            setQueuePosition(0);\n            onClose();\n            return; // Exit early for game_started\n          }\n          \n          // For other matchmaking messages, only process if modal is open\n          if (open) {\n            // FORCE stop all searching states\n            setIsSearching(false);\n            setSearchTime(0);\n            setQueuePosition(0);\n            \n            // Always call onMatchFound if room data is available\n            if (lastMessage.room) {\n              //console.log('üéÆ MatchmakingModal: FORCE - Calling onMatchFound with room data');\n              onMatchFound(lastMessage.room);\n            }\n            \n            // FORCE close the modal\n            //console.log('üéÆ MatchmakingModal: FORCE - Calling onClose to force modal closure');\n            onClose();\n          }\n        }\n      }\n    }\n  }, [lastMessage, open, isSearching, onClose, onMatchFound]);\n\n  // CRITICAL FIX: Always listen for matchmaking events regardless of modal state\n  useEffect(() => {\n    const handleGlobalMatchmaking = (event: CustomEvent) => {\n      const message = event.detail;\n      console.log('üéÆ MatchmakingModal: Received matchmaking message:', message.type, 'Modal open:', open);\n      \n      // Handle matchmaking messages regardless of modal open state\n      if (['match_found', 'matchmaking_success', 'game_started'].includes(message.type)) {\n        console.log('üéÆ MatchmakingModal: Processing critical matchmaking message:', message.type);\n        \n        // Reset modal state immediately\n        setIsSearching(false);\n        setSearchTime(0);\n        setQueuePosition(0);\n        setSearchStartTime(null);\n        setIsWebSocketHandlingEnabled(false);\n        \n        if (message.type === 'match_found' || message.type === 'matchmaking_success') {\n          if (message.room) {\n            console.log('üéÆ MatchmakingModal: Match found! Room data:', message.room);\n            \n            // CRITICAL FIX: Force a brief delay to ensure UI state is ready before calling onMatchFound\n            // This fixes the issue where the second player gets auto-connected without proper UI refresh\n            setTimeout(() => {\n              console.log('üéÆ MatchmakingModal: Calling onMatchFound with room data');\n              onMatchFound(message.room);\n              onClose();\n            }, 100); // Small delay to ensure proper state synchronization\n          }\n        }\n        \n        if (message.type === 'game_started') {\n          console.log('üéÆ MatchmakingModal: Game started - ensuring modal is closed');\n          onClose();\n        }\n      }\n    };\n\n    const handleForceClose = (event: CustomEvent) => {\n      // Emergency force close triggered\n      setIsSearching(false);\n      setSearchTime(0);\n      setQueuePosition(0);\n      setSearchStartTime(null);\n      setIsWebSocketHandlingEnabled(false);\n      onClose();\n    };\n\n    window.addEventListener('matchmaking_message_received', handleGlobalMatchmaking as EventListener);\n    window.addEventListener('force_close_matchmaking', handleForceClose as EventListener);\n    \n    return () => {\n      window.removeEventListener('matchmaking_message_received', handleGlobalMatchmaking as EventListener);\n      window.removeEventListener('force_close_matchmaking', handleForceClose as EventListener);\n    };\n  }, [onClose, onMatchFound]); // Listen regardless of modal open state\n\n  // WebSocket message handling is now managed by parent component (home.tsx) to prevent conflicts\n\n  const joinMatchmakingMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest('/api/matchmaking/join', { method: 'POST', body: {} });\n      return response.json();\n    },\n    onSuccess: (data) => {\n      if (data.status === 'matched') {\n        setIsSearching(false);\n        // Parent component handles WebSocket messages and room joining\n        // No need for onClose() here as parent will handle it\n        toast({\n          title: t('matchFound'),\n          description: t('matchedWithOpponent'),\n        });\n      } else if (data.status === 'waiting') {\n        setIsSearching(true);\n        setQueuePosition(1);\n        toast({\n          title: t('searchingForOpponent'),\n          description: t('lookingForPlayer'),\n        });\n      }\n    },\n    onError: (error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: t('unauthorized'),\n          description: t('loggedOutLoggingIn'),\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      \n      console.error('üö® Matchmaking error:', error);\n      \n      // Handle specific error types with appropriate styling and messages\n      let toastTitle = t('error');\n      let errorMessage = error.message;\n      let variant: \"destructive\" | \"default\" = \"destructive\";\n      \n      // Check for insufficient coins error and show modal instead of toast\n      if (error.status === 403 && error.message?.includes('coins')) {\n        setErrorModal({\n          open: true,\n          title: 'Insufficient Coins',\n          message: error.message || 'You need 100 coins to play online. Win AI games to earn coins!',\n          type: 'coins'\n        });\n      } else if (error.message.includes('room') || error.message.includes('connection')) {\n        setErrorModal({\n          open: true,\n          title: 'Connection Error',\n          message: 'Connection issue. Please try again.',\n          type: 'error'\n        });\n      } else if (error.message.includes('queue')) {\n        setErrorModal({\n          open: true,\n          title: 'Matchmaking Error',\n          message: 'Matchmaking queue error. Please try again.',\n          type: 'error'\n        });\n      } else {\n        setErrorModal({\n          open: true,\n          title: 'Error',\n          message: errorMessage,\n          type: 'error'\n        });\n      }\n      setIsSearching(false);\n      \n      // Reset modal state on error\n      setSearchTime(0);\n      setQueuePosition(0);\n      setSearchStartTime(null);\n      setIsWebSocketHandlingEnabled(false);\n    },\n  });\n\n  const leaveMatchmakingMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest('/api/matchmaking/leave', { method: 'POST', body: {} });\n      return response.json();\n    },\n    onSuccess: () => {\n      setIsSearching(false);\n      setSearchTime(0);\n      setQueuePosition(0);\n      toast({\n        title: t('leftQueue'),\n        description: t('leftMatchmakingQueue'),\n      });\n    },\n    onError: (error) => {\n      toast({\n        title: t('error'),\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleStartSearch = async () => {\n    console.log('üéÆ MatchmakingModal: Pre-matchmaking connection validation');\n    \n    // CRITICAL FIX: Always test WebSocket connectivity with ping before matchmaking\n    if (!isWebSocketConnected) {\n      console.log('üö´ WebSocket not connected, attempting to refresh connection...');\n      toast({\n        title: 'Connection Issue',\n        description: 'Refreshing connection, please wait...',\n        variant: \"default\",\n      });\n      \n      // Call refresh function if available\n      if (refreshWebSocketConnection) {\n        refreshWebSocketConnection();\n      }\n      \n      // Give some time for connection refresh\n      setTimeout(() => {\n        console.log('üéÆ MatchmakingModal: Retrying matchmaking after connection refresh');\n        setSearchTime(0);\n        setQueuePosition(0);\n        setSearchStartTime(Date.now());\n        joinMatchmakingMutation.mutate();\n      }, 3000);\n      \n      return;\n    }\n    \n    // Test WebSocket with ping before matchmaking - CRITICAL for idle connections\n    //console.log('üèì Testing WebSocket connectivity with ping...');\n    \n    // Create a promise to wait for pong response\n    const testConnectivity = new Promise((resolve, reject) => {\n      const timeout = setTimeout(() => {\n        reject(new Error('Connection test timeout'));\n      }, 5000);\n      \n      // Listen for pong response\n      const handlePongResponse = (event: CustomEvent) => {\n        if (event.detail.type === 'pong') {\n          //console.log('üèì Pong received - WebSocket is active');\n          clearTimeout(timeout);\n          window.removeEventListener('websocket_pong_received', handlePongResponse as EventListener);\n          resolve(true);\n        }\n      };\n      \n      window.addEventListener('websocket_pong_received', handlePongResponse as EventListener);\n      \n      // Send ping through global WebSocket\n      const pingEvent = new CustomEvent('send_websocket_ping', {\n        detail: { type: 'ping', timestamp: Date.now() }\n      });\n      window.dispatchEvent(pingEvent);\n    });\n    \n    try {\n      await testConnectivity;\n      //console.log('üéÆ MatchmakingModal: WebSocket connectivity confirmed, starting matchmaking');\n      setSearchTime(0);\n      setQueuePosition(0);\n      setSearchStartTime(Date.now());\n      joinMatchmakingMutation.mutate();\n    } catch (error) {\n      console.error('üö´ WebSocket connectivity test failed:', error);\n      toast({\n        title: 'Quick Match',\n        description: 'We are preparing your room, please wait..',\n        variant: \"destructive\",\n      });\n      \n      // Attempt connection refresh as fallback\n      if (refreshWebSocketConnection) {\n        refreshWebSocketConnection();\n        setTimeout(() => {\n          setSearchTime(0);\n          setQueuePosition(0);\n          setSearchStartTime(Date.now());\n          joinMatchmakingMutation.mutate();\n        }, 3000);\n      }\n    }\n  };\n\n  const handleCancelSearch = () => {\n    setSearchStartTime(null); // Clear search start time\n    setIsWebSocketHandlingEnabled(false); // Disable WebSocket handling\n    leaveMatchmakingMutation.mutate();\n  };\n\n  const handleClose = () => {\n    if (isSearching) {\n      handleCancelSearch();\n    } else {\n      setSearchStartTime(null); // Clear search start time on close\n      setIsWebSocketHandlingEnabled(false); // Disable WebSocket handling\n    }\n    onClose();\n  };\n\n  // Listen for matchmaking state changes from parent\n  useEffect(() => {\n    if (!open && isSearching) {\n      // Modal was closed externally (by parent), reset searching state\n      //console.log('üéÆ MatchmakingModal: Modal closed externally while searching, resetting state');\n      setIsSearching(false);\n      setSearchTime(0);\n      setQueuePosition(0);\n      setSearchStartTime(null);\n      setIsWebSocketHandlingEnabled(false);\n    }\n  }, [open, isSearching]);\n\n  // Reset search state when modal opens fresh\n  useEffect(() => {\n    if (open && !isSearching) {\n      setSearchStartTime(null);\n      setSearchTime(0);\n      setQueuePosition(0);\n    }\n  }, [open, isSearching]);\n\n  // Search timer and emergency timeout\n  useEffect(() => {\n    let timer: NodeJS.Timeout;\n    let emergencyTimeout: NodeJS.Timeout;\n    \n    if (isSearching) {\n      // Regular search timer\n      timer = setInterval(() => {\n        setSearchTime(prev => prev + 1);\n      }, 1000);\n      \n      // Emergency timeout to force close modal after 60 seconds\n      emergencyTimeout = setTimeout(() => {\n        if (isSearching) {\n          //console.log('üö® MatchmakingModal: Emergency timeout - forcing modal closure after 60 seconds');\n          setIsSearching(false);\n          setSearchTime(0);\n          setQueuePosition(0);\n          setSearchStartTime(null);\n          setIsWebSocketHandlingEnabled(false);\n          onClose();\n        }\n      }, 60000);\n    }\n    \n    return () => {\n      clearInterval(timer);\n      clearTimeout(emergencyTimeout);\n    };\n  }, [isSearching, onClose]);\n\n  const formatTime = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  return (\n    <>\n    <Dialog open={open} onOpenChange={handleClose}>\n      <DialogContent className=\"sm:max-w-md\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Zap className=\"h-5 w-5 text-yellow-500\" />\n            {t('quickMatch')}\n          </DialogTitle>\n        </DialogHeader>\n        \n        <div className=\"space-y-4\">\n          {!isSearching && !joinMatchmakingMutation.isPending ? (\n            <div className=\"text-center space-y-4\">\n              <div className=\"p-6 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-lg\">\n                <Users className=\"h-12 w-12 mx-auto text-blue-500 mb-3\" />\n                <h3 className=\"font-semibold text-lg mb-2\">{t('readyToPlay')}</h3>\n                <p className=\"text-sm text-gray-600 dark:text-gray-300\">\n                  {t('findAnotherPlayerCompete')}\n                </p>\n              </div>\n              \n              <Card>\n                <CardContent className=\"p-4\">\n                  <div className=\"text-center space-y-2\">\n                    <div className=\"flex items-center justify-center gap-2 text-sm\">\n                      <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\n                      <span>{t('onlinePlayersLookingForMatches')}</span>\n                    </div>\n                    <div className=\"text-xs text-gray-500\">\n                      {t('averageMatchTime')}\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Button \n                onClick={handleStartSearch}\n                className=\"w-full\"\n                size=\"lg\"\n              >\n                <Zap className=\"h-4 w-4 mr-2\" />\n                {t('findMatch')}\n              </Button>\n            </div>\n          ) : (\n            <div className=\"text-center space-y-4\">\n              <div className=\"p-6 bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 rounded-lg\">\n                <div className=\"flex items-center justify-center mb-4\">\n                  <Loader2 className=\"h-8 w-8 text-yellow-500 animate-spin\" />\n                </div>\n                <h3 className=\"font-semibold text-lg mb-2\">{t('searchingForOpponent')}</h3>\n                <p className=\"text-sm text-gray-600 dark:text-gray-300\">\n                  {t('lookingForPlayer')}\n                </p>\n              </div>\n              \n              <Card>\n                <CardContent className=\"p-4\">\n                  <div className=\"space-y-3\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-sm font-medium\">{t('searchTime')}</span>\n                      <span className=\"text-sm text-blue-600 dark:text-blue-400 font-mono\">\n                        {formatTime(searchTime)}\n                      </span>\n                    </div>\n                    \n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-sm font-medium\">{t('status')}</span>\n                      <div className=\"flex items-center gap-1\">\n                        <div className=\"w-2 h-2 bg-yellow-500 rounded-full animate-pulse\"></div>\n                        <span className=\"text-sm text-yellow-600 dark:text-yellow-400\">\n                          {t('searching')}\n                        </span>\n                      </div>\n                    </div>\n                    \n                    <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2\">\n                      <div \n                        className={`h-2 rounded-full transition-all duration-1000 ${\n                          searchTime >= 25 ? 'bg-gradient-to-r from-orange-500 to-red-500' : 'bg-gradient-to-r from-blue-500 to-purple-500'\n                        }`}\n                        style={{ width: `${Math.min((searchTime / 25) * 100, 100)}%` }}\n                      ></div>\n                    </div>\n                    \n                    <div className=\"text-xs text-center\">\n                      {searchTime < 10 ? (\n                        <span className=\"text-gray-500\">{t('findingPerfectOpponent')}</span>\n                      ) : searchTime < 20 ? (\n                        <span className=\"text-gray-500\">{t('expandingSearch')}</span>\n                      ) : searchTime < 25 ? (\n                        <span className=\"text-gray-500\">{t('expandingSearch')}</span>\n                      ) : (\n                        <span className=\"text-blue-500 font-medium\">{t('findingPerfectOpponent')}</span>\n                      )}\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Button \n                onClick={handleCancelSearch}\n                variant=\"outline\"\n                className=\"w-full\"\n                disabled={leaveMatchmakingMutation.isPending}\n              >\n                <X className=\"h-4 w-4 mr-2\" />\n                {t('cancel')}\n              </Button>\n            </div>\n          )}\n        </div>\n      </DialogContent>\n    </Dialog>\n    \n    <ErrorModal\n      open={errorModal.open}\n      onClose={() => setErrorModal(prev => ({ ...prev, open: false }))}\n      title={errorModal.title}\n      message={errorModal.message}\n      type={errorModal.type}\n    />\n  </>\n  );\n}","size_bytes":20989},"client/src/components/MoveTimer.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Clock } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\ninterface MoveTimerProps {\n  isPlayerTurn: boolean;\n  currentPlayer: 'X' | 'O';\n  onTimeout?: () => void;\n  gameStatus?: string;\n  resetKey?: string; // Add reset key to force timer reset\n}\n\nexport function MoveTimer({ isPlayerTurn, currentPlayer, onTimeout, gameStatus, resetKey }: MoveTimerProps) {\n  const [timeRemaining, setTimeRemaining] = useState(30);\n  const [isActive, setIsActive] = useState(false);\n\n  // Reset timer when it becomes player's turn or current player changes\n  useEffect(() => {\n    if (isPlayerTurn && gameStatus === 'active') {\n      setTimeRemaining(30);\n      setIsActive(true);\n    } else {\n      setIsActive(false);\n    }\n  }, [isPlayerTurn, currentPlayer, gameStatus, resetKey]);\n\n  // Timer countdown effect\n  useEffect(() => {\n    let interval: NodeJS.Timeout | null = null;\n    \n    if (isActive && timeRemaining > 0 && gameStatus === 'active') {\n      interval = setInterval(() => {\n        setTimeRemaining(prev => {\n          const newTime = prev - 1;\n          if (newTime <= 0) {\n            setIsActive(false);\n            onTimeout?.();\n            return 0;\n          }\n          return newTime;\n        });\n      }, 1000);\n    }\n\n    return () => {\n      if (interval) {\n        clearInterval(interval);\n      }\n    };\n  }, [isActive, timeRemaining, onTimeout, gameStatus]);\n\n  // Don't show timer if game is not active or it's not the player's turn\n  if (!isPlayerTurn || gameStatus !== 'active' || !isActive) {\n    return null;\n  }\n\n  const getTimerColor = () => {\n    if (timeRemaining > 20) return 'text-green-500';\n    if (timeRemaining > 10) return 'text-yellow-500';\n    if (timeRemaining > 5) return 'text-orange-500';\n    return 'text-red-500';\n  };\n\n  const getProgressColor = () => {\n    if (timeRemaining > 20) return 'bg-green-500';\n    if (timeRemaining > 10) return 'bg-yellow-500';\n    if (timeRemaining > 5) return 'bg-orange-500';\n    return 'bg-red-500';\n  };\n\n  const progressPercentage = (timeRemaining / 30) * 100;\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, scale: 0.9 }}\n      animate={{ opacity: 1, scale: 1 }}\n      exit={{ opacity: 0, scale: 0.9 }}\n      className=\"flex items-center space-x-2 bg-gray-50 dark:bg-gray-800 rounded-lg p-3 border\"\n      data-testid=\"move-timer\"\n    >\n      <Clock className={`w-4 h-4 ${getTimerColor()}`} />\n      <div className=\"flex-1\">\n        <div className=\"flex items-center justify-between mb-1\">\n          <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n            Your turn\n          </span>\n          <span className={`text-sm font-bold ${getTimerColor()}`}>\n            {timeRemaining}s\n          </span>\n        </div>\n        <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2\">\n          <div\n            className={`h-2 rounded-full transition-all duration-1000 ease-linear ${getProgressColor()}`}\n            style={{ width: `${progressPercentage}%` }}\n          />\n        </div>\n      </div>\n      {timeRemaining <= 5 && (\n        <motion.div\n          animate={{ scale: [1, 1.1, 1] }}\n          transition={{ repeat: Infinity, duration: 0.5 }}\n          className=\"text-red-500 font-bold text-xs\"\n        >\n          HURRY!\n        </motion.div>\n      )}\n    </motion.div>\n  );\n}","size_bytes":3380},"client/src/components/OnlineUsersModal.tsx":{"content":"import React, { useState, useEffect } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useTranslation } from \"@/contexts/LanguageContext\";\nimport { useOnlineStatus } from \"@/hooks/useOnlineStatus\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { User, Clock, Users, UserX, UserCheck, Eye, UserPlus } from \"lucide-react\";\nimport { showUserFriendlyError } from \"@/lib/errorUtils\";\nimport { UserProfileModal } from \"./UserProfileModal\";\n\ninterface OnlineUsersModalProps {\n  open: boolean;\n  onClose: () => void;\n  currentRoom?: any;\n  user?: any;\n}\n\nexport function OnlineUsersModal({ open, onClose, currentRoom, user }: OnlineUsersModalProps) {\n  const { toast } = useToast();\n  const { t } = useTranslation();\n  const queryClient = useQueryClient();\n  const { isOnline } = useOnlineStatus();\n  const [blockedUsers, setBlockedUsers] = useState<Set<string>>(new Set());\n  const [friends, setFriends] = useState<Set<string>>(new Set());\n  const [profileUser, setProfileUser] = useState<any>(null);\n  const [showProfileModal, setShowProfileModal] = useState(false);\n\n  const { data: onlineUsers, isLoading } = useQuery({\n    queryKey: [\"/api/users/online\"],\n    refetchInterval: open ? 60000 : false, // Increased to 15s and only when modal is open\n    enabled: open,\n    staleTime: 60000, // Consider data fresh for 12 seconds\n    refetchOnWindowFocus: false,\n    refetchOnMount: false,\n  });\n\n  // Fetch blocked users\n  const { data: blockedUsersData } = useQuery({\n    queryKey: [\"/api/users/blocked\"],\n    enabled: open,\n  });\n\n  // Fetch friends\n  const { data: friendsData } = useQuery({\n    queryKey: [\"/api/friends\"],\n    enabled: open,\n  });\n\n  // Update blocked users state when data changes\n  useEffect(() => {\n    if (blockedUsersData) {\n      setBlockedUsers(new Set(blockedUsersData.map((blocked: any) => blocked.blockedId)));\n    }\n  }, [blockedUsersData]);\n\n  // Update friends state when data changes\n  useEffect(() => {\n    if (friendsData) {\n      setFriends(new Set(friendsData.map((friend: any) => friend.id)));\n    }\n  }, [friendsData]);\n\n\n\n  const blockUserMutation = useMutation({\n    mutationFn: async (userId: string) => {\n      return await apiRequest('/api/users/block', { method: 'POST', body: { userId } });\n    },\n    onSuccess: (_, userId) => {\n      setBlockedUsers(prev => new Set(prev).add(userId));\n      queryClient.invalidateQueries({ queryKey: [\"/api/users/blocked\"] });\n      toast({\n        title: t('userBlocked'),\n        description: t('userBlockedSuccessfully'),\n      });\n    },\n    onError: (error: any) => {\n      showUserFriendlyError(error, toast);\n    },\n  });\n\n  const unblockUserMutation = useMutation({\n    mutationFn: async (userId: string) => {\n      return await apiRequest('/api/users/unblock', { method: 'POST', body: { userId } });\n    },\n    onSuccess: (_, userId) => {\n      setBlockedUsers(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(userId);\n        return newSet;\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/users/blocked\"] });\n      toast({\n        title: t('userUnblocked'),\n        description: t('userUnblockedSuccessfully'),\n      });\n    },\n    onError: (error: any) => {\n      showUserFriendlyError(error, toast);\n    },\n  });\n\n  const sendFriendRequestMutation = useMutation({\n    mutationFn: async (requestedId: string) => {\n      return await apiRequest('/api/friends/request', { method: 'POST', body: { requestedId } });\n    },\n    onSuccess: (_, requestedId) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/friends\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/friends/requests\"] });\n      toast({\n        title: t('friendRequestSent'),\n        description: t('friendRequestSentSuccessfully'),\n      });\n    },\n    onError: (error: any) => {\n      // Handle specific friend request errors\n      if (error.message?.includes('already exists') || error.message?.includes('already sent')) {\n        toast({\n          title: t('error'),\n          description: t('friendRequestAlreadyExists'),\n          variant: 'destructive',\n        });\n      } else if (error.message?.includes('already friends')) {\n        toast({\n          title: t('error'),\n          description: t('alreadyFriends'),\n          variant: 'destructive',\n        });\n      } else {\n        showUserFriendlyError(error, toast);\n      }\n    },\n  });\n\n\n\n\n\n  const handleBlockUser = (userId: string) => {\n    blockUserMutation.mutate(userId);\n  };\n\n  const handleUnblockUser = (userId: string) => {\n    unblockUserMutation.mutate(userId);\n  };\n\n  const handleAddFriend = (userId: string) => {\n    sendFriendRequestMutation.mutate(userId);\n  };\n\n  const handleViewProfile = (user: any) => {\n    setProfileUser(user);\n    setShowProfileModal(true);\n  };\n\n\n\n  const formatLastSeen = (lastSeen: string) => {\n    const diff = Date.now() - new Date(lastSeen).getTime();\n    const minutes = Math.floor(diff / 60000);\n    \n    if (minutes < 1) return t('justNow');\n    if (minutes < 60) return `${minutes}${t('minutesAgo')}`;\n    \n    const hours = Math.floor(minutes / 60);\n    if (hours < 24) return `${hours}${t('hoursAgo')}`;\n    \n    const days = Math.floor(hours / 24);\n    return `${days}${t('daysAgo')}`;\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"sm:max-w-md\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Users className=\"h-5 w-5\" />\n            {t('onlinePlayers')} ({onlineUsers?.total || 0})\n          </DialogTitle>\n        </DialogHeader>\n        \n        <div className=\"space-y-4\">\n          <div className=\"bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800 rounded-lg p-3\">\n            <p className=\"text-sm text-blue-800 dark:text-blue-200\">\n              <strong>{t('onlinePlayers')}:</strong> {t('viewPlayerProfilesAndManageInteractions')}\n            </p>\n          </div>\n              \n              {isLoading ? (\n                <div className=\"flex items-center justify-center py-8\">\n                  <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n                </div>\n              ) : (\n                <ScrollArea className=\"h-[400px] w-full\">\n                  <div className=\"space-y-2\">\n                    {onlineUsers?.users?.length > 0 ? (\n                      onlineUsers.users.map((user: any) => {\n                        const isBlocked = blockedUsers.has(user.userId);\n                        const isFriend = friends.has(user.userId);\n                        return (\n                          <Card key={user.userId} className={`p-3 cursor-pointer transition-colors ${isBlocked ? 'opacity-50 border-red-200 dark:border-red-800' : 'hover:bg-slate-50 dark:hover:bg-slate-800'}`}>\n                            <div className=\"space-y-3\">\n                              {/* User Info Row */}\n                              <div className=\"flex items-center gap-3\">\n                                {user.profilePicture || user.profileImageUrl ? (\n                                  <img\n                                    src={user.profilePicture || user.profileImageUrl}\n                                    alt={t('profile')}\n                                    className=\"h-10 w-10 rounded-full object-cover\"\n                                  />\n                                ) : (\n                                  <div className=\"h-10 w-10 rounded-full bg-blue-600 flex items-center justify-center\">\n                                    <User className=\"h-5 w-5 text-white\" />\n                                  </div>\n                                )}\n                                <div className=\"flex-1\">\n                                  <div className=\"flex items-center gap-2 mb-1\">\n                                    <h3 className=\"font-medium\">\n                                      {user.displayName || user.firstName || user.username}\n                                    </h3>\n                                    {isBlocked && (\n                                      <Badge variant=\"destructive\" className=\"text-xs\">\n                                        {t('blocked')}\n                                      </Badge>\n                                    )}\n                                    {user.inRoom && (\n                                      <Badge variant=\"secondary\" className=\"text-xs\">{t('inRoom')}</Badge>\n                                    )}\n                                  </div>\n                                  <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                                    <Clock className=\"h-3 w-3\" />\n                                    {formatLastSeen(user.lastSeen)}\n                                  </div>\n                                </div>\n                              </div>\n                              \n                              {/* Action Buttons Row */}\n                              <div className=\"flex items-center gap-2 flex-wrap\">\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"outline\"\n                                  onClick={() => handleViewProfile(user)}\n                                  className=\"text-blue-600 hover:text-blue-700\"\n                                >\n                                  <Eye className=\"h-4 w-4 mr-1\" />\n                                  {t('profile')}\n                                </Button>\n                                \n                                {!isFriend && !isBlocked && (\n                                  <Button\n                                    size=\"sm\"\n                                    variant=\"outline\"\n                                    onClick={() => handleAddFriend(user.userId)}\n                                    disabled={sendFriendRequestMutation.isPending}\n                                    className=\"text-green-600 hover:text-green-700\"\n                                  >\n                                    <UserPlus className=\"h-4 w-4 mr-1\" />\n                                    {t('addFriend')}\n                                  </Button>\n                                )}\n                                \n                                {isBlocked ? (\n                                  <Button\n                                    size=\"sm\"\n                                    variant=\"outline\"\n                                    onClick={() => handleUnblockUser(user.userId)}\n                                    disabled={unblockUserMutation.isPending}\n                                    className=\"text-green-600 hover:text-green-700\"\n                                  >\n                                    <UserCheck className=\"h-4 w-4 mr-1\" />\n                                    {t('unblock')}\n                                  </Button>\n                                ) : (\n                                  <Button\n                                    size=\"sm\"\n                                    variant=\"outline\"\n                                    onClick={() => handleBlockUser(user.userId)}\n                                    disabled={blockUserMutation.isPending}\n                                    className=\"text-red-600 hover:text-red-700\"\n                                  >\n                                    <UserX className=\"h-4 w-4 mr-1\" />\n                                    {t('block')}\n                                  </Button>\n                                )}\n                              </div>\n                              \n                              {user.achievements && user.achievements.length > 0 && (\n                                <div className=\"flex items-center gap-1 pl-13\">\n                                  {user.achievements.map((achievement: any) => (\n                                    <span\n                                      key={achievement.id}\n                                      className=\"text-xs bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-2 py-1 rounded-full flex items-center gap-1\"\n                                      title={achievement.description}\n                                    >\n                                      {achievement.icon}\n                                      <span className=\"font-medium\">{achievement.achievementName}</span>\n                                    </span>\n                                  ))}\n                                </div>\n                              )}\n                            </div>\n                          </Card>\n                        );\n                      })\n                    ) : (\n                      <div className=\"text-center py-8 text-muted-foreground\">\n                        {t('noOtherPlayersOnline')}\n                      </div>\n                    )}\n                  </div>\n                </ScrollArea>\n              )}\n        </div>\n      </DialogContent>\n      \n      {/* Profile Modal */}\n      {profileUser && (\n        <UserProfileModal\n          open={showProfileModal}\n          onClose={() => setShowProfileModal(false)}\n          userId={profileUser.userId}\n          username={profileUser.username}\n          displayName={profileUser.displayName || profileUser.firstName || profileUser.username}\n          profilePicture={profileUser.profilePicture}\n          profileImageUrl={profileUser.profileImageUrl}\n        />\n      )}\n    </Dialog>\n  );\n}","size_bytes":13954},"client/src/components/PlayAgainRequestDialog.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { RefreshCw, X, Check, User } from \"lucide-react\";\n\ninterface PlayAgainRequest {\n  id: string;\n  requesterId: string;\n  requestedId: string;\n  gameId: string;\n  status: string;\n  requestedAt: string;\n  requester: {\n    id: string;\n    displayName: string;\n    firstName: string;\n    lastName: string;\n    username: string;\n    profileImageUrl?: string;\n  };\n  game: {\n    id: string;\n    gameMode: string;\n  };\n}\n\ninterface PlayAgainRequestDialogProps {\n  open: boolean;\n  onClose: () => void;\n  request: PlayAgainRequest | null;\n}\n\nexport function PlayAgainRequestDialog({ open, onClose, request }: PlayAgainRequestDialogProps) {\n  const [isResponding, setIsResponding] = useState(false);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const respondMutation = useMutation({\n    mutationFn: async ({ requestId, response }: { requestId: string; response: 'accepted' | 'rejected' }) => {\n      return apiRequest(`/api/play-again/respond`, {\n        method: 'POST',\n        body: { requestId, response },\n      });\n    },\n    onSuccess: (_, { response }) => {\n      toast({\n        description: response === 'accepted' ? \n          \"Play again request accepted! Starting new game...\" : \n          \"Play again request declined\",\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/play-again/requests'] });\n      onClose();\n    },\n    onError: (error) => {\n      console.error('Error responding to play again request:', error);\n      toast({\n        variant: \"destructive\",\n        description: \"Failed to respond to play again request\",\n      });\n    },\n    onSettled: () => {\n      setIsResponding(false);\n    },\n  });\n\n  const handleRespond = async (response: 'accepted' | 'rejected') => {\n    if (!request || isResponding) return;\n    \n    setIsResponding(true);\n    respondMutation.mutate({ requestId: request.id, response });\n  };\n\n  if (!open || !request) return null;\n\n  const requesterName = request.requester.displayName || \n                       request.requester.firstName || \n                       request.requester.username || \n                       'Unknown Player';\n\n  return (\n    <div \n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        backgroundColor: 'rgba(0, 0, 0, 0.8)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 9999,\n        padding: '16px'\n      }}\n      onClick={onClose}\n    >\n      <div \n        style={{\n          backgroundColor: '#1e293b',\n          borderRadius: '8px',\n          padding: '24px',\n          maxWidth: '400px',\n          width: '100%',\n          boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.25)',\n          border: '1px solid #475569',\n          color: 'white',\n          textAlign: 'center'\n        }}\n        onClick={(e) => e.stopPropagation()}\n      >\n        <div style={{ marginBottom: '24px' }}>\n          <RefreshCw \n            style={{ \n              width: '48px', \n              height: '48px', \n              margin: '0 auto 16px', \n              color: '#3b82f6' \n            }} \n          />\n          <h3 style={{ fontSize: '20px', fontWeight: 'bold', marginBottom: '8px' }}>\n            Play Again Request\n          </h3>\n          <p style={{ color: '#9ca3af', fontSize: '14px' }}>\n            You have a new play again request!\n          </p>\n        </div>\n\n        {/* Requester Info */}\n        <div style={{ \n          display: 'flex', \n          alignItems: 'center', \n          justifyContent: 'center', \n          gap: '12px', \n          marginBottom: '24px',\n          padding: '16px',\n          backgroundColor: '#334155',\n          borderRadius: '8px'\n        }}>\n          <div style={{\n            width: '48px',\n            height: '48px',\n            borderRadius: '50%',\n            backgroundColor: '#3b82f6',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            overflow: 'hidden'\n          }}>\n            {request.requester.profileImageUrl ? (\n              <img \n                src={request.requester.profileImageUrl} \n                alt={requesterName}\n                style={{\n                  width: '100%',\n                  height: '100%',\n                  objectFit: 'cover'\n                }}\n              />\n            ) : (\n              <User style={{ width: '24px', height: '24px', color: 'white' }} />\n            )}\n          </div>\n          <div style={{ textAlign: 'left' }}>\n            <p style={{ fontWeight: 'bold', fontSize: '16px', margin: 0 }}>\n              {requesterName}\n            </p>\n            <p style={{ color: '#9ca3af', fontSize: '14px', margin: 0 }}>\n              wants to play again\n            </p>\n          </div>\n        </div>\n\n        {/* Action Buttons */}\n        <div style={{ display: 'flex', gap: '12px', justifyContent: 'center' }}>\n          <Button\n            onClick={() => handleRespond('rejected')}\n            disabled={isResponding}\n            variant=\"outline\"\n            data-testid=\"button-reject-play-again\"\n            style={{\n              padding: '8px 16px',\n              backgroundColor: 'transparent',\n              color: '#ef4444',\n              border: '1px solid #ef4444',\n              borderRadius: '6px'\n            }}\n          >\n            <X style={{ width: '16px', height: '16px', marginRight: '8px' }} />\n            Decline\n          </Button>\n          \n          <Button\n            onClick={() => handleRespond('accepted')}\n            disabled={isResponding}\n            data-testid=\"button-accept-play-again\"\n            style={{\n              padding: '8px 16px',\n              backgroundColor: '#10b981',\n              color: 'white',\n              border: '1px solid #10b981',\n              borderRadius: '6px'\n            }}\n          >\n            <Check style={{ width: '16px', height: '16px', marginRight: '8px' }} />\n            {isResponding ? 'Starting...' : 'Accept'}\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":6316},"client/src/components/PlayerList.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useTranslation } from \"@/contexts/LanguageContext\";\nimport { User, Eye } from \"lucide-react\";\n\ninterface PlayerListProps {\n  roomId: string;\n}\n\nexport function PlayerList({ roomId }: PlayerListProps) {\n  const { isAuthenticated } = useAuth();\n  const { t } = useTranslation();\n  \n  const { data: participants = [], isLoading } = useQuery({\n    queryKey: [\"/api/rooms\", roomId, \"participants\"],\n    enabled: !!roomId && isAuthenticated,\n    refetchInterval: isAuthenticated ? 10000 : false, // Reduced frequency to 10 seconds\n    staleTime: 8000, // Consider data fresh for 8 seconds to reduce duplicate calls\n    refetchOnWindowFocus: false, // Prevent refetch on window focus\n    refetchOnMount: false, // Only refetch if data is stale\n  });\n\n  if (isLoading) {\n    return (\n      <Card className=\"bg-slate-800 border-slate-700\">\n        <CardHeader>\n          <CardTitle className=\"text-lg\">{t('playersAndSpectators')}</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"animate-pulse\">\n            <div className=\"h-4 bg-slate-700 rounded w-3/4 mb-2\"></div>\n            <div className=\"h-8 bg-slate-700 rounded mb-2\"></div>\n            <div className=\"h-8 bg-slate-700 rounded\"></div>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  const players = participants.filter(p => p.role === 'player');\n  const spectators = participants.filter(p => p.role === 'spectator');\n\n  return (\n    <Card className=\"bg-slate-800 border-slate-700\">\n      <CardHeader>\n        <CardTitle className=\"text-lg\">{t('playersAndSpectators')}</CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        {/* Players */}\n        <div>\n          <h4 className=\"text-sm font-medium text-gray-400 mb-2\">\n            {t('players')} ({players.length}/2)\n          </h4>\n          <div className=\"space-y-2\">\n            {players.length === 0 ? (\n              <div className=\"text-sm text-gray-500 text-center py-4\">\n                {t('noPlayersInRoom')}\n              </div>\n            ) : (\n              players.map((participant, index) => (\n                <div key={participant.id} className=\"flex items-center justify-between p-2 bg-slate-700 rounded\">\n                  <div className=\"flex items-center space-x-3\">\n                    {participant.user.profileImageUrl ? (\n                      <img \n                        src={participant.user.profileImageUrl} \n                        alt={t('playerAvatar')} \n                        className=\"w-8 h-8 rounded-full object-cover\"\n                      />\n                    ) : (\n                      <div className=\"w-8 h-8 bg-slate-600 rounded-full flex items-center justify-center\">\n                        <User className=\"w-4 h-4 text-gray-400\" />\n                      </div>\n                    )}\n                    <span className=\"text-sm\">\n                      {participant.user.firstName || participant.user.username || t('anonymous')}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <div className={`w-3 h-3 rounded-full ${\n                      index === 0 ? 'bg-blue-500' : 'bg-red-500'\n                    }`}></div>\n                    <span className=\"text-xs text-gray-400\">\n                      {index === 0 ? 'X' : 'O'}\n                    </span>\n                  </div>\n                </div>\n              ))\n            )}\n          </div>\n        </div>\n\n        {/* Spectators */}\n        <div>\n          <h4 className=\"text-sm font-medium text-gray-400 mb-2\">\n            {t('spectators')} ({spectators.length})\n          </h4>\n          <div className=\"space-y-2\">\n            {spectators.length === 0 ? (\n              <div className=\"text-sm text-gray-500 text-center py-2\">\n                {t('noSpectators')}\n              </div>\n            ) : (\n              spectators.map((participant) => (\n                <div key={participant.id} className=\"flex items-center justify-between p-2 bg-slate-700 rounded\">\n                  <div className=\"flex items-center space-x-3\">\n                    {participant.user.profileImageUrl ? (\n                      <img \n                        src={participant.user.profileImageUrl} \n                        alt={t('spectatorAvatar')} \n                        className=\"w-8 h-8 rounded-full object-cover\"\n                      />\n                    ) : (\n                      <div className=\"w-8 h-8 bg-slate-600 rounded-full flex items-center justify-center\">\n                        <User className=\"w-4 h-4 text-gray-400\" />\n                      </div>\n                    )}\n                    <span className=\"text-sm\">\n                      {participant.user.firstName || participant.user.username || t('anonymous')}\n                    </span>\n                  </div>\n                  <Badge variant=\"secondary\" className=\"bg-gray-600 text-xs\">\n                    <Eye className=\"w-3 h-3 mr-1\" />\n                    {t('watching')}\n                  </Badge>\n                </div>\n              ))\n            )}\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","size_bytes":5407},"client/src/components/PlayerProfileModal.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Trophy, Target, Users, Swords, Clock, Calendar } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useTranslation } from \"@/contexts/LanguageContext\";\n\ninterface PlayerProfile {\n  id: string;\n  username: string;\n  displayName: string;\n  profileImageUrl?: string;\n  wins: number;\n  losses: number;\n  draws: number;\n  totalGames: number;\n  coins: number;\n  level: number;\n  winsToNextLevel: number;\n  createdAt: string;\n  achievements: Array<{\n    id: string;\n    name: string;\n    description: string;\n    icon: string;\n    unlockedAt: string;\n  }>;\n}\n\ninterface HeadToHeadStats {\n  totalGames: number;\n  wins: number;\n  losses: number;\n  draws: number;\n  winRate: number;\n  recentGames: Array<{\n    id: string;\n    result: 'win' | 'loss' | 'draw';\n    playedAt: string;\n  }>;\n}\n\ninterface PlayerProfileModalProps {\n  playerId: string | null;\n  open: boolean;\n  onClose: () => void;\n  currentUserId?: string;\n}\n\nexport function PlayerProfileModal({ playerId, open, onClose, currentUserId }: PlayerProfileModalProps) {\n  const { t } = useTranslation();\n  \n  // Debug logging for profile modal\n  useEffect(() => {\n    // PlayerProfileModal props changed\n  }, [playerId, open, currentUserId]);\n  \n  const { data: profile, isLoading: profileLoading } = useQuery<PlayerProfile>({\n    queryKey: ['/api/players', playerId],\n    enabled: open && !!playerId,\n  });\n\n  const { data: headToHead, isLoading: h2hLoading } = useQuery<HeadToHeadStats>({\n    queryKey: ['/api/head-to-head', currentUserId, playerId],\n    enabled: open && !!playerId && !!currentUserId && playerId !== currentUserId,\n  });\n\n  const isOwnProfile = playerId === currentUserId;\n  const winRate = profile ? Math.round((profile.wins / Math.max(profile.totalGames, 1)) * 100) : 0;\n\n  const getAchievementLevel = (profile: PlayerProfile | undefined) => {\n    if (!profile) return 'none';\n    if (profile.totalGames >= 500) return 'ultimateVeteran';\n    if (profile.wins >= 200) return 'grandmaster';\n    if (profile.wins >= 100) return 'champion';\n    if (profile.wins >= 50) return 'legend';\n    return 'none';\n  };\n\n  const renderAchievementBorder = (profile: PlayerProfile | undefined) => {\n    if (!profile) return <span className=\"font-semibold text-sm truncate\">Unknown Player</span>;\n    \n    const level = getAchievementLevel(profile);\n    \n    switch (level) {\n      case 'ultimateVeteran':\n        return (\n          <motion.span\n            animate={{\n              textShadow: [\n                \"0 0 10px #ff6347, 0 0 20px #ff1493, 0 0 30px #ff4500\",\n                \"0 0 15px #ff4500, 0 0 25px #ff6347, 0 0 35px #ff1493\",\n                \"0 0 12px #ff1493, 0 0 22px #ff4500, 0 0 32px #ff6347\"\n              ],\n              scale: [1, 1.05, 1],\n              filter: [\n                \"brightness(1) saturate(1)\",\n                \"brightness(1.2) saturate(1.3)\",\n                \"brightness(1) saturate(1)\"\n              ]\n            }}\n            transition={{\n              duration: 2.0,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n            className=\"font-bold text-lg truncate text-red-400\"\n          >\n            üî• {profile.displayName}\n          </motion.span>\n        );\n      case 'grandmaster':\n        return (\n          <motion.span\n            animate={{\n              textShadow: [\n                \"0 0 8px #4f46e5, 0 0 16px #c0c0c0, 0 0 24px #9333ea\",\n                \"0 0 10px #9333ea, 0 0 20px #ffd700, 0 0 30px #4f46e5\",\n                \"0 0 9px #ffd700, 0 0 18px #4f46e5, 0 0 27px #c0c0c0\"\n              ],\n              scale: [1, 1.02, 1],\n              rotate: [0, 1, -1, 0]\n            }}\n            transition={{\n              duration: 3.0,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n            className=\"font-bold text-lg truncate text-indigo-400\"\n          >\n            üíé {profile.displayName}\n          </motion.span>\n        );\n      case 'champion':\n        return (\n          <motion.span\n            animate={{\n              textShadow: [\n                \"0 0 10px #9333ea, 0 0 20px #3b82f6, 0 0 30px #ffd700\",\n                \"0 0 15px #ffd700, 0 0 25px #ec4899, 0 0 35px #9333ea\",\n                \"0 0 12px #ec4899, 0 0 22px #9333ea, 0 0 32px #3b82f6\"\n              ],\n              scale: [1, 1.03, 1]\n            }}\n            transition={{\n              duration: 2.5,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n            className=\"font-bold text-lg truncate text-purple-400\"\n          >\n            üëë {profile.displayName}\n          </motion.span>\n        );\n      case 'legend':\n        return (\n          <motion.span\n            animate={{\n              textShadow: [\n                \"0 0 6px #ff4500, 0 0 12px #ff6600, 0 0 18px #ff8800\",\n                \"0 0 8px #ff0000, 0 0 16px #ff3300, 0 0 24px #ff6600\",\n                \"0 0 7px #ff8800, 0 0 14px #ffaa00, 0 0 21px #ffcc00\"\n              ]\n            }}\n            transition={{\n              duration: 1.2,\n              repeat: Infinity,\n              ease: \"easeInOut\"\n            }}\n            className=\"font-bold text-lg truncate text-orange-400\"\n          >\n            üåü {profile.displayName}\n          </motion.span>\n        );\n      default:\n        return (\n          <span className=\"font-semibold text-lg truncate\">\n            {profile.displayName}\n          </span>\n        );\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString();\n  };\n\n  if (!open || !playerId) {\n    // PlayerProfileModal not showing\n    return null;\n  }\n\n  // PlayerProfileModal rendering\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"player-profile-modal max-w-2xl max-h-[90vh] w-[95vw] sm:w-full mx-auto flex flex-col overflow-hidden\">\n        <DialogHeader className=\"flex-shrink-0 pb-4\">\n          <DialogTitle className=\"flex items-center gap-2 text-xl\">\n            <Users className=\"w-6 h-6 text-blue-500\" />\n            {t('playerProfile') || 'Player Profile'}\n          </DialogTitle>\n        </DialogHeader>\n\n        {profileLoading ? (\n          <div className=\"flex items-center justify-center py-8 flex-1\">\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500\"></div>\n            <span className=\"ml-2\">{t('loading') || 'Loading...'}</span>\n          </div>\n        ) : profile ? (\n          <div className=\"flex-1 overflow-y-auto space-y-6\">\n            {/* Profile Header */}\n            <Card>\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center gap-4\">\n                  {/* Profile Picture */}\n                  <div className=\"flex-shrink-0\">\n                    {profile.profileImageUrl ? (\n                      <img\n                        src={profile.profileImageUrl}\n                        alt={`${profile.displayName}'s profile`}\n                        className=\"w-20 h-20 rounded-full object-cover border-4 border-gray-200 dark:border-gray-700\"\n                      />\n                    ) : (\n                      <div className=\"w-20 h-20 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white font-bold text-2xl\">\n                        {profile.displayName.charAt(0).toUpperCase()}\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Profile Info */}\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"mb-2\">\n                      {renderAchievementBorder(profile)}\n                    </div>\n                    <Badge variant=\"secondary\" className=\"text-sm mb-2\">\n                      @{profile.username}\n                    </Badge>\n                    <div className=\"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400\">\n                      <Calendar className=\"w-4 h-4\" />\n                      <span>{t('joined') || 'Joined'} {formatDate(profile.createdAt)}</span>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Game Statistics */}\n            <Card>\n              <CardContent className=\"p-6\">\n                <h3 className=\"text-lg font-semibold mb-4 flex items-center gap-2\">\n                  <Trophy className=\"w-5 h-5\" />\n                  {t('gameStats') || 'Game Statistics'}\n                </h3>\n                <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4 mb-6\">\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-green-600 dark:text-green-400\">{profile.wins}</div>\n                    <div className=\"text-sm text-gray-600 dark:text-gray-400\">{t('wins') || 'Wins'}</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-red-600 dark:text-red-400\">{profile.losses}</div>\n                    <div className=\"text-sm text-gray-600 dark:text-gray-400\">{t('losses') || 'Losses'}</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-yellow-600 dark:text-yellow-400\">{profile.draws}</div>\n                    <div className=\"text-sm text-gray-600 dark:text-gray-400\">{t('draws') || 'Draws'}</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-blue-600 dark:text-blue-400\">{winRate}%</div>\n                    <div className=\"text-sm text-gray-600 dark:text-gray-400\">{t('winRate') || 'Win Rate'}</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-green-500 dark:text-green-300 flex items-center justify-center gap-1\">\n                      <span>üí∞</span>\n                      <span>{profile.coins ?? 1000}</span>\n                    </div>\n                    <div className=\"text-sm text-gray-600 dark:text-gray-400\">Coins</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-amber-600 dark:text-amber-400 flex items-center justify-center gap-1\">\n                      <span>üèÜ</span>\n                      <span>Lv.{profile.level || 0}</span>\n                    </div>\n                    <div className=\"text-sm text-gray-600 dark:text-gray-400\">Level</div>\n                  </div>\n                </div>\n                \n                {/* Level Progress Bar */}\n                <div className=\"bg-gradient-to-r from-amber-50 to-yellow-50 dark:from-amber-900/20 dark:to-yellow-900/20 p-4 rounded-lg\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <span className=\"text-sm font-medium text-amber-700 dark:text-amber-400\">Level Progress</span>\n                    <span className=\"text-sm text-amber-600 dark:text-amber-500\">\n                      {profile.winsToNextLevel ?? 60} wins to next level\n                    </span>\n                  </div>\n                  <div className=\"w-full bg-amber-200 dark:bg-amber-800 rounded-full h-2\">\n                    <div \n                      className=\"bg-gradient-to-r from-amber-500 to-yellow-500 h-2 rounded-full transition-all duration-300\"\n                      style={{ width: `${((60 - (profile.winsToNextLevel ?? 60)) / 60) * 100}%` }}\n                    />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Head-to-Head Statistics */}\n            {!isOwnProfile && currentUserId && (\n              <Card>\n                <CardContent className=\"p-6\">\n                  <h3 className=\"text-lg font-semibold mb-4 flex items-center gap-2\">\n                    <Swords className=\"w-5 h-5\" />\n                    {t('headToHead') || 'Head-to-Head vs You'}\n                  </h3>\n                  {h2hLoading ? (\n                    <div className=\"flex items-center justify-center py-4\">\n                      <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500\"></div>\n                      <span className=\"ml-2\">{t('loading') || 'Loading...'}</span>\n                    </div>\n                  ) : headToHead ? (\n                    <div>\n                      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4\">\n                        <div className=\"text-center\">\n                          <div className=\"text-xl font-bold text-gray-800 dark:text-gray-200\">{headToHead.totalGames}</div>\n                          <div className=\"text-sm text-gray-600 dark:text-gray-400\">{t('totalGames') || 'Total Games'}</div>\n                        </div>\n                        <div className=\"text-center\">\n                          <div className=\"text-xl font-bold text-green-600 dark:text-green-400\">{headToHead.wins}</div>\n                          <div className=\"text-sm text-gray-600 dark:text-gray-400\">{t('yourWins') || 'Your Wins'}</div>\n                        </div>\n                        <div className=\"text-center\">\n                          <div className=\"text-xl font-bold text-red-600 dark:text-red-400\">{headToHead.losses}</div>\n                          <div className=\"text-sm text-gray-600 dark:text-gray-400\">{t('yourLosses') || 'Your Losses'}</div>\n                        </div>\n                        <div className=\"text-center\">\n                          <div className=\"text-xl font-bold text-blue-600 dark:text-blue-400\">{headToHead.winRate}%</div>\n                          <div className=\"text-sm text-gray-600 dark:text-gray-400\">{t('yourWinRate') || 'Your Win Rate'}</div>\n                        </div>\n                      </div>\n                      {headToHead.recentGames.length > 0 && (\n                        <div>\n                          <h4 className=\"font-medium mb-2\">{t('recentGames') || 'Recent Games'}</h4>\n                          <div className=\"space-y-2\">\n                            {headToHead.recentGames.slice(0, 5).map((game) => (\n                              <div key={game.id} className=\"flex items-center justify-between text-sm\">\n                                <span className=\"text-gray-600 dark:text-gray-400\">{formatDate(game.playedAt)}</span>\n                                <Badge variant={\n                                  game.result === 'win' ? 'default' : \n                                  game.result === 'loss' ? 'destructive' : 'secondary'\n                                }>\n                                  {game.result === 'win' ? t('win') || 'Win' :\n                                   game.result === 'loss' ? t('loss') || 'Loss' :\n                                   t('draw') || 'Draw'}\n                                </Badge>\n                              </div>\n                            ))}\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  ) : (\n                    <p className=\"text-gray-600 dark:text-gray-400 text-center\">\n                      {t('noGamesPlayed') || 'No games played against this player yet.'}\n                    </p>\n                  )}\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Achievements */}\n            {profile.achievements.length > 0 && (\n              <Card>\n                <CardContent className=\"p-6\">\n                  <h3 className=\"text-lg font-semibold mb-4 flex items-center gap-2\">\n                    <Trophy className=\"w-5 h-5\" />\n                    {t('achievements') || 'Achievements'}\n                  </h3>\n                  <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\n                    {profile.achievements.map((achievement) => (\n                      <div key={achievement.id} className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg\">\n                        <span className=\"text-2xl\">{achievement.icon}</span>\n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"font-medium truncate\">{achievement.name}</div>\n                          <div className=\"text-sm text-gray-600 dark:text-gray-400 truncate\">{achievement.description}</div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n          </div>\n        ) : (\n          <div className=\"flex items-center justify-center py-8 flex-1\">\n            <span className=\"text-gray-600 dark:text-gray-400\">{t('playerNotFound') || 'Player not found'}</span>\n          </div>\n        )}\n\n        <div className=\"flex-shrink-0 pt-4 border-t\">\n          <Button onClick={onClose} className=\"w-full\">\n            {t('close') || 'Close'}\n          </Button>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":17388},"client/src/components/PlayerRankings.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Trophy, Medal, Award, TrendingUp, TrendingDown, Minus, User, BarChart3, PieChart, Activity, Zap, Crown, Star, Target } from \"lucide-react\";\nimport { useState, useEffect } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\n\ninterface PlayerRanking {\n  userId: string;\n  displayName: string;\n  firstName: string;\n  lastName: string;\n  profileImageUrl: string;\n  wins: number;\n  losses: number;\n  draws: number;\n  totalGames: number;\n  winRate: number;\n  rank: number;\n  rankChange: number; // +/- change from previous ranking\n  streak: number; // current win/loss streak\n  streakType: 'win' | 'loss' | 'draw';\n}\n\ninterface PlayerRankingsProps {\n  currentUserId?: string;\n}\n\ninterface RankingStats {\n  totalPlayers: number;\n  averageWinRate: number;\n  mostActivePlayer: string;\n  topStreak: number;\n  totalGamesPlayed: number;\n}\n\nexport function PlayerRankings({ currentUserId }: PlayerRankingsProps) {\n  const [sortBy, setSortBy] = useState<'winRate' | 'totalGames' | 'wins'>('winRate');\n  const [viewMode, setViewMode] = useState<'list' | 'chart' | 'stats'>('list');\n  const [previousRankings, setPreviousRankings] = useState<PlayerRanking[]>([]);\n\n  const { data: rankings, isLoading } = useQuery({\n    queryKey: ['/api/rankings', sortBy],\n    refetchInterval: 30000, // Increased to 30s - rankings don't change frequently\n    staleTime: 25000, // Consider data fresh for 25 seconds\n    refetchOnWindowFocus: false,\n    refetchOnMount: false,\n  });\n\n  // Track ranking changes\n  useEffect(() => {\n    if (rankings && rankings.length > 0) {\n      setPreviousRankings(prev => {\n        if (prev.length === 0) return rankings;\n        \n        // Calculate rank changes\n        const updatedRankings = rankings.map((current: PlayerRanking) => {\n          const previous = prev.find(p => p.userId === current.userId);\n          const rankChange = previous ? previous.rank - current.rank : 0;\n          return { ...current, rankChange };\n        });\n        \n        return updatedRankings;\n      });\n    }\n  }, [rankings]);\n\n  if (isLoading) {\n    return (\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Trophy className=\"h-5 w-5 text-yellow-500\" />\n            Player Rankings\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-4\">\n            {[...Array(5)].map((_, i) => (\n              <div key={i} className=\"flex items-center space-x-3 p-3 rounded-lg animate-pulse\">\n                <div className=\"w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded-full\"></div>\n                <div className=\"flex-1 space-y-2\">\n                  <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-24\"></div>\n                  <div className=\"h-3 bg-gray-200 dark:bg-gray-700 rounded w-16\"></div>\n                </div>\n                <div className=\"h-6 bg-gray-200 dark:bg-gray-700 rounded w-12\"></div>\n              </div>\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  const getRankIcon = (rank: number) => {\n    switch (rank) {\n      case 1:\n        return <Trophy className=\"h-5 w-5 text-yellow-500\" />;\n      case 2:\n        return <Medal className=\"h-5 w-5 text-gray-400\" />;\n      case 3:\n        return <Award className=\"h-5 w-5 text-amber-600\" />;\n      default:\n        return <span className=\"text-sm font-bold text-gray-500\">#{rank}</span>;\n    }\n  };\n\n  const getRankChangeIcon = (change: number) => {\n    if (change > 0) return <TrendingUp className=\"h-4 w-4 text-green-500\" />;\n    if (change < 0) return <TrendingDown className=\"h-4 w-4 text-red-500\" />;\n    return <Minus className=\"h-4 w-4 text-gray-500\" />;\n  };\n\n  const getStreakColor = (streakType: string) => {\n    switch (streakType) {\n      case 'win':\n        return 'bg-green-500';\n      case 'loss':\n        return 'bg-red-500';\n      default:\n        return 'bg-gray-500';\n    }\n  };\n\n  const getWinRateColor = (winRate: number) => {\n    if (winRate >= 70) return 'text-green-600 dark:text-green-400';\n    if (winRate >= 50) return 'text-yellow-600 dark:text-yellow-400';\n    return 'text-red-600 dark:text-red-400';\n  };\n\n  const calculateStats = (rankings: PlayerRanking[]): RankingStats => {\n    if (!rankings || rankings.length === 0) {\n      return {\n        totalPlayers: 0,\n        averageWinRate: 0,\n        mostActivePlayer: '',\n        topStreak: 0,\n        totalGamesPlayed: 0\n      };\n    }\n\n    const totalGamesPlayed = rankings.reduce((sum, player) => sum + player.totalGames, 0);\n    const averageWinRate = rankings.reduce((sum, player) => sum + player.winRate, 0) / rankings.length;\n    const mostActivePlayer = rankings.reduce((prev, current) => \n      prev.totalGames > current.totalGames ? prev : current\n    ).displayName || 'Unknown';\n    const topStreak = Math.max(...rankings.map(player => player.streak));\n\n    return {\n      totalPlayers: rankings.length,\n      averageWinRate,\n      mostActivePlayer,\n      topStreak,\n      totalGamesPlayed\n    };\n  };\n\n  const renderChart = () => {\n    if (!rankings || rankings.length === 0) return null;\n\n    const topPlayers = rankings.slice(0, 10);\n    const maxWinRate = Math.max(...topPlayers.map(p => p.winRate));\n\n    return (\n      <div className=\"space-y-4\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          {/* Win Rate Chart */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-sm\">\n                <BarChart3 className=\"h-4 w-4\" />\n                Win Rate Distribution\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-2\">\n                {topPlayers.map((player, index) => (\n                  <motion.div\n                    key={player.userId}\n                    initial={{ opacity: 0, x: -20 }}\n                    animate={{ opacity: 1, x: 0 }}\n                    transition={{ delay: index * 0.1 }}\n                    className=\"flex items-center gap-2\"\n                  >\n                    <div className=\"w-16 text-xs text-gray-600 dark:text-gray-400 truncate\">\n                      {player.displayName || 'Unknown'}\n                    </div>\n                    <div className=\"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2\">\n                      <motion.div\n                        className=\"h-2 rounded-full bg-gradient-to-r from-blue-500 to-purple-500\"\n                        initial={{ width: 0 }}\n                        animate={{ width: `${(player.winRate / maxWinRate) * 100}%` }}\n                        transition={{ duration: 0.8, delay: index * 0.1 }}\n                      />\n                    </div>\n                    <div className=\"w-12 text-xs text-right\">\n                      {player.winRate.toFixed(1)}%\n                    </div>\n                  </motion.div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Games Played Chart */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2 text-sm\">\n                <Activity className=\"h-4 w-4\" />\n                Games Played\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-2\">\n                {topPlayers.map((player, index) => {\n                  const maxGames = Math.max(...topPlayers.map(p => p.totalGames));\n                  return (\n                    <motion.div\n                      key={player.userId}\n                      initial={{ opacity: 0, x: -20 }}\n                      animate={{ opacity: 1, x: 0 }}\n                      transition={{ delay: index * 0.1 }}\n                      className=\"flex items-center gap-2\"\n                    >\n                      <div className=\"w-16 text-xs text-gray-600 dark:text-gray-400 truncate\">\n                        {player.displayName || 'Unknown'}\n                      </div>\n                      <div className=\"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2\">\n                        <motion.div\n                          className=\"h-2 rounded-full bg-gradient-to-r from-green-500 to-blue-500\"\n                          initial={{ width: 0 }}\n                          animate={{ width: `${(player.totalGames / maxGames) * 100}%` }}\n                          transition={{ duration: 0.8, delay: index * 0.1 }}\n                        />\n                      </div>\n                      <div className=\"w-12 text-xs text-right\">\n                        {player.totalGames}\n                      </div>\n                    </motion.div>\n                  );\n                })}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Streak Leaders */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-sm\">\n              <Zap className=\"h-4 w-4\" />\n              Current Streaks\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              {rankings\n                .filter(player => player.streak > 1)\n                .sort((a, b) => b.streak - a.streak)\n                .slice(0, 6)\n                .map((player, index) => (\n                  <motion.div\n                    key={player.userId}\n                    initial={{ opacity: 0, scale: 0.8 }}\n                    animate={{ opacity: 1, scale: 1 }}\n                    transition={{ delay: index * 0.1 }}\n                    className={`p-3 rounded-lg border-2 ${\n                      player.streakType === 'win' \n                        ? 'border-green-500 bg-green-50 dark:bg-green-900/20' \n                        : player.streakType === 'loss'\n                        ? 'border-red-500 bg-red-50 dark:bg-red-900/20'\n                        : 'border-gray-500 bg-gray-50 dark:bg-gray-900/20'\n                    }`}\n                  >\n                    <div className=\"flex items-center gap-2\">\n                      {player.profileImageUrl ? (\n                        <img \n                          src={player.profileImageUrl} \n                          alt={player.displayName}\n                          className=\"w-8 h-8 rounded-full object-cover\"\n                        />\n                      ) : (\n                        <div className=\"w-8 h-8 bg-gray-300 dark:bg-gray-600 rounded-full flex items-center justify-center\">\n                          <User className=\"h-4 w-4 text-gray-600 dark:text-gray-400\" />\n                        </div>\n                      )}\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"text-sm font-medium truncate\">\n                          {player.displayName || 'Unknown'}\n                        </p>\n                        <p className=\"text-xs text-gray-500\">\n                          {player.streak} {player.streakType}{player.streak > 1 ? 's' : ''}\n                        </p>\n                      </div>\n                      <div className={`text-lg font-bold ${\n                        player.streakType === 'win' \n                          ? 'text-green-600' \n                          : player.streakType === 'loss'\n                          ? 'text-red-600'\n                          : 'text-gray-600'\n                      }`}>\n                        {player.streak}\n                      </div>\n                    </div>\n                  </motion.div>\n                ))}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  };\n\n  const renderStats = () => {\n    if (!rankings || rankings.length === 0) return null;\n\n    const stats = calculateStats(rankings);\n\n    return (\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5 }}\n        >\n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">Total Players</p>\n                  <p className=\"text-2xl font-bold\">{stats.totalPlayers}</p>\n                </div>\n                <User className=\"h-8 w-8 text-blue-500\" />\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5, delay: 0.1 }}\n        >\n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">Average Win Rate</p>\n                  <p className=\"text-2xl font-bold\">{stats.averageWinRate.toFixed(1)}%</p>\n                </div>\n                <Target className=\"h-8 w-8 text-green-500\" />\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5, delay: 0.2 }}\n        >\n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">Most Active</p>\n                  <p className=\"text-lg font-bold truncate\">{stats.mostActivePlayer}</p>\n                </div>\n                <Crown className=\"h-8 w-8 text-purple-500\" />\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5, delay: 0.3 }}\n        >\n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">Top Streak</p>\n                  <p className=\"text-2xl font-bold\">{stats.topStreak}</p>\n                </div>\n                <Zap className=\"h-8 w-8 text-orange-500\" />\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5, delay: 0.4 }}\n          className=\"md:col-span-2 lg:col-span-4\"\n        >\n          <Card>\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">Total Games Played</p>\n                  <p className=\"text-3xl font-bold\">{stats.totalGamesPlayed}</p>\n                </div>\n                <Activity className=\"h-8 w-8 text-indigo-500\" />\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n      </div>\n    );\n  };\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n            <Trophy className=\"h-5 w-5 text-yellow-500\" />\n            Player Rankings\n          </div>\n          <div className=\"flex gap-2\">\n            {/* View Mode Toggle */}\n            <div className=\"flex gap-1 mr-2\">\n              <button\n                onClick={() => setViewMode('list')}\n                className={`p-2 rounded ${\n                  viewMode === 'list' \n                    ? 'bg-blue-500 text-white' \n                    : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300'\n                }`}\n                title=\"List View\"\n              >\n                <User className=\"h-4 w-4\" />\n              </button>\n              <button\n                onClick={() => setViewMode('chart')}\n                className={`p-2 rounded ${\n                  viewMode === 'chart' \n                    ? 'bg-blue-500 text-white' \n                    : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300'\n                }`}\n                title=\"Chart View\"\n              >\n                <BarChart3 className=\"h-4 w-4\" />\n              </button>\n              <button\n                onClick={() => setViewMode('stats')}\n                className={`p-2 rounded ${\n                  viewMode === 'stats' \n                    ? 'bg-blue-500 text-white' \n                    : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300'\n                }`}\n                title=\"Stats View\"\n              >\n                <PieChart className=\"h-4 w-4\" />\n              </button>\n            </div>\n            \n            {/* Sort Options */}\n            {viewMode === 'list' && (\n              <div className=\"flex gap-2\">\n                <button\n                  onClick={() => setSortBy('winRate')}\n                  className={`px-3 py-1 rounded text-sm ${\n                    sortBy === 'winRate' \n                      ? 'bg-blue-500 text-white' \n                      : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300'\n                  }`}\n                >\n                  Win Rate\n                </button>\n                <button\n                  onClick={() => setSortBy('wins')}\n                  className={`px-3 py-1 rounded text-sm ${\n                    sortBy === 'wins' \n                      ? 'bg-blue-500 text-white' \n                      : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300'\n                  }`}\n                >\n                  Wins\n                </button>\n                <button\n                  onClick={() => setSortBy('totalGames')}\n                  className={`px-3 py-1 rounded text-sm ${\n                    sortBy === 'totalGames' \n                      ? 'bg-blue-500 text-white' \n                      : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300'\n                  }`}\n                >\n                  Games\n                </button>\n              </div>\n            )}\n          </div>\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        <AnimatePresence mode=\"wait\">\n          {viewMode === 'list' && (\n            <motion.div\n              key=\"list\"\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -20 }}\n              transition={{ duration: 0.3 }}\n              className=\"space-y-3\"\n            >\n              {rankings?.map((player: PlayerRanking, index) => (\n                <motion.div\n                  key={player.userId}\n                  initial={{ opacity: 0, x: -20 }}\n                  animate={{ opacity: 1, x: 0 }}\n                  transition={{ delay: index * 0.05 }}\n                  className={`flex items-center space-x-3 p-3 rounded-lg transition-all hover:bg-gray-50 dark:hover:bg-gray-800 ${\n                    player.userId === currentUserId \n                      ? 'ring-2 ring-blue-500 bg-blue-50 dark:bg-blue-900/20' \n                      : ''\n                  }`}\n                >\n                  {/* Rank */}\n                  <div className=\"flex items-center justify-center w-8 h-8\">\n                    {getRankIcon(player.rank)}\n                  </div>\n\n                  {/* Profile Picture */}\n                  <div className=\"relative\">\n                    {player.profileImageUrl ? (\n                      <img \n                        src={player.profileImageUrl} \n                        alt={player.displayName}\n                        className=\"w-10 h-10 rounded-full object-cover\"\n                      />\n                    ) : (\n                      <div className=\"w-10 h-10 bg-gray-300 dark:bg-gray-600 rounded-full flex items-center justify-center\">\n                        <User className=\"h-5 w-5 text-gray-600 dark:text-gray-400\" />\n                      </div>\n                    )}\n                    \n                    {/* Streak indicator */}\n                    {player.streak > 1 && (\n                      <motion.div\n                        initial={{ scale: 0 }}\n                        animate={{ scale: 1 }}\n                        transition={{ delay: index * 0.05 + 0.2 }}\n                        className={`absolute -top-1 -right-1 w-5 h-5 rounded-full ${getStreakColor(player.streakType)} flex items-center justify-center`}\n                      >\n                        <span className=\"text-xs font-bold text-white\">{player.streak}</span>\n                      </motion.div>\n                    )}\n                  </div>\n\n                  {/* Player Info */}\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center gap-2\">\n                      <p className=\"font-medium text-gray-900 dark:text-gray-100 truncate\">\n                        {player.displayName || `${player.firstName} ${player.lastName}`.trim() || 'Anonymous'}\n                      </p>\n                      {player.userId === currentUserId && (\n                        <Badge variant=\"outline\" className=\"text-xs\">You</Badge>\n                      )}\n                      {player.rankChange > 0 && (\n                        <motion.div\n                          initial={{ scale: 0 }}\n                          animate={{ scale: 1 }}\n                          transition={{ delay: index * 0.05 + 0.3 }}\n                          className=\"flex items-center gap-1\"\n                        >\n                          <TrendingUp className=\"h-3 w-3 text-green-500\" />\n                          <span className=\"text-xs text-green-500\">+{player.rankChange}</span>\n                        </motion.div>\n                      )}\n                      {player.rankChange < 0 && (\n                        <motion.div\n                          initial={{ scale: 0 }}\n                          animate={{ scale: 1 }}\n                          transition={{ delay: index * 0.05 + 0.3 }}\n                          className=\"flex items-center gap-1\"\n                        >\n                          <TrendingDown className=\"h-3 w-3 text-red-500\" />\n                          <span className=\"text-xs text-red-500\">{player.rankChange}</span>\n                        </motion.div>\n                      )}\n                    </div>\n                    \n                    <div className=\"flex items-center gap-4 mt-1\">\n                      <div className=\"flex items-center gap-1 text-sm text-gray-600 dark:text-gray-400\">\n                        <span className={`font-medium ${getWinRateColor(player.winRate)}`}>\n                          {player.winRate.toFixed(1)}%\n                        </span>\n                        <span>({player.wins}W-{player.losses}L-{player.draws}D)</span>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Win Rate Progress */}\n                  <div className=\"w-20\">\n                    <Progress \n                      value={player.winRate} \n                      className=\"h-2\"\n                    />\n                  </div>\n\n                  {/* Total Games */}\n                  <div className=\"text-right\">\n                    <p className=\"text-sm font-medium text-gray-900 dark:text-gray-100\">\n                      {player.totalGames}\n                    </p>\n                    <p className=\"text-xs text-gray-500\">games</p>\n                  </div>\n                </motion.div>\n              ))}\n              \n              {(!rankings || rankings.length === 0) && (\n                <motion.div\n                  initial={{ opacity: 0 }}\n                  animate={{ opacity: 1 }}\n                  className=\"text-center py-8 text-gray-500\"\n                >\n                  <Trophy className=\"h-12 w-12 mx-auto mb-3 text-gray-300\" />\n                  <p>No rankings available yet</p>\n                  <p className=\"text-sm\">Play some online games to see rankings!</p>\n                </motion.div>\n              )}\n            </motion.div>\n          )}\n\n          {viewMode === 'chart' && (\n            <motion.div\n              key=\"chart\"\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -20 }}\n              transition={{ duration: 0.3 }}\n            >\n              {renderChart()}\n            </motion.div>\n          )}\n\n          {viewMode === 'stats' && (\n            <motion.div\n              key=\"stats\"\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -20 }}\n              transition={{ duration: 0.3 }}\n            >\n              {renderStats()}\n            </motion.div>\n          )}\n        </AnimatePresence>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":25323},"client/src/components/ProfileManager.tsx":{"content":"import { useState, useRef } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport { User, Upload, X } from \"lucide-react\";\nimport { useTranslation } from \"@/contexts/LanguageContext\";\n\ninterface ProfileManagerProps {\n  user: any;\n  open?: boolean;\n  onClose?: () => void;\n}\n\nexport function ProfileManager({ user, open = false, onClose }: ProfileManagerProps) {\n  const { t } = useTranslation();\n  const [displayName, setDisplayName] = useState(user?.displayName || user?.username || '');\n  const [profilePicture, setProfilePicture] = useState(user?.profilePicture || '');\n  const [isUploading, setIsUploading] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const updateProfileMutation = useMutation({\n    mutationFn: async (data: { displayName?: string; profilePicture?: string }) => {\n      const response = await apiRequest('/api/auth/profile', { method: 'PUT', body: data });\n      return response.json();\n    },\n    onSuccess: (updatedUser) => {\n      // Update the user data in the cache\n      queryClient.setQueryData(['/api/auth/user'], updatedUser);\n      \n      // Also invalidate and refetch to ensure fresh data\n      queryClient.invalidateQueries({\n        queryKey: ['/api/auth/user']\n      });\n      \n      toast({\n        title: t('profileUpdated'),\n        description: t('profileUpdatedSuccess'),\n      });\n      onClose?.();\n    },\n    onError: (error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: t('unauthorized'),\n          description: t('loggedOutLoggingIn'),\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: t('error'),\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleImageUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    if (file.size > 1 * 1024 * 1024) { // 1MB limit\n      toast({\n        title: t('fileTooLarge'),\n        description: t('selectImageUnder1MB'),\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (!file.type.startsWith('image/')) {\n      toast({\n        title: t('invalidFileType'),\n        description: t('selectImageFile'),\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsUploading(true);\n    const reader = new FileReader();\n    \n    reader.onload = (e) => {\n      const dataUrl = e.target?.result as string;\n      setProfilePicture(dataUrl);\n      setIsUploading(false);\n    };\n    \n    reader.onerror = () => {\n      toast({\n        title: t('uploadFailed'),\n        description: t('failedToReadImage'),\n        variant: \"destructive\",\n      });\n      setIsUploading(false);\n    };\n    \n    reader.readAsDataURL(file);\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    updateProfileMutation.mutate({\n      displayName,\n      profilePicture,\n    });\n  };\n\n  const removeProfilePicture = () => {\n    setProfilePicture('');\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"sm:max-w-[425px]\">\n        <DialogHeader>\n          <DialogTitle>{t('editProfile')}</DialogTitle>\n        </DialogHeader>\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          {/* Profile Picture Section */}\n          <div className=\"space-y-2\">\n            <Label>{t('profilePicture')}</Label>\n            <div className=\"flex items-center space-x-4\">\n              <div className=\"relative\">\n                {profilePicture ? (\n                  <div className=\"relative w-20 h-20 rounded-full overflow-hidden\">\n                    <img \n                      src={profilePicture} \n                      alt=\"Profile\" \n                      className=\"w-full h-full object-cover\"\n                    />\n                    <button\n                      type=\"button\"\n                      onClick={removeProfilePicture}\n                      className=\"absolute top-0 right-0 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600\"\n                    >\n                      <X className=\"w-3 h-3\" />\n                    </button>\n                  </div>\n                ) : (\n                  <div className=\"w-20 h-20 bg-gray-200 dark:bg-gray-700 rounded-full flex items-center justify-center\">\n                    <User className=\"w-10 h-10 text-gray-400\" />\n                  </div>\n                )}\n              </div>\n              <div className=\"flex-1\">\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  accept=\"image/*\"\n                  onChange={handleImageUpload}\n                  className=\"hidden\"\n                />\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={() => fileInputRef.current?.click()}\n                  disabled={isUploading}\n                >\n                  <Upload className=\"w-4 h-4 mr-2\" />\n                  {isUploading ? t('uploading') : t('uploadPhoto')}\n                </Button>\n              </div>\n            </div>\n          </div>\n\n          {/* Display Name */}\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"displayName\">{t('displayName')}</Label>\n            <Input\n              id=\"displayName\"\n              value={displayName}\n              onChange={(e) => setDisplayName(e.target.value)}\n              placeholder={t('enterDisplayName')}\n            />\n          </div>\n\n          {/* Username (read-only) */}\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"username\">{t('username')}</Label>\n            <Input\n              id=\"username\"\n              value={user?.username || ''}\n              disabled\n              className=\"bg-gray-100 dark:bg-gray-800\"\n            />\n          </div>\n\n          <div className=\"flex justify-end space-x-2 pt-4\">\n            <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n              {t('cancel')}\n            </Button>\n            <Button \n              type=\"submit\" \n              disabled={updateProfileMutation.isPending}\n            >\n              {updateProfileMutation.isPending ? t('saving') : t('saveChanges')}\n            </Button>\n          </div>\n        </form>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":7036},"client/src/components/ProfilePictureUpload.tsx":{"content":"import { useState } from \"react\";\nimport { ref, uploadBytes, getDownloadURL } from \"firebase/storage\";\nimport { updateProfile } from \"firebase/auth\";\nimport { storage } from \"@/lib/firebase\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Upload, Camera } from \"lucide-react\";\n\ninterface ProfilePictureUploadProps {\n  user: any;\n}\n\nexport function ProfilePictureUpload({ user }: ProfilePictureUploadProps) {\n  const [uploading, setUploading] = useState(false);\n  const { toast } = useToast();\n\n  const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file || !user) return;\n\n    // Check file size (max 1MB)\n    if (file.size > 1 * 1024 * 1024) {\n      toast({\n        title: \"File too large\",\n        description: \"Please select an image smaller than 1MB\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    // Check file type\n    if (!file.type.startsWith('image/')) {\n      toast({\n        title: \"Invalid file type\",\n        description: \"Please select an image file\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    try {\n      setUploading(true);\n      \n      // Create a storage reference\n      const storageRef = ref(storage, `profile-pictures/${user.uid}`);\n      \n      // Upload the file\n      await uploadBytes(storageRef, file);\n      \n      // Get the download URL\n      const downloadURL = await getDownloadURL(storageRef);\n      \n      // Update the user's profile\n      await updateProfile(user, {\n        photoURL: downloadURL,\n      });\n      \n      toast({\n        title: \"Profile picture updated\",\n        description: \"Your profile picture has been successfully updated\",\n      });\n      \n    } catch (error) {\n      console.error(\"Error uploading profile picture:\", error);\n      toast({\n        title: \"Upload failed\",\n        description: \"Failed to upload profile picture. Please try again.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col items-center space-y-4\">\n      <Avatar className=\"w-24 h-24\">\n        <AvatarImage src={user?.photoURL || \"\"} alt={user?.displayName || \"Profile\"} />\n        <AvatarFallback className=\"bg-primary text-primary-foreground text-xl\">\n          {user?.displayName?.charAt(0).toUpperCase() || user?.email?.charAt(0).toUpperCase() || \"U\"}\n        </AvatarFallback>\n      </Avatar>\n      \n      <div className=\"flex flex-col items-center space-y-2\">\n        <Input\n          type=\"file\"\n          accept=\"image/*\"\n          onChange={handleFileUpload}\n          disabled={uploading}\n          className=\"hidden\"\n          id=\"profile-picture-upload\"\n        />\n        <label htmlFor=\"profile-picture-upload\">\n          <Button\n            variant=\"outline\"\n            disabled={uploading}\n            className=\"cursor-pointer\"\n            asChild\n          >\n            <span className=\"flex items-center space-x-2\">\n              {uploading ? (\n                <>\n                  <Upload className=\"w-4 h-4 animate-spin\" />\n                  <span>Uploading...</span>\n                </>\n              ) : (\n                <>\n                  <Camera className=\"w-4 h-4\" />\n                  <span>Change Picture</span>\n                </>\n              )}\n            </span>\n          </Button>\n        </label>\n        <p className=\"text-sm text-muted-foreground\">\n          Max size: 1MB. Formats: JPG, PNG, GIF\n        </p>\n      </div>\n    </div>\n  );\n}","size_bytes":3715},"client/src/components/QuickChatPanel.tsx":{"content":"import React from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { useLanguage } from '@/contexts/LanguageContext';\nimport { translations } from '@/lib/i18n';\n\ninterface QuickChatPanelProps {\n  onMessageClick: (message: string) => void;\n  onClose: () => void;\n  isOpen: boolean;\n}\n\nconst QUICK_CHAT_KEYS = [\n  'goodLuck',\n  'wellPlayed',\n  'niceMove',\n  'greatStrategy',\n  'playFaster',\n  'takeYourTime',\n  'goodGame',\n  'thanksForGame',\n  'oneMore',\n  'impressive',\n  'thinking',\n  'readyToPlay'\n] as const;\n\nexport function QuickChatPanel({ onMessageClick, onClose, isOpen }: QuickChatPanelProps) {\n  const { language } = useLanguage();\n\n  return (\n    <AnimatePresence>\n      {isOpen && (\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          exit={{ opacity: 0, y: 20 }}\n          transition={{ duration: 0.2 }}\n          className=\"absolute bottom-16 left-1/2 transform -translate-x-1/2 z-50\"\n        >\n          <Card className=\"bg-white/95 dark:bg-gray-800/95 backdrop-blur-sm border shadow-lg max-w-xs\">\n            <CardContent className=\"p-3\">\n              <div className=\"grid grid-cols-1 gap-2 max-h-48 overflow-y-auto\">\n                {QUICK_CHAT_KEYS.map((key, index) => {\n                  const messageText = translations[key]?.[language] || key;\n                  return (\n                    <Button\n                      key={index}\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => onMessageClick(messageText)}\n                      className=\"h-8 text-xs justify-start hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors\"\n                      title={`Send: ${messageText}`}\n                    >\n                      <motion.span\n                        whileHover={{ scale: 1.05 }}\n                        whileTap={{ scale: 0.95 }}\n                        className=\"truncate\"\n                      >\n                        {messageText}\n                      </motion.span>\n                    </Button>\n                  );\n                })}\n              </div>\n              <div className=\"mt-2 pt-2 border-t\">\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={onClose}\n                  className=\"w-full text-xs text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200\"\n                >\n                  {translations.close[language]}\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n}","size_bytes":2766},"client/src/components/RoomManager.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation, useQueryClient, useQuery } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport { Plus, LogOut, Play, UserPlus } from \"lucide-react\";\nimport { InviteFriendsModal } from \"./InviteFriendsModal\";\nimport { useTranslation } from \"@/contexts/LanguageContext\";\n\ninterface RoomManagerProps {\n  currentRoom: any;\n  onRoomJoin: (room: any) => void;\n  onRoomLeave: () => void;\n  onCreateRoom: () => void;\n  onGameStart: (game: any) => void;\n  gameMode: 'ai' | 'pass-play' | 'online';\n  user: any;\n}\n\nexport function RoomManager({ \n  currentRoom, \n  onRoomJoin, \n  onRoomLeave, \n  onCreateRoom, \n  onGameStart,\n  gameMode,\n  user \n}: RoomManagerProps) {\n  const { t } = useTranslation();\n  const [joinCode, setJoinCode] = useState(\"\");\n  const [showInviteModal, setShowInviteModal] = useState(false);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // Fetch participants for the current room - reuse the same query key to share cache\n  const { data: participants = [] } = useQuery({\n    queryKey: [\"/api/rooms\", currentRoom?.id, \"participants\"], // Use same key as PlayerList\n    enabled: !!currentRoom,\n    staleTime: 8000, // Consider data fresh for 8 seconds\n    refetchOnWindowFocus: false, // Prevent refetch on window focus\n    refetchOnMount: false, // Only refetch if data is stale\n    refetchInterval: false, // Don't poll here, let PlayerList handle it\n  });\n\n  const joinRoomMutation = useMutation({\n    mutationFn: async (data: { code: string, role: 'player' | 'spectator' }) => {\n      const response = await apiRequest(`/api/rooms/${data.code}/join`, { method: 'POST', body: { role: data.role } });\n      return response.json();\n    },\n    onSuccess: (data) => {\n      onRoomJoin(data.room);\n      setJoinCode(\"\");\n      toast({\n        title: t('success'),\n        description: t('joinedRoomSuccessfully'),\n      });\n    },\n    onError: (error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: t('unauthorized'),\n          description: t('loggedOutLoggingIn'),\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      \n      // Handle insufficient coins error\n      if (error.status === 403 && error.message?.includes('coins')) {\n        toast({\n          title: 'üí∞ Insufficient Coins',\n          description: error.message || 'You need 100 coins to join as a player. Win AI games to earn coins! You can still join as a spectator.',\n          variant: \"destructive\",\n        });\n        return;\n      }\n      \n      toast({\n        title: t('error'),\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const startGameMutation = useMutation({\n    mutationFn: async () => {\n      if (!currentRoom) throw new Error('No room selected');\n      \n      const response = await apiRequest(`/api/rooms/${currentRoom.id}/start-game`, { method: 'POST', body: {} });\n      return response.json();\n    },\n    onSuccess: (game) => {\n      // Game started successfully\n      onGameStart(game);\n      toast({\n        title: t('gameStarted'),\n        description: t('letTheBattleBegin'),\n      });\n    },\n    onError: (error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: t('unauthorized'),\n          description: t('loggedOutLoggingIn'),\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: t('error'),\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleJoinRoom = (role: 'player' | 'spectator' = 'player') => {\n    if (joinCode.trim()) {\n      joinRoomMutation.mutate({ \n        code: joinCode.trim().toUpperCase(), \n        role \n      });\n    }\n  };\n\n  const handleLeaveRoom = () => {\n    onRoomLeave();\n    toast({\n      title: t('leftRoom'),\n      description: t('youHaveLeftTheRoom'),\n    });\n  };\n\n  return (\n    <Card className=\"bg-slate-800 border-slate-700\">\n      <CardHeader>\n        <CardTitle className=\"text-lg\">{t('roomManagement')}</CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        {!currentRoom ? (\n          <>\n            {/* Join Room */}\n            <div className=\"space-y-2\">\n              <Input\n                placeholder={t('roomCode')}\n                value={joinCode}\n                onChange={(e) => setJoinCode(e.target.value.toUpperCase())}\n                className=\"bg-slate-700 border-slate-600 text-white\"\n                maxLength={8}\n              />\n              <div className=\"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2\">\n                <Button \n                  onClick={() => handleJoinRoom('player')}\n                  disabled={!joinCode.trim() || joinRoomMutation.isPending}\n                  className=\"w-full sm:flex-1 bg-green-600 hover:bg-green-700\"\n                >\n                  {t('joinAsPlayer')}\n                </Button>\n                <Button \n                  onClick={() => handleJoinRoom('spectator')}\n                  disabled={!joinCode.trim() || joinRoomMutation.isPending}\n                  className=\"w-full sm:flex-1 bg-blue-600 hover:bg-blue-700\"\n                >\n                  {t('joinAsSpectator')}\n                </Button>\n              </div>\n            </div>\n            \n            {/* Create Room */}\n            <Button \n              onClick={onCreateRoom}\n              className=\"w-full bg-purple-600 hover:bg-purple-700\"\n              disabled={joinRoomMutation.isPending}\n            >\n              <Plus className=\"w-4 h-4 mr-2\" />\n              {t('createNewRoom')}\n            </Button>\n          </>\n        ) : (\n          <>\n            {/* Current Room */}\n            <div className=\"p-3 bg-slate-700 rounded-lg\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <span className=\"font-medium\">{t('currentRoom')}</span>\n                <Badge variant=\"secondary\" className={`${\n                  currentRoom.status === 'playing' ? 'bg-orange-600' : \n                  currentRoom.status === 'waiting' ? 'bg-green-600' : 'bg-gray-600'\n                }`}>\n                  {currentRoom.status === 'playing' ? t('playing') : \n                   currentRoom.status === 'waiting' ? t('waiting') : t('active')}\n                </Badge>\n              </div>\n              <div className=\"text-sm text-gray-400\">\n                {t('room')} #{currentRoom.code}\n              </div>\n              <div className=\"text-sm text-gray-400\">\n                {currentRoom.name}\n              </div>\n            </div>\n\n            {/* Room Actions */}\n            <div className=\"space-y-2\">\n              {/* Main action buttons */}\n              <div className=\"flex space-x-2\">\n                {/* Check if user is the room creator */}\n                {currentRoom.ownerId === (user?.userId || user?.id) ? (\n                  <Button\n                    onClick={() => {\n                      // Start game button clicked\n                      startGameMutation.mutate();\n                    }}\n                    disabled={startGameMutation.isPending || currentRoom.status === 'playing'}\n                    className=\"flex-1 bg-primary hover:bg-primary/90\"\n                  >\n                    <Play className=\"w-4 h-4 mr-2\" />\n                    {startGameMutation.isPending ? t('starting') : \n                     currentRoom.status === 'playing' ? t('gameRunning') : t('startGame')}\n                  </Button>\n                ) : (\n                  <Button\n                    disabled\n                    className=\"flex-1 bg-gray-600 cursor-not-allowed\"\n                  >\n                    <Play className=\"w-4 h-4 mr-2\" />\n                    {currentRoom.status === 'playing' ? t('gameRunning') : t('waitForStart')}\n                  </Button>\n                )}\n                <Button\n                  variant=\"outline\"\n                  onClick={handleLeaveRoom}\n                  className=\"border-red-600 text-red-600 hover:bg-red-600 hover:text-white\"\n                >\n                  <LogOut className=\"w-4 h-4\" />\n                </Button>\n              </div>\n              \n              {/* Invite friends button (only for room owner and when not playing) */}\n              {currentRoom.ownerId === (user?.userId || user?.id) && currentRoom.status !== 'playing' && (\n                <Button\n                  onClick={() => setShowInviteModal(true)}\n                  variant=\"outline\"\n                  className=\"w-full border-blue-500 text-blue-500 hover:bg-blue-500 hover:text-white\"\n                >\n                  <UserPlus className=\"w-4 h-4 mr-2\" />\n                  {t('inviteFriends')}\n                </Button>\n              )}\n            </div>\n          </>\n        )}\n      </CardContent>\n      \n      {/* Invite Friends Modal */}\n      {currentRoom && (\n        <InviteFriendsModal\n          open={showInviteModal}\n          onClose={() => setShowInviteModal(false)}\n          roomId={currentRoom.id}\n          roomName={currentRoom.name}\n        />\n      )}\n    </Card>\n  );\n}\n","size_bytes":9657},"client/src/components/ShareButton.tsx":{"content":"import { useState } from 'react';\nimport { Share2, Facebook, Twitter, MessageCircle, Copy, Check, Smartphone } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n  DropdownMenuSeparator,\n} from '@/components/ui/dropdown-menu';\nimport { useToast } from '@/hooks/use-toast';\nimport { getShareUrl, getShareText, shareConfig } from '@/lib/shareConfig';\n\ninterface ShareButtonProps {\n  title?: string;\n  text?: string;\n  url?: string;\n  variant?: 'default' | 'outline' | 'ghost';\n  size?: 'default' | 'sm' | 'lg';\n  className?: string;\n  preferPlayStore?: boolean; // Whether to prefer Play Store link when available\n}\n\nexport function ShareButton({ \n  title,\n  text,\n  url,\n  variant = \"outline\",\n  size = \"default\",\n  className = \"\",\n  preferPlayStore = true\n}: ShareButtonProps) {\n  const [copied, setCopied] = useState(false);\n  const { toast } = useToast();\n  \n  // Get dynamic URL and text based on environment\n  const dynamicUrl = url || getShareUrl(preferPlayStore);\n  const dynamicText = text || getShareText(dynamicUrl);\n  const dynamicTitle = title || shareConfig.appName;\n  \n  const encodedUrl = encodeURIComponent(dynamicUrl);\n  const encodedTitle = encodeURIComponent(dynamicTitle);\n  const encodedText = encodeURIComponent(dynamicText);\n\n  const shareLinks = {\n    facebook: `https://www.facebook.com/sharer/sharer.php?u=${encodedUrl}&quote=${encodedText}`,\n    twitter: `https://twitter.com/intent/tweet?text=${encodedText}&url=${encodedUrl}`,\n    whatsapp: `https://wa.me/?text=${encodedText}%20${encodedUrl}`,\n  };\n\n  const handleCopyLink = async (urlToCopy: string = dynamicUrl) => {\n    try {\n      await navigator.clipboard.writeText(urlToCopy);\n      setCopied(true);\n      const isPlayStore = urlToCopy === shareConfig.playStoreUrl;\n      toast({\n        title: \"Link copied!\",\n        description: isPlayStore \n          ? \"Play Store link copied to clipboard\" \n          : \"Share link copied to clipboard\",\n      });\n      setTimeout(() => setCopied(false), 2000);\n    } catch (err) {\n      toast({\n        title: \"Failed to copy\",\n        description: \"Could not copy link to clipboard\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleShare = (platform: string) => {\n    window.open(shareLinks[platform as keyof typeof shareLinks], '_blank', 'width=600,height=400');\n  };\n\n  const handleNativeShare = async () => {\n    if (navigator.share) {\n      try {\n        await navigator.share({\n          title: dynamicTitle,\n          text: dynamicText,\n          url: dynamicUrl,\n        });\n      } catch (err) {\n        // User cancelled or share failed, fallback to dropdown\n        console.log('Native share cancelled or failed');\n      }\n    }\n  };\n\n  // Check if native sharing is available\n  const hasNativeShare = navigator.share && navigator.canShare && navigator.canShare({ \n    title: dynamicTitle, \n    text: dynamicText, \n    url: dynamicUrl \n  });\n\n  if (hasNativeShare) {\n    return (\n      <Button\n        variant={variant}\n        size={size}\n        onClick={handleNativeShare}\n        className={className}\n      >\n        <Share2 className=\"h-4 w-4 mr-2\" />\n        Share\n      </Button>\n    );\n  }\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <Button variant={variant} size={size} className={className}>\n          <Share2 className=\"h-4 w-4 mr-2\" />\n          Share\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent align=\"end\" className=\"w-52\">\n        <DropdownMenuItem onClick={() => handleShare('facebook')}>\n          <Facebook className=\"h-4 w-4 mr-2 text-blue-600\" />\n          Share on Facebook\n        </DropdownMenuItem>\n        <DropdownMenuItem onClick={() => handleShare('twitter')}>\n          <Twitter className=\"h-4 w-4 mr-2 text-blue-400\" />\n          Share on Twitter\n        </DropdownMenuItem>\n        <DropdownMenuItem onClick={() => handleShare('whatsapp')}>\n          <MessageCircle className=\"h-4 w-4 mr-2 text-green-600\" />\n          Share on WhatsApp\n        </DropdownMenuItem>\n        \n        <DropdownMenuSeparator />\n        \n        {/* Current app link (Replit or production web) */}\n        <DropdownMenuItem onClick={() => handleCopyLink(getShareUrl(false))}>\n          {copied ? (\n            <Check className=\"h-4 w-4 mr-2 text-green-600\" />\n          ) : (\n            <Copy className=\"h-4 w-4 mr-2\" />\n          )}\n          Copy Web App Link\n        </DropdownMenuItem>\n        \n        {/* Play Store link (only show if configured) */}\n        {shareConfig.playStoreUrl && (\n          <DropdownMenuItem onClick={() => handleCopyLink(shareConfig.playStoreUrl!)}>\n            <Smartphone className=\"h-4 w-4 mr-2 text-green-700\" />\n            Copy Play Store Link\n          </DropdownMenuItem>\n        )}\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}","size_bytes":4918},"client/src/components/SimpleConfetti.tsx":{"content":"import React from 'react';\n\ninterface SimpleConfettiProps {\n  active: boolean;\n}\n\nexport function SimpleConfetti({ active }: SimpleConfettiProps) {\n  if (!active || typeof window === 'undefined') return null;\n\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        width: '100%',\n        height: '100%',\n        pointerEvents: 'none',\n        zIndex: 10000,\n        overflow: 'hidden'\n      }}\n    >\n      {/* Simple CSS-based confetti particles */}\n      {Array.from({ length: 50 }, (_, i) => (\n        <div\n          key={i}\n          style={{\n            position: 'absolute',\n            left: `${Math.random() * 100}%`,\n            top: '-10px',\n            width: '10px',\n            height: '10px',\n            backgroundColor: ['#ff6b6b', '#4ecdc4', '#45b7d1', '#f9ca24', '#f0932b', '#eb4d4b', '#6c5ce7', '#a29bfe'][Math.floor(Math.random() * 8)],\n            borderRadius: Math.random() > 0.5 ? '50%' : '0%',\n            animation: `fall ${2 + Math.random() * 3}s linear infinite`,\n            animationDelay: `${Math.random() * 2}s`,\n            transform: `rotate(${Math.random() * 360}deg)`\n          }}\n        />\n      ))}\n      \n      <style>{`\n        @keyframes fall {\n          0% {\n            transform: translateY(-100vh) rotate(0deg);\n            opacity: 1;\n          }\n          100% {\n            transform: translateY(100vh) rotate(360deg);\n            opacity: 0;\n          }\n        }\n      `}</style>\n    </div>\n  );\n}","size_bytes":1495},"client/src/components/SimpleModal.tsx":{"content":"interface SimpleModalProps {\n  open: boolean;\n  onClose: () => void;\n  children: any;\n}\n\nexport function SimpleModal({ open, onClose, children }: SimpleModalProps) {\n  if (!open) return null;\n\n  return (\n    <div \n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        backgroundColor: 'rgba(0, 0, 0, 0.85)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 9999,\n        padding: '16px'\n      }}\n      onClick={onClose}\n    >\n      <div \n        style={{\n          backgroundColor: '#1e293b',\n          borderRadius: '8px',\n          padding: '24px',\n          maxWidth: '400px',\n          width: '100%',\n          boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.25)',\n          border: '1px solid #475569'\n        }}\n        onClick={(e) => e.stopPropagation()}\n      >\n        {children}\n      </div>\n    </div>\n  );\n}","size_bytes":940},"client/src/components/ThemeSelector.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { useTheme, GameTheme } from '@/contexts/ThemeContext';\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Palette, Check, Lock, Star } from \"lucide-react\";\nimport { useQuery } from \"@tanstack/react-query\";\n\nexport function ThemeSelector() {\n  const { currentTheme, setTheme, themes } = useTheme();\n  const [open, setOpen] = useState(false);\n  \n  // Fetch theme unlocks from API\n  const { data: themeData } = useQuery({\n    queryKey: ['/api/themes'],\n    enabled: open,\n  });\n  \n  const isThemeUnlocked = (themeId: string) => {\n    // Default themes are always unlocked\n    const defaultThemes = ['default', 'neon', 'autumn', 'minimalist', 'nature', 'space'];\n    if (defaultThemes.includes(themeId)) return true;\n    \n    // Check if special theme is unlocked\n    const specialTheme = themeData?.specialThemes?.find((t: any) => t.id === themeId);\n    return specialTheme?.unlocked || false;\n  };\n  \n  const getUnlockRequirement = (themeId: string) => {\n    const requirements = {\n      halloween: 'Win 10 games in a row',\n      christmas: 'Win 20 games total',\n      summer: 'Play 100 games total'\n    };\n    return requirements[themeId as keyof typeof requirements] || '';\n  };\n\n  useEffect(() => {\n    const handleOpenThemeSelector = () => {\n      console.log('Theme selector opening...');\n      setOpen(true);\n    };\n\n    window.addEventListener('openThemeSelector', handleOpenThemeSelector);\n    return () => window.removeEventListener('openThemeSelector', handleOpenThemeSelector);\n  }, []);\n\n  const handleThemeSelect = (theme: GameTheme) => {\n    if (!isThemeUnlocked(theme)) return; // Don't allow selecting locked themes\n    \n    setTheme(theme);\n    setOpen(false);\n    // Close the header sidebar after theme selection\n    const closeEvent = new CustomEvent('closeHeaderSidebar');\n    window.dispatchEvent(closeEvent);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>Choose Your Theme</DialogTitle>\n        </DialogHeader>\n        <div className=\"space-y-6\">\n          {/* Default Themes */}\n          <div>\n            <h3 className=\"text-lg font-semibold mb-3 flex items-center gap-2\">\n              <Palette className=\"w-5 h-5\" />\n              Default Themes\n            </h3>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n              {Object.entries(themes).filter(([key]) => \n                ['default', 'neon', 'autumn', 'minimalist', 'nature', 'space'].includes(key)\n              ).map(([key, theme]) => (\n                <Card \n                  key={key} \n                  className={`cursor-pointer transition-all hover:scale-105 ${\n                    currentTheme === key ? 'ring-2 ring-blue-500' : ''\n                  }`}\n                  onClick={() => handleThemeSelect(key as GameTheme)}\n                >\n                  <CardHeader className=\"pb-2\">\n                    <CardTitle className=\"text-lg flex items-center justify-between\">\n                      {theme.name}\n                      {currentTheme === key && (\n                        <Badge variant=\"secondary\" className=\"gap-1\">\n                          <Check className=\"h-3 w-3\" />\n                          Active\n                        </Badge>\n                      )}\n                    </CardTitle>\n                    <p className=\"text-sm text-gray-600\">{theme.description}</p>\n                  </CardHeader>\n                  <CardContent>\n                    <div className={`p-4 rounded-lg ${theme.backgroundColor} ${theme.borderColor} border-2`}>\n                      <div className={`grid grid-cols-3 gap-1 ${theme.boardStyle} p-2 rounded`}>\n                        {Array.from({ length: 9 }, (_, i) => (\n                          <div\n                            key={i}\n                            className={`aspect-square ${theme.cellStyle} rounded text-xs flex items-center justify-center border`}\n                          >\n                            {i === 0 ? <span className={theme.playerXColor}>X</span> : \n                             i === 4 ? <span className={theme.playerOColor}>O</span> : ''}\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          </div>\n\n          {/* Special Themes */}\n          <div>\n            <h3 className=\"text-lg font-semibold mb-3 flex items-center gap-2\">\n              <Star className=\"w-5 h-5\" />\n              Special Themes\n            </h3>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n              {Object.entries(themes).filter(([key]) => \n                ['halloween', 'christmas', 'summer'].includes(key)\n              ).map(([key, theme]) => {\n                const unlocked = isThemeUnlocked(key);\n                const requirement = getUnlockRequirement(key);\n                \n                return (\n                  <Card \n                    key={key} \n                    className={`transition-all ${\n                      unlocked ? 'cursor-pointer hover:scale-105' : 'cursor-not-allowed opacity-60'\n                    } ${currentTheme === key ? 'ring-2 ring-blue-500' : ''}`}\n                    onClick={() => unlocked && handleThemeSelect(key as GameTheme)}\n                  >\n                    <CardHeader className=\"pb-2\">\n                      <CardTitle className=\"text-lg flex items-center justify-between\">\n                        <div className=\"flex items-center gap-2\">\n                          {theme.name}\n                          {!unlocked && <Lock className=\"h-4 w-4\" />}\n                        </div>\n                        {currentTheme === key && (\n                          <Badge variant=\"secondary\" className=\"gap-1\">\n                            <Check className=\"h-3 w-3\" />\n                            Active\n                          </Badge>\n                        )}\n                      </CardTitle>\n                      <p className=\"text-sm text-gray-600\">\n                        {unlocked ? theme.description : `üîí ${requirement}`}\n                      </p>\n                    </CardHeader>\n                    <CardContent>\n                      <div className={`p-4 rounded-lg ${theme.backgroundColor} ${theme.borderColor} border-2 ${!unlocked ? 'filter grayscale' : ''}`}>\n                        <div className={`grid grid-cols-3 gap-1 ${theme.boardStyle} p-2 rounded`}>\n                          {Array.from({ length: 9 }, (_, i) => (\n                            <div\n                              key={i}\n                              className={`aspect-square ${theme.cellStyle} rounded text-xs flex items-center justify-center border`}\n                            >\n                              {i === 0 ? <span className={theme.playerXColor}>X</span> : \n                               i === 4 ? <span className={theme.playerOColor}>O</span> : \n                               i === 8 ? <span className={theme.playerXColor}>X</span> : ''}\n                            </div>\n                          ))}\n                        </div>\n                        <div className={`mt-2 text-xs ${theme.textColor} text-center`}>\n                          {unlocked ? 'Preview' : 'Locked'}\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                );\n              })}\n            </div>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":7947},"client/src/components/UserProfileModal.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { X, Trophy, Target, Users, GamepadIcon, Zap, Flame } from 'lucide-react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { apiRequest } from '@/lib/queryClient';\n\ninterface UserProfileModalProps {\n  open: boolean;\n  onClose: () => void;\n  userId: string;\n  username: string;\n  displayName: string;\n  profilePicture?: string;\n  profileImageUrl?: string;\n}\n\ninterface OnlineGameStats {\n  wins: number;\n  losses: number;\n  draws: number;\n  totalGames: number;\n  currentWinStreak: number;\n  bestWinStreak: number;\n  level: number;\n  winsToNextLevel: number;\n  coins?: number;\n}\n\nexport function UserProfileModal({ \n  open, \n  onClose, \n  userId, \n  username, \n  displayName, \n  profilePicture, \n  profileImageUrl \n}: UserProfileModalProps) {\n  const [stats, setStats] = useState<OnlineGameStats | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (open && userId) {\n      fetchOnlineStats();\n    }\n  }, [open, userId]);\n\n  const fetchOnlineStats = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      console.log('Fetching online stats for user:', userId);\n      const response = await fetch(`/api/users/${userId}/online-stats`, {\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      \n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n      \n      const data = await response.json();\n      console.log('Online stats response:', data);\n      setStats(data);\n    } catch (err) {\n      setError('Failed to load player statistics');\n      console.error('Error fetching online stats:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getWinRate = () => {\n    if (!stats || stats.totalGames === 0) return 0;\n    return Math.round((stats.wins / stats.totalGames) * 100);\n  };\n\n  const profileImage = profileImageUrl || profilePicture;\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"sm:max-w-md max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-3\">\n            <div className=\"relative\">\n              {profileImage ? (\n                <img \n                  src={profileImage} \n                  alt={displayName}\n                  className=\"w-12 h-12 rounded-full object-cover\"\n                />\n              ) : (\n                <div className=\"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center\">\n                  <span className=\"text-white font-semibold text-lg\">\n                    {displayName.charAt(0).toUpperCase()}\n                  </span>\n                </div>\n              )}\n            </div>\n            <div>\n              <h2 className=\"text-xl font-bold\">{displayName}</h2>\n              <p className=\"text-sm text-muted-foreground\">@{username}</p>\n            </div>\n          </DialogTitle>\n        </DialogHeader>\n        \n        <div className=\"py-4\">\n          <div className=\"flex items-center gap-2 mb-4\">\n            <GamepadIcon className=\"w-5 h-5\" />\n            <h3 className=\"font-semibold\">Online Multiplayer Stats</h3>\n          </div>\n          \n          {loading ? (\n            <div className=\"text-center py-8\">\n              <div className=\"animate-spin w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full mx-auto\"></div>\n              <p className=\"text-sm text-muted-foreground mt-2\">Loading stats...</p>\n            </div>\n          ) : error ? (\n            <div className=\"text-center py-8\">\n              <p className=\"text-red-500 text-sm\">{error}</p>\n              <Button \n                onClick={fetchOnlineStats} \n                variant=\"outline\" \n                size=\"sm\" \n                className=\"mt-2\"\n              >\n                Try Again\n              </Button>\n            </div>\n          ) : stats ? (\n            <div className=\"space-y-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg text-center\">\n                  <div className=\"flex items-center justify-center gap-2 mb-2\">\n                    <Trophy className=\"w-5 h-5 text-green-600\" />\n                    <span className=\"text-sm font-medium text-green-600\">Wins</span>\n                  </div>\n                  <div className=\"text-2xl font-bold text-green-700 dark:text-green-400\">\n                    {stats.wins}\n                  </div>\n                </div>\n                \n                <div className=\"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg text-center\">\n                  <div className=\"flex items-center justify-center gap-2 mb-2\">\n                    <Target className=\"w-5 h-5 text-red-600\" />\n                    <span className=\"text-sm font-medium text-red-600\">Losses</span>\n                  </div>\n                  <div className=\"text-2xl font-bold text-red-700 dark:text-red-400\">\n                    {stats.losses}\n                  </div>\n                </div>\n              </div>\n              \n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg text-center\">\n                  <div className=\"flex items-center justify-center gap-2 mb-2\">\n                    <Users className=\"w-5 h-5 text-yellow-600\" />\n                    <span className=\"text-sm font-medium text-yellow-600\">Draws</span>\n                  </div>\n                  <div className=\"text-2xl font-bold text-yellow-700 dark:text-yellow-400\">\n                    {stats.draws}\n                  </div>\n                </div>\n                \n                <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg text-center\">\n                  <div className=\"flex items-center justify-center gap-2 mb-2\">\n                    <GamepadIcon className=\"w-5 h-5 text-blue-600\" />\n                    <span className=\"text-sm font-medium text-blue-600\">Total Games</span>\n                  </div>\n                  <div className=\"text-2xl font-bold text-blue-700 dark:text-blue-400\">\n                    {stats.totalGames}\n                  </div>\n                </div>\n              </div>\n              \n              {/* Streak and Coins Information */}\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"bg-orange-50 dark:bg-orange-900/20 p-4 rounded-lg text-center\">\n                  <div className=\"flex items-center justify-center gap-2 mb-2\">\n                    <Zap className=\"w-5 h-5 text-orange-600\" />\n                    <span className=\"text-sm font-medium text-orange-600\">Current Streak</span>\n                  </div>\n                  <div className=\"text-2xl font-bold text-orange-700 dark:text-orange-400\">\n                    {stats.currentWinStreak || 0}\n                  </div>\n                </div>\n                \n                <div className=\"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg text-center\">\n                  <div className=\"flex items-center justify-center gap-2 mb-2\">\n                    <Flame className=\"w-5 h-5 text-purple-600\" />\n                    <span className=\"text-sm font-medium text-purple-600\">Best Streak</span>\n                  </div>\n                  <div className=\"text-2xl font-bold text-purple-700 dark:text-purple-400\">\n                    {stats.bestWinStreak || 0}\n                  </div>\n                </div>\n              </div>\n\n              {/* Level */}\n              <div className=\"bg-gradient-to-r from-amber-50 to-yellow-50 dark:from-amber-900/20 dark:to-yellow-900/20 p-4 rounded-lg\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"text-2xl\">üèÜ</span>\n                    <span className=\"text-sm font-medium text-amber-700 dark:text-amber-400\">Level</span>\n                  </div>\n                  <span className=\"text-2xl font-bold text-amber-700 dark:text-amber-400\">\n                    {stats.level}\n                  </span>\n                </div>\n                <div className=\"text-xs text-amber-600 dark:text-amber-500\">\n                  {stats.winsToNextLevel} wins to next level\n                </div>\n                <div className=\"w-full bg-amber-200 dark:bg-amber-800 rounded-full h-2 mt-2\">\n                  <div \n                    className=\"bg-gradient-to-r from-amber-500 to-yellow-500 h-2 rounded-full transition-all duration-300\"\n                    style={{ width: `${((60 - stats.winsToNextLevel) / 60) * 100}%` }}\n                  />\n                </div>\n              </div>\n\n              {/* Coins */}\n              <div className=\"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-4 rounded-lg\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"text-2xl\">üí∞</span>\n                    <span className=\"text-sm font-medium text-green-700 dark:text-green-400\">Coins</span>\n                  </div>\n                  <span className=\"text-2xl font-bold text-green-700 dark:text-green-400\">\n                    {stats.coins ?? 1000}\n                  </span>\n                </div>\n              </div>\n              \n              {stats.totalGames > 0 && (\n                <div className=\"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 p-4 rounded-lg\">\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-sm font-medium\">Win Rate</span>\n                    <span className=\"text-2xl font-bold text-purple-700 dark:text-purple-400\">\n                      {getWinRate()}%\n                    </span>\n                  </div>\n                  <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 mt-2\">\n                    <div \n                      className=\"bg-gradient-to-r from-purple-500 to-pink-500 h-2 rounded-full transition-all duration-300\"\n                      style={{ width: `${getWinRate()}%` }}\n                    />\n                  </div>\n                </div>\n              )}\n              \n              {stats.totalGames === 0 && (\n                <div className=\"text-center py-6 bg-gray-50 dark:bg-gray-800 rounded-lg\">\n                  <GamepadIcon className=\"w-12 h-12 text-gray-400 mx-auto mb-2\" />\n                  <p className=\"text-gray-600 dark:text-gray-400 font-medium\">\n                    No online games played yet\n                  </p>\n                  <p className=\"text-sm text-gray-500 dark:text-gray-500\">\n                    Statistics will appear after playing online multiplayer games\n                  </p>\n                </div>\n              )}\n            </div>\n          ) : null}\n        </div>\n        \n        <div className=\"flex justify-end\">\n          <Button onClick={onClose} variant=\"outline\">\n            Close\n          </Button>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":11427},"client/src/contexts/ChatContext.tsx":{"content":"import React, { createContext, useContext, useState, useEffect, ReactNode, useCallback } from 'react';\nimport { ChatPopup } from '@/components/ChatPopup';\nimport { useOnlineStatus } from '@/hooks/useOnlineStatus';\n\ninterface ChatMessage {\n  senderId: string;\n  senderName: string;\n  message: string;\n  timestamp: string;\n}\n\ninterface ActiveChat {\n  id: string;\n  sender: { userId: string; displayName: string };\n  initialMessage: string;\n  isOpen: boolean;\n}\n\ninterface ChatContextType {\n  showChatPopup: (sender: { userId: string; displayName: string; username?: string }, message: string) => void;\n  closeChatPopup: (chatId: string) => void;\n  activeChats: ActiveChat[];\n}\n\nconst ChatContext = createContext<ChatContextType | undefined>(undefined);\n\nexport const useChatContext = () => {\n  const context = useContext(ChatContext);\n  if (!context) {\n    throw new Error('useChatContext must be used within a ChatProvider');\n  }\n  return context;\n};\n\ninterface ChatProviderProps {\n  children: ReactNode;\n  currentUser: any;\n}\n\nexport function ChatProvider({ children, currentUser }: ChatProviderProps) {\n  //console.log('üì® ChatProvider: Initializing with currentUser:', currentUser);\n  \n  const { isOnline } = useOnlineStatus();\n  const [activeChats, setActiveChats] = useState<ActiveChat[]>([]);\n  const [isMobile, setIsMobile] = useState(false);\n  \n  // Detect mobile screen size\n  useEffect(() => {\n    const checkIsMobile = () => {\n      setIsMobile(window.innerWidth < 768);\n    };\n    \n    checkIsMobile();\n    window.addEventListener('resize', checkIsMobile);\n    \n    return () => window.removeEventListener('resize', checkIsMobile);\n  }, []);\n\n  const showChatPopup = useCallback((sender: { userId: string; displayName: string; username?: string }, message: string) => {\n    //console.log('üì® ChatContext: showChatPopup called with sender:', sender, 'message:', message);\n    \n    // Check if we already have a chat open with this user\n    setActiveChats(prev => {\n      const existingChatIndex = prev.findIndex(chat => chat.sender.userId === sender.userId);\n      \n      if (existingChatIndex >= 0) {\n        // For existing chats, create a new chat instance to force re-render with new message\n        const updated = [...prev];\n        const existingChat = updated[existingChatIndex];\n        \n        // Remove the old chat and add a new one with the new message\n        updated.splice(existingChatIndex, 1);\n        \n        const newChat: ActiveChat = {\n          id: `chat-${sender.userId}-${Date.now()}`, // New ID to force re-mount\n          sender,\n          initialMessage: message,\n          isOpen: true\n        };\n        \n        return [...updated, newChat];\n      } else {\n        // Create new chat\n        const newChat: ActiveChat = {\n          id: `chat-${sender.userId}-${Date.now()}`,\n          sender,\n          initialMessage: message,\n          isOpen: true\n        };\n        \n        return [...prev, newChat];\n      }\n    });\n    \n    //console.log('üì® ChatContext: Chat popups updated');\n  }, []);\n\n  // Listen for incoming chat messages and user offline events\n  useEffect(() => {\n    //console.log('üì® ChatProvider: useEffect initializing - currentUser:', currentUser);\n    \n    const handleChatMessage = (event: CustomEvent) => {\n      //console.log('üì® ChatContext: Event listener triggered with event:', event);\n      const data = event.detail;\n      console.log('üì® ChatContext: Event detail:', data);\n      \n      if (data && data.type === 'chat_message_received') {\n        //console.log('üì® ChatContext: Processing chat message:', data.message);\n        const sender = {\n          userId: data.message.senderId,\n          displayName: data.message.senderDisplayName || data.message.senderName,\n          username: data.message.senderDisplayName || data.message.senderName\n        };\n        \n        //console.log('üì® ChatContext: Calling showChatPopup with sender:', sender, 'message:', data.message.message);\n        // Show popup with the new message\n        showChatPopup(sender, data.message.message);\n      } else {\n        //console.log('üì® ChatContext: Event data is not chat_message_received type:', data);\n      }\n    };\n    \n    const handleUserOffline = (event: CustomEvent) => {\n      const data = event.detail;\n      //console.log('üì® ChatContext: User offline event:', data);\n      \n      if (data && data.type === 'user_offline' && data.userId) {\n        // Clear chat popups for the offline user\n        setActiveChats(prev => prev.filter(chat => chat.sender.userId !== data.userId));\n        //console.log(`üì® ChatContext: Cleared chat history for offline user: ${data.userId}`);\n      }\n    };\n\n    //console.log('üì® ChatContext: Setting up event listeners for chat_message_received and user_offline');\n    // Listen for WebSocket messages\n    window.addEventListener('chat_message_received', handleChatMessage as EventListener);\n    window.addEventListener('user_offline', handleUserOffline as EventListener);\n    \n    return () => {\n      console.log('üì® ChatContext: Removing event listeners');\n      window.removeEventListener('chat_message_received', handleChatMessage as EventListener);\n      window.removeEventListener('user_offline', handleUserOffline as EventListener);\n    };\n  }, [showChatPopup]);\n\n  // Add test function for debugging\n  (window as any).testChatPopup = () => {\n    console.log('üß™ Testing chat popup directly');\n    showChatPopup(\n      { userId: 'test123', displayName: 'Test User', username: 'testuser' },\n      'Test message from test function'\n    );\n  };\n\n  const closeChatPopup = (chatId: string) => {\n    setActiveChats(prev => prev.filter(chat => chat.id !== chatId));\n  };\n\n  return (\n    <ChatContext.Provider value={{ showChatPopup, closeChatPopup, activeChats }}>\n      {children}\n      {activeChats.map((chat, index) => (\n        <div\n          key={chat.id}\n          className={`fixed transition-all duration-300 ${\n            isMobile \n              ? 'left-4 right-4' // Full width on mobile with margin\n              : '' // Let desktop use style positioning\n          }`}\n          style={{\n            zIndex: 1000 + index,\n            ...(isMobile ? {\n              bottom: `${20 + index * 200}px`, // Stack vertically on mobile\n            } : {\n              bottom: '20px',\n              right: `${20 + index * 320}px` // Stack horizontally on desktop\n            })\n          }}\n        >\n          <ChatPopup\n            isOpen={chat.isOpen}\n            onClose={() => closeChatPopup(chat.id)}\n            currentUser={currentUser}\n            initialSender={chat.sender}\n            initialMessage={chat.initialMessage}\n          />\n        </div>\n      ))}\n    </ChatContext.Provider>\n  );\n}","size_bytes":6744},"client/src/contexts/LanguageContext.tsx":{"content":"import React, { createContext, useContext, useState, useEffect } from 'react';\nimport { Language, getCurrentLanguage, setCurrentLanguage, initializeLanguage, translations, TranslationKey } from '@/lib/i18n';\n\ninterface LanguageContextType {\n  language: Language;\n  setLanguage: (lang: Language) => void;\n  isRTL: boolean;\n}\n\nconst LanguageContext = createContext<LanguageContextType | undefined>(undefined);\n\nexport function LanguageProvider({ children }: { children: React.ReactNode }) {\n  const [language, setLanguageState] = useState<Language>(() => getCurrentLanguage());\n  const [isRTL, setIsRTL] = useState(false);\n\n  useEffect(() => {\n    initializeLanguage();\n    const lang = getCurrentLanguage();\n    setLanguageState(lang);\n    setIsRTL(lang === 'ar');\n    \n    // Apply RTL/LTR on initial load\n    if (lang === 'ar') {\n      document.documentElement.setAttribute('dir', 'rtl');\n      document.documentElement.classList.add('rtl');\n    } else {\n      document.documentElement.setAttribute('dir', 'ltr');\n      document.documentElement.classList.remove('rtl');\n    }\n  }, []);\n\n  const setLanguage = (lang: Language) => {\n    setCurrentLanguage(lang);\n    setLanguageState(lang);\n    setIsRTL(lang === 'ar');\n    \n    // Apply RTL/LTR changes immediately without reload\n    if (lang === 'ar') {\n      document.documentElement.setAttribute('dir', 'rtl');\n      document.documentElement.classList.add('rtl');\n    } else {\n      document.documentElement.setAttribute('dir', 'ltr');\n      document.documentElement.classList.remove('rtl');\n    }\n  };\n\n  return (\n    <LanguageContext.Provider value={{ language, setLanguage, isRTL }}>\n      {children}\n    </LanguageContext.Provider>\n  );\n}\n\nexport function useLanguage() {\n  const context = useContext(LanguageContext);\n  if (context === undefined) {\n    throw new Error('useLanguage must be used within a LanguageProvider');\n  }\n  return context;\n}\n\n// Custom hook for getting translations\nexport function useTranslation() {\n  const { language } = useLanguage();\n  \n  return {\n    t: (key: TranslationKey, variables?: Record<string, string>) => {\n      let translation = translations[key]?.[language] || translations[key]?.en || key;\n      \n      // Replace variables in the translation\n      if (variables) {\n        Object.entries(variables).forEach(([varKey, value]) => {\n          translation = translation.replace(new RegExp(`{${varKey}}`, 'g'), value);\n        });\n      }\n      \n      return translation;\n    },\n    language\n  };\n}","size_bytes":2495},"client/src/contexts/ThemeContext.tsx":{"content":"import React, { createContext, useContext, useState, useEffect } from 'react';\n\nexport type GameTheme = 'default' | 'neon' | 'autumn' | 'minimalist' | 'nature' | 'space' | 'halloween' | 'christmas' | 'summer';\n\ninterface ThemeContextType {\n  currentTheme: GameTheme;\n  setTheme: (theme: GameTheme) => void;\n  themes: Record<GameTheme, {\n    name: string;\n    description: string;\n    boardStyle: string;\n    cellStyle: string;\n    cellHoverStyle: string;\n    playerXColor: string;\n    playerOColor: string;\n    backgroundColor: string;\n    textColor: string;\n    borderColor: string;\n    winningCellStyle: string;\n  }>;\n}\n\nconst themes = {\n  default: {\n    name: 'Default',\n    description: 'Classic dark theme',\n    boardStyle: 'bg-slate-800 border-slate-700',\n    cellStyle: 'bg-slate-700 border-slate-600 text-white hover:bg-slate-600',\n    cellHoverStyle: 'hover:bg-slate-600',\n    playerXColor: 'text-blue-400',\n    playerOColor: 'text-red-400',\n    backgroundColor: 'bg-slate-900',\n    textColor: 'text-white',\n    borderColor: 'border-slate-700',\n    winningCellStyle: 'bg-gradient-to-br from-yellow-400 to-orange-500 shadow-lg shadow-yellow-400/50'\n  },\n  neon: {\n    name: 'Neon',\n    description: 'Cyberpunk neon glow',\n    boardStyle: 'bg-black border-cyan-500 shadow-lg shadow-cyan-500/20',\n    cellStyle: 'bg-gray-900 border-cyan-400 text-cyan-300 hover:bg-cyan-900/30 hover:border-cyan-300 hover:shadow-cyan-400/50',\n    cellHoverStyle: 'hover:bg-cyan-900/30 hover:border-cyan-300 hover:shadow-cyan-400/50',\n    playerXColor: 'text-cyan-400 drop-shadow-[0_0_8px_rgba(34,211,238,0.8)]',\n    playerOColor: 'text-pink-400 drop-shadow-[0_0_8px_rgba(244,114,182,0.8)]',\n    backgroundColor: 'bg-black',\n    textColor: 'text-cyan-300',\n    borderColor: 'border-cyan-500',\n    winningCellStyle: 'bg-gradient-to-br from-cyan-400 to-pink-500 shadow-lg shadow-cyan-400/50 border-cyan-300'\n  },\n  autumn: {\n    name: 'Autumn',\n    description: 'Warm autumn colors theme',\n    boardStyle: 'bg-gradient-to-br from-orange-100 to-amber-100 border-orange-300 shadow-lg shadow-orange-200/50',\n    cellStyle: 'bg-gradient-to-br from-orange-50 to-amber-50 border-orange-200 text-orange-900 hover:from-orange-100 hover:to-amber-100 transition-all duration-300',\n    cellHoverStyle: 'hover:from-orange-100 hover:to-amber-100 transition-all duration-300',\n    playerXColor: 'text-red-700 font-semibold',\n    playerOColor: 'text-amber-700 font-semibold',\n    backgroundColor: 'bg-gradient-to-br from-orange-50 to-amber-50',\n    textColor: 'text-orange-900',\n    borderColor: 'border-orange-300',\n    winningCellStyle: 'bg-gradient-to-br from-red-200 to-orange-200 shadow-md shadow-red-200/50 border-red-300'\n  },\n  minimalist: {\n    name: 'Minimalist',\n    description: 'Clean and simple',\n    boardStyle: 'bg-white border-gray-300 shadow-md',\n    cellStyle: 'bg-gray-50 border-gray-200 text-gray-800 hover:bg-gray-100',\n    cellHoverStyle: 'hover:bg-gray-100',\n    playerXColor: 'text-indigo-600',\n    playerOColor: 'text-rose-600',\n    backgroundColor: 'bg-gray-50',\n    textColor: 'text-gray-800',\n    borderColor: 'border-gray-300',\n    winningCellStyle: 'bg-gradient-to-br from-indigo-100 to-rose-100 border-indigo-300'\n  },\n  nature: {\n    name: 'Nature',\n    description: 'Earth tones and natural colors',\n    boardStyle: 'bg-green-900 border-green-700 shadow-lg',\n    cellStyle: 'bg-green-800 border-green-600 text-green-100 hover:bg-green-700',\n    cellHoverStyle: 'hover:bg-green-700',\n    playerXColor: 'text-emerald-300',\n    playerOColor: 'text-amber-300',\n    backgroundColor: 'bg-green-950',\n    textColor: 'text-green-100',\n    borderColor: 'border-green-700',\n    winningCellStyle: 'bg-gradient-to-br from-emerald-400 to-amber-500 shadow-lg shadow-emerald-400/50'\n  },\n  space: {\n    name: 'Space',\n    description: 'Deep space adventure',\n    boardStyle: 'bg-indigo-950 border-purple-600 shadow-lg shadow-purple-600/20',\n    cellStyle: 'bg-indigo-900 border-purple-500 text-purple-100 hover:bg-purple-900/50',\n    cellHoverStyle: 'hover:bg-purple-900/50',\n    playerXColor: 'text-blue-300 drop-shadow-[0_0_6px_rgba(147,197,253,0.6)]',\n    playerOColor: 'text-purple-300 drop-shadow-[0_0_6px_rgba(196,181,253,0.6)]',\n    backgroundColor: 'bg-indigo-950',\n    textColor: 'text-purple-100',\n    borderColor: 'border-purple-600',\n    winningCellStyle: 'bg-gradient-to-br from-blue-400 to-purple-500 shadow-lg shadow-blue-400/50'\n  },\n  halloween: {\n    name: 'Halloween',\n    description: 'Spooky orange and black theme',\n    boardStyle: 'bg-gradient-to-br from-orange-800 to-black border-orange-500 shadow-lg shadow-orange-500/30',\n    cellStyle: 'bg-gradient-to-br from-orange-700 to-orange-900 border-orange-600 text-orange-100 hover:from-orange-600 hover:to-orange-800 transition-all duration-300',\n    cellHoverStyle: 'hover:from-orange-600 hover:to-orange-800 transition-all duration-300',\n    playerXColor: 'text-orange-400 drop-shadow-[0_0_8px_rgba(251,146,60,0.8)]',\n    playerOColor: 'text-purple-400 drop-shadow-[0_0_8px_rgba(196,181,253,0.8)]',\n    backgroundColor: 'bg-gradient-to-br from-orange-900 to-black',\n    textColor: 'text-orange-100',\n    borderColor: 'border-orange-500',\n    winningCellStyle: 'bg-gradient-to-br from-orange-400 to-purple-500 shadow-lg shadow-orange-400/50 border-orange-300'\n  },\n  christmas: {\n    name: 'Christmas',\n    description: 'Festive red and green theme',\n    boardStyle: 'bg-gradient-to-br from-red-800 to-green-800 border-red-400 shadow-lg shadow-red-400/30',\n    cellStyle: 'bg-gradient-to-br from-red-700 to-green-700 border-red-500 text-red-100 hover:from-red-600 hover:to-green-600 transition-all duration-300',\n    cellHoverStyle: 'hover:from-red-600 hover:to-green-600 transition-all duration-300',\n    playerXColor: 'text-red-400 drop-shadow-[0_0_8px_rgba(248,113,113,0.8)]',\n    playerOColor: 'text-green-400 drop-shadow-[0_0_8px_rgba(74,222,128,0.8)]',\n    backgroundColor: 'bg-gradient-to-br from-red-900 to-green-900',\n    textColor: 'text-red-100',\n    borderColor: 'border-red-400',\n    winningCellStyle: 'bg-gradient-to-br from-red-400 to-green-400 shadow-lg shadow-red-400/50 border-red-300'\n  },\n  summer: {\n    name: 'Summer',\n    description: 'Bright and sunny theme',\n    boardStyle: 'bg-gradient-to-br from-yellow-300 to-blue-300 border-yellow-400 shadow-lg shadow-yellow-400/30',\n    cellStyle: 'bg-gradient-to-br from-yellow-200 to-blue-200 border-yellow-300 text-yellow-900 hover:from-yellow-100 hover:to-blue-100 transition-all duration-300',\n    cellHoverStyle: 'hover:from-yellow-100 hover:to-blue-100 transition-all duration-300',\n    playerXColor: 'text-yellow-700 drop-shadow-[0_0_8px_rgba(234,179,8,0.6)]',\n    playerOColor: 'text-blue-700 drop-shadow-[0_0_8px_rgba(59,130,246,0.6)]',\n    backgroundColor: 'bg-gradient-to-br from-yellow-100 to-blue-100',\n    textColor: 'text-yellow-900',\n    borderColor: 'border-yellow-400',\n    winningCellStyle: 'bg-gradient-to-br from-yellow-400 to-blue-400 shadow-lg shadow-yellow-400/50 border-yellow-300'\n  }\n};\n\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\n\nexport function ThemeProvider({ children }: { children: React.ReactNode }) {\n  const [currentTheme, setCurrentTheme] = useState<GameTheme>('default');\n\n  useEffect(() => {\n    const savedTheme = localStorage.getItem('game-theme') as GameTheme;\n    if (savedTheme && themes[savedTheme]) {\n      setCurrentTheme(savedTheme);\n    }\n  }, []);\n\n  const setTheme = (theme: GameTheme) => {\n    setCurrentTheme(theme);\n    localStorage.setItem('game-theme', theme);\n  };\n\n  return (\n    <ThemeContext.Provider value={{ currentTheme, setTheme, themes }}>\n      {children}\n    </ThemeContext.Provider>\n  );\n}\n\nexport function useTheme() {\n  const context = useContext(ThemeContext);\n  if (context === undefined) {\n    throw new Error('useTheme must be used within a ThemeProvider');\n  }\n  return context;\n}","size_bytes":7917},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/hooks/useAudio.ts":{"content":"import { useState, useEffect, useRef } from 'react';\n\ninterface AudioSettings {\n  backgroundMusic: boolean;\n  soundEffects: boolean;\n  volume: number;\n}\n\nexport function useAudio() {\n  const [settings, setSettings] = useState<AudioSettings>(() => {\n    const saved = localStorage.getItem('audioSettings');\n    return saved ? JSON.parse(saved) : {\n      backgroundMusic: true,\n      soundEffects: true,\n      volume: 0.5\n    };\n  });\n\n  const backgroundMusicRef = useRef<HTMLAudioElement | null>(null);\n  const soundEffectsRef = useRef<{ [key: string]: HTMLAudioElement }>({});\n\n  useEffect(() => {\n    localStorage.setItem('audioSettings', JSON.stringify(settings));\n  }, [settings]);\n\n  useEffect(() => {\n    // Initialize background music (disabled to prevent vibrating sound)\n    if (!backgroundMusicRef.current) {\n      backgroundMusicRef.current = new Audio();\n      backgroundMusicRef.current.loop = true;\n      backgroundMusicRef.current.volume = settings.volume * 0.3; // Lower volume for background music\n      \n      // Remove the Web Audio API oscillator that was causing the vibrating sound\n      // Background music is now disabled to prevent creepy vibrating sounds\n    }\n\n    // Initialize sound effects\n    const sounds = ['move', 'win', 'lose', 'draw', 'click', 'celebrate'];\n    sounds.forEach(sound => {\n      if (!soundEffectsRef.current[sound]) {\n        soundEffectsRef.current[sound] = new Audio();\n        soundEffectsRef.current[sound].volume = settings.volume;\n      }\n    });\n\n    return () => {\n      // Cleanup audio resources\n      if (backgroundMusicRef.current) {\n        backgroundMusicRef.current.pause();\n      }\n      Object.values(soundEffectsRef.current).forEach(audio => {\n        audio.pause();\n      });\n    };\n  }, []);\n\n  const generateTone = (frequency: number, duration: number, volume: number = settings.volume) => {\n    if (!settings.soundEffects || typeof window === 'undefined') return;\n\n    try {\n      const audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\n      const oscillator = audioContext.createOscillator();\n      const gainNode = audioContext.createGain();\n      \n      oscillator.connect(gainNode);\n      gainNode.connect(audioContext.destination);\n      \n      oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);\n      gainNode.gain.setValueAtTime(volume * 0.1, audioContext.currentTime);\n      gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + duration);\n      \n      oscillator.start();\n      oscillator.stop(audioContext.currentTime + duration);\n    } catch (error) {\n      console.warn('Audio generation failed:', error);\n    }\n  };\n\n  const playSound = (soundType: string) => {\n    if (!settings.soundEffects) return;\n\n    switch (soundType) {\n      case 'move':\n        generateTone(800, 0.1);\n        break;\n      case 'win':\n        generateTone(523, 0.2); // C5\n        setTimeout(() => generateTone(659, 0.2), 100); // E5\n        setTimeout(() => generateTone(784, 0.3), 200); // G5\n        break;\n      case 'celebrate':\n        // Victory celebration sound - ascending major scale\n        generateTone(523, 0.15); // C5\n        setTimeout(() => generateTone(587, 0.15), 120); // D5\n        setTimeout(() => generateTone(659, 0.15), 240); // E5\n        setTimeout(() => generateTone(698, 0.15), 360); // F5\n        setTimeout(() => generateTone(784, 0.15), 480); // G5\n        setTimeout(() => generateTone(880, 0.15), 600); // A5\n        setTimeout(() => generateTone(988, 0.15), 720); // B5\n        setTimeout(() => generateTone(1047, 0.4), 840); // C6 (triumphant finale)\n        break;\n      case 'lose':\n        generateTone(392, 0.2); // G4\n        setTimeout(() => generateTone(349, 0.2), 100); // F4\n        setTimeout(() => generateTone(311, 0.3), 200); // E‚ô≠4\n        break;\n      case 'draw':\n        generateTone(440, 0.5); // A4\n        break;\n      case 'click':\n        generateTone(1000, 0.05);\n        break;\n      default:\n        generateTone(440, 0.1);\n    }\n  };\n\n  const toggleBackgroundMusic = () => {\n    setSettings(prev => ({\n      ...prev,\n      backgroundMusic: !prev.backgroundMusic\n    }));\n  };\n\n  const toggleSoundEffects = () => {\n    setSettings(prev => ({\n      ...prev,\n      soundEffects: !prev.soundEffects\n    }));\n  };\n\n  const setVolume = (volume: number) => {\n    setSettings(prev => ({\n      ...prev,\n      volume: Math.max(0, Math.min(1, volume))\n    }));\n  };\n\n  return {\n    settings,\n    playSound,\n    toggleBackgroundMusic,\n    toggleSoundEffects,\n    setVolume\n  };\n}","size_bytes":4573},"client/src/hooks/useAuth.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { useState, useEffect, useRef } from \"react\";\n\nexport function useAuth() {\n  const { data: user, isLoading: queryLoading } = useQuery({\n    queryKey: [\"/api/auth/user\"],\n    retry: false,\n  });\n\n  const [isLoading, setIsLoading] = useState(true);\n  const startTimeRef = useRef(Date.now());\n\n  useEffect(() => {\n    // Always show loading for at least 2.5 seconds, then stop regardless of query state\n    const timer = setTimeout(() => {\n      setIsLoading(false);\n    }, 2500);\n\n    return () => clearTimeout(timer);\n  }, []);\n\n  // Store user data in localStorage as backup for session issues\n  useEffect(() => {\n    if (user) {\n      try {\n        localStorage.setItem('backup_user_data', JSON.stringify(user));\n        console.log('üíæ User data backed up to localStorage');\n      } catch (error) {\n        console.warn('Failed to backup user data:', error);\n      }\n    }\n  }, [user]);\n\n  return {\n    user,\n    isLoading,\n    isAuthenticated: !!user,\n  };\n}","size_bytes":1020},"client/src/hooks/useOnlineStatus.ts":{"content":"import { useState, useEffect } from \"react\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useWebSocket } from \"@/hooks/useWebSocket\";\n\n/**\n * Custom hook to track user's actual online status using heartbeat-based logic\n * This prioritizes heartbeat API success over WebSocket connection status\n * to provide accurate online status when users switch tabs\n */\nexport function useOnlineStatus() {\n  const { user } = useAuth();\n  const { isConnected } = useWebSocket();\n  const [userOnlineStatus, setUserOnlineStatus] = useState(true);\n  const [lastHeartbeatSuccess, setLastHeartbeatSuccess] = useState(true);\n  const [heartbeatFailures, setHeartbeatFailures] = useState(0);\n\n  // Heartbeat to maintain accurate online status\n  useEffect(() => {\n    if (!user) {\n      setUserOnlineStatus(false);\n      return;\n    }\n\n    const runHeartbeat = async () => {\n      try {\n        const response = await fetch('/api/heartbeat', {\n          method: 'POST',\n          credentials: 'include'\n        });\n        \n        if (response.ok) {\n          setLastHeartbeatSuccess(true);\n          setUserOnlineStatus(true);\n          setHeartbeatFailures(0); // Reset failure counter on success\n        } else {\n          setLastHeartbeatSuccess(false);\n          setHeartbeatFailures(prev => {\n            const newCount = prev + 1;\n            // Only mark as offline after 3 consecutive failures (45 seconds)\n            if (newCount >= 3) {\n              setUserOnlineStatus(false);\n            }\n            return newCount;\n          });\n        }\n      } catch (error) {\n        setLastHeartbeatSuccess(false);\n        setHeartbeatFailures(prev => {\n          const newCount = prev + 1;\n          // Only mark as offline after 3 consecutive failures (45 seconds)\n          if (newCount >= 3) {\n            setUserOnlineStatus(false);\n          }\n          return newCount;\n        });\n      }\n    };\n\n    // Run heartbeat immediately\n    runHeartbeat();\n    \n    // Then run it every 15 seconds\n    const heartbeat = setInterval(runHeartbeat, 15000);\n\n    return () => clearInterval(heartbeat);\n  }, [user]);\n\n  // Determine actual online status - prioritize heartbeat status since that's what backend uses\n  // If heartbeat is working (< 3 failures), user is online regardless of WebSocket\n  // If heartbeat fails repeatedly, then check WebSocket as backup\n  const actualOnlineStatus = heartbeatFailures < 3 ? userOnlineStatus : isConnected;\n\n  return {\n    isOnline: actualOnlineStatus,\n    isConnected,\n    heartbeatFailures,\n    lastHeartbeatSuccess\n  };\n}","size_bytes":2557},"client/src/hooks/useWebSocket.ts":{"content":"import { useEffect, useRef, useState } from 'react';\nimport { useAuth } from './useAuth';\n\ninterface WebSocketMessage {\n  type: string;\n  [key: string]: any;\n}\n\nexport function useWebSocket() {\n  const { user } = useAuth();\n  const ws = useRef<WebSocket | null>(null);\n  const [isConnected, setIsConnected] = useState(false);\n  const [lastMessage, setLastMessage] = useState<WebSocketMessage | null>(null);\n  const [connectionQuality, setConnectionQuality] = useState<'good' | 'poor' | 'disconnected'>('disconnected');\n  const joinedRooms = useRef<Set<string>>(new Set());\n  const messageQueue = useRef<WebSocketMessage[]>([]);\n  const reconnectAttempts = useRef(0);\n  const lastPingTime = useRef<number>(0);\n  const pingResponseTime = useRef<number>(0);\n\n  useEffect(() => {\n    if (!user) return;\n    \n    // Prevent duplicate connections by checking if one already exists\n    if (ws.current && ws.current.readyState !== WebSocket.CLOSED) {\n      return;\n    }\n\n    // Fix: Use strict same-origin WebSocket URL to ensure cookies are sent\n    const wsUrl = `${window.location.origin.replace(/^http/, 'ws')}/ws`;\n    \n\n    ws.current = new WebSocket(wsUrl);\n\n    ws.current.onopen = () => {\n      setIsConnected(true);\n      setConnectionQuality('good');\n      reconnectAttempts.current = 0; // Reset on successful connection\n      // Clear joined rooms on reconnect to prevent duplicates\n      joinedRooms.current.clear();\n      \n      // Get user ID with fallback to backup data\n      let userId = (user as any)?.userId || (user as any)?.id;\n      \n      // If no user from API, try backup from localStorage\n      if (!userId) {\n        try {\n          const backupUser = localStorage.getItem('backup_user_data');\n          if (backupUser) {\n            const parsedUser = JSON.parse(backupUser);\n            userId = parsedUser?.userId || parsedUser?.id;\n            //console.log('üîÑ Using backup user data for WebSocket auth');\n          }\n        } catch (error) {\n          console.warn('Failed to read backup user data:', error);\n        }\n      }\n      \n      // Authenticate with WebSocket\n      const authMessage = {\n        type: 'auth',\n        userId: userId,\n      };\n\n      // WebSocket authenticated\n      ws.current?.send(JSON.stringify(authMessage));\n    };\n\n    ws.current.onmessage = (event) => {\n      try {\n        const message = JSON.parse(event.data);\n\n        // Remove verbose logging for game messages\n        \n        // Dispatch custom events for different message types\n        if (message.type === 'chat_message_received') {\n          const chatEvent = new CustomEvent('chat_message_received', {\n            detail: message\n          });\n          window.dispatchEvent(chatEvent);\n        }\n\n        // Handle room invitation messages\n        if (message.type === 'room_invitation') {\n          const invitationEvent = new CustomEvent('room_invitation_received', {\n            detail: message.invitation\n          });\n          window.dispatchEvent(invitationEvent);\n        }\n\n        // Handle player left win scenario - dispatch custom event for game board handling\n        if (message.type === 'player_left_win') {\n          // Player left win message received\n          \n          // Dispatch custom event for game board to handle\n          const playerLeftWinEvent = new CustomEvent('player_left_win', {\n            detail: message\n          });\n          window.dispatchEvent(playerLeftWinEvent);\n          \n          return; // Don't process further\n        }\n\n        // Handle game abandonment due to player leaving\n        if (message.type === 'game_abandoned') {\n          \n          // Show toast notification directly\n          const toastMessage = message.message || \"Game ended because a player left the room.\";\n          \n          // Create and show a temporary toast-like notification (XSS-safe)\n          const notificationDiv = document.createElement('div');\n          \n          const containerDiv = document.createElement('div');\n          containerDiv.style.cssText = `\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            background: #ef4444;\n            color: white;\n            padding: 16px;\n            border-radius: 8px;\n            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n            z-index: 9999;\n            max-width: 400px;\n            font-family: system-ui, -apple-system, sans-serif;\n          `;\n          \n          const titleDiv = document.createElement('div');\n          titleDiv.style.cssText = 'font-weight: 600; margin-bottom: 4px;';\n          titleDiv.textContent = 'Game Ended';\n          \n          const messageDiv = document.createElement('div');\n          messageDiv.style.cssText = 'font-size: 14px; opacity: 0.9;';\n          messageDiv.textContent = toastMessage; // Safe: uses textContent instead of innerHTML\n          \n          containerDiv.appendChild(titleDiv);\n          containerDiv.appendChild(messageDiv);\n          notificationDiv.appendChild(containerDiv);\n          document.body.appendChild(notificationDiv);\n          \n          // Clear any stored game state to prevent reconnection\n          localStorage.removeItem('currentGameState');\n          sessionStorage.removeItem('currentGameState');\n          \n          // Force page reload after showing the notification\n          setTimeout(() => {\n            window.location.href = '/'; // Redirect to root instead of reload to prevent reconnection\n          }, 2000); // Give user time to see the notification\n          \n          return; // Don't set lastMessage to prevent useEffect processing\n        }\n        \n        // Handle spectator leaving and needing to redirect to home\n        if (message.type === 'spectator_left') {\n          // For spectators, provide immediate smooth transition to AI board\n          // Clear any stored game/room state\n          localStorage.removeItem('currentGameState');\n          sessionStorage.removeItem('currentGameState');\n          localStorage.removeItem('currentRoomState');\n          sessionStorage.removeItem('currentRoomState');\n          \n          // Dispatch immediate transition event with explicit AI mode\n          const spectatorTransitionEvent = new CustomEvent('spectator_transition_to_ai', {\n            detail: {\n              message: message.message || 'You have left the room',\n              targetMode: 'ai'\n            }\n          });\n          \n          window.dispatchEvent(spectatorTransitionEvent);\n          \n          return; // Don't set lastMessage to prevent useEffect processing\n        }\n        \n        // For critical reconnection messages, dispatch custom events immediately\n        if (message.type === 'reconnection_room_join') {\n          // Dispatching immediate room reconnection event\n          window.dispatchEvent(new CustomEvent('reconnection_room_join', {\n            detail: message\n          }));\n        }\n        \n        if (message.type === 'game_reconnection') {\n          // Dispatching immediate game_reconnection event\n          window.dispatchEvent(new CustomEvent('game_reconnection', {\n            detail: message\n          }));\n        }\n\n        // Handle play again requests\n        if (message.type === 'play_again_request') {\n          // Dispatching play again request event\n          window.dispatchEvent(new CustomEvent('play_again_request_received', {\n            detail: message\n          }));\n        }\n\n        // Handle play again rejection - redirect to home\n        if (message.type === 'play_again_rejected') {\n          // Dispatching play again rejected event to redirect to AI table\n          window.dispatchEvent(new CustomEvent('play_again_rejected_received', {\n            detail: message\n          }));\n        }\n\n        // Handle online status updates for friends list\n        if (message.type === 'online_users_update' || message.type === 'user_offline') {\n          // Dispatching online status update\n          window.dispatchEvent(new CustomEvent('online_status_update', {\n            detail: message\n          }));\n        }\n        \n        // Add timestamp to message for proper matching in modal\n        const messageWithTimestamp = {\n          ...message,\n          timestamp: Date.now()\n        };\n        \n        // Handle matchmaking-related messages\n        if (['match_found', 'matchmaking_success', 'matchmaking_response', 'game_started'].includes(message.type)) {\n          // Matchmaking message received\n          \n          // Dispatch a global event for matchmaking messages to ensure modal receives them\n          const matchmakingEvent = new CustomEvent('matchmaking_message_received', {\n            detail: messageWithTimestamp\n          });\n          window.dispatchEvent(matchmakingEvent);\n        }\n        \n        // Handle pong response with connection quality analysis\n        if (message.type === 'pong') {\n          const responseTime = Date.now() - lastPingTime.current;\n          pingResponseTime.current = responseTime;\n          \n          // Update connection quality based on response time\n          if (responseTime < 200) {\n            setConnectionQuality('good');\n          } else if (responseTime < 1000) {\n            setConnectionQuality('poor');\n          }\n          \n          window.dispatchEvent(new CustomEvent('websocket_pong_received', {\n            detail: { ...message, responseTime }\n          }));\n        }\n        \n        // Setting lastMessage in useWebSocket\n        setLastMessage(messageWithTimestamp);\n      } catch (error) {\n        console.error('Failed to parse WebSocket message:', error);\n      }\n    };\n\n    ws.current.onclose = (event) => {\n      // WebSocket connection closed\n      setIsConnected(false);\n      setConnectionQuality('disconnected');\n      reconnectAttempts.current++;\n      \n      // Smart reconnection with exponential backoff, but cap at 5 seconds max\n      if (event.code !== 1000) {\n        const baseDelay = Math.min(1000 * Math.pow(1.5, reconnectAttempts.current - 1), 5000);\n        const jitter = Math.random() * 1000; // Add jitter to prevent thundering herd\n        const delay = Math.min(baseDelay + jitter, 5000);\n        \n        // Reconnecting with backoff\n        setTimeout(() => {\n          if (user && (!ws.current || ws.current.readyState === WebSocket.CLOSED)) {\n            // Reconnecting for active player\n            setIsConnected(false);\n          }\n        }, delay);\n      }\n    };\n\n    ws.current.onerror = (error) => {\n      console.error('WebSocket error:', error);\n    };\n\n    // Listen for ping send events\n    const handleSendPing = (event: CustomEvent) => {\n      if (ws.current && ws.current.readyState === WebSocket.OPEN) {\n        //console.log('üèì Sending ping to server');\n        ws.current.send(JSON.stringify(event.detail));\n      }\n    };\n\n    window.addEventListener('send_websocket_ping', handleSendPing as EventListener);\n\n    // Enhanced heartbeat with connection quality monitoring - send ping every 15 seconds\n    const pingInterval = setInterval(() => {\n      if (ws.current && ws.current.readyState === WebSocket.OPEN) {\n        lastPingTime.current = Date.now();\n        ws.current.send(JSON.stringify({ \n          type: 'ping', \n          timestamp: lastPingTime.current,\n          keepAlive: true \n        }));\n      }\n    }, 30000); // Optimized ping frequency for stable connections\n\n    return () => {\n      window.removeEventListener('send_websocket_ping', handleSendPing as EventListener);\n      clearInterval(pingInterval); // Clean up heartbeat interval\n      \n      if (ws.current && ws.current.readyState !== WebSocket.CLOSED) {\n        ws.current.close();\n      }\n      ws.current = null;\n    };\n  }, [(user as any)?.userId || (user as any)?.id]); // Only recreate when user ID changes, not the entire user object\n\n  const sendMessage = (message: WebSocketMessage) => {\n    if (ws.current && ws.current.readyState === WebSocket.OPEN) {\n      // For poor connections, prioritize game moves over other messages\n      if (connectionQuality === 'poor' && message.type === 'move') {\n        // Skip other queued messages and send move immediately\n        messageQueue.current = messageQueue.current.filter(m => m.type === 'move');\n        // Priority move sent on poor connection\n      } else {\n        // Sending WebSocket message\n      }\n      \n      ws.current.send(JSON.stringify(message));\n      \n      // Process any queued messages after successful send\n      while (messageQueue.current.length > 0 && ws.current.readyState === WebSocket.OPEN) {\n        const queuedMessage = messageQueue.current.shift();\n        if (queuedMessage) {\n          // Sending queued message\n          ws.current.send(JSON.stringify(queuedMessage));\n        }\n      }\n    } else {\n      // Queue critical messages for retry when connection is restored\n      if (['move', 'join_room', 'auth'].includes(message.type)) {\n        messageQueue.current.push(message);\n        // Queued critical message for retry\n      } else {\n        console.warn(`‚ùå WebSocket not ready, message not sent:`, message);\n      }\n    }\n  };\n\n  // Add a refresh connection method for matchmaking issues\n  const refreshConnection = () => {\n    if (ws.current) {\n      ws.current.close();\n      ws.current = null;\n      setIsConnected(false);\n      \n      // Trigger a reconnection by updating the user dependency\n      setTimeout(() => {\n        if (user) {\n          // Fix: Use strict same-origin WebSocket URL to ensure cookies are sent\n          const wsUrl = `${window.location.origin.replace(/^http/, 'ws')}/ws`;\n          \n          ws.current = new WebSocket(wsUrl);\n          \n          ws.current.onopen = () => {\n            setIsConnected(true);\n            joinedRooms.current.clear();\n            \n            let userId = (user as any)?.userId || (user as any)?.id;\n            \n            if (!userId) {\n              try {\n                const backupUser = localStorage.getItem('backup_user_data');\n                if (backupUser) {\n                  const parsedUser = JSON.parse(backupUser);\n                  userId = parsedUser?.userId || parsedUser?.id;\n                }\n              } catch (error) {\n                console.warn('Failed to read backup user data:', error);\n              }\n            }\n            \n            const authMessage = {\n              type: 'auth',\n              userId: userId,\n            };\n\n            console.log('üîÑ Refreshed WebSocket connection with userId:', userId);\n            ws.current?.send(JSON.stringify(authMessage));\n          };\n          \n          ws.current.onmessage = (event) => {\n            try {\n              const message = JSON.parse(event.data);\n              \n              if (message.type === 'chat_message_received') {\n                const chatEvent = new CustomEvent('chat_message_received', {\n                  detail: message\n                });\n                window.dispatchEvent(chatEvent);\n              }\n\n              if (message.type === 'room_invitation') {\n                const invitationEvent = new CustomEvent('room_invitation_received', {\n                  detail: message.invitation\n                });\n                window.dispatchEvent(invitationEvent);\n              }\n\n              if (message.type === 'player_left_win') {\n                console.log('üèÜ WebSocket: Player left win message received:', message);\n                \n                const playerLeftWinEvent = new CustomEvent('player_left_win', {\n                  detail: message\n                });\n                window.dispatchEvent(playerLeftWinEvent);\n                \n                return;\n              }\n\n              if (message.type === 'game_abandoned') {\n                const toastMessage = message.message || \"Game ended because a player left the room.\";\n                \n                const notificationDiv = document.createElement('div');\n                notificationDiv.innerHTML = `\n                  <div style=\"\n                    position: fixed;\n                    top: 20px;\n                    right: 20px;\n                    background: #ef4444;\n                    color: white;\n                    padding: 16px;\n                    border-radius: 8px;\n                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n                    z-index: 9999;\n                    max-width: 400px;\n                    font-family: system-ui, -apple-system, sans-serif;\n                  \">\n                    <div style=\"font-weight: 600; margin-bottom: 4px;\">Game Ended</div>\n                    <div style=\"font-size: 14px; opacity: 0.9;\">${toastMessage}</div>\n                  </div>\n                `;\n                document.body.appendChild(notificationDiv);\n\n                setTimeout(() => {\n                  document.body.removeChild(notificationDiv);\n                }, 5000);\n\n                localStorage.removeItem('currentGameState');\n                sessionStorage.removeItem('currentGameState');\n                \n                setTimeout(() => {\n                  window.location.href = '/';\n                }, 2000);\n                \n                return;\n              }\n              \n              if (message.type === 'spectator_left') {\n                localStorage.removeItem('currentGameState');\n                sessionStorage.removeItem('currentGameState');\n                localStorage.removeItem('currentRoomState');\n                sessionStorage.removeItem('currentRoomState');\n                \n                const spectatorTransitionEvent = new CustomEvent('spectator_transition_to_ai', {\n                  detail: {\n                    message: message.message || 'You have left the room',\n                    targetMode: 'ai'\n                  }\n                });\n                \n                window.dispatchEvent(spectatorTransitionEvent);\n                \n                return;\n              }\n              \n              if (message.type === 'reconnection_room_join') {\n                window.dispatchEvent(new CustomEvent('reconnection_room_join', {\n                  detail: message\n                }));\n              }\n              \n              if (message.type === 'game_reconnection') {\n                window.dispatchEvent(new CustomEvent('game_reconnection', {\n                  detail: message\n                }));\n              }\n\n              if (message.type === 'online_users_update' || message.type === 'user_offline') {\n                window.dispatchEvent(new CustomEvent('online_status_update', {\n                  detail: message\n                }));\n              }\n              \n              const messageWithTimestamp = {\n                ...message,\n                timestamp: Date.now()\n              };\n              \n              if (['match_found', 'matchmaking_success', 'matchmaking_response', 'game_started'].includes(message.type)) {\n                console.log('üéÆ WebSocket: Received matchmaking message:', message.type, messageWithTimestamp);\n                \n                const matchmakingEvent = new CustomEvent('matchmaking_message_received', {\n                  detail: messageWithTimestamp\n                });\n                window.dispatchEvent(matchmakingEvent);\n              }\n              \n              setLastMessage(messageWithTimestamp);\n            } catch (error) {\n              console.error('Failed to parse WebSocket message:', error);\n            }\n          };\n\n          ws.current.onclose = (event) => {\n            setIsConnected(false);\n          };\n\n          ws.current.onerror = (error) => {\n            console.error('WebSocket error:', error);\n          };\n        }\n      }, 100);\n    }\n  };\n\n  const joinRoom = (roomId: string) => {\n    if (joinedRooms.current.has(roomId)) {\n      //console.log(`üè† Already joined room ${roomId}, skipping duplicate join`);\n      return;\n    }\n    //console.log(`üè† Joining room: ${roomId}`);\n    joinedRooms.current.add(roomId);\n    sendMessage({ type: 'join_room', roomId });\n  };\n\n  const leaveRoom = (roomId: string) => {\n    //console.log(`üè† Leaving room: ${roomId}`);\n    joinedRooms.current.delete(roomId);\n    sendMessage({ type: 'leave_room', roomId });\n  };\n\n  return {\n    isConnected,\n    lastMessage,\n    connectionQuality,\n    sendMessage,\n    joinRoom,\n    leaveRoom,\n    refreshConnection,\n  };\n}\n","size_bytes":20348},"client/src/lib/authUtils.ts":{"content":"export function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}","size_bytes":115},"client/src/lib/errorUtils.ts":{"content":"// Utility functions for handling and formatting error messages\n\nexport function parseErrorMessage(error: any): string {\n  if (!error) return \"An unexpected error occurred\";\n  \n  // If error is a string, try to parse it\n  if (typeof error === 'string') {\n    try {\n      // Handle cases like \"403: {'error':'You are blocked by this user'}\"\n      const statusMatch = error.match(/^\\d+:\\s*(.+)$/);\n      if (statusMatch) {\n        const errorPart = statusMatch[1];\n        try {\n          const parsed = JSON.parse(errorPart);\n          if (parsed.error) {\n            return formatUserFriendlyError(parsed.error);\n          }\n        } catch {\n          // If JSON parsing fails, try to extract error from string\n          const errorMatch = errorPart.match(/'error':\\s*'([^']+)'/);\n          if (errorMatch) {\n            return formatUserFriendlyError(errorMatch[1]);\n          }\n        }\n        return formatUserFriendlyError(errorPart);\n      }\n      return formatUserFriendlyError(error);\n    } catch {\n      return formatUserFriendlyError(error);\n    }\n  }\n  \n  // If error is an object\n  if (error.message) {\n    return parseErrorMessage(error.message);\n  }\n  \n  if (error.error) {\n    return formatUserFriendlyError(error.error);\n  }\n  \n  return \"An unexpected error occurred\";\n}\n\nfunction formatUserFriendlyError(errorMessage: string): string {\n  // Common error message mappings\n  const errorMappings: Record<string, string> = {\n    \"You are blocked by this user\": \"This user has blocked you and you cannot send messages to them.\",\n    \"Target user connection not found\": \"Your friend is offline. You can send messages when they are online.\",\n    \"User not found\": \"This user could not be found.\",\n    \"Not authenticated\": \"Please log in to continue.\",\n    \"Access denied\": \"You don't have permission to perform this action.\",\n    \"Invalid request\": \"The request is invalid. Please try again.\",\n    \"Server error\": \"Something went wrong on our end. Please try again later.\",\n    \"Network error\": \"Please check your internet connection and try again.\",\n    \"Unauthorized\": \"You are not authorized to perform this action.\",\n    \"Forbidden\": \"This action is not allowed.\",\n    \"Not found\": \"The requested resource could not be found.\",\n    \"Conflict\": \"This action conflicts with the current state.\",\n    \"Too many requests\": \"Too many requests. Please wait a moment and try again.\",\n    \"Service unavailable\": \"The service is temporarily unavailable. Please try again later.\"\n  };\n  \n  // Check for exact matches first\n  if (errorMappings[errorMessage]) {\n    return errorMappings[errorMessage];\n  }\n  \n  // Check for partial matches\n  for (const [key, value] of Object.entries(errorMappings)) {\n    if (errorMessage.toLowerCase().includes(key.toLowerCase())) {\n      return value;\n    }\n  }\n  \n  // Handle common HTTP status codes\n  if (errorMessage.includes('400')) {\n    return \"The request is invalid. Please check your input and try again.\";\n  }\n  if (errorMessage.includes('401') || errorMessage.includes('403')) {\n    return \"You are not authorized to perform this action.\";\n  }\n  if (errorMessage.includes('404')) {\n    return \"The requested resource could not be found.\";\n  }\n  if (errorMessage.includes('409')) {\n    return \"This action conflicts with the current state.\";\n  }\n  if (errorMessage.includes('429')) {\n    return \"Too many requests. Please wait a moment and try again.\";\n  }\n  if (errorMessage.includes('500')) {\n    return \"Something went wrong on our end. Please try again later.\";\n  }\n  if (errorMessage.includes('503')) {\n    return \"The service is temporarily unavailable. Please try again later.\";\n  }\n  \n  // Clean up technical error messages\n  const cleanedMessage = errorMessage\n    .replace(/^\\d+:\\s*/, '') // Remove status codes\n    .replace(/^Error:\\s*/, '') // Remove \"Error:\" prefix\n    .replace(/\\{[^}]*\\}/g, '') // Remove JSON objects\n    .replace(/[\"']/g, '') // Remove quotes\n    .trim();\n  \n  // If the cleaned message is empty or too technical, provide a generic message\n  if (!cleanedMessage || cleanedMessage.length < 5 || containsTechnicalTerms(cleanedMessage)) {\n    return \"An error occurred. Please try again.\";\n  }\n  \n  // Capitalize first letter\n  return cleanedMessage.charAt(0).toUpperCase() + cleanedMessage.slice(1);\n}\n\nfunction containsTechnicalTerms(message: string): boolean {\n  const technicalTerms = [\n    'http', 'api', 'json', 'sql', 'database', 'server', 'client',\n    'request', 'response', 'status', 'code', 'stack', 'trace',\n    'function', 'method', 'object', 'array', 'null', 'undefined'\n  ];\n  \n  const lowerMessage = message.toLowerCase();\n  return technicalTerms.some(term => lowerMessage.includes(term));\n}\n\nexport function showUserFriendlyError(error: any, toast: any) {\n  const friendlyMessage = parseErrorMessage(error);\n  \n  toast({\n    title: \"Error\",\n    description: friendlyMessage,\n    variant: \"destructive\",\n  });\n}","size_bytes":4907},"client/src/lib/firebase.ts":{"content":"// Simple auth API calls\nexport const login = async (credentials: { username: string; password: string }) => {\n  const response = await fetch('/api/auth/login', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(credentials)\n  });\n  \n  if (!response.ok) {\n    const errorData = await response.json();\n    throw new Error(errorData.error || 'Login failed');\n  }\n  \n  return response.json();\n};\n\nexport const register = async (credentials: { username: string; password: string; email: string }) => {\n  const response = await fetch('/api/auth/register', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(credentials)\n  });\n  \n  if (!response.ok) {\n    const errorData = await response.json();\n    throw new Error(errorData.error || 'Registration failed');\n  }\n  \n  return response.json();\n};\n\nexport const sendEmailVerification = async (email: string) => {\n  const response = await fetch('/api/auth/send-verification', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ email })\n  });\n  \n  if (!response.ok) {\n    const errorData = await response.json();\n    throw new Error(errorData.message || 'Failed to send verification email');\n  }\n  \n  return response.json();\n};\n\nexport const verifyEmail = async (token: string) => {\n  const response = await fetch('/api/auth/verify-email', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ token })\n  });\n  \n  if (!response.ok) {\n    throw new Error('Email verification failed');\n  }\n  \n  return response.json();\n};\n\nexport const logout = async () => {\n  await fetch('/api/auth/logout', { method: 'POST' });\n   // Navigate to auth page without reload\n  window.dispatchEvent(new CustomEvent('navigate', { detail: { path: '/auth' } }));\n};\n\nexport const getCurrentUser = async () => {\n  try {\n    const response = await fetch('/api/auth/user');\n    if (!response.ok) {\n      return null;\n    }\n    return response.json();\n  } catch (error) {\n    console.error('Error getting current user:', error);\n    return null;\n  }\n};","size_bytes":2161},"client/src/lib/i18n.ts":{"content":"// Internationalization system for TicTac 3x5 game\n// Supports Arabic, Bengali, Hindi, Spanish, and Indonesian languages\n\nexport type Language = 'en' | 'ar' | 'bn' | 'hi' | 'es' | 'id';\n\nexport const languages = {\n  en: { name: 'English', flag: 'üá∫üá∏', dir: 'ltr' },\n  ar: { name: 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©', flag: 'üá∏üá¶', dir: 'rtl' },\n  bn: { name: '‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ', flag: 'üáßüá©', dir: 'ltr' },\n  hi: { name: '‡§π‡§ø‡§Ç‡§¶‡•Ä', flag: 'üáÆüá≥', dir: 'ltr' },\n  es: { name: 'Espa√±ol', flag: 'üá™üá∏', dir: 'ltr' },\n  id: { name: 'Bahasa Indonesia', flag: 'üáÆüá©', dir: 'ltr' }\n} as const;\n\nexport const translations = {\n  // Navigation & Header\n  appName: {\n    en: 'TicTac 3x5',\n    ar: 'ÿ™ŸäŸÉ ÿ™ÿßŸÉ 3√ó5',\n    bn: '‡¶ü‡¶ø‡¶ï ‡¶ü‡ßç‡¶Ø‡¶æ‡¶ï 3√ó5',\n    hi: '‡§ü‡§ø‡§ï ‡§ü‡•à‡§ï 3√ó5',\n    es: 'TicTac 3x5',\n    id: 'TicTac 3x5',\n  },\n  getStarted: {\n    en: 'Get Started',\n    ar: 'ÿßÿ®ÿØÿ£ ÿßŸÑÿ¢ŸÜ',\n    bn: '‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®',\n    hi: '‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Comenzar',\n    id: 'Mulai',\n  },\n  login: {\n    en: 'Login',\n    ar: 'ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ',\n    bn: '‡¶≤‡¶ó‡¶á‡¶®',\n    hi: '‡§≤‡•â‡§ó ‡§á‡§®',\n    es: 'Iniciar Sesi√≥n',\n    id: 'Masuk',\n  },\n  logout: {\n    en: 'Logout',\n    ar: 'ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨',\n    bn: '‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü',\n    hi: '‡§≤‡•â‡§ó ‡§Ü‡§â‡§ü',\n    es: 'Cerrar Sesi√≥n',\n    id: 'Keluar',\n  },\n  register: {\n    en: 'Register',\n    ar: 'ÿ•ŸÜÿ¥ÿßÿ° ÿ≠ÿ≥ÿßÿ®',\n    bn: '‡¶®‡¶ø‡¶¨‡¶®‡ßç‡¶ß‡¶®',\n    hi: '‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Registrarse',\n    id: 'Daftar',\n  },\n  \n  // Game Interface\n  strategicTicTacToe: {\n    en: 'Strategic Tic-Tac-Toe',\n    ar: 'ŸÑÿπÿ®ÿ© ÿ•ŸÉÿ≥ ÿ£Ÿà ÿßŸÑÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ©',\n    bn: '‡¶ï‡ßå‡¶∂‡¶≤‡¶ó‡¶§ ‡¶ü‡¶ø‡¶ï ‡¶ü‡ßç‡¶Ø‡¶æ‡¶ï ‡¶ü‡ßã',\n    hi: '‡§∞‡§£‡§®‡•Ä‡§§‡§ø‡§ï ‡§ü‡§ø‡§ï ‡§ü‡•à‡§ï ‡§ü‡•ã',\n    es: 'Tic-Tac-Toe Estrat√©gico',\n    id: 'Tic-Tac-Toe Strategis',\n  },\n  game: {\n    en: 'Game',\n    ar: 'ŸÑÿπÿ®ÿ©',\n    bn: '‡¶ó‡ßá‡¶Æ',\n    hi: '‡§ó‡•á‡§Æ',\n    es: 'Juego',\n    id: 'Permainan',\n  },\n  startPlayingNow: {\n    en: 'Start Playing Now',\n    ar: 'ÿßÿ®ÿØÿ£ ÿßŸÑŸÑÿπÿ® ÿßŸÑÿ¢ŸÜ',\n    bn: '‡¶è‡¶ñ‡¶®‡¶á ‡¶ñ‡ßá‡¶≤‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®',\n    hi: '‡§Ö‡§≠‡•Ä ‡§ñ‡•á‡§≤‡§®‡§æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Empezar a Jugar Ahora',\n    id: 'Mulai Bermain Sekarang',\n  },\n  gameDescription: {\n    en: 'Experience the classic game on a 3x5 grid with strategic gameplay.',\n    ar: 'ÿßÿ≥ÿ™ŸÖÿ™ÿπ ÿ®ÿßŸÑŸÑÿπÿ®ÿ© ÿßŸÑŸÉŸÑÿßÿ≥ŸäŸÉŸäÿ© ÿπŸÑŸâ ÿ¥ÿ®ŸÉÿ© 3√ó5 ŸÖÿπ ŸÑÿπÿ® ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿä.',\n    bn: '‡¶ï‡ßå‡¶∂‡¶≤‡¶ó‡¶§ ‡¶ó‡ßá‡¶Æ‡¶™‡ßç‡¶≤‡ßá ‡¶∏‡¶π 3√ó5 ‡¶ó‡ßç‡¶∞‡¶ø‡¶°‡ßá ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡¶ø‡¶ï ‡¶ó‡ßá‡¶Æ‡¶ü‡¶ø ‡¶Ö‡¶®‡ßÅ‡¶≠‡¶¨ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§',\n    hi: '‡§∞‡§£‡§®‡•Ä‡§§‡§ø‡§ï ‡§ó‡•á‡§Æ‡§™‡•ç‡§≤‡•á ‡§ï‡•á ‡§∏‡§æ‡§• 3√ó5 ‡§ó‡•ç‡§∞‡§ø‡§° ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§æ‡§∏‡§ø‡§ï ‡§ó‡•á‡§Æ ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§ï‡§∞‡•á‡§Ç‡•§',\n    es: 'Experimenta el juego cl√°sico en una cuadr√≠cula de 3x5 con jugabilidad estrat√©gica.',\n    id: 'Rasakan permainan klasik di grid 3x5 dengan gameplay strategis.',\n  },\n  \n  // Game Modes\n  gameMode: {\n    en: 'Game Mode',\n    ar: 'Ÿàÿ∂ÿπ ÿßŸÑŸÑÿπÿ®ÿ©',\n    bn: '‡¶ó‡ßá‡¶Æ ‡¶Æ‡ßã‡¶°',\n    hi: '‡§ó‡•á‡§Æ ‡§Æ‡•ã‡§°',\n    es: 'Modo de Juego',\n    id: 'Mode Permainan',\n  },\n  aiMode: {\n    en: 'AI Mode',\n    ar: 'Ÿàÿ∂ÿπ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä',\n    bn: '‡¶è‡¶Ü‡¶á ‡¶Æ‡ßã‡¶°',\n    hi: '‡§è‡§Ü‡§à ‡§Æ‡•ã‡§°',\n    es: 'Modo IA',\n    id: 'Mode AI',\n  },\n  passPlayMode: {\n    en: 'Pass & Play',\n    ar: 'ÿ™ŸÜÿßŸàÿ® ÿßŸÑŸÑÿπÿ®',\n    bn: '‡¶™‡¶æ‡¶∏ ‡¶è‡¶¨‡¶Ç ‡¶™‡ßç‡¶≤‡ßá',\n    hi: '‡§™‡§æ‡§∏ ‡§î‡§∞ ‡§™‡•ç‡§≤‡•á',\n    es: 'Pasar y Jugar',\n    id: 'Pass & Play',\n  },\n  onlineMode: {\n    en: 'Online Mode',\n    ar: 'Ÿàÿ∂ÿπ ÿßŸÑÿ•ŸÜÿ™ÿ±ŸÜÿ™',\n    bn: '‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶Æ‡ßã‡¶°',\n    hi: '‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§Æ‡•ã‡§°',\n    es: 'Modo Online',\n    id: 'Mode Online',\n  },\n  \n  // Game Rules\n  gameRules: {\n    en: 'Game Rules',\n    ar: 'ŸÇŸàÿßÿπÿØ ÿßŸÑŸÑÿπÿ®ÿ©',\n    bn: '‡¶ó‡ßá‡¶Æ‡ßá‡¶∞ ‡¶®‡¶ø‡¶Ø‡¶º‡¶Æ',\n    hi: '‡§ó‡•á‡§Æ ‡§®‡§ø‡§Ø‡§Æ',\n    es: 'Reglas del Juego',\n    id: 'Aturan Permainan',\n  },\n  horizontalWin: {\n    en: 'Horizontal Win: Get 4 symbols in a row horizontally',\n    ar: 'ÿßŸÑŸÅŸàÿ≤ ÿßŸÑÿ£ŸÅŸÇŸä: ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ 4 ÿ±ŸÖŸàÿ≤ ŸÅŸä ÿµŸÅ ÿ£ŸÅŸÇŸä',\n    bn: '‡¶Ö‡¶®‡ßÅ‡¶≠‡ßÇ‡¶Æ‡¶ø‡¶ï ‡¶ú‡¶Ø‡¶º: ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡¶æ‡¶∞‡¶ø‡¶§‡ßá 4‡¶ü‡¶ø ‡¶ö‡¶ø‡¶π‡ßç‡¶® ‡¶™‡¶æ‡¶®',\n    hi: '‡§ï‡•ç‡§∑‡•à‡§§‡§ø‡§ú ‡§ú‡•Ä‡§§: ‡§è‡§ï ‡§™‡§Ç‡§ï‡•ç‡§§‡§ø ‡§Æ‡•á‡§Ç 4 ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Victoria Horizontal: Consigue 4 s√≠mbolos en una fila horizontal',\n    id: 'Kemenangan Horizontal: Dapatkan 4 simbol dalam baris horizontal',\n  },\n  verticalWin: {\n    en: 'Vertical Win: Get 3 symbols in a column vertically',\n    ar: 'ÿßŸÑŸÅŸàÿ≤ ÿßŸÑÿπŸÖŸàÿØŸä: ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ 3 ÿ±ŸÖŸàÿ≤ ŸÅŸä ÿπŸÖŸàÿØ ÿπŸÖŸàÿØŸä',\n    bn: '‡¶â‡¶≤‡ßç‡¶≤‡¶Æ‡ßç‡¶¨ ‡¶ú‡¶Ø‡¶º: ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ï‡¶≤‡¶æ‡¶Æ‡ßá 3‡¶ü‡¶ø ‡¶ö‡¶ø‡¶π‡ßç‡¶® ‡¶™‡¶æ‡¶®',\n    hi: '‡§ä‡§∞‡•ç‡§ß‡•ç‡§µ‡§æ‡§ß‡§∞ ‡§ú‡•Ä‡§§: ‡§è‡§ï ‡§ï‡•â‡§≤‡§Æ ‡§Æ‡•á‡§Ç 3 ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Victoria Vertical: Consigue 3 s√≠mbolos en una columna vertical',\n    id: 'Kemenangan Vertikal: Dapatkan 3 simbol dalam kolom vertikal',\n  },\n  diagonalWin: {\n    en: 'Diagonal Win: Get 3 symbols diagonally (positions 5, 10, 15 restricted)',\n    ar: 'ÿßŸÑŸÅŸàÿ≤ ÿßŸÑŸÇÿ∑ÿ±Ÿä: ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ 3 ÿ±ŸÖŸàÿ≤ ŸÇÿ∑ÿ±ŸäÿßŸã (ÿßŸÑŸÖŸàÿßÿ∂ÿπ 5ÿå 10ÿå 15 ŸÖÿ≠ÿ∏Ÿàÿ±ÿ©)',\n    bn: '‡¶ï‡¶∞‡ßç‡¶£ ‡¶ú‡¶Ø‡¶º: ‡¶ï‡¶∞‡ßç‡¶£‡¶≠‡¶æ‡¶¨‡ßá 3‡¶ü‡¶ø ‡¶ö‡¶ø‡¶π‡ßç‡¶® ‡¶™‡¶æ‡¶® (‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶® 5, 10, 15 ‡¶∏‡ßÄ‡¶Æ‡¶ø‡¶§)',\n    hi: '‡§µ‡§ø‡§ï‡§∞‡•ç‡§£ ‡§ú‡•Ä‡§§: ‡§µ‡§ø‡§ï‡§∞‡•ç‡§£ ‡§Æ‡•á‡§Ç 3 ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç (‡§∏‡•ç‡§•‡§ø‡§§‡§ø 5, 10, 15 ‡§™‡•ç‡§∞‡§§‡§ø‡§¨‡§Ç‡§ß‡§ø‡§§)',\n    es: 'Victoria Diagonal: Consigue 3 s√≠mbolos en diagonal (posiciones 5, 10, 15 restringidas)',\n    id: 'Kemenangan Diagonal: Dapatkan 3 simbol secara diagonal (posisi 5, 10, 15 terbatas)',\n  },\n  gridLayout: {\n    en: 'Grid Layout: 3 rows √ó 5 columns (positions 1-15)',\n    ar: 'ÿ™ÿÆÿ∑Ÿäÿ∑ ÿßŸÑÿ¥ÿ®ŸÉÿ©: 3 ÿµŸÅŸàŸÅ √ó 5 ÿ£ÿπŸÖÿØÿ© (ÿßŸÑŸÖŸàÿßÿ∂ÿπ 1-15)',\n    bn: '‡¶ó‡ßç‡¶∞‡¶ø‡¶° ‡¶≤‡ßá‡¶Ü‡¶â‡¶ü: 3 ‡¶∏‡¶æ‡¶∞‡¶ø √ó 5 ‡¶ï‡¶≤‡¶æ‡¶Æ (‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶® 1-15)',\n    hi: '‡§ó‡•ç‡§∞‡§ø‡§° ‡§≤‡•á‡§Ü‡§â‡§ü: 3 ‡§™‡§Ç‡§ï‡•ç‡§§‡§ø‡§Ø‡§æ‡§Å √ó 5 ‡§ï‡•â‡§≤‡§Æ (‡§∏‡•ç‡§•‡§ø‡§§‡§ø 1-15)',\n    es: 'Dise√±o de Cuadr√≠cula: 3 filas √ó 5 columnas (posiciones 1-15)',\n    id: 'Tata Letak Grid: 3 baris √ó 5 kolom (posisi 1-15)',\n  },\n  \n  // Quick Chat Messages\n  quickChat: {\n    en: 'Quick Chat',\n    ar: 'ÿØÿ±ÿØÿ¥ÿ© ÿ≥ÿ±Ÿäÿπÿ©',\n    bn: '‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶ü',\n    hi: '‡§§‡•ç‡§µ‡§∞‡§ø‡§§ ‡§ö‡•à‡§ü',\n    es: 'Chat R√°pido',\n    id: 'Chat Cepat',\n  },\n  goodLuck: {\n    en: 'Good luck!',\n    ar: 'ÿ≠ÿ∏ ÿ≥ÿπŸäÿØ!',\n    bn: '‡¶∂‡ßÅ‡¶≠‡¶ï‡¶æ‡¶Æ‡¶®‡¶æ!',\n    hi: '‡§∂‡•Å‡§≠‡§ï‡§æ‡§Æ‡§®‡§æ‡§è‡§Å!',\n    es: '¬°Buena suerte!',\n    id: 'Semoga beruntung!',\n  },\n  wellPlayed: {\n    en: 'Well played!',\n    ar: 'ŸÑÿπÿ® ÿ¨ŸäÿØ!',\n    bn: '‡¶≠‡¶æ‡¶≤ ‡¶ñ‡ßá‡¶≤‡ßá‡¶õ‡ßá‡¶®!',\n    hi: '‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§ñ‡•á‡§≤‡§æ!',\n    es: '¬°Bien jugado!',\n    id: 'Permainan bagus!',\n  },\n  niceMove: {\n    en: 'Nice move!',\n    ar: 'ÿ≠ÿ±ŸÉÿ© ÿ¨ŸäÿØÿ©!',\n    bn: '‡¶ö‡¶Æ‡ßé‡¶ï‡¶æ‡¶∞ ‡¶ö‡¶æ‡¶≤!',\n    hi: '‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§ö‡§æ‡§≤!',\n    es: '¬°Buen movimiento!',\n    id: 'Gerakan bagus!',\n  },\n  greatStrategy: {\n    en: 'Great strategy!',\n    ar: 'ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© ÿ±ÿßÿ¶ÿπÿ©!',\n    bn: '‡¶¶‡ßÅ‡¶∞‡ßç‡¶¶‡¶æ‡¶®‡ßç‡¶§ ‡¶ï‡ßå‡¶∂‡¶≤!',\n    hi: '‡§¨‡•á‡§π‡§§‡§∞‡•Ä‡§® ‡§∞‡§£‡§®‡•Ä‡§§‡§ø!',\n    es: '¬°Gran estrategia!',\n    id: 'Strategi hebat!',\n  },\n  playFaster: {\n    en: 'Play faster!',\n    ar: 'ÿßŸÑÿπÿ® ÿ®ÿ≥ÿ±ÿπÿ© ÿ£ŸÉÿ®ÿ±!',\n    bn: '‡¶Ü‡¶∞‡ßã ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶ñ‡ßá‡¶≤‡ßÅ‡¶®!',\n    hi: '‡§§‡•á‡§ú‡§º ‡§ñ‡•á‡§≤‡•á‡§Ç!',\n    es: '¬°Juega m√°s r√°pido!',\n    id: 'Main lebih cepat!',\n  },\n  takeYourTime: {\n    en: 'Take your time',\n    ar: 'ÿÆÿ∞ ŸàŸÇÿ™ŸÉ',\n    bn: '‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶®‡¶ø‡¶®',\n    hi: '‡§Ö‡§™‡§®‡§æ ‡§∏‡§Æ‡§Ø ‡§≤‡•á‡§Ç',\n    es: 'T√≥mate tu tiempo',\n    id: 'Ambil waktu Anda',\n  },\n  goodGame: {\n    en: 'Good game!',\n    ar: 'ŸÑÿπÿ®ÿ© ÿ¨ŸäÿØÿ©!',\n    bn: '‡¶≠‡¶æ‡¶≤ ‡¶ó‡ßá‡¶Æ!',\n    hi: '‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§ó‡•á‡§Æ!',\n    es: '¬°Buen juego!',\n    id: 'Permainan bagus!',\n  },\n  thanksForGame: {\n    en: 'Thanks for the game!',\n    ar: 'ÿ¥ŸÉÿ±ÿß ÿπŸÑŸâ ÿßŸÑŸÑÿπÿ®ÿ©!',\n    bn: '‡¶ó‡ßá‡¶Æ‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ß‡¶®‡ßç‡¶Ø‡¶¨‡¶æ‡¶¶!',\n    hi: '‡§ó‡•á‡§Æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶!',\n    es: '¬°Gracias por el juego!',\n    id: 'Terima kasih untuk permainannya!',\n  },\n  oneMore: {\n    en: 'One more?',\n    ar: 'Ÿàÿßÿ≠ÿØÿ© ÿ£ÿÆÿ±Ÿâÿü',\n    bn: '‡¶Ü‡¶∞‡ßã ‡¶è‡¶ï‡¶ü‡¶ø?',\n    hi: '‡§è‡§ï ‡§î‡§∞?',\n    es: '¬øUna m√°s?',\n    id: 'Satu lagi?',\n  },\n  impressive: {\n    en: 'Impressive!',\n    ar: 'ŸÖÿ´Ÿäÿ± ŸÑŸÑÿ•ÿπÿ¨ÿßÿ®!',\n    bn: '‡¶ö‡¶Æ‡ßé‡¶ï‡¶æ‡¶∞!',\n    hi: '‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡§∂‡§æ‡§≤‡•Ä!',\n    es: '¬°Impresionante!',\n    id: 'Mengesankan!',\n  },\n  thinking: {\n    en: 'Thinking...',\n    ar: 'ÿ£ŸÅŸÉÿ±...',\n    bn: '‡¶≠‡¶æ‡¶¨‡¶õ‡¶ø...',\n    hi: '‡§∏‡•ã‡§ö ‡§∞‡§π‡§æ ‡§π‡•Ç‡§Ç...',\n    es: 'Pensando...',\n    id: 'Berpikir...',\n  },\n  readyToPlay: {\n    en: 'Ready to play!',\n    ar: 'ÿ¨ÿßŸáÿ≤ ŸÑŸÑÿπÿ®!',\n    bn: '‡¶ñ‡ßá‡¶≤‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§!',\n    hi: '‡§ñ‡•á‡§≤‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§§‡•à‡§Ø‡§æ‡§∞!',\n    es: '¬°Listo para jugar!',\n    id: 'Siap bermain!',\n  },\n  \n  // UI Elements\n  close: {\n    en: 'Close',\n    ar: 'ÿ•ÿ∫ŸÑÿßŸÇ',\n    bn: '‡¶¨‡¶®‡ßç‡¶ß',\n    hi: '‡§¨‡§Ç‡§¶',\n    es: 'Cerrar',\n    id: 'Tutup',\n  },\n  chat: {\n    en: 'Chat',\n    ar: 'ÿØÿ±ÿØÿ¥ÿ©',\n    bn: '‡¶ö‡ßç‡¶Ø‡¶æ‡¶ü',\n    hi: '‡§ö‡•à‡§ü',\n    es: 'Chat',\n    id: 'Chat',\n  },\n  resetGame: {\n    en: 'Reset Game',\n    ar: 'ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑŸÑÿπÿ®ÿ©',\n    bn: '‡¶ó‡ßá‡¶Æ ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü',\n    hi: '‡§ó‡•á‡§Æ ‡§∞‡•Ä‡§∏‡•á‡§ü',\n    es: 'Reiniciar Juego',\n    id: 'Reset Permainan',\n  },\n  \n  // Auth Forms\n  username: {\n    en: 'Username',\n    ar: 'ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ',\n    bn: '‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶®‡¶æ‡¶Æ',\n    hi: '‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡§Æ',\n    es: 'Nombre de Usuario',\n    id: 'Nama Pengguna',\n  },\n  password: {\n    en: 'Password',\n    ar: 'ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±',\n    bn: '‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°',\n    hi: '‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°',\n    es: 'Contrase√±a',\n    id: 'Kata Sandi',\n  },\n  email: {\n    en: 'Email',\n    ar: 'ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä',\n    bn: '‡¶á‡¶Æ‡ßá‡¶á‡¶≤',\n    hi: '‡§à‡¶Æ‡ßá‡¶≤',\n    es: 'Correo Electr√≥nico',\n    id: 'Email',\n  },\n  loading: {\n    en: 'Loading...',\n    ar: 'ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...',\n    bn: '‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...',\n    hi: '‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...',\n    es: 'Cargando...',\n    id: 'Memuat...',\n  },\n  usernameOrEmail: {\n    en: 'Username or Email',\n    ar: 'ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ£Ÿà ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä',\n    bn: '‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶¨‡¶æ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤',\n    hi: '‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡¶Æ ‡§Ø‡§æ ‡§à‡¶Æ‡ßá‡¶á‡¶≤',\n    es: 'Nombre de Usuario o Correo',\n    id: 'Nama Pengguna atau Email',\n  },\n  enterCredentialsToAccess: {\n    en: 'Enter your credentials to access your account',\n    ar: 'ÿ£ÿØÿÆŸÑ ÿ®ŸäÿßŸÜÿßÿ™ŸÉ ŸÑŸÑŸàÿµŸàŸÑ ÿ•ŸÑŸâ ÿ≠ÿ≥ÿßÿ®ŸÉ',\n    bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶ï‡¶∞‡¶§‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂ ‡¶ï‡¶∞‡¶æ‡¶®',\n    hi: '‡§Ö‡§™‡§®‡•á ‡§ñ‡§æ‡§§‡•á ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡§®‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Ingresa tus credenciales para acceder a tu cuenta',\n    id: 'Masukkan kredensial Anda untuk mengakses akun Anda',\n  },\n  enterDetailsToCreate: {\n    en: 'Enter your details to create a new account',\n    ar: 'ÿ£ÿØÿÆŸÑ ÿ®ŸäÿßŸÜÿßÿ™ŸÉ ŸÑÿ•ŸÜÿ¥ÿßÿ° ÿ≠ÿ≥ÿßÿ® ÿ¨ÿØŸäÿØ',\n    bn: '‡¶è‡¶ï‡¶ü‡¶ø ‡¶®‡¶§‡ßÅ‡¶® ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£ ‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂ ‡¶ï‡¶∞‡¶æ‡¶®',\n    hi: '‡§®‡§Ø‡§æ ‡§ñ‡§æ‡§§‡§æ ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡§®‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§¶‡§∞‡ßç‡¶ú ‡¶ï‡¶∞‡•á‡§Ç',\n    es: 'Ingresa tus datos para crear una nueva cuenta',\n    id: 'Masukkan detail Anda untuk membuat akun baru',\n  },\n  enterUsernameOrEmail: {\n    en: 'Enter your username or email',\n    ar: 'ÿ£ÿØÿÆŸÑ ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ£Ÿà ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä',\n    bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶¨‡¶æ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂ ‡¶ï‡¶∞‡¶æ‡¶®',\n    hi: '‡§Ö‡§™‡§®‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡§Æ ‡§Ø‡§æ ‡§à‡¶Æ‡ßá‡¶á‡¶≤ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Ingresa tu nombre de usuario o correo',\n    id: 'Masukkan nama pengguna atau email Anda',\n  },\n  enterUsername: {\n    en: 'Enter your username',\n    ar: 'ÿ£ÿØÿÆŸÑ ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ',\n    bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂ ‡¶ï‡¶∞‡¶æ‡¶®',\n    hi: '‡§Ö‡§™‡§®‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡§Æ ‡§¶‡§∞‡ßç‡¶ú ‡¶ï‡¶∞‡•á‡§Ç',\n    es: 'Ingresa tu nombre de usuario',\n    id: 'Masukkan nama pengguna Anda',\n  },\n  enterEmail: {\n    en: 'Enter your email',\n    ar: 'ÿ£ÿØÿÆŸÑ ÿ®ÿ±ŸäÿØŸÉ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä',\n    bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂ ‡¶ï‡¶∞‡¶æ‡¶®',\n    hi: '‡§Ö‡§™‡§®‡§æ ‡§à‡¶Æ‡ßá‡¶á‡¶≤ ‡§¶‡§∞‡ßç‡¶ú ‡¶ï‡¶∞‡•á‡§Ç',\n    es: 'Ingresa tu correo electr√≥nico',\n    id: 'Masukkan email Anda',\n  },\n  enterPassword: {\n    en: 'Enter your password',\n    ar: 'ÿ£ÿØÿÆŸÑ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±',\n    bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂ ‡¶ï‡¶∞‡¶æ‡¶®',\n    hi: '‡§Ö‡§™‡§®‡§æ ‡§™‡§æ‡§∏‡§µ‡§∞‡ßç‡¶° ‡§¶‡§∞‡ßç‡¶ú ‡¶ï‡¶∞‡•á‡§Ç',\n    es: 'Ingresa tu contrase√±a',\n    id: 'Masukkan kata sandi Anda',\n  },\n  emailRequiredForVerification: {\n    en: 'Email is required for account verification and recovery',\n    ar: 'ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä ŸÖÿ∑ŸÑŸàÿ® ŸÑŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ≠ÿ≥ÿßÿ® ŸàÿßŸÑÿßÿ≥ÿ™ÿ±ÿØÿßÿØ',\n    bn: '‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á‡¶ï‡¶∞‡¶£ ‡¶è‡¶¨‡¶Ç ‡¶™‡ßÅ‡¶®‡¶∞‡ßÅ‡¶¶‡ßç‡¶ß‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®',\n    hi: '‡§ñ‡§æ‡§§‡§æ ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§® ‡§î‡§∞ ‡§™‡•Å‡§®‡§∞‡•ç‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§‡§ø ‡§ï‡•á ‡§≤‡§ø‡§è ‡§à‡¶Æ‡ßá‡¶á‡¶≤ ‡§Ü‡§µ‡§∂‡ßç‡¶Ø‡¶ï ‡§π‡•à',\n    es: 'El correo es requerido para verificaci√≥n y recuperaci√≥n de cuenta',\n    id: 'Email diperlukan untuk verifikasi dan pemulihan akun',\n  },\n  forgotPassword: {\n    en: 'Forgot password?',\n    ar: 'ŸÜÿ≥Ÿäÿ™ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±ÿü',\n    bn: '‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶≠‡ßÅ‡¶≤‡ßá ‡¶ó‡ßá‡¶õ‡ßá‡¶®?',\n    hi: '‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§≠‡•Ç‡§≤ ‡§ó‡§è?',\n    es: '¬øOlvidaste tu contrase√±a?',\n    id: 'Lupa kata sandi?',\n  },\n  dontHaveAccountSignUp: {\n    en: \"Don't have an account? Sign up\",\n    ar: 'ŸÑŸäÿ≥ ŸÑÿØŸäŸÉ ÿ≠ÿ≥ÿßÿ®ÿü ÿ≥ÿ¨ŸÑ ÿßŸÑÿ¢ŸÜ',\n    bn: '‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡ßá‡¶á? ‡¶∏‡¶æ‡¶á‡¶® ‡¶Ü‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®',\n    hi: '‡§ñ‡§æ‡§§‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à? ‡§∏‡§æ‡§á‡§® ‡§Ö‡§™ ‡§ï‡§∞‡•á‡§Ç',\n    es: '¬øNo tienes cuenta? Reg√≠strate',\n    id: 'Tidak punya akun? Daftar',\n  },\n  alreadyHaveAccountSignIn: {\n    en: 'Already have an account? Sign in',\n    ar: 'ŸÑÿØŸäŸÉ ÿ≠ÿ≥ÿßÿ® ÿ®ÿßŸÑŸÅÿπŸÑÿü ÿ≥ÿ¨ŸÑ ÿßŸÑÿØÿÆŸàŸÑ',\n    bn: '‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶Ü‡¶õ‡ßá? ‡¶∏‡¶æ‡¶á‡¶® ‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®',\n    hi: '‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§ñ‡§æ‡§§‡§æ ‡§π‡•à? ‡§∏‡§æ‡§á‡§® ‡§á‡§® ‡§ï‡§∞‡•á‡§Ç',\n    es: '¬øYa tienes cuenta? Inicia sesi√≥n',\n    id: 'Sudah punya akun? Masuk',\n  },\n  \n  // Toast Messages\n  loginSuccessful: {\n    en: 'Login successful',\n    ar: 'ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ÿ®ŸÜÿ¨ÿßÿ≠',\n    bn: '‡¶≤‡¶ó‡¶á‡¶® ‡¶∏‡¶´‡¶≤',\n    hi: '‡§≤‡•â‡§ó‡§ø‡§® ‡§∏‡§´‡§≤',\n    es: 'Inicio de sesi√≥n exitoso',\n    id: 'Login berhasil',\n  },\n  welcomeBack: {\n    en: 'Welcome back!',\n    ar: 'ŸÖÿ±ÿ≠ÿ®ÿßŸã ÿ®ÿπŸàÿØÿ™ŸÉ!',\n    bn: '‡¶´‡¶ø‡¶∞‡ßá ‡¶Ü‡¶∏‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ!',\n    hi: '‡§µ‡§æ‡§™‡§∏‡•Ä ‡§™‡§∞ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à!',\n    es: '¬°Bienvenido de vuelta!',\n    id: 'Selamat datang kembali!',\n  },\n  emailVerificationRequired: {\n    en: 'Email verification required',\n    ar: 'ŸÖÿ∑ŸÑŸàÿ® ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä',\n    bn: '‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á‡¶ï‡¶∞‡¶£ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®',\n    hi: '‡§à‡¶Æ‡ßá‡¶á‡¶≤ ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§® ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï',\n    es: 'Verificaci√≥n de correo requerida',\n    id: 'Verifikasi email diperlukan',\n  },\n  pleaseVerifyEmailBeforeLogin: {\n    en: 'Please verify your email before logging in.',\n    ar: 'Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿ®ÿ±ŸäÿØŸÉ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä ŸÇÿ®ŸÑ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ.',\n    bn: '‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶Ü‡¶ó‡ßá ‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á ‡¶ï‡¶∞‡ßÅ‡¶®‡•§',\n    hi: '‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§™‡§®‡•á ‡§à‡¶Æ‡ßá‡¶á‡§≤ ‡§ï‡•ã ‡§∏‡§§‡ßç‡¶Ø‡¶æ‡¶™‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§',\n    es: 'Por favor verifica tu correo antes de iniciar sesi√≥n.',\n    id: 'Harap verifikasi email Anda sebelum login.',\n  },\n  loginFailed: {\n    en: 'Login failed',\n    ar: 'ŸÅÿ¥ŸÑ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ',\n    bn: '‡¶≤‡¶ó‡¶á‡¶® ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•',\n    hi: '‡§≤‡•â‡§ó‡§ø‡§® ‡§Ö‡§∏‡§´‡§≤',\n    es: 'Inicio de sesi√≥n fallido',\n    id: 'Login gagal',\n  },\n  pleaseCheckCredentials: {\n    en: 'Please check your credentials and try again.',\n    ar: 'Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿ®ŸäÿßŸÜÿßÿ™ŸÉ ŸàÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ.',\n    bn: '‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§',\n    hi: '‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§™‡§®‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç ‡§î‡§∞ ‡§™‡ßÅ‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§',\n    es: 'Por favor verifica tus credenciales e int√©ntalo de nuevo.',\n    id: 'Harap periksa kredensial Anda dan coba lagi.',\n  },\n  emailRequired: {\n    en: 'Email required',\n    ar: 'ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä ŸÖÿ∑ŸÑŸàÿ®',\n    bn: '‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®',\n    hi: '‡§à‡¶Æ‡ßá‡¶á‡¶≤ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï',\n    es: 'Correo requerido',\n    id: 'Email diperlukan',\n  },\n  pleaseProvideEmailToRegister: {\n    en: 'Please provide an email address to register.',\n    ar: 'Ÿäÿ±ÿ¨Ÿâ ÿ™ŸÇÿØŸäŸÖ ÿπŸÜŸàÿßŸÜ ÿ®ÿ±ŸäÿØ ÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä ŸÑŸÑÿ™ÿ≥ÿ¨ŸäŸÑ.',\n    bn: '‡¶®‡¶ø‡¶¨‡¶®‡ßç‡¶ß‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§',\n    hi: '‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•É‡§™‡§Ø‡§æ ‡§è‡§ï ‡§à‡¶Æ‡ßá‡¶á‡§≤ ‡§™‡§§‡§æ ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡•á‡§Ç‡•§',\n    es: 'Por favor proporciona una direcci√≥n de correo para registrarte.',\n    id: 'Harap berikan alamat email untuk mendaftar.',\n  },\n  registrationSuccessful: {\n    en: 'Registration successful',\n    ar: 'ŸÜÿ¨ÿ≠ ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ',\n    bn: '‡¶®‡¶ø‡¶¨‡¶®‡ßç‡¶ß‡¶® ‡¶∏‡¶´‡¶≤',\n    hi: '‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§∏‡§´‡§≤',\n    es: 'Registro exitoso',\n    id: 'Pendaftaran berhasil',\n  },\n  pleaseVerifyEmailToContinue: {\n    en: 'Please verify your email to continue.',\n    ar: 'Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿ®ÿ±ŸäÿØŸÉ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä ŸÑŸÑŸÖÿ™ÿßÿ®ÿπÿ©.',\n    bn: '‡¶ö‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ø‡ßá‡¶§‡ßá ‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á ‡¶ï‡¶∞‡ßÅ‡¶®‡•§',\n    hi: '‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§™‡§®‡•á ‡§à‡¶Æ‡ßá‡¶á‡¶≤ ‡§ï‡•ã ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç‡•§',\n    es: 'Por favor verifica tu correo para continuar.',\n    id: 'Harap verifikasi email Anda untuk melanjutkan.',\n  },\n  registrationFailed: {\n    en: 'Registration failed',\n    ar: 'ŸÅÿ¥ŸÑ ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ',\n    bn: '‡¶®‡¶ø‡¶¨‡¶®‡ßç‡¶ß‡¶® ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•',\n    hi: '‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§Ö‡§∏‡§´‡§≤',\n    es: 'Registro fallido',\n    id: 'Pendaftaran gagal',\n  },\n  pleaseCheckInformationAndTryAgain: {\n    en: 'Please check your information and try again.',\n    ar: 'Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ŸÖÿπŸÑŸàŸÖÿßÿ™ŸÉ ŸàÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ.',\n    bn: '‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§',\n    hi: '‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§™‡§®‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç ‡§î‡§∞ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§',\n    es: 'Por favor verifica tu informaci√≥n e int√©ntalo de nuevo.',\n    id: 'Harap periksa informasi Anda dan coba lagi.',\n  },\n  \n  // Game Status\n  playerTurn: {\n    en: \"Player %s's Turn\",\n    ar: 'ÿØŸàÿ± ÿßŸÑŸÑÿßÿπÿ® %s',\n    bn: '‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º %s ‡¶è‡¶∞ ‡¶™‡¶æ‡¶≤‡¶æ',\n    hi: '‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä %s ‡§ï‡•Ä ‡§¨‡§æ‡§∞‡•Ä',\n    es: 'Turno del Jugador %s',\n    id: 'Giliran Pemain %s',\n  },\n  winner: {\n    en: 'Winner: %s',\n    ar: 'ÿßŸÑŸÅÿßÿ¶ÿ≤: %s',\n    bn: '‡¶¨‡¶ø‡¶ú‡¶Ø‡¶º‡ßÄ: %s',\n    hi: '‡§µ‡§ø‡§ú‡•á‡§§‡§æ: %s',\n    es: 'Ganador: %s',\n    id: 'Pemenang: %s',\n  },\n  draw: {\n    en: 'Draw!',\n    ar: 'ÿ™ÿπÿßÿØŸÑ!',\n    bn: '‡¶°‡ßç‡¶∞!',\n    hi: '‡§°‡•ç‡§∞‡•â!',\n    es: '¬°Empate!',\n    id: 'Seri!',\n  },\n  \n  // Settings\n  settings: {\n    en: 'Settings',\n    ar: 'ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™',\n    bn: '‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏',\n    hi: '‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏',\n    es: 'Configuraci√≥n',\n    id: 'Pengaturan',\n  },\n  theme: {\n    en: 'Theme',\n    ar: 'ÿßŸÑŸÖÿ∏Ÿáÿ±',\n    bn: '‡¶•‡¶ø‡¶Æ',\n    hi: '‡§•‡•Ä‡§Æ',\n    es: 'Tema',\n    id: 'Tema',\n  },\n  language: {\n    en: 'Language',\n    ar: 'ÿßŸÑŸÑÿ∫ÿ©',\n    bn: '‡¶≠‡¶æ‡¶∑‡¶æ',\n    hi: '‡§≠‡§æ‡§∑‡§æ',\n    es: 'Idioma',\n    id: 'Bahasa',\n  },\n  \n  // AI Difficulty Levels\n  difficulty: {\n    en: 'Difficulty',\n    ar: 'ŸÖÿ≥ÿ™ŸàŸâ ÿßŸÑÿµÿπŸàÿ®ÿ©',\n    bn: '‡¶ï‡¶†‡¶ø‡¶®‡¶§‡¶æ',\n    hi: '‡§ï‡§†‡§ø‡§®‡§æ‡§à',\n    es: 'Dificultad',\n    id: 'Tingkat Kesulitan',\n  },\n  easy: {\n    en: 'Easy',\n    ar: 'ÿ≥ŸáŸÑ',\n    bn: '‡¶∏‡¶π‡¶ú',\n    hi: '‡§Ü‡§∏‡§æ‡§®',\n    es: 'F√°cil',\n    id: 'Mudah',\n  },\n  medium: {\n    en: 'Medium',\n    ar: 'ŸÖÿ™Ÿàÿ≥ÿ∑',\n    bn: '‡¶Æ‡¶æ‡¶ù‡¶æ‡¶∞‡¶ø',\n    hi: '‡§Æ‡§ß‡•ç‡§Ø‡§Æ',\n    es: 'Medio',\n    id: 'Sedang',\n  },\n  hard: {\n    en: 'Hard',\n    ar: 'ÿµÿπÿ®',\n    bn: '‡¶ï‡¶†‡¶ø‡¶®',\n    hi: '‡§ï‡§†‡§ø‡§®',\n    es: 'Dif√≠cil',\n    id: 'Sulit',\n  },\n  \n  // Game Mode Descriptions\n  challengeComputer: {\n    en: 'Challenge the computer',\n    ar: 'ÿ™ÿ≠ÿØŸä ÿßŸÑÿ≠ÿßÿ≥Ÿàÿ®',\n    bn: '‡¶ï‡¶Æ‡ßç‡¶™‡¶ø‡¶â‡¶ü‡¶æ‡¶∞‡¶ï‡ßá ‡¶ö‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶û‡ßç‡¶ú ‡¶ï‡¶∞‡ßÅ‡¶®',\n    hi: '‡§ï‡§Ç‡§™‡•ç‡§Ø‡•Ç‡§ü‡§∞ ‡§ï‡•ã ‡§ö‡•Å‡§®‡•å‡§§‡•Ä ‡§¶‡•á‡§Ç',\n    es: 'Desaf√≠a a la computadora',\n    id: 'Tantang komputer',\n  },\n  localMultiplayer: {\n    en: 'Local multiplayer',\n    ar: 'ŸÖÿ™ÿπÿØÿØ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ÿßŸÑŸÖÿ≠ŸÑŸä',\n    bn: '‡¶∏‡ßç‡¶•‡¶æ‡¶®‡ßÄ‡¶Ø‡¶º ‡¶¨‡¶π‡ßÅ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º',\n    hi: '‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§Æ‡§≤‡•ç‡§ü‡•Ä‡§™‡•ç‡§≤‡•á‡§Ø‡§∞',\n    es: 'Multijugador local',\n    id: 'Multiplayer lokal',\n  },\n  playWithFriends: {\n    en: 'Play with friends online',\n    ar: 'ÿßŸÑÿπÿ® ŸÖÿπ ÿßŸÑÿ£ÿµÿØŸÇÿßÿ° ÿπÿ®ÿ± ÿßŸÑÿ•ŸÜÿ™ÿ±ŸÜÿ™',\n    bn: '‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶®‡ßá ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶ñ‡ßá‡¶≤‡ßÅ‡¶®',\n    hi: '‡§¶‡•ã‡§∏‡•ç‡§§‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§ñ‡•á‡§≤‡•á‡§Ç',\n    es: 'Juega con amigos en l√≠nea',\n    id: 'Bermain dengan teman secara online',\n  },\n  \n  // Profile and Dashboard\n  profile: {\n    en: 'Profile',\n    ar: 'ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä',\n    bn: '‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤',\n    hi: '‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤',\n    es: 'Perfil',\n    id: 'Profil',\n  },\n  playerDashboard: {\n    en: 'Player Dashboard',\n    ar: 'ŸÑŸàÿ≠ÿ© ÿ™ÿ≠ŸÉŸÖ ÿßŸÑŸÑÿßÿπÿ®',\n    bn: '‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°',\n    hi: '‡§™‡•ç‡§≤‡•á‡§Ø‡§∞ ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°',\n    es: 'Panel del Jugador',\n    id: 'Dashboard Pemain',\n  },\n  gameBoard: {\n    en: 'Game Board',\n    ar: 'ŸÑŸàÿ≠ÿ© ÿßŸÑŸÑÿπÿ®ÿ©',\n    bn: '‡¶ó‡ßá‡¶Æ ‡¶¨‡ßã‡¶∞‡ßç‡¶°',\n    hi: '‡§ó‡•á‡§Æ ‡§¨‡•ã‡§∞‡•ç‡§°',\n    es: 'Tablero de Juego',\n    id: 'Papan Permainan',\n  },\n  playerTurnX: {\n    en: \"Player X's Turn\",\n    ar: 'ÿØŸàÿ± ÿßŸÑŸÑÿßÿπÿ® X',\n    bn: '‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ X ‡¶è‡¶∞ ‡¶™‡¶æ‡¶≤‡¶æ',\n    hi: '‡§™‡•ç‡§≤‡•á‡§Ø‡§∞ X ‡§ï‡•Ä ‡§¨‡§æ‡§∞‡•Ä',\n    es: 'Turno del Jugador X',\n    id: 'Giliran Pemain X',\n  },\n  gameStats: {\n    en: 'Game Stats',\n    ar: 'ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ©',\n    bn: '‡¶ó‡ßá‡¶Æ‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶®',\n    hi: '‡§ó‡•á‡§Æ ‡§Ü‡§Ç‡§ï‡§°‡§º‡•á',\n    es: 'Estad√≠sticas del Juego',\n    id: 'Statistik Permainan',\n  },\n  wins: {\n    en: 'Wins',\n    ar: 'ÿßŸÜÿ™ÿµÿßÿ±ÿßÿ™',\n    bn: '‡¶ú‡¶Ø‡¶º',\n    hi: '‡§ú‡•Ä‡§§',\n    es: 'Victorias',\n    id: 'Menang',\n  },\n  losses: {\n    en: 'Losses',\n    ar: 'Ÿáÿ≤ÿßÿ¶ŸÖ',\n    bn: '‡¶™‡¶∞‡¶æ‡¶ú‡¶Ø‡¶º',\n    hi: '‡§π‡§æ‡§∞',\n    es: 'Derrotas',\n    id: 'Kalah',\n  },\n  draws: {\n    en: 'Draws',\n    ar: 'ÿ™ÿπÿßÿØŸÑ',\n    bn: '‡¶°‡ßç‡¶∞',\n    hi: '‡§°‡•ç‡§∞‡•â',\n    es: 'Empates',\n    id: 'Seri',\n  },\n  total: {\n    en: 'Total',\n    ar: 'ÿßŸÑŸÖÿ¨ŸÖŸàÿπ',\n    bn: '‡¶Æ‡ßã‡¶ü',\n    hi: '‡§ï‡•Å‡§≤',\n    es: 'Total',\n    id: 'Total',\n  },\n  \n  // Profile Management\n  editProfile: {\n    en: 'Edit Profile',\n    ar: 'ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä',\n    bn: '‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶Æ‡ßç‡¶™‡¶æ‡¶¶‡¶®‡¶æ',\n    hi: '‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤ ‡§∏‡§Ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Editar Perfil',\n    id: 'Edit Profil',\n  },\n  profilePicture: {\n    en: 'Profile Picture',\n    ar: 'ÿµŸàÿ±ÿ© ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä',\n    bn: '‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶õ‡¶¨‡¶ø',\n    hi: '‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤ ‡§ö‡§ø‡§§‡•ç‡§∞',\n    es: 'Foto de Perfil',\n    id: 'Foto Profil',\n  },\n  displayName: {\n    en: 'Display Name',\n    ar: 'ÿßŸÑÿßÿ≥ŸÖ ÿßŸÑŸÖÿπÿ±Ÿàÿ∂',\n    bn: '‡¶™‡ßç‡¶∞‡¶¶‡¶∞‡ßç‡¶∂‡¶® ‡¶®‡¶æ‡¶Æ',\n    hi: '‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§® ‡§®‡§æ‡§Æ',\n    es: 'Nombre de Visualizaci√≥n',\n    id: 'Nama Tampilan',\n  },\n  uploadPhoto: {\n    en: 'Upload Photo',\n    ar: 'ÿ±ŸÅÿπ ÿµŸàÿ±ÿ©',\n    bn: '‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶°',\n    hi: '‡§´‡•ã‡§ü‡•ã ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Subir Foto',\n    id: 'Unggah Foto',\n  },\n  saveChanges: {\n    en: 'Save Changes',\n    ar: 'ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ÿ∫ŸäŸäÿ±ÿßÿ™',\n    bn: '‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£',\n    hi: '‡§™‡§∞‡§ø‡§µ‡§∞‡•ç‡§§‡§® ‡§∏‡§π‡•á‡§ú‡•á‡§Ç',\n    es: 'Guardar Cambios',\n    id: 'Simpan Perubahan',\n  },\n  cancel: {\n    en: 'Cancel',\n    ar: 'ÿ•ŸÑÿ∫ÿßÿ°',\n    bn: '‡¶¨‡¶æ‡¶§‡¶ø‡¶≤',\n    hi: '‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Cancelar',\n    id: 'Batal',\n  },\n  \n  // Friends and Social\n  friends: {\n    en: 'Friends',\n    ar: 'ÿßŸÑÿ£ÿµÿØŸÇÿßÿ°',\n    bn: '‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶∞‡¶æ',\n    hi: '‡§Æ‡§ø‡§§‡•ç‡§∞',\n    es: 'Amigos',\n    id: 'Teman',\n  },\n  friendsOne: {\n    en: 'Friends (1)',\n    ar: 'ÿßŸÑÿ£ÿµÿØŸÇÿßÿ° (1)',\n    bn: '‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶∞‡¶æ (1)',\n    hi: '‡§Æ‡§ø‡§§‡•ç‡§∞ (1)',\n    es: 'Amigos (1)',\n    id: 'Teman (1)',\n  },\n  requests: {\n    en: 'Requests',\n    ar: 'ÿßŸÑÿ∑ŸÑÿ®ÿßÿ™',\n    bn: '‡¶Ö‡¶®‡ßÅ‡¶∞‡ßã‡¶ß',\n    hi: '‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß',\n    es: 'Solicitudes',\n    id: 'Permintaan',\n  },\n  addFriend: {\n    en: 'Add Friend',\n    ar: 'ÿ•ÿ∂ÿßŸÅÿ© ÿµÿØŸäŸÇ',\n    bn: '‡¶¨‡¶®‡ßç‡¶ß‡ßÅ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®',\n    hi: '‡§Æ‡§ø‡§§‡•ç‡§∞ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç',\n    es: 'Agregar Amigo',\n    id: 'Tambah Teman',\n  },\n  \n  // Achievements\n  achievements: {\n    en: 'Achievements',\n    ar: 'ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤ÿßÿ™',\n    bn: '‡¶Ö‡¶∞‡ßç‡¶ú‡¶®',\n    hi: '‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡§ø‡§Ø‡§æ‡§Ç',\n    es: 'Logros',\n    id: 'Pencapaian',\n  },\n  yourAchievements: {\n    en: 'Your Achievements',\n    ar: 'ÿ•ŸÜÿ¨ÿßÿ≤ÿßÿ™ŸÉ',\n    bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶ú‡¶®',\n    hi: '‡§Ü‡§™‡§ï‡•Ä ‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡§ø‡§Ø‡§æ‡§Ç',\n    es: 'Tus Logros',\n    id: 'Pencapaian Anda',\n  },\n\n  winYourFirstGame: {\n    en: 'Win your first game',\n    ar: 'ÿßÿ±ÿ®ÿ≠ ŸÑÿπÿ®ÿ™ŸÉ ÿßŸÑÿ£ŸàŸÑŸâ',\n    bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶ó‡ßá‡¶Æ ‡¶ú‡¶ø‡¶§‡ßÅ‡¶®',\n    hi: '‡§Ö‡§™‡§®‡§æ ‡§™‡§π‡§≤‡§æ ‡§ó‡ßá‡∏° ‡¶ú‡ßÄ‡¶§‡•á‡§Ç',\n    es: 'Gana tu primer juego',\n    id: 'Menangkan permainan pertama Anda',\n  },\n  speedDemonDesc: {\n    en: 'Win 20 total games to unlock the Christmas theme - keep playing!',\n    ar: 'ÿßÿ±ÿ®ÿ≠ 20 ŸÑÿπÿ®ÿ© ŸÑŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ŸÖÿ∏Ÿáÿ± ÿπŸäÿØ ÿßŸÑŸÖŸäŸÑÿßÿØ - ÿßÿ≥ÿ™ŸÖÿ± ŸÅŸä ÿßŸÑŸÑÿπÿ®!',\n    bn: '‡ß®‡ß¶‡¶ü‡¶ø ‡¶ó‡ßá‡¶Æ ‡¶ú‡¶ø‡¶§‡ßÅ‡¶® ‡¶ï‡ßç‡¶∞‡¶ø‡¶∏‡¶Æ‡¶æ‡¶∏ ‡¶•‡¶ø‡¶Æ ‡¶Ü‡¶®‡¶≤‡¶ï ‡¶ï‡¶∞‡¶§‡ßá - ‡¶ñ‡ßá‡¶≤‡¶æ ‡¶ö‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ø‡¶æ‡¶®!',\n    hi: '‡§ï‡•ç‡§∞‡§ø‡§∏‡§Æ‡§∏ ‡§•‡•Ä‡§Æ ‡§Ö‡§®‡§≤‡•â‡§ï ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è 20 ‡§ó‡•á‡§Æ ‡§ú‡•Ä‡§§‡•á‡§Ç - ‡§ñ‡•á‡§≤‡§§‡•á ‡§∞‡§π‡•á‡§Ç!',\n    es: 'Gana 20 juegos para desbloquear el tema navide√±o - ¬°sigue jugando!',\n    id: 'Menangkan 20 permainan untuk membuka tema Natal - terus bermain!',\n  },\n  legendDesc: {\n    en: 'Achieve 50 total wins to become a true legend with animated border!',\n    ar: 'ÿ≠ŸÇŸÇ 50 ŸÅŸàÿ≤ÿßŸã ŸÑŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ŸÑŸÇÿ® ÿ£ÿ≥ÿ∑Ÿàÿ±ÿ© ŸÖÿπ ÿ≠ÿØŸàÿØ ŸÖÿ™ÿ≠ÿ±ŸÉÿ©!',\n    bn: '‡¶Ö‡ßç‡¶Ø‡¶æ‡¶®‡¶ø‡¶Æ‡ßá‡¶ü‡ßá‡¶° ‡¶¨‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶∏‡¶π ‡¶™‡ßç‡¶∞‡¶ï‡ßÉ‡¶§ ‡¶ï‡¶ø‡¶Ç‡¶¨‡¶¶‡¶®‡ßç‡¶§‡¶ø ‡¶π‡¶§‡ßá ‡ß´‡ß¶‡¶ü‡¶ø ‡¶ú‡¶Ø‡¶º ‡¶Ö‡¶∞‡ßç‡¶ú‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®!',\n    hi: '‡§è‡§®‡§ø‡§Æ‡•á‡§ü‡•á‡§° ‡§¨‡•â‡§∞‡•ç‡§°‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§ö‡•ç‡§ö‡•á ‡§≤‡•Ä‡§ú‡•á‡§Ç‡§° ‡§¨‡§®‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è 50 ‡§ú‡•Ä‡§§ ‡§π‡§æ‡§∏‡§ø‡§≤ ‡§ï‡§∞‡•á‡§Ç!',\n    es: '¬°Consigue 50 victorias para convertirte en una verdadera leyenda con borde animado!',\n    id: 'Raih 50 kemenangan untuk menjadi legenda sejati dengan border animasi!',\n  },\n  championDesc: {\n    en: 'Achieve 100 total wins to become an ultimate champion with cosmic border!',\n    ar: 'ÿ≠ŸÇŸÇ 100 ŸÅŸàÿ≤ ŸÑŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ŸÑŸÇÿ® ÿßŸÑÿ®ÿ∑ŸÑ ÿßŸÑŸÜŸáÿßÿ¶Ÿä ŸÖÿπ ÿ≠ÿØŸàÿØ ŸÉŸàŸÜŸäÿ©!',\n    bn: '‡¶ï‡¶∏‡¶Æ‡¶ø‡¶ï ‡¶¨‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶∏‡¶π ‡¶ö‡ßÇ‡¶°‡¶º‡¶æ‡¶®‡ßç‡¶§ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™‡¶ø‡¶Ø‡¶º‡¶® ‡¶π‡¶§‡ßá ‡ßß‡ß¶‡ß¶‡¶ü‡¶ø ‡¶ú‡¶Ø‡¶º ‡¶Ö‡¶∞‡ßç‡¶ú‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®!',\n    hi: '‡§ï‡•â‡§∏‡•ç‡§Æ‡¶ø‡§ï ‡§¨‡•â‡§∞‡•ç‡§°‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§Ö‡§≤‡•ç‡§ü‡§ø‡§Æ‡•á‡§ü ‡§ö‡•à‡§Ç‡§™‡§ø‡§Ø‡§® ‡§¨‡§®‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è 100 ‡§ú‡•Ä‡§§ ‡§π‡§æ‡§∏‡§ø‡§≤ ‡§ï‡§∞‡•á‡§Ç!',\n    es: '¬°Consigue 100 victorias para convertirte en el campe√≥n definitivo con borde c√≥smico!',\n    id: 'Raih 100 kemenangan untuk menjadi juara ultimate dengan border kosmik!',\n  },\n  grandmaster: {\n    en: 'Grandmaster',\n    ar: 'ÿßŸÑÿ£ÿ≥ÿ™ÿßÿ∞ ÿßŸÑÿ£ŸÉÿ®ÿ±',\n    bn: '‡¶ó‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶Æ‡¶æ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞',\n    hi: '‡§ó‡•ç‡§∞‡•à‡§Ç‡§°‡§Æ‡§æ‡§∏‡•ç‡§ü‡§∞',\n    es: 'Gran Maestro',\n    id: 'Grandmaster',\n  },\n  achieveTwoHundredTotalWins: {\n    en: 'Achieve 200 total wins',\n    ar: 'ÿ≠ŸÇŸÇ 200 ŸÅŸàÿ≤ ÿ•ÿ¨ŸÖÿßŸÑŸä',\n    bn: '‡ß®‡ß¶‡ß¶‡¶ü‡¶ø ‡¶Æ‡ßã‡¶ü ‡¶ú‡¶Ø‡¶º ‡¶Ö‡¶∞‡ßç‡¶ú‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®',\n    hi: '200 ‡§ï‡•Å‡§≤ ‡§ú‡•Ä‡§§ ‡§π‡§æ‡§∏‡§ø‡§≤ ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Consigue 200 victorias totales',\n    id: 'Raih 200 kemenangan total',\n  },\n  ultimateVeteran: {\n    en: 'Ultimate Veteran',\n    ar: 'ÿßŸÑŸÖÿ≠ÿßÿ±ÿ® ÿßŸÑÿ£ŸÇÿµŸâ',\n    bn: '‡¶ö‡ßÇ‡¶°‡¶º‡¶æ‡¶®‡ßç‡¶§ ‡¶≠‡ßá‡¶ü‡ßá‡¶∞‡¶æ‡¶®',\n    hi: '‡§Ö‡§≤‡•ç‡§ü‡§ø‡§Æ‡•á‡§ü ‡§µ‡•á‡§ü‡•á‡§∞‡§®',\n    es: 'Veterano Supremo',\n    id: 'Veteran Ultimate',\n  },\n  playFiveHundredTotalGames: {\n    en: 'Play 500 total games',\n    ar: 'ÿßŸÑÿπÿ® 500 ŸÑÿπÿ®ÿ© ÿ•ÿ¨ŸÖÿßŸÑŸäÿ©',\n    bn: '‡ß´‡ß¶‡ß¶‡¶ü‡¶ø ‡¶Æ‡ßã‡¶ü ‡¶ó‡ßá‡¶Æ ‡¶ñ‡ßá‡¶≤‡ßÅ‡¶®',\n    hi: '500 ‡§ï‡•Å‡§≤ ‡§ó‡•á‡§Æ ‡§ñ‡•á‡§≤‡•á‡§Ç',\n    es: 'Juega 500 juegos totales',\n    id: 'Mainkan 500 permainan total',\n  },\n  \n  // Quick Actions\n  quickActions: {\n    en: 'Quick Actions',\n    ar: 'ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™ ÿßŸÑÿ≥ÿ±Ÿäÿπÿ©',\n    bn: '‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶ï‡¶∞‡ßç‡¶Æ',\n    hi: '‡§§‡•ç‡§µ‡§∞‡§ø‡§§ ‡§ï‡§æ‡§∞‡•ç‡§Ø',\n    es: 'Acciones R√°pidas',\n    id: 'Tindakan Cepat',\n  },\n  change: {\n    en: 'Change',\n    ar: 'ÿ™ÿ∫ŸäŸäÿ±',\n    bn: '‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®',\n    hi: '‡§¨‡§¶‡§≤‡§æ‡§µ',\n    es: 'Cambiar',\n    id: 'Ubah',\n  },\n  view: {\n    en: 'View',\n    ar: 'ÿπÿ±ÿ∂',\n    bn: '‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®',\n    hi: '‡§¶‡•á‡§ñ‡•á‡§Ç',\n    es: 'Ver',\n    id: 'Lihat',\n  },\n  menu: {\n    en: 'Menu',\n    ar: 'ÿßŸÑŸÇÿßÿ¶ŸÖÿ©',\n    bn: '‡¶Æ‡ßá‡¶®‡ßÅ',\n    hi: '‡§Æ‡•á‡§®‡•Ç',\n    es: 'Men√∫',\n    id: 'Menu',\n  },\n  online: {\n    en: 'Online',\n    ar: 'ŸÖÿ™ÿµŸÑ',\n    bn: '‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶®',\n    hi: '‡§ë‡§®‡§≤‡¶æ‡§á‡§®',\n    es: 'En l√≠nea',\n    id: 'Online',\n  },\n  playersLabel: {\n    en: 'Players',\n    ar: 'ÿßŸÑŸÑÿßÿπÿ®ŸàŸÜ',\n    bn: '‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º',\n    hi: '‡§ñ‡¶ø‡¶≤‡¶æ‡¶°‡§º‡ßÄ',\n    es: 'Jugadores',\n    id: 'Pemain',\n  },\n  onePlayer: {\n    en: '1 Player',\n    ar: '1 ŸÑÿßÿπÿ®',\n    bn: '‡ßß ‡¶ú‡¶® ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º',\n    hi: '1 ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä',\n    es: '1 Jugador',\n    id: '1 Pemain',\n  },\n  profileSettings: {\n    en: 'Profile Settings',\n    ar: 'ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä',\n    bn: '‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏',\n    hi: '‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤ ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏',\n    es: 'Configuraci√≥n de Perfil',\n    id: 'Pengaturan Profil',\n  },\n  offline: {\n    en: 'Offline',\n    ar: 'ÿ∫Ÿäÿ± ŸÖÿ™ÿµŸÑ',\n    bn: '‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶®',\n    hi: '‡§ë‡§´‡§≤‡§æ‡§á‡§®',\n    es: 'Desconectado',\n    id: 'Offline',\n  },\n  \n  // Game Board Elements\n  gameId: {\n    en: 'Game ID',\n    ar: 'ŸÖÿπÿ±ŸÅ ÿßŸÑŸÑÿπÿ®ÿ©',\n    bn: '‡¶ó‡ßá‡¶Æ ‡¶Ü‡¶á‡¶°‡¶ø',\n    hi: '‡§ó‡•á‡§Æ ‡§Ü‡§à‡§°‡•Ä',\n    es: 'ID del Juego',\n    id: 'ID Permainan',\n  },\n  roomLabel: {\n    en: 'Room',\n    ar: 'ÿßŸÑÿ∫ÿ±ŸÅÿ©',\n    bn: '‡¶∞‡ßÅ‡¶Æ',\n    hi: '‡§ï‡§Æ‡§∞‡§æ',\n    es: 'Habitaci√≥n',\n    id: 'Ruang',\n  },\n  local: {\n    en: 'Local',\n    ar: 'ŸÖÿ≠ŸÑŸä',\n    bn: '‡¶∏‡ßç‡¶•‡¶æ‡¶®‡ßÄ‡¶Ø‡¶º',\n    hi: '‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø',\n    es: 'Local',\n    id: 'Lokal',\n  },\n\n  \n  // Player Names\n  playerX: {\n    en: 'Player X',\n    ar: 'ÿßŸÑŸÑÿßÿπÿ® X',\n    bn: '‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ X',\n    hi: '‡§™‡•ç‡§≤‡•á‡§Ø‡§∞ X',\n    es: 'Jugador X',\n    id: 'Pemain X',\n  },\n  playerO: {\n    en: 'Player O',\n    ar: 'ÿßŸÑŸÑÿßÿπÿ® O',\n    bn: '‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ O',\n    hi: '‡§™‡•ç‡§≤‡•á‡§Ø‡§∞ O',\n    es: 'Jugador O',\n    id: 'Pemain O',\n  },\n  playerTurnO: {\n    en: \"Player O's Turn\",\n    ar: 'ÿØŸàÿ± ÿßŸÑŸÑÿßÿπÿ® O',\n    bn: '‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ O ‡¶è‡¶∞ ‡¶™‡¶æ‡¶≤‡¶æ',\n    hi: '‡§™‡•ç‡§≤‡•á‡§Ø‡§∞ O ‡§ï‡•Ä ‡§¨‡§æ‡§∞‡•Ä',\n    es: 'Turno del Jugador O',\n    id: 'Giliran Pemain O',\n  },\n  aiTurn: {\n    en: \"AI's Turn\",\n    ar: 'ÿØŸàÿ± ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä',\n    bn: '‡¶è‡¶Ü‡¶á ‡¶è‡¶∞ ‡¶™‡¶æ‡¶≤‡¶æ',\n    hi: 'AI ‡§ï‡•Ä ‡§¨‡§æ‡§∞‡•Ä',\n    es: 'Turno de la IA',\n    id: 'Giliran AI',\n  },\n  ai: {\n    en: 'AI',\n    ar: 'ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä',\n    bn: '‡¶è‡¶Ü‡¶á',\n    hi: 'AI',\n    es: 'IA',\n    id: 'AI',\n  },\n  \n  // Achievement Categories and Details\n  victoryAchievements: {\n    en: 'Victory Achievements',\n    ar: 'ÿ•ŸÜÿ¨ÿßÿ≤ÿßÿ™ ÿßŸÑŸÜÿµÿ±',\n    bn: '‡¶¨‡¶ø‡¶ú‡¶Ø‡¶º‡ßá‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶ú‡¶®',\n    hi: '‡§µ‡§ø‡§ú‡§Ø ‡§ï‡•Ä ‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡§ø‡§Ø‡§æ‡§Ç',\n    es: 'Logros de Victoria',\n    id: 'Pencapaian Kemenangan',\n  },\n  skillAchievements: {\n    en: 'Skill Achievements',\n    ar: 'ÿ•ŸÜÿ¨ÿßÿ≤ÿßÿ™ ÿßŸÑŸÖŸáÿßÿ±ÿ©',\n    bn: '‡¶¶‡¶ï‡ßç‡¶∑‡¶§‡¶æ‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶ú‡¶®',\n    hi: '‡§ï‡•å‡§∂‡§≤ ‡§ï‡•Ä ‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡§ø‡§Ø‡§æ‡§Ç',\n    es: 'Logros de Habilidad',\n    id: 'Pencapaian Keterampilan',\n  },\n  experienceAchievements: {\n    en: 'Experience Achievements',\n    ar: 'ÿ•ŸÜÿ¨ÿßÿ≤ÿßÿ™ ÿßŸÑÿÆÿ®ÿ±ÿ©',\n    bn: '‡¶Ö‡¶≠‡¶ø‡¶ú‡ßç‡¶û‡¶§‡¶æ‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶ú‡¶®',\n    hi: '‡§Ö‡§®‡•Å‡§≠‡§µ ‡§ï‡•Ä ‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡§ø‡§Ø‡§æ‡§Ç',\n    es: 'Logros de Experiencia',\n    id: 'Pencapaian Pengalaman',\n  },\n  playerAchievements: {\n    en: 'Player Achievements',\n    ar: 'ÿ•ŸÜÿ¨ÿßÿ≤ÿßÿ™ ÿßŸÑŸÑÿßÿπÿ®',\n    bn: '‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º‡ßá‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶ú‡¶®',\n    hi: '‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§ï‡•Ä ‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡§ø‡§Ø‡§æ‡§Ç',\n    es: 'Logros del Jugador',\n    id: 'Pencapaian Pemain',\n  },\n  \n  // Achievement Names\n  firstVictoryTitle: {\n    en: 'First Victory',\n    ar: 'ÿ£ŸàŸÑ ÿßŸÜÿ™ÿµÿßÿ±',\n    bn: '‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶¨‡¶ø‡¶ú‡¶Ø‡¶º',\n    hi: '‡§™‡§π‡§≤‡•Ä ‡§µ‡§ø‡§ú‡§Ø',\n    es: 'Primera Victoria',\n    id: 'Kemenangan Pertama',\n  },\n  winStreakMaster: {\n    en: 'Win Streak Master',\n    ar: 'ÿ≥ŸäÿØ ÿ≥ŸÑÿ≥ŸÑÿ© ÿßŸÑÿßŸÜÿ™ÿµÿßÿ±ÿßÿ™',\n    bn: '‡¶ú‡¶Ø‡¶º‡ßá‡¶∞ ‡¶ß‡¶æ‡¶∞‡¶æ ‡¶Æ‡¶æ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞',\n    hi: '‡§ú‡•Ä‡§§ ‡§ï‡•Ä ‡§≤‡§ï‡•Ä‡§∞ ‡§ï‡•á ‡§Æ‡§æ‡§∏‡•ç‡§ü‡§∞',\n    es: 'Maestro de Racha Ganadora',\n    id: 'Master Kemenangan Beruntun',\n  },\n  unstoppable: {\n    en: 'Unstoppable',\n    ar: 'ŸÑÿß ŸäŸèŸÇŸáÿ±',\n    bn: '‡¶Ö‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∞‡ßã‡¶ß‡ßç‡¶Ø',\n    hi: '‡§Ö‡§ú‡•á‡§Ø',\n    es: 'Imparable',\n    id: 'Tak Terhentikan',\n  },\n  masterOfDiagonals: {\n    en: 'Master of Diagonals',\n    ar: 'ÿ≥ŸäÿØ ÿßŸÑÿ£ŸÇÿ∑ÿßÿ±',\n    bn: '‡¶ï‡¶∞‡ßç‡¶£‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞',\n    hi: '‡§µ‡§ø‡§ï‡§∞‡•ç‡§£ ‡§ï‡•á ‡§Æ‡§æ‡§∏‡•ç‡§ü‡§∞',\n    es: 'Maestro de Diagonales',\n    id: 'Master Diagonal',\n  },\n  speedDemon: {\n    en: 'Speed Demon',\n    ar: 'ÿ¥Ÿäÿ∑ÿßŸÜ ÿßŸÑÿ≥ÿ±ÿπÿ©',\n    bn: '‡¶ó‡¶§‡¶ø‡¶∞ ‡¶¶‡¶æ‡¶®‡¶¨',\n    hi: '‡§ó‡§§‡§ø ‡§ï‡•á ‡§¶‡§æ‡§®‡§µ',\n    es: 'Demonio de la Velocidad',\n    id: 'Iblis Kecepatan',\n  },\n  veteranPlayer: {\n    en: 'Veteran Player',\n    ar: 'ŸÑÿßÿπÿ® ŸÖÿ≠ŸÜŸÉ',\n    bn: '‡¶Ö‡¶≠‡¶ø‡¶ú‡ßç‡¶û ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º',\n    hi: '‡§Ö‡§®‡•Å‡§≠‡§µ‡•Ä ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä',\n    es: 'Jugador Veterano',\n    id: 'Pemain Veteran',\n  },\n  comebackKing: {\n    en: 'Comeback King',\n    ar: 'ŸÖŸÑŸÉ ÿßŸÑÿπŸàÿØÿ©',\n    bn: '‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡¶æ‡¶¨‡¶∞‡ßç‡¶§‡¶®‡ßá‡¶∞ ‡¶∞‡¶æ‡¶ú‡¶æ',\n    hi: '‡§µ‡§æ‡§™‡§∏‡•Ä ‡§ï‡•á ‡§∞‡§æ‡§ú‡§æ',\n    es: 'Rey del Regreso',\n    id: 'Raja Comeback',\n  },\n  legend: {\n    en: 'Legend',\n    ar: 'ÿ£ÿ≥ÿ∑Ÿàÿ±ÿ©',\n    bn: '‡¶ï‡¶ø‡¶Ç‡¶¨‡¶¶‡¶®‡ßç‡¶§‡¶ø',\n    hi: '‡§¶‡§Ç‡§§‡§ï‡§•‡§æ',\n    es: 'Leyenda',\n    id: 'Legenda',\n  },\n  champion: {\n    en: 'Champion',\n    ar: 'ÿ®ÿ∑ŸÑ',\n    bn: '‡¶ö‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™‡¶ø‡¶Ø‡¶º‡¶®',\n    hi: '‡§ö‡•à‡§Ç‡§™‡§ø‡§Ø‡§®',\n    es: 'Campe√≥n',\n    id: 'Juara',\n  },\n  \n  // Achievement Descriptions\n  winYourVeryFirstGame: {\n    en: 'Win your very first game against any opponent to earn this achievement',\n    ar: 'ÿßÿ±ÿ®ÿ≠ ŸÑÿπÿ®ÿ™ŸÉ ÿßŸÑÿ£ŸàŸÑŸâ ÿ∂ÿØ ÿ£Ÿä ÿÆÿµŸÖ ŸÑŸÉÿ≥ÿ® Ÿáÿ∞ÿß ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤',\n    bn: '‡¶è‡¶á ‡¶Ö‡¶∞‡ßç‡¶ú‡¶® ‡¶Ö‡¶∞‡ßç‡¶ú‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶™‡¶ï‡ßç‡¶∑‡ßá‡¶∞ ‡¶¨‡¶ø‡¶∞‡ßÅ‡¶¶‡ßç‡¶ß‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶ó‡ßá‡¶Æ ‡¶ú‡¶ø‡¶§‡ßÅ‡¶®',\n    hi: '‡§á‡§∏ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡§ø ‡§ï‡•ã ‡§Ö‡§∞‡•ç‡§ú‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§™‡•ç‡§∞‡§§‡§ø‡§¶‡•ç‡§µ‡§Ç‡§¶‡•ç‡§µ‡•Ä ‡§ï‡•á ‡§ñ‡§ø‡§≤‡§æ‡§´ ‡§Ö‡§™‡§®‡§æ ‡§™‡§π‡§≤‡§æ ‡§ó‡•á‡§Æ ‡§ú‡•Ä‡§§‡•á‡§Ç',\n    es: 'Gana tu primer juego contra cualquier oponente para obtener este logro',\n    id: 'Menangkan permainan pertama Anda melawan lawan mana pun untuk mendapatkan pencapaian ini',\n  },\n  winFiveConsecutiveGames: {\n    en: 'Win 5 consecutive games without losing - show your consistency!',\n    ar: 'ÿßÿ±ÿ®ÿ≠ 5 ÿ£ŸÑÿπÿßÿ® ŸÖÿ™ÿ™ÿßŸÑŸäÿ© ÿØŸàŸÜ ÿÆÿ≥ÿßÿ±ÿ© - ÿ£ÿ∏Ÿáÿ± ÿ´ÿ®ÿßÿ™ŸÉ!',\n    bn: '‡¶π‡¶æ‡¶∞ ‡¶®‡¶æ ‡¶Æ‡ßá‡¶®‡ßá ‡¶™‡¶∞‡¶™‡¶∞ 5‡¶ü‡¶ø ‡¶ó‡ßá‡¶Æ ‡¶ú‡¶ø‡¶§‡ßÅ‡¶® - ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ß‡¶æ‡¶∞‡¶æ‡¶¨‡¶æ‡¶π‡¶ø‡¶ï‡¶§‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®!',\n    hi: '‡§¨‡§ø‡§®‡§æ ‡§π‡§æ‡§∞‡•á 5 ‡§≤‡§ó‡§æ‡§§‡§æ‡§∞ ‡§ó‡•á‡§Æ ‡§ú‡•Ä‡§§‡•á‡§Ç - ‡§Ö‡§™‡§®‡•Ä ‡§®‡§ø‡§∞‡§Çÿ™‡§∞‡§§‡§æ ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Ç!',\n    es: 'Gana 5 juegos consecutivos sin perder - ¬°muestra tu consistencia!',\n    id: 'Menangkan 5 permainan berturut-turut tanpa kalah - tunjukkan konsistensi Anda!',\n  },\n  winTenConsecutiveGames: {\n    en: 'Win 10 consecutive games without losing to unlock the Halloween theme!',\n    ar: 'ÿßÿ±ÿ®ÿ≠ 10 ÿ£ŸÑÿπÿßÿ® ŸÖÿ™ÿ™ÿßŸÑŸäÿ© ÿØŸàŸÜ ÿÆÿ≥ÿßÿ±ÿ© ŸÑŸÅÿ™ÿ≠ ŸÖŸàÿ∂Ÿàÿπ ÿßŸÑŸáÿßŸÑŸàŸäŸÜ!',\n    bn: '‡¶π‡ßç‡¶Ø‡¶æ‡¶≤‡ßã‡¶á‡¶® ‡¶•‡¶ø‡¶Æ ‡¶Ü‡¶®‡¶≤‡¶ï ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶æ‡¶∞ ‡¶®‡¶æ ‡¶Æ‡ßá‡¶®‡ßá ‡¶™‡¶∞‡¶™‡¶∞ 10‡¶ü‡¶ø ‡¶ó‡ßá‡¶Æ ‡¶ú‡¶ø‡¶§‡ßÅ‡¶®!',\n    hi: '‡§π‡•à‡§≤‡•ã‡§µ‡•Ä‡§® ‡§•‡•Ä‡§Æ ‡§Ö‡§®‡§≤‡•â‡§ï ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¨‡§ø‡§®‡§æ ‡§π‡§æ‡§∞‡•á 10 ‡§≤‡§ó‡§æ‡§§‡§æ‡§∞ ‡§ó‡•á‡§Æ ‡§ú‡•Ä‡§§‡•á‡§Ç!',\n    es: 'Gana 10 juegos consecutivos sin perder para desbloquear el tema de Halloween!',\n    id: 'Menangkan 10 permainan berturut-turut tanpa kalah untuk membuka tema Halloween!',\n  },\n  winThreeGamesDiagonally: {\n    en: 'Win 3 games by getting three in a row diagonally (corner to corner)',\n    ar: 'ÿßÿ±ÿ®ÿ≠ 3 ÿ£ŸÑÿπÿßÿ® ÿ®ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿ´ŸÑÿßÿ´ÿ© ŸÅŸä ÿµŸÅ ŸÇÿ∑ÿ±ŸäÿßŸã (ŸÖŸÜ ÿ≤ÿßŸàŸäÿ© ÿ•ŸÑŸâ ÿ≤ÿßŸàŸäÿ©)',\n    bn: '‡¶ï‡¶∞‡ßç‡¶£‡¶≠‡¶æ‡¶¨‡ßá (‡¶ï‡ßã‡¶£ ‡¶•‡ßá‡¶ï‡ßá ‡¶ï‡ßã‡¶£‡ßá) ‡¶§‡¶ø‡¶®‡¶ü‡¶ø ‡¶™‡¶∞‡¶™‡¶∞ ‡¶™‡ßá‡¶Ø‡¶º‡ßá 3‡¶ü‡¶ø ‡¶ó‡ßá‡¶Æ ‡¶ú‡¶ø‡¶§‡ßÅ‡¶®',\n    hi: '‡§µ‡§ø‡§ï‡§∞‡•ç‡§£ ‡§∞‡•Ç‡§™ ‡§∏‡•á (‡§ï‡•ã‡§®‡•á ‡§∏‡•á ‡§ï‡•ã‡§®‡•á ‡§§‡§ï) ‡§§‡•Ä‡§® ‡§ï‡•ã ‡§è‡§ï ‡§™‡§Ç‡§ï‡•ç‡§§‡§ø ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§ï‡•á 3 ‡§ó‡•á‡§Æ ‡§ú‡•Ä‡§§‡•á‡§Ç',\n    es: 'Gana 3 juegos obteniendo tres en fila diagonalmente (esquina a esquina)',\n    id: 'Menangkan 3 permainan dengan mendapatkan tiga berturut-turut secara diagonal (sudut ke sudut)',\n  },\n  winTwentyTotalGames: {\n    en: 'Win 20 total games to unlock the Christmas theme - keep playing!',\n    ar: 'ÿßÿ±ÿ®ÿ≠ 20 ŸÑÿπÿ®ÿ© ÿ•ÿ¨ŸÖÿßŸÑŸäÿ© ŸÑŸÅÿ™ÿ≠ ŸÖŸàÿ∂Ÿàÿπ ÿßŸÑŸÉÿ±Ÿäÿ≥ŸÖÿßÿ≥ - ÿßÿ≥ÿ™ŸÖÿ± ŸÅŸä ÿßŸÑŸÑÿπÿ®!',\n    bn: '‡¶ï‡ßç‡¶∞‡¶ø‡¶∏‡¶Æ‡¶æ‡¶∏ ‡¶•‡¶ø‡¶Æ ‡¶Ü‡¶®‡¶≤‡¶ï ‡¶ï‡¶∞‡¶§‡ßá ‡¶Æ‡ßã‡¶ü 20‡¶ü‡¶ø ‡¶ó‡ßá‡¶Æ ‡¶ú‡¶ø‡¶§‡ßÅ‡¶® - ‡¶ñ‡ßá‡¶≤‡¶æ ‡¶ö‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ø‡¶æ‡¶®!',\n    hi: '‡§ï‡•ç‡§∞‡§ø‡§∏‡§Æ‡§∏ ‡§•‡•Ä‡§Æ ‡§Ö‡§®‡§≤‡•â‡§ï ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•Å‡§≤ 20 ‡§ó‡•á‡§Æ ‡§ú‡•Ä‡§§‡•á‡§Ç - ‡§ñ‡•á‡§≤‡§§‡•á ‡§∞‡§π‡•á‡§Ç!',\n    es: 'Gana 20 juegos en total para desbloquear el tema navide√±o - ¬°sigue jugando!',\n    id: 'Menangkan 20 permainan total untuk membuka tema Natal - terus bermain!',\n  },\n  playOneHundredTotalGames: {\n    en: 'Play 100 total games (wins + losses + draws) to unlock the Summer theme',\n    ar: 'ÿßŸÑÿπÿ® 100 ŸÑÿπÿ®ÿ© ÿ•ÿ¨ŸÖÿßŸÑŸäÿ© (ÿßŸÜÿ™ÿµÿßÿ±ÿßÿ™ + Ÿáÿ≤ÿßÿ¶ŸÖ + ÿ™ÿπÿßÿØŸÑ) ŸÑŸÅÿ™ÿ≠ ŸÖŸàÿ∂Ÿàÿπ ÿßŸÑÿµŸäŸÅ',\n    bn: '‡¶ó‡ßç‡¶∞‡ßÄ‡¶∑‡ßç‡¶Æ‡¶ï‡¶æ‡¶≤‡ßÄ‡¶® ‡¶•‡¶ø‡¶Æ ‡¶Ü‡¶®‡¶≤‡¶ï ‡¶ï‡¶∞‡¶§‡ßá ‡¶Æ‡ßã‡¶ü 100‡¶ü‡¶ø ‡¶ó‡ßá‡¶Æ ‡¶ñ‡ßá‡¶≤‡ßÅ‡¶® (‡¶ú‡¶Ø‡¶º + ‡¶π‡¶æ‡¶∞ + ‡¶°‡ßç‡¶∞)',\n    hi: '‡§ó‡§∞‡•ç‡§Æ‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡§æ ‡§•‡•Ä‡§Æ ‡§Ö‡§®‡§≤‡•â‡§ï ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•Å‡§≤ 100 ‡§ó‡•á‡§Æ ‡§ñ‡•á‡§≤‡•á‡§Ç (‡§ú‡•Ä‡§§ + ‡§π‡§æ‡§∞ + ‡§°‡•ç‡§∞‡•â)',\n    es: 'Juega 100 juegos en total (victorias + derrotas + empates) para desbloquear el tema de verano',\n    id: 'Mainkan 100 permainan total (menang + kalah + seri) untuk membuka tema musim panas',\n  },\n  winAfterLosingFive: {\n    en: 'Win a game after losing 5 games in a row - prove your resilience!',\n    ar: 'ÿßÿ±ÿ®ÿ≠ ŸÑÿπÿ®ÿ© ÿ®ÿπÿØ ÿÆÿ≥ÿßÿ±ÿ© 5 ÿ£ŸÑÿπÿßÿ® ŸÖÿ™ÿ™ÿßŸÑŸäÿ© - ÿ£ÿ´ÿ®ÿ™ ŸÖÿ±ŸàŸÜÿ™ŸÉ!',\n    bn: '‡¶™‡¶∞‡¶™‡¶∞ 5‡¶ü‡¶ø ‡¶ó‡ßá‡¶Æ ‡¶π‡¶æ‡¶∞‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ó‡ßá‡¶Æ ‡¶ú‡¶ø‡¶§‡ßÅ‡¶® - ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡ßç‡¶•‡¶ø‡¶§‡¶ø‡¶∏‡ßç‡¶•‡¶æ‡¶™‡¶ï‡¶§‡¶æ ‡¶™‡ßç‡¶∞‡¶Æ‡¶æ‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®!',\n    hi: '‡§≤‡§ó‡§æ‡§§‡§æ‡§∞ 5 ‡§ó‡•á‡§Æ ‡§π‡§æ‡§∞‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§è‡§ï ‡§ó‡•á‡§Æ ‡§ú‡•Ä‡§§‡•á‡§Ç - ‡§Ö‡§™‡§®‡•Ä ‡§≤‡§ö‡§ï ‡§∏‡§æ‡§¨‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç!',\n    es: 'Gana un juego despu√©s de perder 5 juegos seguidos - ¬°demuestra tu resistencia!',\n    id: 'Menangkan permainan setelah kalah 5 permainan berturut-turut - buktikan ketahananmu!',\n  },\n  achieveFiftyTotalWins: {\n    en: 'Achieve 50 total wins to become a true legend with animated fire border!',\n    ar: 'ÿ≠ŸÇŸÇ 50 ÿßŸÜÿ™ÿµÿßÿ±ÿßŸã ÿ•ÿ¨ŸÖÿßŸÑŸäÿßŸã ŸÑÿ™ÿµÿ®ÿ≠ ÿ£ÿ≥ÿ∑Ÿàÿ±ÿ© ÿ≠ŸÇŸäŸÇŸäÿ© ŸÖÿπ ÿ≠ÿØŸàÿØ ÿßŸÑŸÜÿßÿ± ÿßŸÑŸÖÿ™ÿ≠ÿ±ŸÉÿ©!',\n    bn: '‡¶Ö‡ßç‡¶Ø‡¶æ‡¶®‡¶ø‡¶Æ‡ßá‡¶ü‡ßá‡¶° ‡¶´‡¶æ‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶¨‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶∏‡¶π ‡¶∏‡¶§‡ßç‡¶Ø‡¶ø‡¶ï‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ï‡¶ø‡¶Ç‡¶¨‡¶¶‡¶®‡ßç‡¶§‡¶ø ‡¶π‡¶§‡ßá ‡¶Æ‡ßã‡¶ü 50‡¶ü‡¶ø ‡¶ú‡¶Ø‡¶º ‡¶Ö‡¶∞‡ßç‡¶ú‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®!',\n    hi: '‡§è‡§®‡§ø‡§Æ‡•á‡§ü‡•á‡§° ‡§´‡§æ‡§Ø‡§∞ ‡§¨‡•â‡§∞‡•ç‡§°‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§è‡§ï ‡§∏‡§ö‡•ç‡§ö‡•á ‡§ï‡§ø‡§Ç‡§µ‡§¶‡§Ç‡§§‡•Ä ‡§¨‡§®‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•Å‡§≤ 50 ‡§ú‡•Ä‡§§ ‡§π‡§æ‡§∏‡§ø‡§≤ ‡§ï‡§∞‡•á‡§Ç!',\n    es: '¬°Logra 50 victorias totales para convertirte en una verdadera leyenda con borde de fuego animado!',\n    id: 'Capai 50 kemenangan total untuk menjadi legenda sejati dengan border api beranimasi!',\n  },\n  achieveOneHundredTotalWins: {\n    en: 'Achieve 100 total wins to become an ultimate champion with cosmic border!',\n    ar: 'ÿ≠ŸÇŸÇ 100 ÿßŸÜÿ™ÿµÿßÿ± ÿ•ÿ¨ŸÖÿßŸÑŸä ŸÑÿ™ÿµÿ®ÿ≠ ÿ®ÿ∑ŸÑÿßŸã ŸÜŸáÿßÿ¶ŸäÿßŸã ŸÖÿπ ÿ≠ÿØŸàÿØ ŸÉŸàŸÜŸäÿ©!',\n    bn: '‡¶ï‡¶∏‡¶Æ‡¶ø‡¶ï ‡¶¨‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶∏‡¶π ‡¶ö‡ßÇ‡¶°‡¶º‡¶æ‡¶®‡ßç‡¶§ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™‡¶ø‡¶Ø‡¶º‡¶® ‡¶π‡¶§‡ßá ‡¶Æ‡ßã‡¶ü 100‡¶ü‡¶ø ‡¶ú‡¶Ø‡¶º ‡¶Ö‡¶∞‡ßç‡¶ú‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®!',\n    hi: '‡§ï‡•â‡§∏‡•ç‡§Æ‡§ø‡§ï ‡§¨‡•â‡§∞‡•ç‡§°‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§è‡§ï ‡§™‡§∞‡§Æ ‡§ö‡•à‡§Ç‡§™‡§ø‡§Ø‡§® ‡§¨‡§®‡§®‡•á ‡§ï‡•á ‡§≤‡¶ø‡§è ‡§ï‡•Å‡¶≤ 100 ‡§ú‡•Ä‡§§ ‡§π‡§æ‡§∏‡§ø‡¶≤ ‡§ï‡§∞‡•á‡§Ç!',\n    es: '¬°Logra 100 victorias totales para convertirte en un campe√≥n definitivo con borde c√≥smico!',\n    id: 'Capai 100 kemenangan total untuk menjadi juara tertinggi dengan border kosmik!',\n  },\n  \n  // Room Management\n  quickMatch: {\n    en: 'Quick Match',\n    ar: 'ŸÖÿ®ÿßÿ±ÿßÿ© ÿ≥ÿ±Ÿäÿπÿ©',\n    bn: '‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö',\n    hi: '‡§§‡•ç‡§µ‡§∞‡§ø‡§§ ‡§Æ‡•à‡§ö',\n    es: 'Partida R√°pida',\n    id: 'Pertandingan Cepat',\n  },\n  getMatchedWithAnotherPlayer: {\n    en: 'Get matched with another player instantly',\n    ar: 'ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ ŸÖÿ®ÿßÿ±ÿßÿ© ŸÖÿπ ŸÑÿßÿπÿ® ÿ¢ÿÆÿ± ŸÅŸàÿ±ÿßŸã',\n    bn: '‡¶§‡¶æ‡ßé‡¶ï‡ßç‡¶∑‡¶£‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö ‡¶™‡¶æ‡¶®',\n    hi: '‡§§‡•Å‡§∞‡§Ç‡§§ ‡§¶‡•Ç‡§∏‡§∞‡•á ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§ï‡•á ‡§∏‡§æ‡§• ‡§Æ‡•à‡§ö ‡§π‡•ã ‡§ú‡§æ‡§è‡§Ç',\n    es: 'Obt√©n una partida con otro jugador al instante',\n    id: 'Dapatkan pertandingan dengan pemain lain secara instan',\n  },\n  findMatch: {\n    en: 'Find Match',\n    ar: 'ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ŸÖÿ®ÿßÿ±ÿßÿ©',\n    bn: '‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®',\n    hi: '‡§Æ‡•à‡§ö ‡§ñ‡•ã‡§ú‡•á‡§Ç',\n    es: 'Buscar Partida',\n    id: 'Cari Pertandingan',\n  },\n  or: {\n    en: 'or',\n    ar: 'ÿ£Ÿà',\n    bn: '‡¶Ö‡¶•‡¶¨‡¶æ',\n    hi: '‡§Ø‡§æ',\n    es: 'o',\n    id: 'atau',\n  },\n  createOrJoinRoom: {\n    en: 'Create or join a room to play with friends',\n    ar: 'ÿ£ŸÜÿ¥ÿ¶ ÿ£Ÿà ÿßŸÜÿ∂ŸÖ ÿ•ŸÑŸâ ÿ∫ÿ±ŸÅÿ© ŸÑŸÑÿπÿ® ŸÖÿπ ÿßŸÑÿ£ÿµÿØŸÇÿßÿ°',\n    bn: '‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶ñ‡ßá‡¶≤‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∞‡ßÅ‡¶Æ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶¨‡¶æ ‡¶Ø‡ßã‡¶ó ‡¶¶‡¶ø‡¶®',\n    hi: '‡§¶‡•ã‡§∏‡•ç‡§§‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ñ‡•á‡§≤‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§∞‡•Ç‡§Æ ‡§¨‡§®‡§æ‡§è‡§Ç ‡§Ø‡§æ ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç',\n    es: 'Crea o √∫nete a una sala para jugar con amigos',\n    id: 'Buat atau bergabung dengan ruang untuk bermain dengan teman',\n  },\n  roomManagement: {\n    en: 'Room Management',\n    ar: 'ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ∫ÿ±ŸÅÿ©',\n    bn: '‡¶∞‡ßÅ‡¶Æ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶™‡¶®‡¶æ',\n    hi: '‡§∞‡•Ç‡§Æ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®',\n    es: 'Gesti√≥n de Sala',\n    id: 'Manajemen Ruang',\n  },\n  roomCode: {\n    en: 'Room code',\n    ar: 'ÿ±ŸÖÿ≤ ÿßŸÑÿ∫ÿ±ŸÅÿ©',\n    bn: '‡¶∞‡ßÅ‡¶Æ ‡¶ï‡ßã‡¶°',\n    hi: '‡§∞‡•Ç‡§Æ ‡§ï‡•ã‡§°',\n    es: 'C√≥digo de sala',\n    id: 'Kode ruang',\n  },\n  joinAsPlayer: {\n    en: 'Join as Player',\n    ar: 'ÿßŸÜÿ∂ŸÖ ŸÉŸÑÿßÿπÿ®',\n    bn: '‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶Ø‡ßã‡¶ó ‡¶¶‡¶ø‡¶®',\n    hi: '‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç',\n    es: 'Unirse como Jugador',\n    id: 'Bergabung sebagai Pemain',\n  },\n  joinAsSpectator: {\n    en: 'Join as Spectator',\n    ar: 'ÿßŸÜÿ∂ŸÖ ŸÉŸÖÿ¥ÿßŸáÿØ',\n    bn: '‡¶¶‡¶∞‡ßç‡¶∂‡¶ï ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶Ø‡ßã‡¶ó ‡¶¶‡¶ø‡¶®',\n    hi: '‡§¶‡§∞‡•ç‡§∂‡§ï ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç',\n    es: 'Unirse como Espectador',\n    id: 'Bergabung sebagai Penonton',\n  },\n  createNewRoom: {\n    en: 'Create New Room',\n    ar: 'ÿ•ŸÜÿ¥ÿßÿ° ÿ∫ÿ±ŸÅÿ© ÿ¨ÿØŸäÿØÿ©',\n    bn: '‡¶®‡¶§‡ßÅ‡¶® ‡¶∞‡ßÅ‡¶Æ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®',\n    hi: '‡§®‡§Ø‡§æ ‡§∞‡•Ç‡§Æ ‡§¨‡§®‡§æ‡§è‡§Ç',\n    es: 'Crear Nueva Sala',\n    id: 'Buat Ruang Baru',\n  },\n  \n  // Online Users\n  onlineUsers: {\n    en: 'Online Users',\n    ar: 'ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸàŸÜ ÿßŸÑŸÖÿ™ÿµŸÑŸàŸÜ',\n    bn: '‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ',\n    hi: '‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ',\n    es: 'Usuarios en L√≠nea',\n    id: 'Pengguna Online',\n  },\n  \n  // Room and Matchmaking\n  roomNameInput: {\n    en: 'Room Name',\n    ar: 'ÿßÿ≥ŸÖ ÿßŸÑÿ∫ÿ±ŸÅÿ©',\n    bn: '‡¶∞‡ßÅ‡¶Æ‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ',\n    hi: '‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§®‡§æ‡§Æ',\n    es: 'Nombre de la Sala',\n    id: 'Nama Ruang',\n  },\n  enterRoomName: {\n    en: 'Enter room name',\n    ar: 'ÿ£ÿØÿÆŸÑ ÿßÿ≥ŸÖ ÿßŸÑÿ∫ÿ±ŸÅÿ©',\n    bn: '‡¶∞‡ßÅ‡¶Æ‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®',\n    hi: '‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Ingresa el nombre de la sala',\n    id: 'Masukkan nama ruang',\n  },\n  maxPlayers: {\n    en: 'Max Players',\n    ar: 'ÿ£ŸÇÿµŸâ ÿπÿØÿØ ŸÑÿßÿπÿ®ŸäŸÜ',\n    bn: '‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º',\n    hi: '‡§Ö‡§ß‡§ø‡§ï‡§§‡§Æ ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä',\n    es: 'M√°ximo de Jugadores',\n    id: 'Pemain Maksimal',\n  },\n  twoPlayers: {\n    en: '2 Players',\n    ar: '2 ŸÑÿßÿπÿ®ŸäŸÜ',\n    bn: '2 ‡¶ú‡¶® ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º',\n    hi: '2 ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä',\n    es: '2 Jugadores',\n    id: '2 Pemain',\n  },\n  twoPlayersSpectators: {\n    en: '2 Players + 50 Spectators',\n    ar: '2 ŸÑÿßÿπÿ®ŸäŸÜ + 50 ŸÖÿ¥ÿßŸáÿØ',\n    bn: '2 ‡¶ú‡¶® ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º + 50 ‡¶ú‡¶® ‡¶¶‡¶∞‡ßç‡¶∂‡¶ï',\n    hi: '2 ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä + 50 ‡§¶‡§∞‡•ç‡§∂‡§ï',\n    es: '2 Jugadores + 50 Espectadores',\n    id: '2 Pemain + 50 Penonton',\n  },\n  private: {\n    en: 'Private',\n    ar: 'ÿÆÿßÿµ',\n    bn: '‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶ó‡¶§',\n    hi: '‡§®‡§ø‡§ú‡•Ä',\n    es: 'Privado',\n    id: 'Pribadi',\n  },\n  makeRoomPrivate: {\n    en: 'Make room private (invite only)',\n    ar: 'ÿ¨ÿπŸÑ ÿßŸÑÿ∫ÿ±ŸÅÿ© ÿÆÿßÿµÿ© (ÿ®ÿØÿπŸàÿ© ŸÅŸÇÿ∑)',\n    bn: '‡¶∞‡ßÅ‡¶Æ‡¶ü‡¶ø ‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶ó‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶® (‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶Ü‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá)',\n    hi: '‡§∞‡•Ç‡§Æ ‡§ï‡•ã ‡§®‡§ø‡§ú‡•Ä ‡§¨‡§®‡§æ‡§è‡§Ç (‡§ï‡•á‡§µ‡§≤ ‡§Ü‡§Æ‡§Ç‡§§‡•ç‡§∞‡§£)',\n    es: 'Hacer la sala privada (solo por invitaci√≥n)',\n    id: 'Buat ruang privat (hanya undangan)',\n  },\n  createRoom: {\n    en: 'Create Room',\n    ar: 'ÿ•ŸÜÿ¥ÿßÿ° ÿ∫ÿ±ŸÅÿ©',\n    bn: '‡¶∞‡ßÅ‡¶Æ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®',\n    hi: '‡§∞‡•Ç‡§Æ ‡§¨‡§®‡§æ‡§è‡§Ç',\n    es: 'Crear Sala',\n    id: 'Buat Ruang',\n  },\n  creating: {\n    en: 'Creating...',\n    ar: 'ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ•ŸÜÿ¥ÿßÿ°...',\n    bn: '‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...',\n    hi: '‡§¨‡§®‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...',\n    es: 'Creando...',\n    id: 'Membuat...',\n  },\n  roomCreated: {\n    en: 'Room Created',\n    ar: 'ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ∫ÿ±ŸÅÿ©',\n    bn: '‡¶∞‡ßÅ‡¶Æ ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá',\n    hi: '‡§∞‡•Ç‡§Æ ‡§¨‡§®‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ',\n    es: 'Sala Creada',\n    id: 'Ruang Dibuat',\n  },\n  roomCodeCreated: {\n    en: 'Room %s created successfully',\n    ar: 'ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ∫ÿ±ŸÅÿ© %s ÿ®ŸÜÿ¨ÿßÿ≠',\n    bn: '‡¶∞‡ßÅ‡¶Æ %s ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá',\n    hi: '‡§∞‡•Ç‡§Æ %s ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§¨‡§®‡§æ‡§Ø‡§æ ‡§ó‡§Ø‡§æ',\n    es: 'Sala %s creada exitosamente',\n    id: 'Ruang %s berhasil dibuat',\n  },\n  error: {\n    en: 'Error',\n    ar: 'ÿÆÿ∑ÿ£',\n    bn: '‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø',\n    hi: '‡§§‡•ç‡§∞‡•Å‡§ü‡§ø',\n    es: 'Error',\n    id: 'Kesalahan',\n  },\n  roomNameRequired: {\n    en: 'Room name is required',\n    ar: 'ÿßÿ≥ŸÖ ÿßŸÑÿ∫ÿ±ŸÅÿ© ŸÖÿ∑ŸÑŸàÿ®',\n    bn: '‡¶∞‡ßÅ‡¶Æ‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®',\n    hi: '‡§∞‡•Ç‡§Æ ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à',\n    es: 'Se requiere el nombre de la sala',\n    id: 'Nama ruang diperlukan',\n  },\n  unauthorized: {\n    en: 'Unauthorized',\n    ar: 'ÿ∫Ÿäÿ± ŸÖÿµÿ±ÿ≠',\n    bn: '‡¶Ö‡¶®‡¶®‡ßÅ‡¶Æ‡ßã‡¶¶‡¶ø‡¶§',\n    hi: '‡§Ö‡§®‡§ß‡§ø‡§ï‡•É‡§§',\n    es: 'No autorizado',\n    id: 'Tidak Diotorisasi',\n  },\n  loggedOutLoggingIn: {\n    en: 'You are logged out. Logging in again...',\n    ar: 'ŸÑŸÇÿØ ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿÆÿ±Ÿàÿ¨ŸÉ. ÿ¨ÿßÿ±Ÿä ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ...',\n    bn: '‡¶Ü‡¶™‡¶®‡¶ø ‡¶≤‡¶ó ‡¶Ü‡¶â‡¶ü ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡¶®‡•§ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶≤‡¶ó ‡¶á‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...',\n    hi: '‡§Ü‡§™ ‡§≤‡•â‡§ó ‡§Ü‡§â‡§ü ‡§π‡•à‡§Ç‡•§ ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§≤‡•â‡§ó ‡§á‡§® ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...',\n    es: 'Has cerrado sesi√≥n. Iniciando sesi√≥n de nuevo...',\n    id: 'Anda telah logout. Masuk lagi...',\n  },\n  success: {\n    en: 'Success',\n    ar: 'ŸÜÿ¨ÿ≠',\n    bn: '‡¶∏‡¶´‡¶≤',\n    hi: '‡§∏‡§´‡§≤‡§§‡§æ',\n    es: '√âxito',\n    id: 'Berhasil',\n  },\n  joinedRoomSuccessfully: {\n    en: 'Joined room successfully',\n    ar: 'ÿßŸÜÿ∂ŸÖŸÖÿ™ ÿ•ŸÑŸâ ÿßŸÑÿ∫ÿ±ŸÅÿ© ÿ®ŸÜÿ¨ÿßÿ≠',\n    bn: '‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∞‡ßÅ‡¶Æ‡ßá ‡¶Ø‡ßã‡¶ó ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡¶®',\n    hi: '‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§∞‡•Ç‡§Æ ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•Å‡§è',\n    es: 'Se uni√≥ a la sala exitosamente',\n    id: 'Berhasil bergabung dengan ruang',\n  },\n  gameStarted: {\n    en: 'Game Started',\n    ar: 'ÿ®ÿØÿ£ÿ™ ÿßŸÑŸÑÿπÿ®ÿ©',\n    bn: '‡¶ó‡ßá‡¶Æ ‡¶∂‡ßÅ‡¶∞‡ßÅ',\n    hi: '‡§ó‡•á‡§Æ ‡§∂‡•Å‡§∞‡•Ç',\n    es: 'Juego Iniciado',\n    id: 'Permainan Dimulai',\n  },\n  letTheBattleBegin: {\n    en: 'Let the battle begin!',\n    ar: 'ŸÑÿ™ÿ®ÿØÿ£ ÿßŸÑŸÖÿπÿ±ŸÉÿ©!',\n    bn: '‡¶Ø‡ßÅ‡¶¶‡ßç‡¶ß ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡ßã‡¶ï!',\n    hi: '‡§Ø‡•Å‡§¶‡•ç‡§ß ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã!',\n    es: '¬°Que comience la batalla!',\n    id: 'Biarkan pertempuran dimulai!',\n  },\n  searching: {\n    en: 'Searching...',\n    ar: 'ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ®ÿ≠ÿ´...',\n    bn: '‡¶ñ‡ßã‡¶Å‡¶ú‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...',\n    hi: '‡§ñ‡•ã‡§ú ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...',\n    es: 'Buscando...',\n    id: 'Mencari...',\n  },\n  matchFound: {\n    en: 'Match Found!',\n    ar: 'ÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ŸÖÿ®ÿßÿ±ÿßÿ©!',\n    bn: '‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶ó‡ßá‡¶õ‡ßá!',\n    hi: '‡§Æ‡•à‡§ö ‡§Æ‡§ø‡§≤ ‡§ó‡§Ø‡§æ!',\n    es: '¬°Partida Encontrada!',\n    id: 'Pertandingan Ditemukan!',\n  },\n  matchedWithOpponent: {\n    en: \"You've been matched with an opponent. Game starting...\",\n    ar: 'ÿ™ŸÖ ÿ±ÿ®ÿ∑ŸÉ ŸÖÿπ ÿÆÿµŸÖ. ÿ®ÿØÿ° ÿßŸÑŸÑÿπÿ®ÿ©...',\n    bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶è‡¶ï‡¶ú‡¶® ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶™‡¶ï‡ßç‡¶∑‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶ó‡ßá‡¶Æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...',\n    hi: '‡§Ü‡§™‡§ï‡§æ ‡§Æ‡•à‡§ö ‡§è‡§ï ‡§™‡•ç‡§∞‡§§‡§ø‡§¶‡•ç‡§µ‡§Ç‡§¶‡•ç‡§µ‡•Ä ‡§ï‡•á ‡§∏‡§æ‡§• ‡§π‡•ã ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§ ‡§ó‡•á‡§Æ ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...',\n    es: 'Has sido emparejado con un oponente. El juego est√° comenzando...',\n    id: 'Anda telah dicocokkan dengan lawan. Permainan dimulai...',\n  },\n  searchingForOpponent: {\n    en: 'Searching for Opponent',\n    ar: 'ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿÆÿµŸÖ',\n    bn: '‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶™‡¶ï‡ßç‡¶∑ ‡¶ñ‡ßã‡¶Å‡¶ú‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá',\n    hi: '‡§™‡•ç‡§∞‡§§‡§ø‡§¶‡•ç‡§µ‡§Ç‡§¶‡•ç‡§µ‡•Ä ‡§ï‡•Ä ‡§ñ‡•ã‡§ú',\n    es: 'Buscando Oponente',\n    id: 'Mencari Lawan',\n  },\n  lookingForPlayer: {\n    en: 'Looking for another player to match with...',\n    ar: 'ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ŸÑÿßÿπÿ® ÿ¢ÿÆÿ± ŸÑŸÑŸÖÿ∑ÿßÿ®ŸÇÿ© ŸÖÿπŸá...',\n    bn: '‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶®‡ßç‡¶Ø ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º ‡¶ñ‡ßã‡¶Å‡¶ú‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...',\n    hi: '‡§Æ‡•à‡§ö ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¶‡•Ç‡§∏‡§∞‡§æ ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§ñ‡•ã‡§ú ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...',\n    es: 'Buscando otro jugador para emparejar...',\n    id: 'Mencari pemain lain untuk dicocokkan...',\n  },\n  leftQueue: {\n    en: 'Left Queue',\n    ar: 'ÿ™ÿ±ŸÉ ÿßŸÑÿ∑ÿßÿ®Ÿàÿ±',\n    bn: '‡¶∏‡¶æ‡¶∞‡¶ø ‡¶õ‡ßá‡¶°‡¶º‡ßá‡¶õ‡ßá‡¶®',\n    hi: '‡§ï‡§§‡§æ‡§∞ ‡§õ‡•ã‡§°‡§º ‡§¶‡•Ä',\n    es: 'Sali√≥ de la Cola',\n    id: 'Meninggalkan Antrian',\n  },\n  leftMatchmakingQueue: {\n    en: \"You've left the matchmaking queue.\",\n    ar: 'ŸÑŸÇÿØ ÿ™ÿ±ŸÉÿ™ ÿ∑ÿßÿ®Ÿàÿ± ÿßŸÑŸÖÿ∑ÿßÿ®ŸÇÿ©.',\n    bn: '‡¶Ü‡¶™‡¶®‡¶ø ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö‡¶Æ‡ßá‡¶ï‡¶ø‡¶Ç ‡¶∏‡¶æ‡¶∞‡¶ø ‡¶õ‡ßá‡¶°‡¶º‡ßá ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡¶®‡•§',\n    hi: '‡§Ü‡§™‡§®‡•á ‡§Æ‡•à‡§ö‡§Æ‡•á‡§ï‡§ø‡§Ç‡§ó ‡§ï‡§§‡§æ‡§∞ ‡§õ‡•ã‡§°‡§º ‡§¶‡•Ä ‡§π‡•à‡•§',\n    es: 'Has salido de la cola de emparejamiento.',\n    id: 'Anda telah meninggalkan antrian matchmaking.',\n  },\n\n  findAnotherPlayerCompete: {\n    en: \"We'll find another player for you to compete against in real-time!\",\n    ar: 'ÿ≥ŸÜÿ¨ÿØ ŸÑŸÉ ŸÑÿßÿπÿ®ÿßŸã ÿ¢ÿÆÿ± ŸÑŸÑÿ™ŸÜÿßŸÅÿ≥ ŸÖÿπŸá ŸÅŸä ÿßŸÑŸàŸÇÿ™ ÿßŸÑŸÅÿπŸÑŸä!',\n    bn: '‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶≤-‡¶ü‡¶æ‡¶á‡¶Æ‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡¶ø‡¶§‡¶æ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶∞‡ßá‡¶ï‡¶ú‡¶® ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßá ‡¶¶‡ßá‡¶¨!',\n    hi: '‡§π‡§Æ ‡§Ü‡§™‡§ï‡•á ‡§≤‡§ø‡§è ‡§∞‡•Ä‡§Ø‡§≤-‡§ü‡§æ‡§á‡§Æ ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§§‡§ø‡§∏‡•ç‡§™‡§∞‡•ç‡§ß‡§æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§î‡§∞ ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§¢‡•Ç‡§Ç‡§¢‡•á‡§Ç‡§ó‡•á!',\n    es: '¬°Te encontraremos otro jugador para competir en tiempo real!',\n    id: 'Kami akan menemukan pemain lain untuk Anda lawan secara real-time!',\n  },\n  onlinePlayersLookingForMatches: {\n    en: 'Online players looking for matches',\n    ar: 'ÿßŸÑŸÑÿßÿπÿ®ŸàŸÜ ÿßŸÑŸÖÿ™ÿµŸÑŸàŸÜ Ÿäÿ®ÿ≠ÿ´ŸàŸÜ ÿπŸÜ ŸÖÿ®ÿßÿ±Ÿäÿßÿ™',\n    bn: '‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º‡¶∞‡¶æ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö ‡¶ñ‡ßÅ‡¶Å‡¶ú‡¶õ‡ßá‡¶®',\n    hi: '‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§Æ‡•à‡§ö ‡§ï‡•Ä ‡§§‡§≤‡§æ‡§∂ ‡§Æ‡•á‡§Ç ‡§π‡•à‡§Ç',\n    es: 'Jugadores en l√≠nea buscando partidas',\n    id: 'Pemain online mencari pertandingan',\n  },\n  averageMatchTime: {\n    en: 'Average match time: 10-30 seconds',\n    ar: 'ŸÖÿ™Ÿàÿ≥ÿ∑ ŸàŸÇÿ™ ÿßŸÑŸÖÿ®ÿßÿ±ÿßÿ©: 10-30 ÿ´ÿßŸÜŸäÿ©',\n    bn: '‡¶ó‡¶°‡¶º ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö ‡¶∏‡¶Æ‡¶Ø‡¶º: 10-30 ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°',\n    hi: '‡§î‡§∏‡§§ ‡§Æ‡•à‡§ö ‡§∏‡§Æ‡§Ø: 10-30 ‡§∏‡•á‡§ï‡§Ç‡§°',\n    es: 'Tiempo promedio de partida: 10-30 segundos',\n    id: 'Waktu rata-rata pertandingan: 10-30 detik',\n  },\n  searchTime: {\n    en: 'Search Time:',\n    ar: 'ŸàŸÇÿ™ ÿßŸÑÿ®ÿ≠ÿ´:',\n    bn: '‡¶Ö‡¶®‡ßÅ‡¶∏‡¶®‡ßç‡¶ß‡¶æ‡¶®‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º:',\n    hi: '‡§ñ‡•ã‡§ú ‡§ï‡§æ ‡§∏‡§Æ‡§Ø:',\n    es: 'Tiempo de B√∫squeda:',\n    id: 'Waktu Pencarian:',\n  },\n  status: {\n    en: 'Status:',\n    ar: 'ÿßŸÑÿ≠ÿßŸÑÿ©:',\n    bn: '‡¶∏‡ßç‡¶•‡¶ø‡¶§‡¶ø:',\n    hi: '‡§∏‡•ç‡§•‡§ø‡§§‡§ø:',\n    es: 'Estado:',\n    id: 'Status:',\n  },\n  findingPerfectOpponent: {\n    en: 'Finding the perfect opponent...',\n    ar: 'ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿßŸÑÿÆÿµŸÖ ÿßŸÑŸÖÿ´ÿßŸÑŸä...',\n    bn: '‡¶®‡¶ø‡¶ñ‡ßÅ‡¶Å‡¶§ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶™‡¶ï‡ßç‡¶∑ ‡¶ñ‡ßã‡¶Å‡¶ú‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...',\n    hi: '‡§∏‡§π‡•Ä ‡§™‡•ç‡§∞‡§§‡§ø‡§¶‡•ç‡§µ‡§Ç‡§¶‡•ç‡§µ‡•Ä ‡§ñ‡•ã‡§ú‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...',\n    es: 'Encontrando el oponente perfecto...',\n    id: 'Mencari lawan yang sempurna...',\n  },\n  expandingSearch: {\n    en: 'Expanding search...',\n    ar: 'ÿ™Ÿàÿ≥Ÿäÿπ ÿßŸÑÿ®ÿ≠ÿ´...',\n    bn: '‡¶Ö‡¶®‡ßÅ‡¶∏‡¶®‡ßç‡¶ß‡¶æ‡¶® ‡¶∏‡¶Æ‡ßç‡¶™‡ßç‡¶∞‡¶∏‡¶æ‡¶∞‡¶£...',\n    hi: '‡§ñ‡•ã‡§ú ‡§ï‡§æ ‡§µ‡§ø‡§∏‡•ç‡§§‡§æ‡§∞ ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...',\n    es: 'Expandiendo b√∫squeda...',\n    id: 'Memperluas pencarian...',\n  },\n  almostThere: {\n    en: 'Almost there...',\n    ar: 'ÿ™ŸÇÿ±Ÿäÿ®ÿßŸã ŸàÿµŸÑŸÜÿß...',\n    bn: '‡¶™‡ßç‡¶∞‡¶æ‡¶Ø‡¶º ‡¶∂‡ßá‡¶∑...',\n    hi: '‡§≤‡§ó‡§≠‡§ó ‡§π‡•ã ‡§ó‡§Ø‡§æ...',\n    es: 'Casi llegamos...',\n    id: 'Hampir sampai...',\n  },\n  willMatchWithBot: {\n    en: 'Will match with AI bot in',\n    ar: 'ÿ≥Ÿäÿ™ŸÖ ÿßŸÑŸÖÿ∑ÿßÿ®ŸÇÿ© ŸÖÿπ ÿ±Ÿàÿ®Ÿàÿ™ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä ÿÆŸÑÿßŸÑ',\n    bn: 'AI ‡¶¨‡¶ü ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö ‡¶π‡¶¨‡ßá',\n    hi: 'AI ‡§¨‡•â‡§ü ‡§ï‡•á ‡§∏‡§æ‡§• ‡§Æ‡•à‡§ö ‡§π‡•ã‡§ó‡§æ',\n    es: 'Se emparejar√° con bot de IA en',\n    id: 'Akan dicocokkan dengan bot AI dalam',\n  },\n  matchingWithBot: {\n    en: 'Matching with AI bot...',\n    ar: 'ŸÖÿ∑ÿßÿ®ŸÇÿ© ŸÖÿπ ÿ±Ÿàÿ®Ÿàÿ™ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä...',\n    bn: 'AI ‡¶¨‡¶ü ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ö‡¶ø‡¶Ç...',\n    hi: 'AI ‡§¨‡•â‡§ü ‡§ï‡•á ‡§∏‡§æ‡§• ‡§Æ‡•à‡§ö ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...',\n    es: 'Emparejando con bot de IA...',\n    id: 'Mencocokkan dengan bot AI...',\n  },\n\n  // Game Over Modal\n  gameOver: {\n    en: 'Game Over!',\n    ar: 'ÿßŸÜÿ™Ÿáÿ™ ÿßŸÑŸÑÿπÿ®ÿ©!',\n    bn: '‡¶ñ‡ßá‡¶≤‡¶æ ‡¶∂‡ßá‡¶∑!',\n    hi: '‡§ñ‡•á‡§≤ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§!',\n    es: '¬°Juego Terminado!',\n    id: 'Permainan Selesai!',\n  },\n  playerWins: {\n    en: '{player} Wins!',\n    ar: '{player} ŸäŸÅŸàÿ≤!',\n    bn: '{player} ‡¶ú‡¶ø‡¶§‡ßá‡¶õ‡ßá!',\n    hi: '{player} ‡§ú‡•Ä‡§§‡§æ!',\n    es: '¬°{player} Gana!',\n    id: '{player} Menang!',\n  },\n  diagonalLine: {\n    en: 'Diagonal line',\n    ar: 'ÿÆÿ∑ ŸÇÿ∑ÿ±Ÿä',\n    bn: '‡¶ï‡¶∞‡ßç‡¶£ ‡¶∞‡ßá‡¶ñ‡¶æ',\n    hi: '‡§µ‡§ø‡§ï‡§∞‡•ç‡§£ ‡§∞‡•á‡§ñ‡§æ',\n    es: 'L√≠nea diagonal',\n    id: 'Garis diagonal',\n  },\n  \n  // Social Media Sharing\n  shareGame: {\n    en: 'Share Game',\n    ar: 'ŸÖÿ¥ÿßÿ±ŸÉÿ© ÿßŸÑŸÑÿπÿ®ÿ©',\n    bn: '‡¶ó‡ßá‡¶Æ ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®',\n    hi: '‡§ñ‡•á‡§≤ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Compartir Juego',\n    id: 'Bagikan Permainan',\n  },\n  shareGameText: {\n    en: 'Check out this awesome strategic tic-tac-toe game!',\n    ar: 'ÿßÿ∑ŸÑÿπ ÿπŸÑŸâ ŸÑÿπÿ®ÿ© ÿ•ŸÉÿ≥ ÿ£Ÿà ÿßŸÑÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© ÿßŸÑÿ±ÿßÿ¶ÿπÿ© Ÿáÿ∞Ÿá!',\n    bn: '‡¶è‡¶á ‡¶¶‡ßÅ‡¶∞‡ßç‡¶¶‡¶æ‡¶®‡ßç‡¶§ ‡¶ï‡ßå‡¶∂‡¶≤‡¶ó‡¶§ ‡¶ü‡¶ø‡¶ï ‡¶ü‡ßç‡¶Ø‡¶æ‡¶ï ‡¶ü‡ßã ‡¶ó‡ßá‡¶Æ‡¶ü‡¶ø ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®!',\n    hi: '‡§á‡§∏ ‡§Ö‡§¶‡•ç‡§≠‡•Å‡§§ ‡§∞‡§£‡§®‡•Ä‡§§‡§ø‡§ï ‡§ü‡§ø‡§ï ‡§ü‡•à‡§ï ‡§ü‡•ã ‡§ó‡•á‡§Æ ‡§ï‡•ã ‡§¶‡•á‡§ñ‡•á‡§Ç!',\n    es: '¬°Echa un vistazo a este incre√≠ble juego de tic-tac-toe estrat√©gico!',\n    id: 'Lihat permainan tic-tac-toe strategis yang luar biasa ini!',\n  },\n  mainMenu: {\n    en: 'Main Menu',\n    ar: 'ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©',\n    bn: '‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶Æ‡ßá‡¶®‡ßÅ',\n    hi: '‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§Æ‡•á‡§®‡•Ç',\n    es: 'Men√∫ Principal',\n    id: 'Menu Utama',\n  },\n  playWithAI: {\n    en: 'Home',\n    ar: 'ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©',\n    bn: '‡¶π‡ßã‡¶Æ',\n    hi: '‡§π‡•ã‡§Æ',\n    es: 'Inicio',\n    id: 'Beranda',\n  },\n  playAgain: {\n    en: 'Play Again',\n    ar: 'ÿßŸÑÿπÿ® ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ',\n    bn: '‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ñ‡ßá‡¶≤‡ßÅ‡¶®',\n    hi: '‡§´‡§ø‡§∞ ‡§∏‡•á ‡§ñ‡•á‡§≤‡•á‡§Ç',\n    es: 'Jugar de Nuevo',\n    id: 'Main Lagi',\n  },\n  itsADraw: {\n    en: \"It's a Draw!\",\n    ar: 'ÿ•ŸÜŸá ÿ™ÿπÿßÿØŸÑ!',\n    bn: '‡¶è‡¶ü‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶°‡ßç‡¶∞!',\n    hi: '‡§Ø‡§π ‡§è‡§ï ‡§°‡•ç‡§∞‡•â ‡§π‡•à!',\n    es: '¬°Es un Empate!',\n    id: 'Ini Seri!',\n  },\n  horizontalLine: {\n    en: 'Horizontal line',\n    ar: 'ÿÆÿ∑ ÿ£ŸÅŸÇŸä',\n    bn: '‡¶Ö‡¶®‡ßÅ‡¶≠‡ßÇ‡¶Æ‡¶ø‡¶ï ‡¶∞‡ßá‡¶ñ‡¶æ',\n    hi: '‡§ï‡•ç‡§∑‡•à‡§§‡§ø‡§ú ‡§∞‡•á‡§ñ‡§æ',\n    es: 'L√≠nea horizontal',\n    id: 'Garis horizontal',\n  },\n\n  // Achievement Descriptions\n\n\n  // Missing Chat & Friends Translations\n  sendMessage: {\n    en: 'Send Message',\n    ar: 'ÿ•ÿ±ÿ≥ÿßŸÑ ÿ±ÿ≥ÿßŸÑÿ©',\n    bn: '‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ ‡¶™‡¶æ‡¶†‡¶æ‡¶®',\n    hi: '‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§≠‡•á‡§ú‡•á‡§Ç',\n    es: 'Enviar Mensaje',\n    id: 'Kirim Pesan',\n  },\n  typeMessage: {\n    en: 'Type a message...',\n    ar: 'ÿßŸÉÿ™ÿ® ÿ±ÿ≥ÿßŸÑÿ©...',\n    bn: '‡¶è‡¶ï‡¶ü‡¶ø ‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®...',\n    hi: '‡§è‡§ï ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç...',\n    es: 'Escribe un mensaje...',\n    id: 'Ketik pesan...',\n  },\n  noFriends: {\n    en: 'No friends yet. Add some friends to get started!',\n    ar: 'ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ£ÿµÿØŸÇÿßÿ° ÿ®ÿπÿØ. ÿ£ÿ∂ŸÅ ÿ®ÿπÿ∂ ÿßŸÑÿ£ÿµÿØŸÇÿßÿ° ŸÑŸÑÿ®ÿØÿ°!',\n    bn: '‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ ‡¶®‡ßá‡¶á‡•§ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶§‡ßá ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®!',\n    hi: '‡§Ö‡§≠‡•Ä ‡§§‡§ï ‡§ï‡•ã‡§à ‡§Æ‡§ø‡§§‡•ç‡§∞ ‡§®‡§π‡•Ä‡§Ç‡•§ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•Å‡§õ ‡§Æ‡§ø‡§§‡•ç‡§∞ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç!',\n    es: '¬°A√∫n no hay amigos. Agrega algunos amigos para comenzar!',\n    id: 'Belum ada teman. Tambahkan beberapa teman untuk memulai!',\n  },\n  searchFriends: {\n    en: 'Search by username...',\n    ar: 'ÿßŸÑÿ®ÿ≠ÿ´ ÿ®Ÿàÿßÿ≥ÿ∑ÿ© ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ...',\n    bn: '‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ö‡¶®‡ßÅ‡¶∏‡¶®‡ßç‡¶ß‡¶æ‡¶®...',\n    hi: '‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡§Æ ‡§∏‡•á ‡§ñ‡•ã‡§ú‡•á‡§Ç...',\n    es: 'Buscar por nombre de usuario...',\n    id: 'Cari berdasarkan nama pengguna...',\n  },\n  loadingFriends: {\n    en: 'Loading friends...',\n    ar: 'ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ£ÿµÿØŸÇÿßÿ°...',\n    bn: '‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...',\n    hi: '‡§Æ‡§ø‡§§‡•ç‡§∞ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...',\n    es: 'Cargando amigos...',\n    id: 'Memuat teman...',\n  },\n  removeFriend: {\n    en: 'Remove Friend',\n    ar: 'ÿ•ÿ≤ÿßŸÑÿ© ÿµÿØŸäŸÇ',\n    bn: '‡¶¨‡¶®‡ßç‡¶ß‡ßÅ ‡¶∏‡¶∞‡¶æ‡¶®',\n    hi: '‡§Æ‡§ø‡§§‡•ç‡§∞ ‡§π‡§ü‡§æ‡§è‡§Ç',\n    es: 'Eliminar Amigo',\n    id: 'Hapus Teman',\n  },\n  accept: {\n    en: 'Accept',\n    ar: 'ŸÇÿ®ŸàŸÑ',\n    bn: '‡¶ó‡ßç‡¶∞‡¶π‡¶£',\n    hi: '‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞',\n    es: 'Aceptar',\n    id: 'Terima',\n  },\n  reject: {\n    en: 'Reject',\n    ar: 'ÿ±ŸÅÿ∂',\n    bn: '‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡¶æ‡¶ñ‡ßç‡¶Ø‡¶æ‡¶®',\n    hi: '‡§Ö‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞',\n    es: 'Rechazar',\n    id: 'Tolak',\n  },\n  newGame: {\n    en: 'New Game',\n    ar: 'ŸÑÿπÿ®ÿ© ÿ¨ÿØŸäÿØÿ©',\n    bn: '‡¶®‡¶§‡ßÅ‡¶® ‡¶ó‡ßá‡¶Æ',\n    hi: '‡§®‡§Ø‡§æ ‡§ó‡•á‡§Æ',\n    es: 'Nuevo Juego',\n    id: 'Permainan Baru',\n  },\n  restartGame: {\n    en: 'Restart Game',\n    ar: 'ÿ•ÿπÿßÿØÿ© ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑŸÑÿπÿ®ÿ©',\n    bn: '‡¶ó‡ßá‡¶Æ ‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶Ø‡¶º ‡¶∂‡ßÅ‡¶∞‡ßÅ',\n    hi: '‡§ó‡•á‡§Æ ‡§™‡•Å‡§®‡§É ‡§Ü‡§∞‡§Ç‡§≠ ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Reiniciar Juego',\n    id: 'Mulai Ulang Permainan',\n  },\n  locked: {\n    en: 'Locked',\n    ar: 'ŸÖŸÇŸÅŸÑ',\n    bn: '‡¶≤‡¶ï ‡¶ï‡¶∞‡¶æ',\n    hi: '‡§≤‡•â‡§ï',\n    es: 'Bloqueado',\n    id: 'Terkunci',\n  },\n  unlocked: {\n    en: 'Unlocked',\n    ar: 'ŸÖŸÅÿ™Ÿàÿ≠',\n    bn: '‡¶Ü‡¶®‡¶≤‡¶ï',\n    hi: '‡§Ö‡§®‡§≤‡•â‡§ï',\n    es: 'Desbloqueado',\n    id: 'Terbuka',\n  },\n  emailAddress: {\n    en: 'Email Address',\n    ar: 'ÿπŸÜŸàÿßŸÜ ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä',\n    bn: '‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ',\n    hi: '‡§à‡§Æ‡•á‡§≤ ‡§™‡§§‡§æ',\n    es: 'Direcci√≥n de Correo',\n    id: 'Alamat Email',\n  },\n\n  // Additional Friends & Chat Translations\n  noPendingRequests: {\n    en: 'No pending friend requests',\n    ar: 'ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ∑ŸÑÿ®ÿßÿ™ ÿµÿØÿßŸÇÿ© ŸÖÿπŸÑŸÇÿ©',\n    bn: '‡¶ï‡ßã‡¶®‡ßã ‡¶™‡ßá‡¶®‡ßç‡¶°‡¶ø‡¶Ç ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶§‡ßç‡¶¨‡ßá‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶∞‡ßã‡¶ß ‡¶®‡ßá‡¶á',\n    hi: '‡§ï‡•ã‡§à ‡§≤‡§Ç‡§¨‡§ø‡§§ ‡§Æ‡§ø‡§§‡•ç‡§∞ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§®‡§π‡•Ä‡§Ç',\n    es: 'No hay solicitudes de amistad pendientes',\n    id: 'Tidak ada permintaan pertemanan yang tertunda',\n  },\n  sentOn: {\n    en: 'Sent on',\n    ar: 'ÿ£ÿ±ÿ≥ŸÑ ŸÅŸä',\n    bn: '‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá',\n    hi: '‡§≠‡•á‡§ú‡§æ ‡§ó‡§Ø‡§æ',\n    es: 'Enviado el',\n    id: 'Dikirim pada',\n  },\n  searchResults: {\n    en: 'Search Results',\n    ar: 'ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ®ÿ≠ÿ´',\n    bn: '‡¶Ö‡¶®‡ßÅ‡¶∏‡¶®‡ßç‡¶ß‡¶æ‡¶®‡ßá‡¶∞ ‡¶´‡¶≤‡¶æ‡¶´‡¶≤',\n    hi: '‡§ñ‡•ã‡§ú ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ',\n    es: 'Resultados de B√∫squeda',\n    id: 'Hasil Pencarian',\n  },\n  headToHeadStats: {\n    en: 'Head-to-Head Stats',\n    ar: 'ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑŸÖŸàÿßÿ¨Ÿáÿ© ÿßŸÑŸÖÿ®ÿßÿ¥ÿ±ÿ©',\n    bn: '‡¶Æ‡ßÅ‡¶ñ‡ßã‡¶Æ‡ßÅ‡¶ñ‡¶ø ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶®',\n    hi: '‡§Ü‡§Æ‡§®‡•á-‡§∏‡§æ‡§Æ‡§®‡•á ‡§ï‡•á ‡§Ü‡§Ç‡§ï‡§°‡§º‡•á',\n    es: 'Estad√≠sticas Cara a Cara',\n    id: 'Statistik Head-to-Head',\n  },\n  youWon: {\n    en: 'Your Wins',\n    ar: 'ÿßŸÜÿ™ÿµÿßÿ±ÿßÿ™ŸÉ',\n    bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ú‡¶Ø‡¶º',\n    hi: '‡§Ü‡§™‡§ï‡•Ä ‡§ú‡•Ä‡§§',\n    es: 'Tus Victorias',\n    id: 'Kemenangan Anda',\n  },\n  theyWon: {\n    en: 'Their Wins',\n    ar: 'ÿßŸÜÿ™ÿµÿßÿ±ÿßÿ™ŸáŸÖ',\n    bn: '‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ú‡¶Ø‡¶º',\n    hi: '‡§â‡§®‡§ï‡•Ä ‡§ú‡•Ä‡§§',\n    es: 'Sus Victorias',\n    id: 'Kemenangan Mereka',\n  },\n  totalGames: {\n    en: 'Total Games',\n    ar: 'ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ£ŸÑÿπÿßÿ®',\n    bn: '‡¶Æ‡ßã‡¶ü ‡¶ó‡ßá‡¶Æ',\n    hi: '‡§ï‡•Å‡§≤ ‡§ó‡•á‡§Æ',\n    es: 'Juegos Totales',\n    id: 'Total Permainan',\n  },\n\n  yourWinRate: {\n    en: 'Your Win Rate',\n    ar: 'ŸÖÿπÿØŸÑ ÿßŸÜÿ™ÿµÿßÿ±ŸÉ',\n    bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ú‡¶Ø‡¶º‡ßá‡¶∞ ‡¶π‡¶æ‡¶∞',\n    hi: '‡§Ü‡§™‡§ï‡•Ä ‡§ú‡•Ä‡§§ ‡§¶‡§∞',\n    es: 'Tu Tasa de Victorias',\n    id: 'Tingkat Kemenangan Anda',\n  },\n  loadingStats: {\n    en: 'Loading stats...',\n    ar: 'ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™...',\n    bn: '‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶® ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...',\n    hi: '‡§Ü‡§Ç‡§ï‡§°‡§º‡•á ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...',\n    es: 'Cargando estad√≠sticas...',\n    id: 'Memuat statistik...',\n  },\n  back: {\n    en: 'Back',\n    ar: 'ÿ±ÿ¨Ÿàÿπ',\n    bn: '‡¶™‡¶ø‡¶õ‡¶®‡ßá',\n    hi: '‡§µ‡§æ‡§™‡§∏',\n    es: 'Volver',\n    id: 'Kembali',\n  },\n  chatWith: {\n    en: 'Chat with',\n    ar: 'ÿØÿ±ÿØÿ¥ÿ© ŸÖÿπ',\n    bn: '‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶ö‡ßç‡¶Ø‡¶æ‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®',\n    hi: '‡§ï‡•á ‡§∏‡§æ‡§• ‡§ö‡•à‡§ü ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Chatear con',\n    id: 'Chat dengan',\n  },\n  you: {\n    en: 'You',\n    ar: 'ÿ£ŸÜÿ™',\n    bn: '‡¶Ü‡¶™‡¶®‡¶ø',\n    hi: '‡§Ü‡§™',\n    es: 'T√∫',\n    id: 'Anda',\n  },\n  noMessages: {\n    en: 'No messages yet. Start a conversation with your friend!',\n    ar: 'ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ±ÿ≥ÿßÿ¶ŸÑ ÿ®ÿπÿØ. ÿßÿ®ÿØÿ£ ŸÖÿ≠ÿßÿØÿ´ÿ© ŸÖÿπ ÿµÿØŸäŸÇŸÉ!',\n    bn: '‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ ‡¶®‡ßá‡¶á‡•§ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶ï‡¶•‡ßã‡¶™‡¶ï‡¶•‡¶® ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®!',\n    hi: '‡§Ö‡§≠‡•Ä ‡§§‡§ï ‡§ï‡•ã‡§à ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§®‡§π‡•Ä‡§Ç‡•§ ‡§Ö‡§™‡§®‡•á ‡§Æ‡§ø‡§§‡•ç‡§∞ ‡§∏‡•á ‡§¨‡§æ‡§§‡§ö‡•Ä‡§§ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç!',\n    es: '¬°A√∫n no hay mensajes. Inicia una conversaci√≥n con tu amigo!',\n    id: 'Belum ada pesan. Mulai percakapan dengan teman Anda!',\n  },\n  search: {\n    en: 'Search',\n    ar: 'ÿ®ÿ≠ÿ´',\n    bn: '‡¶Ö‡¶®‡ßÅ‡¶∏‡¶®‡ßç‡¶ß‡¶æ‡¶®',\n    hi: '‡§ñ‡•ã‡§ú‡•á‡§Ç',\n    es: 'Buscar',\n    id: 'Cari',\n  },\n  send: {\n    en: 'Send',\n    ar: 'ÿ•ÿ±ÿ≥ÿßŸÑ',\n    bn: '‡¶™‡¶æ‡¶†‡¶æ‡¶®',\n    hi: '‡§≠‡•á‡§ú‡•á‡§Ç',\n    es: 'Enviar',\n    id: 'Kirim',\n  },\n\n  // GameBoard Messages\n  gameNotActive: {\n    en: 'Game not active',\n    ar: 'ÿßŸÑŸÑÿπÿ®ÿ© ÿ∫Ÿäÿ± ŸÜÿ¥ÿ∑ÿ©',\n    bn: '‡¶ó‡ßá‡¶Æ ‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º ‡¶®‡¶Ø‡¶º',\n    hi: '‡§ó‡•á‡§Æ ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§®‡§π‡•Ä‡§Ç',\n    es: 'Juego no activo',\n    id: 'Permainan tidak aktif',\n  },\n  startNewGameToPlay: {\n    en: 'Start a new game to play',\n    ar: 'ÿßÿ®ÿØÿ£ ŸÑÿπÿ®ÿ© ÿ¨ÿØŸäÿØÿ© ŸÑŸÑÿπÿ®',\n    bn: '‡¶ñ‡ßá‡¶≤‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶®‡¶§‡ßÅ‡¶® ‡¶ó‡ßá‡¶Æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®',\n    hi: '‡§ñ‡•á‡§≤‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§®‡§Ø‡§æ ‡§ó‡•á‡§Æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Inicia un nuevo juego para jugar',\n    id: 'Mulai permainan baru untuk bermain',\n  },\n  invalidMove: {\n    en: 'Invalid move',\n    ar: 'ÿ≠ÿ±ŸÉÿ© ÿ∫Ÿäÿ± ÿµÿßŸÑÿ≠ÿ©',\n    bn: '‡¶Ö‡¶¨‡ßà‡¶ß ‡¶ö‡¶æ‡¶≤',\n    hi: '‡§Ö‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ö‡§æ‡§≤',\n    es: 'Movimiento inv√°lido',\n    id: 'Gerakan tidak valid',\n  },\n  positionOccupied: {\n    en: 'Position already occupied',\n    ar: 'ÿßŸÑŸÖŸàŸÇÿπ ŸÖÿ≠ÿ¨Ÿàÿ≤ ÿ®ÿßŸÑŸÅÿπŸÑ',\n    bn: '‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶® ‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶¶‡¶ñ‡¶≤ ‡¶ï‡¶∞‡¶æ',\n    hi: '‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§ï‡§¨‡•ç‡§ú‡§æ ‡§Æ‡•á‡§Ç',\n    es: 'Posici√≥n ya ocupada',\n    id: 'Posisi sudah ditempati',\n  },\n  notAPlayer: {\n    en: 'Not a player',\n    ar: 'ŸÑŸäÿ≥ ŸÑÿßÿπÿ®ÿßŸã',\n    bn: '‡¶è‡¶ï‡¶ú‡¶® ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º ‡¶®‡¶Ø‡¶º',\n    hi: '‡§è‡§ï ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§®‡§π‡•Ä‡§Ç',\n    es: 'No es un jugador',\n    id: 'Bukan pemain',\n  },\n  notPlayerInGame: {\n    en: 'You are not a player in this game',\n    ar: 'ŸÑÿ≥ÿ™ ŸÑÿßÿπÿ®ÿßŸã ŸÅŸä Ÿáÿ∞Ÿá ÿßŸÑŸÑÿπÿ®ÿ©',\n    bn: '‡¶Ü‡¶™‡¶®‡¶ø ‡¶è‡¶á ‡¶ó‡ßá‡¶Æ‡ßá ‡¶è‡¶ï‡¶ú‡¶® ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º ‡¶®‡¶®',\n    hi: '‡§Ü‡§™ ‡§á‡§∏ ‡§ó‡•á‡§Æ ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡§Ç',\n    es: 'No eres un jugador en este juego',\n    id: 'Anda bukan pemain dalam permainan ini',\n  },\n  notYourTurn: {\n    en: 'Not your turn',\n    ar: 'ŸÑŸäÿ≥ ÿØŸàÿ±ŸÉ',\n    bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶æ‡¶≤‡¶æ ‡¶®‡¶Ø‡¶º',\n    hi: '‡§Ü‡§™‡§ï‡•Ä ‡§¨‡§æ‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç',\n    es: 'No es tu turno',\n    id: 'Bukan giliran Anda',\n  },\n  waitingFor: {\n    en: 'Waiting for',\n    ar: 'ŸÅŸä ÿßŸÜÿ™ÿ∏ÿßÿ±',\n    bn: '‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡¶õ‡ßá',\n    hi: '‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§Æ‡•á‡§Ç',\n    es: 'Esperando a',\n    id: 'Menunggu',\n  },\n  toMakeMove: {\n    en: 'to make a move',\n    ar: 'ŸÑŸÑŸÇŸäÿßŸÖ ÿ®ÿ≠ÿ±ŸÉÿ©',\n    bn: '‡¶è‡¶ï‡¶ü‡¶ø ‡¶ö‡¶æ‡¶≤ ‡¶ï‡¶∞‡¶§‡ßá',\n    hi: '‡§ö‡§æ‡§≤ ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è',\n    es: 'para hacer un movimiento',\n    id: 'untuk bergerak',\n  },\n\n\n  uploading: {\n    en: 'Uploading...',\n    ar: 'ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ±ŸÅÿπ...',\n    bn: '‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...',\n    hi: '‡§Ö‡§™‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...',\n    es: 'Subiendo...',\n    id: 'Mengunggah...',\n  },\n\n  enterDisplayName: {\n    en: 'Enter your display name',\n    ar: 'ÿ£ÿØÿÆŸÑ ÿßÿ≥ŸÖ ÿßŸÑÿπÿ±ÿ∂ ÿßŸÑÿÆÿßÿµ ÿ®ŸÉ',\n    bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶¶‡¶∞‡ßç‡¶∂‡¶® ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®',\n    hi: '‡§Ö‡§™‡§®‡§æ ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§® ‡§®‡§æ‡§Æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Ingresa tu nombre para mostrar',\n    id: 'Masukkan nama tampilan Anda',\n  },\n\n  saving: {\n    en: 'Saving...',\n    ar: 'ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ≠ŸÅÿ∏...',\n    bn: '‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...',\n    hi: '‡§∏‡•á‡§µ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...',\n    es: 'Guardando...',\n    id: 'Menyimpan...',\n  },\n  profileUpdated: {\n    en: 'Profile updated',\n    ar: 'ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä',\n    bn: '‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá',\n    hi: '‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤ ‡§Ö‡§™‡§°‡•á‡§ü ‡§π‡•ã ‡§ó‡§Ø‡§æ',\n    es: 'Perfil actualizado',\n    id: 'Profil diperbarui',\n  },\n  profileUpdatedSuccess: {\n    en: 'Your profile has been updated successfully',\n    ar: 'ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ŸÖŸÑŸÅŸÉ ÿßŸÑÿ¥ÿÆÿµŸä ÿ®ŸÜÿ¨ÿßÿ≠',\n    bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá',\n    hi: '‡§Ü‡§™‡§ï‡•Ä ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§Ö‡§™‡§°‡•á‡§ü ‡§π‡•ã ‡§ó‡§à ‡§π‡•à',\n    es: 'Tu perfil ha sido actualizado exitosamente',\n    id: 'Profil Anda telah berhasil diperbarui',\n  },\n  fileTooLarge: {\n    en: 'File too large',\n    ar: 'ÿßŸÑŸÖŸÑŸÅ ŸÉÿ®Ÿäÿ± ÿ¨ÿØÿß',\n    bn: '‡¶´‡¶æ‡¶á‡¶≤ ‡¶ñ‡ßÅ‡¶¨ ‡¶¨‡¶°‡¶º',\n    hi: '‡§´‡§æ‡§á‡§≤ ‡§¨‡§π‡•Å‡§§ ‡§¨‡§°‡§º‡•Ä',\n    es: 'Archivo demasiado grande',\n    id: 'File terlalu besar',\n  },\n  selectImageUnder1MB: {\n    en: 'Please select an image under 1MB',\n    ar: 'Ÿäÿ±ÿ¨Ÿâ ÿßÿÆÿ™Ÿäÿßÿ± ÿµŸàÿ±ÿ© ÿ£ŸÇŸÑ ŸÖŸÜ 1 ŸÖŸäÿ¨ÿßÿ®ÿßŸäÿ™',\n    bn: '‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡ßßMB ‡¶è‡¶∞ ‡¶ï‡¶Æ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶õ‡¶¨‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®',\n    hi: '‡§ï‡•É‡§™‡§Ø‡§æ 1MB ‡§∏‡•á ‡§ï‡§Æ ‡§ï‡§æ ‡§ö‡§ø‡§§‡•ç‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç',\n    es: 'Por favor selecciona una imagen menor a 1MB',\n    id: 'Silakan pilih gambar di bawah 1MB',\n  },\n  selectImageUnder5MB: {\n    en: 'Please select an image under 5MB',\n    ar: 'Ÿäÿ±ÿ¨Ÿâ ÿßÿÆÿ™Ÿäÿßÿ± ÿµŸàÿ±ÿ© ÿ£ŸÇŸÑ ŸÖŸÜ 5 ŸÖŸäÿ¨ÿßÿ®ÿßŸäÿ™',\n    bn: '‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡ß´MB ‡¶è‡¶∞ ‡¶ï‡¶Æ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶õ‡¶¨‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®',\n    hi: '‡§ï‡•É‡§™‡§Ø‡§æ 5MB ‡§∏‡•á ‡§ï‡§Æ ‡§ï‡§æ ‡§ö‡§ø‡§§‡•ç‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç',\n    es: 'Por favor selecciona una imagen menor a 5MB',\n    id: 'Silakan pilih gambar di bawah 5MB',\n  },\n  invalidFileType: {\n    en: 'Invalid file type',\n    ar: 'ŸÜŸàÿπ ŸÖŸÑŸÅ ÿ∫Ÿäÿ± ÿµÿßŸÑÿ≠',\n    bn: '‡¶Ö‡¶¨‡ßà‡¶ß ‡¶´‡¶æ‡¶á‡¶≤ ‡¶ß‡¶∞‡¶®',\n    hi: '‡§Ö‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§´‡§æ‡§á‡§≤ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞',\n    es: 'Tipo de archivo inv√°lido',\n    id: 'Jenis file tidak valid',\n  },\n  selectImageFile: {\n    en: 'Please select an image file',\n    ar: 'Ÿäÿ±ÿ¨Ÿâ ÿßÿÆÿ™Ÿäÿßÿ± ŸÖŸÑŸÅ ÿµŸàÿ±ÿ©',\n    bn: '‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®',\n    hi: '‡§ï‡•É‡§™‡§Ø‡§æ ‡§è‡§ï ‡§õ‡§µ‡§ø ‡§´‡§æ‡§á‡§≤ ‡§ö‡•Å‡§®‡•á‡§Ç',\n    es: 'Por favor selecciona un archivo de imagen',\n    id: 'Silakan pilih file gambar',\n  },\n  uploadFailed: {\n    en: 'Upload failed',\n    ar: 'ŸÅÿ¥ŸÑ ŸÅŸä ÿßŸÑÿ±ŸÅÿπ',\n    bn: '‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•',\n    hi: '‡§Ö‡§™‡§≤‡•ã‡§° ‡§Ö‡§∏‡§´‡§≤',\n    es: 'Fallo al subir',\n    id: 'Gagal mengunggah',\n  },\n  failedToReadImage: {\n    en: 'Failed to read the image file',\n    ar: 'ŸÅÿ¥ŸÑ ŸÅŸä ŸÇÿ±ÿßÿ°ÿ© ŸÖŸÑŸÅ ÿßŸÑÿµŸàÿ±ÿ©',\n    bn: '‡¶õ‡¶¨‡¶ø‡¶∞ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶™‡¶°‡¶º‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•',\n    hi: '‡§õ‡§µ‡§ø ‡§´‡§æ‡§á‡§≤ ‡§™‡§¢‡§º‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Ö‡§∏‡§´‡§≤',\n    es: 'Fall√≥ al leer el archivo de imagen',\n    id: 'Gagal membaca file gambar',\n  },\n\n\n  // Room Management\n  currentRoom: {\n    en: 'Current Room',\n    ar: 'ÿßŸÑÿ∫ÿ±ŸÅÿ© ÿßŸÑÿ≠ÿßŸÑŸäÿ©',\n    bn: '‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶∞‡ßÅ‡¶Æ',\n    hi: '‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§ï‡§Æ‡§∞‡§æ',\n    es: 'Sala Actual',\n    id: 'Ruang Saat Ini',\n  },\n  waiting: {\n    en: 'WAITING',\n    ar: 'ÿßŸÜÿ™ÿ∏ÿßÿ±',\n    bn: '‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ',\n    hi: '‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ',\n    es: 'ESPERANDO',\n    id: 'MENUNGGU',\n  },\n  playing: {\n    en: 'PLAYING',\n    ar: 'ŸäŸÑÿπÿ®',\n    bn: '‡¶ñ‡ßá‡¶≤‡¶õ‡ßá',\n    hi: '‡§ñ‡•á‡§≤ ‡§∞‡§π‡§æ',\n    es: 'JUGANDO',\n    id: 'BERMAIN',\n  },\n  active: {\n    en: 'ACTIVE',\n    ar: 'ŸÜÿ¥ÿ∑',\n    bn: '‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º',\n    hi: '‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø',\n    es: 'ACTIVO',\n    id: 'AKTIF',\n  },\n  roomName: {\n    en: 'Room',\n    ar: 'ÿ∫ÿ±ŸÅÿ©',\n    bn: '‡¶∞‡ßÅ‡¶Æ',\n    hi: '‡§ï‡§Æ‡¶∞‡§æ',\n    es: 'Sala',\n    id: 'Ruang',\n  },\n  starting: {\n    en: 'Starting...',\n    ar: 'ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ®ÿØÿ°...',\n    bn: '‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...',\n    hi: '‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã ‡§∞‡§π‡§æ...',\n    es: 'Iniciando...',\n    id: 'Memulai...',\n  },\n  gameRunning: {\n    en: 'Game Running',\n    ar: 'ÿßŸÑŸÑÿπÿ®ÿ© ÿ™ÿπŸÖŸÑ',\n    bn: '‡¶ó‡ßá‡¶Æ ‡¶ö‡¶≤‡¶õ‡ßá',\n    hi: '‡§ó‡•á‡§Æ ‡§ö‡§≤ ‡§∞‡§π‡§æ',\n    es: 'Juego en Curso',\n    id: 'Permainan Berjalan',\n  },\n  waitForStart: {\n    en: 'Wait for Start',\n    ar: 'ÿßŸÜÿ™ÿ∏ÿßÿ± ÿßŸÑÿ®ÿØÿßŸäÿ©',\n    bn: '‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ',\n    hi: '‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§ ‡§ï‡§æ ‡§á‡§Ç‡§§‡§ú‡§æ‡§∞',\n    es: 'Esperar Inicio',\n    id: 'Tunggu Mulai',\n  },\n  leftRoom: {\n    en: 'Left Room',\n    ar: 'ÿ∫ÿßÿØÿ± ÿßŸÑÿ∫ÿ±ŸÅÿ©',\n    bn: '‡¶∞‡ßÅ‡¶Æ ‡¶õ‡ßá‡¶°‡¶º‡ßá‡¶õ‡ßá‡¶®',\n    hi: '‡§ï‡§Æ‡§∞‡§æ ‡§õ‡•ã‡§°‡§º ‡§¶‡§ø‡§Ø‡§æ',\n    es: 'Sali√≥ de la Sala',\n    id: 'Keluar Ruang',\n  },\n  youHaveLeftTheRoom: {\n    en: 'You have left the room',\n    ar: 'ŸÑŸÇÿØ ÿ∫ÿßÿØÿ±ÿ™ ÿßŸÑÿ∫ÿ±ŸÅÿ©',\n    bn: '‡¶Ü‡¶™‡¶®‡¶ø ‡¶∞‡ßÅ‡¶Æ ‡¶õ‡ßá‡¶°‡¶º‡ßá‡¶õ‡ßá‡¶®',\n    hi: '‡§Ü‡§™‡§®‡•á ‡§ï‡§Æ‡§∞‡§æ ‡§õ‡•ã‡§°‡§º ‡§¶‡§ø‡§Ø‡§æ ‡§π‡•à',\n    es: 'Has salido de la sala',\n    id: 'Anda telah meninggalkan ruang',\n  },\n  playersAndSpectators: {\n    en: 'Players & Spectators',\n    ar: 'ÿßŸÑŸÑÿßÿπÿ®ŸàŸÜ ŸàÿßŸÑŸÖÿ™ŸÅÿ±ÿ¨ŸàŸÜ',\n    bn: '‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º ‡¶è‡¶¨‡¶Ç ‡¶¶‡¶∞‡ßç‡¶∂‡¶ï',\n    hi: '‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§î‡§∞ ‡§¶‡§∞‡•ç‡§∂‡§ï',\n    es: 'Jugadores y Espectadores',\n    id: 'Pemain & Penonton',\n  },\n  playersCount: {\n    en: 'Players',\n    ar: 'ÿßŸÑŸÑÿßÿπÿ®ŸàŸÜ',\n    bn: '‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º',\n    hi: '‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä',\n    es: 'Jugadores',\n    id: 'Pemain',\n  },\n  spectators: {\n    en: 'Spectators',\n    ar: 'ÿßŸÑŸÖÿ™ŸÅÿ±ÿ¨ŸàŸÜ',\n    bn: '‡¶¶‡¶∞‡ßç‡¶∂‡¶ï',\n    hi: '‡§¶‡§∞‡•ç‡§∂‡§ï',\n    es: 'Espectadores',\n    id: 'Penonton',\n  },\n  noPlayersInRoom: {\n    en: 'No players in room',\n    ar: 'ŸÑÿß ŸäŸàÿ¨ÿØ ŸÑÿßÿπÿ®ŸàŸÜ ŸÅŸä ÿßŸÑÿ∫ÿ±ŸÅÿ©',\n    bn: '‡¶∞‡ßÅ‡¶Æ‡ßá ‡¶ï‡ßã‡¶® ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º ‡¶®‡ßá‡¶á',\n    hi: '‡§ï‡§Æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§à ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§®‡§π‡•Ä‡§Ç',\n    es: 'No hay jugadores en la sala',\n    id: 'Tidak ada pemain di ruang',\n  },\n  noSpectators: {\n    en: 'No spectators',\n    ar: 'ŸÑÿß ŸäŸàÿ¨ÿØ ŸÖÿ™ŸÅÿ±ÿ¨ŸàŸÜ',\n    bn: '‡¶ï‡ßã‡¶® ‡¶¶‡¶∞‡ßç‡¶∂‡¶ï ‡¶®‡ßá‡¶á',\n    hi: '‡§ï‡•ã‡§à ‡§¶‡§∞‡•ç‡§∂‡§ï ‡§®‡§π‡•Ä‡§Ç',\n    es: 'No hay espectadores',\n    id: 'Tidak ada penonton',\n  },\n  playerAvatar: {\n    en: 'Player Avatar',\n    ar: 'ÿµŸàÿ±ÿ© ÿßŸÑŸÑÿßÿπÿ®',\n    bn: '‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º‡ßá‡¶∞ ‡¶õ‡¶¨‡¶ø',\n    hi: '‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§Ö‡§µ‡§§‡§æ‡§∞',\n    es: 'Avatar del Jugador',\n    id: 'Avatar Pemain',\n  },\n  spectatorAvatar: {\n    en: 'Spectator Avatar',\n    ar: 'ÿµŸàÿ±ÿ© ÿßŸÑŸÖÿ™ŸÅÿ±ÿ¨',\n    bn: '‡¶¶‡¶∞‡ßç‡¶∂‡¶ï‡ßá‡¶∞ ‡¶õ‡¶¨‡¶ø',\n    hi: '‡§¶‡§∞‡•ç‡§∂‡§ï ‡§Ö‡§µ‡§§‡§æ‡§∞',\n    es: 'Avatar del Espectador',\n    id: 'Avatar Penonton',\n  },\n  anonymous: {\n    en: 'Anonymous',\n    ar: 'ŸÖÿ¨ŸáŸàŸÑ',\n    bn: '‡¶Ö‡¶ú‡ßç‡¶û‡¶æ‡¶§',\n    hi: '‡§ó‡•Å‡§Æ‡§®‡§æ‡§Æ',\n    es: 'An√≥nimo',\n    id: 'Anonim',\n  },\n  watching: {\n    en: 'WATCHING',\n    ar: 'Ÿäÿ¥ÿßŸáÿØ',\n    bn: '‡¶¶‡ßá‡¶ñ‡¶õ‡ßá',\n    hi: '‡§¶‡•á‡§ñ ‡§∞‡§π‡§æ',\n    es: 'VIENDO',\n    id: 'MENONTON',\n  },\n\n  // Online Players Modal\n  onlinePlayers: {\n    en: 'Online Players',\n    ar: 'ÿßŸÑŸÑÿßÿπÿ®ŸàŸÜ ÿßŸÑŸÖÿ™ÿµŸÑŸàŸÜ',\n    bn: '‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶® ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º',\n    hi: '‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä',\n    es: 'Jugadores en L√≠nea',\n    id: 'Pemain Online',\n  },\n  viewPlayerProfilesAndManageInteractions: {\n    en: 'View player profiles and manage interactions',\n    ar: 'ÿπÿ±ÿ∂ ŸÖŸÑŸÅÿßÿ™ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ Ÿàÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ™ŸÅÿßÿπŸÑÿßÿ™',\n    bn: '‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Æ‡¶ø‡¶•‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶®‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®',\n    hi: '‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤ ‡§¶‡•á‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§¨‡§æ‡§§‡§ö‡•Ä‡§§ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Ver perfiles de jugadores y gestionar interacciones',\n    id: 'Lihat profil pemain dan kelola interaksi',\n  },\n  profileMenu: {\n    en: 'Profile',\n    ar: 'ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿ¥ÿÆÿµŸä',\n    bn: '‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤',\n    hi: '‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤',\n    es: 'Perfil',\n    id: 'Profil',\n  },\n  blocked: {\n    en: 'Blocked',\n    ar: 'ŸÖÿ≠ÿ∏Ÿàÿ±',\n    bn: '‡¶Ö‡¶¨‡¶∞‡ßÅ‡¶¶‡ßç‡¶ß',\n    hi: '‡§Ö‡§µ‡§∞‡•Å‡§¶‡•ç‡§ß',\n    es: 'Bloqueado',\n    id: 'Diblokir',\n  },\n  inRoom: {\n    en: 'In Room',\n    ar: 'ŸÅŸä ÿßŸÑÿ∫ÿ±ŸÅÿ©',\n    bn: '‡¶∞‡ßÅ‡¶Æ‡ßá',\n    hi: '‡§ï‡§Æ‡§∞‡•á ‡§Æ‡•á‡§Ç',\n    es: 'En Sala',\n    id: 'Di Ruang',\n  },\n  block: {\n    en: 'Block',\n    ar: 'ÿ≠ÿ∏ÿ±',\n    bn: '‡¶Ö‡¶¨‡¶∞‡ßã‡¶ß',\n    hi: '‡§¨‡•ç‡§≤‡•â‡§ï',\n    es: 'Bloquear',\n    id: 'Blokir',\n  },\n  unblock: {\n    en: 'Unblock',\n    ar: 'ÿ•ŸÑÿ∫ÿßÿ° ÿßŸÑÿ≠ÿ∏ÿ±',\n    bn: '‡¶Ö‡¶¨‡¶∞‡ßã‡¶ß ‡¶∏‡¶∞‡¶æ‡¶®',\n    hi: '‡§Ö‡§®‡§¨‡•ç‡§≤‡•â‡§ï',\n    es: 'Desbloquear',\n    id: 'Buka Blokir',\n  },\n  userBlocked: {\n    en: 'User blocked',\n    ar: 'ÿ™ŸÖ ÿ≠ÿ∏ÿ± ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ',\n    bn: '‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶Ö‡¶¨‡¶∞‡ßÅ‡¶¶‡ßç‡¶ß',\n    hi: '‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§Ö‡§µ‡§∞‡•Å‡§¶‡•ç‡§ß',\n    es: 'Usuario bloqueado',\n    id: 'Pengguna diblokir',\n  },\n  userBlockedSuccessfully: {\n    en: 'User has been blocked successfully',\n    ar: 'ÿ™ŸÖ ÿ≠ÿ∏ÿ± ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ®ŸÜÿ¨ÿßÿ≠',\n    bn: '‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶Ö‡¶¨‡¶∞‡ßÅ‡¶¶‡ßç‡¶ß ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá',\n    hi: '‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§Ö‡§µ‡§∞‡•Å‡§¶‡•ç‡§ß ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ',\n    es: 'El usuario ha sido bloqueado exitosamente',\n    id: 'Pengguna telah berhasil diblokir',\n  },\n  userUnblocked: {\n    en: 'User unblocked',\n    ar: 'ÿ™ŸÖ ÿ•ŸÑÿ∫ÿßÿ° ÿ≠ÿ∏ÿ± ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ',\n    bn: '‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶Ö‡¶¨‡¶∞‡ßã‡¶ß ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá',\n    hi: '‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§Ö‡§®‡§¨‡•ç‡§≤‡•â‡§ï',\n    es: 'Usuario desbloqueado',\n    id: 'Pengguna dibuka blokirnya',\n  },\n  userUnblockedSuccessfully: {\n    en: 'User has been unblocked successfully',\n    ar: 'ÿ™ŸÖ ÿ•ŸÑÿ∫ÿßÿ° ÿ≠ÿ∏ÿ± ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ÿ®ŸÜÿ¨ÿßÿ≠',\n    bn: '‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶Ö‡¶¨‡¶∞‡ßã‡¶ß ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá',\n    hi: '‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§Ö‡§®‡§¨‡•ç‡§≤‡•â‡§ï ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ',\n    es: 'El usuario ha sido desbloqueado exitosamente',\n    id: 'Pengguna telah berhasil dibuka blokirnya',\n  },\n  friendRequestSent: {\n    en: 'Friend Request Sent',\n    ar: 'ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿ∑ŸÑÿ® ÿßŸÑÿµÿØÿßŸÇÿ©',\n    bn: '‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶§‡ßç‡¶¨‡ßá‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶∞‡ßã‡¶ß ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá',\n    hi: '‡§Æ‡§ø‡§§‡•ç‡§∞‡§§‡§æ ‡§ï‡§æ ‡§Ö‡§®‡ßÅ‡§∞‡•ã‡§ß ‡§≠‡ßá‡¶ú‡¶æ ‡§ó‡§Ø‡§æ',\n    es: 'Solicitud de Amistad Enviada',\n    id: 'Permintaan Pertemanan Dikirim',\n  },\n  friendRequestSentSuccessfully: {\n    en: 'Friend request has been sent successfully',\n    ar: 'ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿ∑ŸÑÿ® ÿßŸÑÿµÿØÿßŸÇÿ© ÿ®ŸÜÿ¨ÿßÿ≠',\n    bn: '‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶§‡ßç‡¶¨‡ßá‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶∞‡ßã‡¶ß ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá',\n    hi: '‡§Æ‡§ø‡§§‡•ç‡§∞‡§§‡§æ ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡ßÇ‡§∞‡•ç‡§µ‡§ï ‡§≠‡•á‡§ú‡§æ ‡§ó‡§Ø‡§æ',\n    es: 'La solicitud de amistad ha sido enviada exitosamente',\n    id: 'Permintaan pertemanan telah berhasil dikirim',\n  },\n  friendRequestAlreadyExists: {\n    en: 'Friend request already exists between you and this user',\n    ar: 'ÿ∑ŸÑÿ® ÿßŸÑÿµÿØÿßŸÇÿ© ŸÖŸàÿ¨ŸàÿØ ÿ®ÿßŸÑŸÅÿπŸÑ ÿ®ŸäŸÜŸÉ Ÿàÿ®ŸäŸÜ Ÿáÿ∞ÿß ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ',\n    bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶¨‡¶Ç ‡¶è‡¶á ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶§‡ßç‡¶¨‡ßá‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶∞‡ßã‡¶ß ‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶Æ‡¶æ‡¶®',\n    hi: '‡§Ü‡§™‡§ï‡•á ‡§î‡§∞ ‡§á‡§∏ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§Æ‡§ø‡§§‡•ç‡§∞‡§§‡§æ ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§π‡•à',\n    es: 'Ya existe una solicitud de amistad entre t√∫ y este usuario',\n    id: 'Permintaan pertemanan sudah ada antara Anda dan pengguna ini',\n  },\n  alreadyFriends: {\n    en: 'You are already friends with this user',\n    ar: 'ÿ£ŸÜÿ™ ÿµÿØŸäŸÇ ÿ®ÿßŸÑŸÅÿπŸÑ ŸÖÿπ Ÿáÿ∞ÿß ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ',\n    bn: '‡¶Ü‡¶™‡¶®‡¶ø ‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶è‡¶á ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ',\n    hi: '‡§Ü‡§™ ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§π‡•Ä ‡§á‡§∏ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á ‡§Æ‡§ø‡§§‡•ç‡§∞ ‡§π‡•à‡§Ç',\n    es: 'Ya eres amigo de este usuario',\n    id: 'Anda sudah berteman dengan pengguna ini',\n  },\n  justNow: {\n    en: 'Just now',\n    ar: 'ÿßŸÑÿ¢ŸÜ',\n    bn: '‡¶è‡¶á‡¶Æ‡¶æ‡¶§‡ßç‡¶∞',\n    hi: '‡§Ö‡§≠‡•Ä',\n    es: 'Ahora mismo',\n    id: 'Baru saja',\n  },\n  minutesAgo: {\n    en: 'm ago',\n    ar: 'ÿØ ŸÖÿ∂ÿ™',\n    bn: '‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ‡¶Ü‡¶ó‡ßá',\n    hi: '‡§Æ‡§ø‡§®‡§ü ‡§™‡§π‡§≤‡•á',\n    es: 'm hace',\n    id: 'm lalu',\n  },\n  hoursAgo: {\n    en: 'h ago',\n    ar: 'ÿ≥ ŸÖÿ∂ÿ™',\n    bn: '‡¶ò‡¶®‡ßç‡¶ü‡¶æ ‡¶Ü‡¶ó‡ßá',\n    hi: '‡§ò‡§Ç‡§ü‡•á ‡§™‡§π‡§≤‡•á',\n    es: 'h hace',\n    id: 'j lalu',\n  },\n  daysAgo: {\n    en: 'd ago',\n    ar: 'Ÿä ŸÖÿ∂ÿ™',\n    bn: '‡¶¶‡¶ø‡¶® ‡¶Ü‡¶ó‡ßá',\n    hi: '‡§¶‡§ø‡§® ‡§™‡§π‡§≤‡•á',\n    es: 'd hace',\n    id: 'h lalu',\n  },\n  noOtherPlayersOnline: {\n    en: 'No other players online',\n    ar: 'ŸÑÿß ŸäŸàÿ¨ÿØ ŸÑÿßÿπÿ®ŸàŸÜ ÿ¢ÿÆÿ±ŸàŸÜ ŸÖÿ™ÿµŸÑŸàŸÜ',\n    bn: '‡¶Ö‡¶®‡ßç‡¶Ø ‡¶ï‡ßã‡¶® ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º ‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶®‡ßá ‡¶®‡ßá‡¶á',\n    hi: '‡§ï‡•ã‡§à ‡§Ö‡§®‡•ç‡§Ø ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§®‡§π‡•Ä‡§Ç',\n    es: 'No hay otros jugadores en l√≠nea',\n    id: 'Tidak ada pemain lain yang online',\n  },\n  connectedToRoom: {\n    en: 'Connected to room',\n    ar: 'ŸÖÿ™ÿµŸÑ ÿ®ÿßŸÑÿ∫ÿ±ŸÅÿ©',\n    bn: '‡¶∞‡ßÅ‡¶Æ‡ßá ‡¶∏‡¶Ç‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§',\n    hi: '‡§ï‡§Æ‡§∞‡•á ‡§∏‡•á ‡§ú‡•Å‡§°‡§º‡§æ ‡§π‡•Å‡§Ü',\n    es: 'Conectado a la sala',\n    id: 'Terhubung ke ruang',\n  },\n  startGame: {\n    en: 'Start Game',\n    ar: 'ÿ®ÿØÿ° ÿßŸÑŸÑÿπÿ®ÿ©',\n    bn: '‡¶ñ‡ßá‡¶≤‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®',\n    hi: '‡§ñ‡•á‡§≤ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Iniciar Juego',\n    id: 'Mulai Permainan',\n  },\n  inviteFriends: {\n    en: 'Invite Friends',\n    ar: 'ÿØÿπŸàÿ© ÿßŸÑÿ£ÿµÿØŸÇÿßÿ°',\n    bn: '‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶Ü‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶ú‡¶æ‡¶®‡¶æ‡¶®',\n    hi: '‡§¶‡•ã‡§∏‡•ç‡§§‡•ã‡§Ç ‡§ï‡•ã ‡§Ü‡§Æ‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Invitar Amigos',\n    id: 'Undang Teman',\n  },\n\n  // Invite Friends Modal\n  inviteFriendsTo: {\n    en: 'Invite Friends to',\n    ar: 'ÿØÿπŸàÿ© ÿßŸÑÿ£ÿµÿØŸÇÿßÿ° ÿ•ŸÑŸâ',\n    bn: '‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶Ü‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶ú‡¶æ‡¶®‡¶æ‡¶®',\n    hi: '‡§Æ‡§ø‡§§‡•ç‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§Ü‡§Æ‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Invitar Amigos a',\n    id: 'Undang Teman ke',\n  },\n  invitationSent: {\n    en: 'Invitation Sent',\n    ar: 'ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿØÿπŸàÿ©',\n    bn: '‡¶Ü‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá',\n    hi: '‡§®‡§ø‡§Æ‡§Ç‡§§‡•ç‡§∞‡§£ ‡§≠‡•á‡§ú‡§æ ‡§ó‡§Ø‡§æ',\n    es: 'Invitaci√≥n Enviada',\n    id: 'Undangan Terkirim',\n  },\n  friendInvitedToRoom: {\n    en: 'Your friend has been invited to join the room!',\n    ar: 'ÿ™ŸÖ ÿØÿπŸàÿ© ÿµÿØŸäŸÇŸÉ ŸÑŸÑÿßŸÜÿ∂ŸÖÿßŸÖ ÿ•ŸÑŸâ ÿßŸÑÿ∫ÿ±ŸÅÿ©!',\n    bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶ï‡ßá ‡¶∞‡ßÅ‡¶Æ‡ßá ‡¶Ø‡ßã‡¶ó ‡¶¶‡¶ø‡¶§‡ßá ‡¶Ü‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶ú‡¶æ‡¶®‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!',\n    hi: '‡§Ü‡§™‡§ï‡•á ‡§Æ‡§ø‡§§‡•ç‡§∞ ‡§ï‡•ã ‡§ï‡§Æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§Æ‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à!',\n    es: '¬°Tu amigo ha sido invitado a unirse a la sala!',\n    id: 'Teman Anda telah diundang untuk bergabung dengan ruangan!',\n  },\n  failedToSendInvitation: {\n    en: 'Failed to send invitation',\n    ar: 'ŸÅÿ¥ŸÑ ŸÅŸä ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿØÿπŸàÿ©',\n    bn: '‡¶Ü‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶™‡¶æ‡¶†‡¶æ‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•',\n    hi: '‡§®‡§ø‡§Æ‡§Ç‡§§‡•ç‡§∞‡§£ ‡§≠‡•á‡§ú‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Ö‡§∏‡§´‡§≤',\n    es: 'Fall√≥ al enviar invitaci√≥n',\n    id: 'Gagal mengirim undangan',\n  },\n\n  noFriendsFound: {\n    en: 'No Friends Found',\n    ar: 'ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿ£ÿµÿØŸÇÿßÿ°',\n    bn: '‡¶ï‡ßã‡¶® ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßá ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø',\n    hi: '‡§ï‡•ã‡§à ‡§Æ‡§ø‡§§‡•ç‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ',\n    es: 'No se encontraron amigos',\n    id: 'Tidak ada teman ditemukan',\n  },\n  addFriendsFirstToInvite: {\n    en: 'Add some friends first to invite them to your rooms!',\n    ar: 'ÿ£ÿ∂ŸÅ ÿ®ÿπÿ∂ ÿßŸÑÿ£ÿµÿØŸÇÿßÿ° ÿ£ŸàŸÑÿßŸã ŸÑÿØÿπŸàÿ™ŸáŸÖ ÿ•ŸÑŸâ ÿ∫ÿ±ŸÅŸÉ!',\n    bn: '‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡ßÅ‡¶Æ‡ßá ‡¶Ü‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶ú‡¶æ‡¶®‡¶æ‡¶§‡ßá!',\n    hi: '‡§™‡§π‡§≤‡•á ‡§ï‡•Å‡§õ ‡§Æ‡§ø‡§§‡•ç‡§∞ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç ‡§§‡§æ‡§ï‡§ø ‡§Ü‡§™ ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§Ö‡§™‡§®‡•á ‡§ï‡§Æ‡§∞‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§Ü‡§Æ‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡•á‡§Ç!',\n    es: '¬°Agrega algunos amigos primero para invitarlos a tus salas!',\n    id: 'Tambahkan beberapa teman dulu untuk mengundang mereka ke ruangan Anda!',\n  },\n  selectFriendsToInvite: {\n    en: 'Select friends to invite to your room:',\n    ar: 'ÿßÿÆÿ™ÿ± ÿßŸÑÿ£ÿµÿØŸÇÿßÿ° ŸÑÿØÿπŸàÿ™ŸáŸÖ ÿ•ŸÑŸâ ÿ∫ÿ±ŸÅÿ™ŸÉ:',\n    bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡ßÅ‡¶Æ‡ßá ‡¶Ü‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶ú‡¶æ‡¶®‡¶æ‡¶§‡ßá ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®:',\n    hi: '‡§Ö‡§™‡§®‡•á ‡§ï‡§Æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§Ü‡§Æ‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Æ‡§ø‡§§‡•ç‡§∞‡•ã‡§Ç ‡§ï‡§æ ‡§ö‡§Ø‡§® ‡§ï‡§∞‡•á‡§Ç:',\n    es: 'Selecciona amigos para invitar a tu sala:',\n    id: 'Pilih teman untuk diundang ke ruangan Anda:',\n  },\n  invited: {\n    en: 'Invited',\n    ar: 'ŸÖÿØÿπŸà',\n    bn: '‡¶Ü‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶ø‡¶§',\n    hi: '‡§Ü‡§Æ‡§Ç‡§§‡•ç‡§∞‡§ø‡§§',\n    es: 'Invitado',\n    id: 'Diundang',\n  },\n  sending: {\n    en: 'Sending...',\n    ar: 'ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ•ÿ±ÿ≥ÿßŸÑ...',\n    bn: '‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶ö‡ßç‡¶õ‡ßá...',\n    hi: '‡§≠‡•á‡§ú‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...',\n    es: 'Enviando...',\n    id: 'Mengirim...',\n  },\n  invite: {\n    en: 'Invite',\n    ar: 'ÿØÿπŸàÿ©',\n    bn: '‡¶Ü‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£',\n    hi: '‡§Ü‡§Æ‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Invitar',\n    id: 'Undang',\n  },\n\n\n  failedToSendMessage: {\n    en: 'Failed to send message',\n    ar: 'ŸÅÿ¥ŸÑ ŸÅŸä ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ©',\n    bn: '‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ ‡¶™‡¶æ‡¶†‡¶æ‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•',\n    hi: '‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§≠‡•á‡§ú‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Ö‡§∏‡§´‡§≤',\n    es: 'Fall√≥ al enviar mensaje',\n    id: 'Gagal mengirim pesan',\n  },\n  noMessagesYet: {\n    en: 'No messages yet. Start a conversation!',\n    ar: 'ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ±ÿ≥ÿßÿ¶ŸÑ ÿ®ÿπÿØ. ÿßÿ®ÿØÿ£ ŸÖÿ≠ÿßÿØÿ´ÿ©!',\n    bn: '‡¶è‡¶ñ‡¶®‡¶ì ‡¶ï‡ßã‡¶® ‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ ‡¶®‡ßá‡¶á‡•§ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ï‡¶•‡ßã‡¶™‡¶ï‡¶•‡¶® ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®!',\n    hi: '‡§Ö‡§≠‡•Ä ‡§§‡§ï ‡§ï‡•ã‡§à ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§®‡§π‡•Ä‡§Ç‡•§ ‡§¨‡§æ‡§§‡§ö‡•Ä‡§§ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç!',\n    es: 'A√∫n no hay mensajes. ¬°Inicia una conversaci√≥n!',\n    id: 'Belum ada pesan. Mulai percakapan!',\n  },\n\n\n  // Invitation Popup\n  invitationAccepted: {\n    en: 'Invitation Accepted',\n    ar: 'ÿ™ŸÖ ŸÇÿ®ŸàŸÑ ÿßŸÑÿØÿπŸàÿ©',\n    bn: '‡¶Ü‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶ó‡ßÉ‡¶π‡ßÄ‡¶§',\n    hi: '‡§®‡§ø‡§Æ‡§Ç‡§§‡•ç‡§∞‡§£ ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ',\n    es: 'Invitaci√≥n Aceptada',\n    id: 'Undangan Diterima',\n  },\n\n  // Leaderboard\n  leaderboard: {\n    en: 'Leaderboard',\n    ar: 'ŸÑŸàÿ≠ÿ© ÿßŸÑŸÖÿ™ÿµÿØÿ±ŸäŸÜ',\n    bn: '‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°',\n    hi: '‡§≤‡•Ä‡§°‡§∞‡§¨‡•ã‡§∞‡•ç‡§°',\n    es: 'Tabla de Posiciones',\n    id: 'Papan Peringkat',\n  },\n  top50Players: {\n    en: 'Top 50 Players',\n    ar: 'ÿ£ŸÅÿ∂ŸÑ 50 ŸÑÿßÿπÿ®',\n    bn: '‡¶∂‡ßÄ‡¶∞‡ßç‡¶∑ 50 ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º',\n    hi: '‡§∂‡•Ä‡§∞‡•ç‡§∑ 50 ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä',\n    es: 'Top 50 Jugadores',\n    id: 'Top 50 Pemain',\n  },\n  leaderboardDescription: {\n    en: 'The best players ranked by total wins. Achievement borders show player status!',\n    ar: 'ÿ£ŸÅÿ∂ŸÑ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ ŸÖÿ±ÿ™ÿ®ŸäŸÜ ÿ≠ÿ≥ÿ® ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿßŸÜÿ™ÿµÿßÿ±ÿßÿ™. ÿ≠ÿØŸàÿØ ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤ÿßÿ™ ÿ™ÿ∏Ÿáÿ± ÿ≠ÿßŸÑÿ© ÿßŸÑŸÑÿßÿπÿ®!',\n    bn: '‡¶Æ‡ßã‡¶ü ‡¶ú‡¶Ø‡¶º‡ßá‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶§‡ßá ‡¶∞‚Äç‡ßç‡¶Ø‡¶æ‡¶ô‡ßç‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶∏‡ßá‡¶∞‡¶æ ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º‡•§ ‡¶Ö‡¶∞‡ßç‡¶ú‡¶®‡ßá‡¶∞ ‡¶∏‡ßÄ‡¶Æ‡¶æ‡¶®‡¶æ ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º‡ßá‡¶∞ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶Ø‡¶º!',\n    hi: '‡§ï‡•Å‡§≤ ‡§ú‡•Ä‡§§ ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§∞‡•à‡§Ç‡§ï ‡§ï‡§ø‡§è ‡§ó‡§è ‡§∏‡§∞‡•ç‡§µ‡§∂‡•ç‡§∞‡•á‡§∑‡•ç‡§† ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä‡•§ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡§ø ‡§∏‡•Ä‡§Æ‡§æ‡§è‡§Ç ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§¶‡§ø‡§ñ‡§æ‡§§‡•Ä ‡§π‡•à‡§Ç!',\n    es: 'Los mejores jugadores clasificados por victorias totales. ¬°Los bordes de logros muestran el estado del jugador!',\n    id: 'Pemain terbaik berdasarkan total kemenangan. Batas pencapaian menunjukkan status pemain!',\n  },\n  loadingLeaderboard: {\n    en: 'Loading leaderboard...',\n    ar: 'ÿ¨ÿßÿ±Ÿç ÿ™ÿ≠ŸÖŸäŸÑ ŸÑŸàÿ≠ÿ© ÿßŸÑŸÖÿ™ÿµÿØÿ±ŸäŸÜ...',\n    bn: '‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...',\n    hi: '‡§≤‡•Ä‡§°‡§∞‡§¨‡•ã‡§∞‡•ç‡§° ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...',\n    es: 'Cargando tabla de posiciones...',\n    id: 'Memuat papan peringkat...',\n  },\n  errorLoadingLeaderboard: {\n    en: 'Error loading leaderboard. Please try again.',\n    ar: 'ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ŸÑŸàÿ≠ÿ© ÿßŸÑŸÖÿ™ÿµÿØÿ±ŸäŸÜ. Ÿäÿ±ÿ¨Ÿâ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ.',\n    bn: '‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø‡•§ ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§',\n    hi: '‡§≤‡•Ä‡§°‡§∞‡§¨‡•ã‡§∞‡•ç‡§° ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§',\n    es: 'Error al cargar la tabla de posiciones. Por favor, int√©ntalo de nuevo.',\n    id: 'Gagal memuat papan peringkat. Silakan coba lagi.',\n  },\n  winsCount: {\n    en: 'wins',\n    ar: 'ÿßŸÜÿ™ÿµÿßÿ±ÿßÿ™',\n    bn: '‡¶ú‡¶Ø‡¶º',\n    hi: '‡§ú‡•Ä‡§§',\n    es: 'victorias',\n    id: 'kemenangan',\n  },\n  games: {\n    en: 'games',\n    ar: 'ÿ£ŸÑÿπÿßÿ®',\n    bn: '‡¶ó‡ßá‡¶Æ',\n    hi: '‡§ó‡•á‡§Æ',\n    es: 'juegos',\n    id: 'permainan',\n  },\n  wld: {\n    en: 'W-L-D',\n    ar: 'ŸÅ-ÿÆ-ÿ™',\n    bn: '‡¶ú-‡¶π-‡¶°',\n    hi: '‡§ú‡•Ä-‡§π‡§æ-‡§°‡•ç‡§∞‡§æ',\n    es: 'V-D-E',\n    id: 'M-K-S',\n  },\n  showing: {\n    en: 'Showing',\n    ar: 'ÿπÿ±ÿ∂',\n    bn: '‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶ö‡ßç‡¶õ‡ßá',\n    hi: '‡§¶‡§ø‡§ñ‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ',\n    es: 'Mostrando',\n    id: 'Menampilkan',\n  },\n  players: {\n    en: 'players',\n    ar: 'ŸÑÿßÿπÿ®ŸäŸÜ',\n    bn: '‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º',\n    hi: '‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä',\n    es: 'jugadores',\n    id: 'pemain',\n  },\n  noPlayersFound: {\n    en: 'No players found. Start playing to appear on the leaderboard!',\n    ar: 'ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ŸÑÿßÿπÿ®ŸäŸÜ. ÿßÿ®ÿØÿ£ ÿßŸÑŸÑÿπÿ® ŸÑŸÑÿ∏ŸáŸàÿ± ŸÅŸä ŸÑŸàÿ≠ÿ© ÿßŸÑŸÖÿ™ÿµÿØÿ±ŸäŸÜ!',\n    bn: '‡¶ï‡ßã‡¶®‡ßã ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§ ‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá ‡¶Ü‡¶∏‡¶§‡ßá ‡¶ñ‡ßá‡¶≤‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®!',\n    hi: '‡§ï‡•ã‡§à ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§ ‡§≤‡•Ä‡§°‡§∞‡§¨‡•ã‡§∞‡•ç‡§° ‡§™‡§∞ ‡§Ü‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ñ‡•á‡§≤‡§®‡§æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç!',\n    es: '¬°No se encontraron jugadores. Comienza a jugar para aparecer en la tabla de posiciones!',\n    id: 'Tidak ada pemain ditemukan. Mulai bermain untuk muncul di papan peringkat!',\n  },\n\n  invitationDeclined: {\n    en: 'Invitation Declined',\n    ar: 'ÿ™ŸÖ ÿ±ŸÅÿ∂ ÿßŸÑÿØÿπŸàÿ©',\n    bn: '‡¶Ü‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡¶æ‡¶ñ‡ßç‡¶Ø‡¶æ‡¶®',\n    hi: '‡§®‡§ø‡§Æ‡§Ç‡§§‡•ç‡§∞‡§£ ‡§Ö‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ',\n    es: 'Invitaci√≥n Rechazada',\n    id: 'Undangan Ditolak',\n  },\n  youDeclinedInvitation: {\n    en: 'You declined the room invitation.',\n    ar: 'ŸÑŸÇÿØ ÿ±ŸÅÿ∂ÿ™ ÿØÿπŸàÿ© ÿßŸÑÿ∫ÿ±ŸÅÿ©.',\n    bn: '‡¶Ü‡¶™‡¶®‡¶ø ‡¶∞‡ßÅ‡¶Æ‡ßá‡¶∞ ‡¶Ü‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡¶æ‡¶ñ‡ßç‡¶Ø‡¶æ‡¶® ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡¶®‡•§',\n    hi: '‡§Ü‡§™‡§®‡•á ‡§ï‡§Æ‡§∞‡•á ‡§ï‡§æ ‡§®‡§ø‡§Æ‡§Ç‡§§‡•ç‡§∞‡§£ ‡§Ö‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ‡•§',\n    es: 'Rechazaste la invitaci√≥n a la sala.',\n    id: 'Anda menolak undangan ruangan.',\n  },\n  roomInvitation: {\n    en: 'Room Invitation',\n    ar: 'ÿØÿπŸàÿ© ÿßŸÑÿ∫ÿ±ŸÅÿ©',\n    bn: '‡¶∞‡ßÅ‡¶Æ‡ßá‡¶∞ ‡¶Ü‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£',\n    hi: '‡§ï‡§Æ‡§∞‡•á ‡§ï‡§æ ‡§®‡§ø‡§Æ‡§Ç‡§§‡•ç‡§∞‡§£',\n    es: 'Invitaci√≥n a la Sala',\n    id: 'Undangan Ruangan',\n  },\n  invitedYouToJoinRoom: {\n    en: '{inviterName} invited you to join their room',\n    ar: '{inviterName} ÿØÿπÿßŸÉ ŸÑŸÑÿßŸÜÿ∂ŸÖÿßŸÖ ÿ•ŸÑŸâ ÿ∫ÿ±ŸÅÿ™Ÿá',\n    bn: '{inviterName} ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∞‡ßÅ‡¶Æ‡ßá ‡¶Ø‡ßã‡¶ó ‡¶¶‡¶ø‡¶§‡ßá ‡¶Ü‡¶Æ‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶ú‡¶æ‡¶®‡¶ø‡¶Ø‡¶º‡ßá‡¶õ‡ßá',\n    hi: '{inviterName} ‡§®‡•á ‡§Ü‡§™‡§ï‡•ã ‡§Ö‡§™‡§®‡•á ‡§ï‡§Æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§Æ‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ',\n    es: '{inviterName} te invit√≥ a unirte a su sala',\n    id: '{inviterName} mengundang Anda untuk bergabung dengan ruangan mereka',\n  },\n\n  gameRoom: {\n    en: 'Game Room',\n    ar: 'ÿ∫ÿ±ŸÅÿ© ÿßŸÑŸÑÿπÿ®ÿ©',\n    bn: '‡¶ó‡ßá‡¶Æ ‡¶∞‡ßÅ‡¶Æ',\n    hi: '‡§ó‡•á‡§Æ ‡§∞‡•Ç‡§Æ',\n    es: 'Sala de Juego',\n    id: 'Ruang Permainan',\n  },\n\n  decline: {\n    en: 'Decline',\n    ar: 'ÿ±ŸÅÿ∂',\n    bn: '‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡¶æ‡¶ñ‡ßç‡¶Ø‡¶æ‡¶®',\n    hi: '‡§Ö‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§∞‡•á‡§Ç',\n    es: 'Rechazar',\n    id: 'Tolak',\n  },\n  \n  // Player Profile Modal\n  playerProfile: {\n    en: 'Player Profile',\n    ar: 'ŸÖŸÑŸÅ ÿßŸÑŸÑÿßÿπÿ®',\n    bn: '‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤',\n    hi: '‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤',\n    es: 'Perfil del Jugador',\n    id: 'Profil Pemain',\n  },\n  joined: {\n    en: 'Joined',\n    ar: 'ÿßŸÜÿ∂ŸÖ',\n    bn: '‡¶Ø‡ßã‡¶ó‡¶¶‡¶æ‡¶®',\n    hi: '‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•Å‡§è',\n    es: 'Se uni√≥',\n    id: 'Bergabung',\n  },\n  winRate: {\n    en: 'Win Rate',\n    ar: 'ŸÖÿπÿØŸÑ ÿßŸÑŸÅŸàÿ≤',\n    bn: '‡¶ú‡¶Ø‡¶º‡ßá‡¶∞ ‡¶π‡¶æ‡¶∞',\n    hi: '‡§ú‡•Ä‡§§ ‡§ï‡•Ä ‡§¶‡§∞',\n    es: 'Tasa de Victoria',\n    id: 'Tingkat Kemenangan',\n  },\n  headToHead: {\n    en: 'Head-to-Head vs You',\n    ar: 'ÿßŸÑŸÖŸàÿßÿ¨Ÿáÿ© ÿßŸÑŸÖÿ®ÿßÿ¥ÿ±ÿ© ÿ∂ÿØŸÉ',\n    bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶™‡¶∞‡ßÄ‡¶§‡ßá ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø',\n    hi: '‡§Ü‡§™‡§ï‡•á ‡§ñ‡§ø‡§≤‡§æ‡§´ ‡§Ü‡§Æ‡§®‡•á-‡§∏‡§æ‡§Æ‡§®‡•á',\n    es: 'Cara a Cara contra Ti',\n    id: 'Head-to-Head vs Anda',\n  },\n  yourWins: {\n    en: 'Your Wins',\n    ar: 'ÿßŸÜÿ™ÿµÿßÿ±ÿßÿ™ŸÉ',\n    bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ú‡¶Ø‡¶º',\n    hi: '‡§Ü‡§™‡§ï‡•Ä ‡§ú‡•Ä‡§§',\n    es: 'Tus Victorias',\n    id: 'Kemenangan Anda',\n  },\n  yourLosses: {\n    en: 'Your Losses',\n    ar: 'ÿÆÿ≥ÿßÿ¶ÿ±ŸÉ',\n    bn: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶π‡¶æ‡¶∞',\n    hi: '‡§Ü‡§™‡§ï‡•Ä ‡¶π‡¶æ‡¶∞',\n    es: 'Tus Derrotas',\n    id: 'Kekalahan Anda',\n  },\n  recentGames: {\n    en: 'Recent Games',\n    ar: 'ÿßŸÑÿ£ŸÑÿπÿßÿ® ÿßŸÑÿ£ÿÆŸäÿ±ÿ©',\n    bn: '‡¶∏‡¶æ‡¶Æ‡ßç‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï ‡¶ó‡ßá‡¶Æ',\n    hi: '‡§π‡§æ‡§≤ ‡§ï‡•á ‡§ó‡•á‡§Æ',\n    es: 'Juegos Recientes',\n    id: 'Permainan Terbaru',\n  },\n  win: {\n    en: 'Win',\n    ar: 'ŸÅŸàÿ≤',\n    bn: '‡¶ú‡¶Ø‡¶º',\n    hi: '‡§ú‡•Ä‡§§',\n    es: 'Victoria',\n    id: 'Menang',\n  },\n  loss: {\n    en: 'Loss',\n    ar: 'ÿÆÿ≥ÿßÿ±ÿ©',\n    bn: '‡¶π‡¶æ‡¶∞',\n    hi: '‡§π‡§æ‡§∞',\n    es: 'Derrota',\n    id: 'Kalah',\n  },\n  noGamesPlayed: {\n    en: 'No games played against this player yet.',\n    ar: 'ŸÑŸÖ Ÿäÿ™ŸÖ ŸÑÿπÿ® ÿ£Ÿä ÿ£ŸÑÿπÿßÿ® ÿ∂ÿØ Ÿáÿ∞ÿß ÿßŸÑŸÑÿßÿπÿ® ÿ®ÿπÿØ.',\n    bn: '‡¶è‡¶á ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º‡ßá‡¶∞ ‡¶¨‡¶ø‡¶∞‡ßÅ‡¶¶‡ßç‡¶ß‡ßá ‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶ó‡ßá‡¶Æ ‡¶ñ‡ßá‡¶≤‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§',\n    hi: '‡§á‡§∏ ‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§ï‡•á ‡§ñ‡§ø‡§≤‡§æ‡§´ ‡§Ö‡§≠‡•Ä ‡§§‡§ï ‡§ï‡•ã‡§à ‡§ó‡•á‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§ñ‡•á‡§≤‡§æ ‡§ó‡§Ø‡§æ‡•§',\n    es: 'A√∫n no se han jugado juegos contra este jugador.',\n    id: 'Belum ada permainan yang dimainkan melawan pemain ini.',\n  },\n  playerNotFound: {\n    en: 'Player not found',\n    ar: 'ÿßŸÑŸÑÿßÿπÿ® ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ',\n    bn: '‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø',\n    hi: '‡§ñ‡§ø‡§≤‡§æ‡§°‡§º‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ',\n    es: 'Jugador no encontrado',\n    id: 'Pemain tidak ditemukan',\n  }\n} as const;\n\n// Type for translation keys\nexport type TranslationKey = keyof typeof translations;\n\n// Get the current language from localStorage or default to English\nexport function getCurrentLanguage(): Language {\n  if (typeof window !== 'undefined') {\n    const saved = localStorage.getItem('language') as Language;\n    if (saved && saved in languages) {\n      return saved;\n    }\n  }\n  return 'en';\n}\n\n// Set the current language\nexport function setCurrentLanguage(lang: Language): void {\n  if (typeof window !== 'undefined') {\n    localStorage.setItem('language', lang);\n    // Update HTML dir attribute for RTL support\n    document.documentElement.dir = languages[lang].dir;\n    // Update HTML lang attribute\n    document.documentElement.lang = lang;\n  }\n}\n\n// Get translation for a key\nexport function t(key: TranslationKey): string {\n  const lang = getCurrentLanguage();\n  return translations[key][lang] || translations[key].en;\n}\n\n// Initialize language settings\nexport function initializeLanguage(): void {\n  const lang = getCurrentLanguage();\n  setCurrentLanguage(lang);\n}","size_bytes":101447},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  url: string,\n  options?: { method?: string; body?: unknown }\n): Promise<Response> {\n  const method = options?.method || 'GET';\n  const data = options?.body;\n  \n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"returnNull\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      refetchOnMount: true, // Always fetch fresh data on component mount\n      staleTime: 0, // Always fetch fresh data, no caching\n      gcTime: 30000, // Keep data in cache for 30 seconds\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n      onError: (error) => {\n        // Handle unhandled promise rejections gracefully\n        console.error('Mutation error:', error);\n      },\n    },\n  },\n});\n","size_bytes":1772},"client/src/lib/shareConfig.ts":{"content":"// Share configuration that automatically detects environment and uses appropriate URLs\n\ninterface ShareConfig {\n  appUrl: string;\n  playStoreUrl?: string;\n  appName: string;\n  description: string;\n}\n\n// Environment detection\nconst isReplit = () => {\n  return window.location.hostname.includes('replit.') || \n         window.location.hostname.includes('.replit.app') ||\n         import.meta.env.VITE_REPLIT_DOMAIN;\n};\n\nconst isProduction = () => {\n  return import.meta.env.PROD && !isReplit();\n};\n\n// Share configuration\nexport const shareConfig: ShareConfig = {\n  // Dynamic URL based on environment\n  appUrl: isProduction() \n    ? import.meta.env.VITE_PRODUCTION_URL || window.location.origin\n    : window.location.origin,\n    \n  // Play Store URL (always use this link for sharing)\n  playStoreUrl: \"https://tictac3x5.darklayerstudios.com\",\n  \n  appName: \"TicTac 3x5 - Strategic Tic-Tac-Toe\",\n  description: \"Experience the next level of tic-tac-toe with strategic 3x5 gameplay!\"\n};\n\n// Get the appropriate share URL - always use Play Store link for sharing\nexport const getShareUrl = (preferPlayStore: boolean = true): string => {\n  // Always prefer Play Store link for sharing\n  if (shareConfig.playStoreUrl) {\n    return shareConfig.playStoreUrl;\n  }\n  \n  // Fallback to web app URL if Play Store URL is not available\n  return shareConfig.appUrl;\n};\n\n// Get share text based on the URL being shared\nexport const getShareText = (url: string): string => {\n  if (url === shareConfig.playStoreUrl) {\n    return `üéÆ Check out ${shareConfig.appName} on Google Play! ${shareConfig.description}`;\n  }\n  \n  return `üéØ ${shareConfig.description} Play ${shareConfig.appName} now!`;\n};\n\n// Environment info for debugging\nexport const getEnvironmentInfo = () => {\n  return {\n    isReplit: isReplit(),\n    isProduction: isProduction(),\n    hostname: window.location.hostname,\n    currentUrl: window.location.origin,\n    playStoreConfigured: !!shareConfig.playStoreUrl\n  };\n};","size_bytes":1970},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n\nexport function formatNumber(num: number): string {\n  if (num >= 1000000000) {\n    return (num / 1000000000).toFixed(1).replace(/\\.0$/, '') + 'B';\n  }\n  if (num >= 1000000) {\n    return (num / 1000000).toFixed(1).replace(/\\.0$/, '') + 'M';\n  }\n  if (num >= 1000) {\n    return (num / 1000).toFixed(1).replace(/\\.0$/, '') + 'k';\n  }\n  return num.toString();\n}\n","size_bytes":525},"client/src/pages/auth.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { EmailVerificationModal } from \"@/components/EmailVerificationModal\";\nimport { ForgotPasswordModal } from \"@/components/ForgotPasswordModal\";\nimport { GamepadIcon, Mail } from \"lucide-react\";\nimport { useTranslation } from \"@/contexts/LanguageContext\";\nimport { queryClient } from \"@/lib/queryClient\";\n\n\nexport default function Auth() {\n  const [isLogin, setIsLogin] = useState(true);\n  const [username, setUsername] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [showEmailVerification, setShowEmailVerification] = useState(false);\n  const [showForgotPassword, setShowForgotPassword] = useState(false);\n  const [registrationEmail, setRegistrationEmail] = useState(\"\");\n  const [isGuestLoading, setIsGuestLoading] = useState(false);\n  const { toast } = useToast();\n  const [, setLocation] = useLocation();\n  const { t } = useTranslation();\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n\n    try {\n      if (isLogin) {\n        const response = await fetch('/api/auth/login', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ username, password })\n        });\n\n        if (response.ok) {\n          // Invalidate auth query to refresh user state immediately\n          await queryClient.invalidateQueries({ queryKey: [\"/api/auth/user\"] });\n          \n          toast({\n            title: t('loginSuccessful'),\n            description: t('welcomeBack'),\n          });\n          \n          // Redirect immediately after invalidating query\n          setLocation('/');\n        } else {\n          const errorData = await response.json();\n          \n          if (errorData.needsVerification) {\n            // User needs email verification\n            setRegistrationEmail(email || username); // Use email if available, otherwise username\n            setShowEmailVerification(true);\n            toast({\n              title: t('emailVerificationRequired'),\n              description: errorData.message || t('pleaseVerifyEmailBeforeLogin'),\n              variant: \"destructive\",\n            });\n          } else {\n            toast({\n              title: t('loginFailed'),\n              description: errorData.error || t('pleaseCheckCredentials'),\n              variant: \"destructive\",\n            });\n          }\n        }\n      } else {\n        if (!email) {\n          toast({\n            title: t('emailRequired'),\n            description: t('pleaseProvideEmailToRegister'),\n            variant: \"destructive\",\n          });\n          return;\n        }\n        \n        const response = await fetch('/api/auth/register', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ username, password, email })\n        });\n\n        if (response.ok) {\n          const data = await response.json();\n          setRegistrationEmail(email);\n          toast({\n            title: t('registrationSuccessful'),\n            description: data.message || t('pleaseVerifyEmailToContinue'),\n          });\n          \n          // Show email verification modal\n          setShowEmailVerification(true);\n        } else {\n          const errorData = await response.json();\n          toast({\n            title: t('registrationFailed'),\n            description: errorData.error || t('pleaseCheckInformationAndTryAgain'),\n            variant: \"destructive\",\n          });\n        }\n      }\n    } catch (error) {\n      toast({\n        title: isLogin ? t('loginFailed') : t('registrationFailed'),\n        description: error instanceof Error ? error.message : t('pleaseCheckCredentials'),\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleGuestLogin = async () => {\n    // Prevent multiple guest creations\n    if (isGuestLoading) return;\n    \n    setIsGuestLoading(true);\n\n    try {\n      const response = await fetch('/api/auth/guest', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' }\n      });\n\n      if (response.ok) {\n        await queryClient.invalidateQueries({ queryKey: [\"/api/auth/user\"] });\n        \n        toast({\n          title: t('loginSuccessful'),\n          description: 'Welcome! You\\'re playing as a guest.',\n        });\n        \n        setLocation('/');\n      } else {\n        const errorData = await response.json();\n        toast({\n          title: 'Guest Login Failed',\n          description: errorData.error || 'Failed to create guest session',\n          variant: \"destructive\",\n        });\n      }\n    } catch (error) {\n      toast({\n        title: 'Guest Login Failed',\n        description: 'Network error. Please try again.',\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsGuestLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center p-4\">\n      <div className=\"w-full max-w-md\">\n        <div className=\"text-center mb-8\">\n          <div className=\"flex justify-center mb-4\">\n            <div className=\"w-16 h-16 bg-primary rounded-2xl flex items-center justify-center\">\n              <GamepadIcon className=\"w-8 h-8 text-white\" />\n            </div>\n          </div>\n          <h1 className=\"text-3xl font-bold text-white mb-2\">{t('appName')}</h1>\n          <p className=\"text-slate-400\">{t('strategicTicTacToe')}</p>\n        </div>\n\n        <Card className=\"bg-slate-800 border-slate-700\">\n          <CardHeader className=\"space-y-1\">\n            <CardTitle className=\"text-2xl text-white\">\n              {isLogin ? t('login') : t('register')}\n            </CardTitle>\n            <CardDescription className=\"text-slate-400\">\n              {isLogin \n                ? t('enterCredentialsToAccess')\n                : t('enterDetailsToCreate')\n              }\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"username\" className=\"text-slate-300\">\n                  {isLogin ? t('usernameOrEmail') : t('username')}\n                </Label>\n                <Input\n                  id=\"username\"\n                  type=\"text\"\n                  placeholder={isLogin ? t('enterUsernameOrEmail') : t('enterUsername')}\n                  value={username}\n                  onChange={(e) => setUsername(e.target.value)}\n                  required\n                  className=\"bg-slate-700 border-slate-600 text-white\"\n                />\n              </div>\n              {!isLogin && (\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"email\" className=\"text-slate-300\">{t('email')}</Label>\n                  <Input\n                    id=\"email\"\n                    type=\"email\"\n                    placeholder={t('enterEmail')}\n                    value={email}\n                    onChange={(e) => setEmail(e.target.value)}\n                    required\n                    className=\"bg-slate-700 border-slate-600 text-white\"\n                  />\n                  <p className=\"text-xs text-slate-400\">\n                    {t('emailRequiredForVerification')}\n                  </p>\n                </div>\n              )}\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"password\" className=\"text-slate-300\">{t('password')}</Label>\n                <Input\n                  id=\"password\"\n                  type=\"password\"\n                  placeholder={t('enterPassword')}\n                  value={password}\n                  onChange={(e) => setPassword(e.target.value)}\n                  required\n                  className=\"bg-slate-700 border-slate-600 text-white\"\n                />\n              </div>\n              <Button \n                type=\"submit\" \n                className=\"w-full bg-primary hover:bg-primary/90\"\n                disabled={isLoading}\n              >\n                {isLoading ? t('loading') : (isLogin ? t('login') : t('register'))}\n              </Button>\n            </form>\n            \n            {/* Guest Login Option */}\n            <div className=\"relative my-6\">\n              <div className=\"absolute inset-0 flex items-center\">\n                <span className=\"w-full border-t border-slate-600\" />\n              </div>\n              <div className=\"relative flex justify-center text-xs uppercase\">\n                <span className=\"bg-slate-800 px-2 text-slate-400\">Or</span>\n              </div>\n            </div>\n            \n            <Button \n              onClick={handleGuestLogin}\n              className=\"w-full bg-slate-600 hover:bg-slate-500 text-white\"\n              disabled={isGuestLoading}\n              variant=\"outline\"\n            >\n              {isGuestLoading ? (\n                <>\n                  <div className=\"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent\"></div>\n                  Creating Guest Session...\n                </>\n              ) : (\n                <>\n                  <GamepadIcon className=\"mr-2 h-4 w-4\" />\n                  Play as Guest\n                </>\n              )}\n            </Button>\n            \n            <p className=\"text-xs text-slate-400 text-center mt-2\">\n              Start playing instantly without registration. Progress saved until logout.\n            </p>\n            \n            <div className=\"text-center space-y-2\">\n              {isLogin && (\n                <Button\n                  type=\"button\"\n                  variant=\"link\"\n                  className=\"text-slate-400 hover:text-white text-sm\"\n                  onClick={() => setShowForgotPassword(true)}\n                >\n                  {t('forgotPassword')}\n                </Button>\n              )}\n              \n              <Button\n                type=\"button\"\n                variant=\"link\"\n                className=\"text-slate-400 hover:text-white\"\n                onClick={() => setIsLogin(!isLogin)}\n              >\n                {isLogin \n                  ? t('dontHaveAccountSignUp')\n                  : t('alreadyHaveAccountSignIn')\n                }\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n        \n        {/* Email Verification Modal */}\n        {showEmailVerification && (\n          <EmailVerificationModal \n            email={registrationEmail}\n            onClose={() => setShowEmailVerification(false)}\n          />\n        )}\n        \n        {/* Forgot Password Modal */}\n        {showForgotPassword && (\n          <ForgotPasswordModal \n            onClose={() => setShowForgotPassword(false)}\n          />\n        )}\n      </div>\n    </div>\n  );\n}","size_bytes":11326},"client/src/pages/home.tsx":{"content":"import { useAuth } from \"@/hooks/useAuth\";\nimport { useWebSocket } from \"@/hooks/useWebSocket\";\nimport { useOnlineStatus } from \"@/hooks/useOnlineStatus\";\nimport { useToast } from \"@/hooks/use-toast\";\n// useAudio hook removed as sound effects are removed\nimport { useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport { useState, useEffect, useRef } from \"react\";\nimport { GameBoard } from \"@/components/GameBoard\";\nimport { GameModeSelector } from \"@/components/GameModeSelector\";\nimport { ProfileManager } from \"@/components/ProfileManager\";\n// AudioControls component removed as requested\nimport { RoomManager } from \"@/components/RoomManager\";\nimport { PlayerList } from \"@/components/PlayerList\";\nimport { CreateRoomModal } from \"@/components/CreateRoomModal\";\nimport { GameOverModal } from \"@/components/GameOverModal\";\nimport { PlayAgainRequestDialog } from \"@/components/PlayAgainRequestDialog\";\nimport { EmailVerificationModal } from \"@/components/EmailVerificationModal\";\nimport { MatchmakingModal } from \"@/components/MatchmakingModal\";\nimport { OnlineUsersModal } from \"@/components/OnlineUsersModal\";\nimport { ThemeSelector } from \"@/components/ThemeSelector\";\nimport { AchievementModal } from \"@/components/AchievementModal\";\nimport { LevelUpModal } from \"@/components/LevelUpModal\";\nimport { Friends } from \"@/components/Friends\";\nimport { InvitationPopup } from \"@/components/InvitationPopup\";\nimport { Leaderboard } from \"@/components/Leaderboard\";\nimport { ShareButton } from \"@/components/ShareButton\";\nimport { UserProfileModal } from \"@/components/UserProfileModal\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { GamepadIcon, LogOut, User, Zap, Loader2, Users, Settings, Menu, X, Palette, Trophy, Languages } from \"lucide-react\";\nimport { logout } from \"@/lib/firebase\";\nimport { useTranslation } from \"@/contexts/LanguageContext\";\nimport { CustomLanguageSelector } from \"@/components/CustomLanguageSelector\";\nimport { useLocation } from \"wouter\";\nimport { formatNumber } from \"@/lib/utils\";\n\n\nexport default function Home() {\n  const { user } = useAuth();\n  const { isConnected, lastMessage, joinRoom, leaveRoom, sendMessage, refreshConnection } = useWebSocket();\n  const { isOnline: actualOnlineStatus } = useOnlineStatus();\n  const { toast } = useToast();\n  const { t } = useTranslation();\n  const queryClient = useQueryClient();\n  const [location, setLocation] = useLocation();\n  // Sound effects removed as requested\n  const [selectedMode, setSelectedMode] = useState<'ai' | 'pass-play' | 'online'>('ai');\n  const [aiDifficulty, setAiDifficulty] = useState<'easy' | 'medium' | 'hard'>('medium');\n  const [currentRoom, setCurrentRoom] = useState<any>(null);\n  const [currentGame, setCurrentGame] = useState<any>(null);\n  const [showCreateRoom, setShowCreateRoom] = useState(false);\n  const [showGameOver, setShowGameOver] = useState(false);\n  const [gameResult, setGameResult] = useState<any>(null);\n  const [isCreatingGame, setIsCreatingGame] = useState(false);\n  const [showEmailVerification, setShowEmailVerification] = useState(false);\n  const [showMatchmaking, setShowMatchmaking] = useState(false);\n  const [isMatchmaking, setIsMatchmaking] = useState(false);\n  const [showOnlineUsers, setShowOnlineUsers] = useState(false);\n  const [onlineUserCount, setOnlineUserCount] = useState(0);\n  const [showProfile, setShowProfile] = useState(false);\n  const [showHeaderSidebar, setShowHeaderSidebar] = useState(false);\n  const [showAchievements, setShowAchievements] = useState(false);\n  const [showLeaderboard, setShowLeaderboard] = useState(false);\n  const [isResettingState, setIsResettingState] = useState(false);\n  const [showUserProfile, setShowUserProfile] = useState(false);\n  const [playAgainRequest, setPlayAgainRequest] = useState<any>(null);\n  const [showPlayAgainRequest, setShowPlayAgainRequest] = useState(false);\n  const [showLevelUp, setShowLevelUp] = useState(false);\n  const [levelUpData, setLevelUpData] = useState<any>(null);\n  const headerSidebarRef = useRef<HTMLDivElement>(null);\n  const gameBoardRef = useRef<HTMLDivElement>(null);\n\n  const { data: userStats } = useQuery({\n    queryKey: [\"/api/users/online-stats\"],\n    enabled: !!user,\n  });\n\n  // Get current user's role in the room (to check if they're a spectator)\n  const { data: roomParticipants = [] } = useQuery({\n    queryKey: [\"/api/rooms\", currentRoom?.id, \"participants\"],\n    enabled: !!currentRoom?.id && !!user,\n    refetchInterval: 10000,\n    staleTime: 8000,\n  });\n\n  // Check if current user is a spectator\n  const currentUserParticipant = (roomParticipants as any[]).find((p: any) => p.userId === ((user as any)?.userId || (user as any)?.id));\n  const isSpectator = currentUserParticipant?.role === 'spectator';\n\n\n\n  // Check if email verification is required\n  useEffect(() => {\n    if (user && (user as any).email && !(user as any).isEmailVerified) {\n      setShowEmailVerification(true);\n    }\n  }, [user]);\n\n  // Check for pending level ups when user loads home\n  useEffect(() => {\n    const checkPendingLevelUps = async () => {\n      if (!user) return;\n      \n      try {\n        const response = await fetch('/api/level-ups/pending', {\n          credentials: 'include'\n        });\n        \n        if (response.ok) {\n          const levelUps = await response.json();\n          if (levelUps.length > 0) {\n            // Show the most recent level up\n            const latestLevelUp = levelUps[0];\n            setLevelUpData(latestLevelUp);\n            setShowLevelUp(true);\n          }\n        }\n      } catch (error) {\n        console.error('Error checking for level ups:', error);\n      }\n    };\n\n    checkPendingLevelUps();\n  }, [user]);\n\n  // Handle level up acknowledgment\n  const handleLevelUpAcknowledge = async () => {\n    if (!levelUpData) return;\n    \n    try {\n      const response = await fetch(`/api/level-ups/${levelUpData.id}/acknowledge`, {\n        method: 'POST',\n        credentials: 'include'\n      });\n      \n      if (response.ok) {\n        setShowLevelUp(false);\n        setLevelUpData(null);\n        \n        // Check if there are more level ups to show\n        const pendingResponse = await fetch('/api/level-ups/pending', {\n          credentials: 'include'\n        });\n        \n        if (pendingResponse.ok) {\n          const remainingLevelUps = await pendingResponse.json();\n          if (remainingLevelUps.length > 0) {\n            // Show the next level up\n            const nextLevelUp = remainingLevelUps[0];\n            setLevelUpData(nextLevelUp);\n            setShowLevelUp(true);\n          }\n        }\n      }\n    } catch (error) {\n      console.error('Error acknowledging level up:', error);\n    }\n  };\n\n  // Close header sidebar when clicking outside or via custom event\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (headerSidebarRef.current && !headerSidebarRef.current.contains(event.target as Node)) {\n        // Check if the click is on a theme selector dialog or any other modal\n        const target = event.target as Element;\n        if (target.closest('[data-radix-portal]') || \n            target.closest('[role=\"dialog\"]') ||\n            target.closest('[data-state=\"open\"]')) {\n          return; // Don't close sidebar if clicking on a dialog or modal\n        }\n        setShowHeaderSidebar(false);\n      }\n    };\n\n    const handleCloseHeaderSidebar = () => {\n      setShowHeaderSidebar(false);\n    };\n\n    if (showHeaderSidebar) {\n      document.addEventListener('mousedown', handleClickOutside);\n      window.addEventListener('closeHeaderSidebar', handleCloseHeaderSidebar);\n      return () => {\n        document.removeEventListener('mousedown', handleClickOutside);\n        window.removeEventListener('closeHeaderSidebar', handleCloseHeaderSidebar);\n      };\n    }\n  }, [showHeaderSidebar]);\n\n  // Listen for spectator transition to AI events\n  useEffect(() => {\n    const handleSpectatorTransitionToAI = (event: any) => {\n      try {\n        // Show toast notification\n        toast({\n          title: \"Left Room\",\n          description: event.detail?.message || \"You have left the room.\",\n          duration: 2000,\n        });\n        \n        // Immediate smooth state transition to AI mode without any delays\n        setCurrentGame(null);\n        setCurrentRoom(null);\n        setSelectedMode('ai');\n        setShowGameOver(false);\n        setGameResult(null);\n        setIsCreatingGame(false);\n        \n        // Initialize a fresh AI game\n        setTimeout(() => {\n          setCurrentGame({\n            id: `local-game-${Date.now()}`,\n            gameMode: 'ai',\n            status: 'active',\n            board: {},\n            currentPlayer: 'X',\n            playerXId: (user as any)?.userId || (user as any)?.id || '',\n            playerOId: 'AI',\n            createdAt: new Date().toISOString(),\n            updatedAt: new Date().toISOString()\n          });\n        }, 100);\n        \n      } catch (error) {\n        // Fallback to simple state reset\n        setCurrentGame(null);\n        setCurrentRoom(null);\n        setSelectedMode('ai');\n        setShowGameOver(false);\n        setGameResult(null);\n        setIsCreatingGame(false);\n      }\n    };\n    \n    window.addEventListener('spectator_transition_to_ai', handleSpectatorTransitionToAI);\n    \n    return () => {\n      window.removeEventListener('spectator_transition_to_ai', handleSpectatorTransitionToAI);\n    };\n  }, [toast, user]);\n\n  // Listen for leaderboard open events\n  useEffect(() => {\n    const handleOpenLeaderboard = () => {\n      setShowLeaderboard(true);\n    };\n\n    window.addEventListener('openLeaderboard', handleOpenLeaderboard);\n    return () => window.removeEventListener('openLeaderboard', handleOpenLeaderboard);\n  }, []);\n\n  // Listen for game abandonment custom events\n  useEffect(() => {\n    const handleGameAbandoned = (event: any) => {\n      console.log('üè† Game abandoned custom event received:', event.detail);\n      try {\n        // Immediate transition to prevent blinking - no delays\n        setIsResettingState(true);\n        \n        // Batch all state changes in a single synchronous update to prevent flickering\n        setCurrentGame(null);\n        setCurrentRoom(null);\n        setSelectedMode('ai');\n        setShowGameOver(false);\n        setGameResult(null);\n        setIsCreatingGame(false);\n        \n        toast({\n          title: \"Game Ended\",\n          description: event.detail.message || \"Game ended because a player left the room.\",\n          variant: \"destructive\",\n        });\n        \n        // Quick reset without delay to prevent visual artifacts\n        setTimeout(() => {\n          setIsResettingState(false);\n          initializeLocalGame();\n        }, 50);\n      } catch (error) {\n        console.error('üè† Error handling game abandonment:', error);\n        // Force page reload as fallback\n        window.location.reload();\n      }\n    };\n\n    window.addEventListener('game_abandoned', handleGameAbandoned);\n    \n    // Handle play again request events\n    const handlePlayAgainRequest = (event: any) => {\n      try {\n        const requestData = event.detail;\n        console.log('üîÑ Play again request received:', requestData);\n        \n        // Store the request data and show the dialog\n        setPlayAgainRequest({\n          id: requestData.requestId,\n          requesterId: requestData.requesterId,\n          gameId: requestData.gameId,\n          requester: {\n            id: requestData.requesterId,\n            // Note: We'll need to fetch requester details or include them in the message\n            displayName: 'Player', // Placeholder - should come from server\n            firstName: 'Player',\n            username: 'player'\n          },\n          game: {\n            id: requestData.gameId,\n            gameMode: 'online'\n          }\n        });\n        setShowPlayAgainRequest(true);\n      } catch (error) {\n        console.error('‚ùå Error handling play again request:', error);\n      }\n    };\n\n    window.addEventListener('play_again_request_received', handlePlayAgainRequest);\n    \n    // Handle play again rejection - redirect to AI table\n    const handlePlayAgainRejected = (event: any) => {\n      try {\n        const rejectionData = event.detail;\n        console.log('‚ùå Play again rejected, redirecting to AI table:', rejectionData);\n        \n        // Close any existing game over modal or play again dialog\n        setShowGameOver(false);\n        setShowPlayAgainRequest(false);\n        setPlayAgainRequest(null);\n        setGameResult(null);\n        \n        // Transition to AI mode (home page with local games)\n        setCurrentGame(null);\n        setCurrentRoom(null);\n        setSelectedMode('ai');\n        \n        // Show notification\n        toast({\n          title: \"Play Again Declined\",\n          description: \"The play again request was declined. Starting a new AI game.\",\n          duration: 3000,\n        });\n        \n        // Initialize a fresh AI game after a short delay\n        setTimeout(() => {\n          initializeLocalGame();\n        }, 500);\n      } catch (error) {\n        console.error('‚ùå Error handling play again rejection:', error);\n      }\n    };\n\n    window.addEventListener('play_again_rejected_received', handlePlayAgainRejected);\n    \n    // Handle room reconnection events\n    const handleRoomReconnection = (event: any) => {\n      const message = event.detail;\n      console.log('üè† Room reconnection event received:', message.room?.id);\n      \n      if (message.room) {\n        // Restore room state immediately\n        setCurrentRoom(message.room);\n        setSelectedMode('online');\n        console.log('‚úÖ Room reconnection processed - Room ID:', message.room.id);\n      }\n    };\n    \n    // Handle immediate game reconnection events\n    const handleGameReconnection = (event: any) => {\n      const message = event.detail;\n      console.log('üîÑ Immediate reconnection event received:', message.game?.id);\n      \n      if (message.game && message.roomId) {\n        // Restore room state first if not already set\n        if (!currentRoom || currentRoom.id !== message.roomId) {\n          // Room state will be set by reconnection_room_join message\n          console.log('üè† Waiting for room reconnection...');\n        }\n        \n        // Restore game state immediately and consistently\n        setSelectedMode('online');\n        setCurrentGame({\n          ...message.game,\n          status: 'active',\n          gameMode: 'online',\n          timestamp: Date.now(),\n          syncTimestamp: Date.now()\n        });\n        \n        // Clear any interfering states\n        setIsCreatingGame(false);\n        setShowGameOver(false);\n        setGameResult(null);\n        setShowMatchmaking(false);\n        \n        console.log('‚úÖ Immediate reconnection processed');\n      }\n    };\n\n    // Handle navigation to AI mode event from GameBoard\n    const handleNavigateToAI = () => {\n      console.log('ü§ñ Navigating to AI mode smoothly (no reload)');\n      \n      // Clear all online game state\n      setCurrentGame(null);\n      setCurrentRoom(null);\n      setShowGameOver(false);\n      setGameResult(null);\n      setIsCreatingGame(false);\n      setShowMatchmaking(false);\n      \n      // Switch to AI mode\n      setSelectedMode('ai');\n      \n      // Initialize local AI game\n      setTimeout(() => {\n        initializeLocalGame();\n      }, 100);\n    };\n\n    window.addEventListener('reconnection_room_join', handleRoomReconnection);\n    window.addEventListener('game_reconnection', handleGameReconnection);\n    window.addEventListener('navigate_to_ai_mode', handleNavigateToAI);\n    \n    return () => {\n      window.removeEventListener('game_abandoned', handleGameAbandoned);\n      window.removeEventListener('play_again_request_received', handlePlayAgainRequest);\n      window.removeEventListener('play_again_rejected_received', handlePlayAgainRejected);\n      window.removeEventListener('reconnection_room_join', handleRoomReconnection);\n      window.removeEventListener('game_reconnection', handleGameReconnection);\n      window.removeEventListener('navigate_to_ai_mode', handleNavigateToAI);\n    };\n  }, []); // Remove toast dependency to prevent effect recreation\n\n  // Track shown toasts to prevent duplicates\n  const [shownGameStartedToasts, setShownGameStartedToasts] = useState<Set<string>>(new Set());\n\n  // Clear toast tracking when games end to prevent memory buildup\n  useEffect(() => {\n    if (currentGame?.status === 'finished' || currentGame?.status === 'abandoned') {\n      const currentGameKey = `${currentGame.id}-${currentRoom?.id}`;\n      setShownGameStartedToasts(prev => {\n        const updated = new Set(prev);\n        updated.delete(currentGameKey);\n        return updated;\n      });\n    }\n  }, [currentGame?.status, currentGame?.id, currentRoom?.id]);\n\n  useEffect(() => {\n    if (lastMessage) {\n      // Home received WebSocket message\n      // Message type being processed\n      switch (lastMessage.type) {\n        case 'online_users_update':\n          setOnlineUserCount(lastMessage.count);\n          break;\n        case 'chat_message_received':\n          // Event is already dispatched by useWebSocket hook, no need to dispatch again\n          break;\n        case 'user_offline':\n          // Dispatch custom event for chat history cleanup\n          window.dispatchEvent(new CustomEvent('user_offline', {\n            detail: lastMessage\n          }));\n          break;\n        case 'game_started':\n          console.log('üéÆ Game started message received:', lastMessage);\n          \n          // Handle game start from WebSocket - ensure both players transition\n          if (lastMessage.game && lastMessage.roomId) {\n            console.log('üéÆ Processing game_started - closing matchmaking modal and setting game state');\n            \n            // CRITICAL FIX: Force close matchmaking modal immediately when game starts\n            setIsMatchmaking(false);\n            setShowMatchmaking(false);\n            handleMatchmakingClose();\n            \n            // Dispatch global event to force close any stuck modals\n            window.dispatchEvent(new CustomEvent('force_close_matchmaking', {\n              detail: { reason: 'game_started', timestamp: Date.now() }\n            }));\n            \n            // CRITICAL FIX: Force UI refresh for proper game board display\n            setIsResettingState(true);\n            \n            // Clear any conflicting storage\n            localStorage.removeItem('currentGameState');\n            sessionStorage.removeItem('currentGameState');\n            localStorage.removeItem('currentRoomState');\n            sessionStorage.removeItem('currentRoomState');\n            \n            setTimeout(() => {\n              // Ensure game mode is set to online when receiving game_started\n              setSelectedMode('online');\n              \n              // Set the room state immediately\n              setCurrentRoom({\n                id: lastMessage.roomId,\n                status: 'playing',\n                code: lastMessage.room?.code || 'ONLINE'\n              });\n              \n              // Set the complete game state from the server message\n              const gameData = {\n                ...lastMessage.game,\n                status: 'active',\n                gameMode: 'online',\n                roomId: lastMessage.roomId,\n                board: lastMessage.game.board || {},\n                currentPlayer: lastMessage.game.currentPlayer || 'X',\n                timestamp: Date.now()\n              };\n              \n              console.log('üéÆ Setting game state:', gameData);\n              setCurrentGame(gameData);\n              \n              // Reset creating state since game was successfully created\n              setIsCreatingGame(false);\n              setShowGameOver(false);\n              setGameResult(null);\n              setIsResettingState(false);\n              \n              // Show game started toast only once per game\n              const gameToastKey = `${lastMessage.game.id}-${lastMessage.roomId}`;\n              if (!shownGameStartedToasts.has(gameToastKey)) {\n                setShownGameStartedToasts(prev => new Set([...prev, gameToastKey]));\n                toast({\n                  title: \"Game Started!\",\n                  description: \"Your match has begun. Good luck!\",\n                  duration: 3000,\n                });\n              }\n              \n              // Auto-scroll to game board when game starts\n              setTimeout(() => {\n                if (gameBoardRef.current) {\n                  gameBoardRef.current.scrollIntoView({ \n                    behavior: 'smooth', \n                    block: 'start' \n                  });\n                }\n              }, 200); // Reduced delay for faster transition\n            }, 100); // Ensure proper state synchronization\n            \n            // Invalidate queries to refresh room data\n            queryClient.invalidateQueries({ queryKey: [\"/api/rooms\", lastMessage.roomId, \"participants\"] });\n          }\n          break;\n        case 'move':\n          // Handle move updates from WebSocket - FOR BOTH PLAYERS AND SPECTATORS\n          // Enhanced move handling - match by gameId OR roomId to ensure spectators see moves\n          const isCurrentGame = currentGame && lastMessage.gameId === currentGame.id;\n          const isCurrentRoom = currentRoom && lastMessage.roomId === currentRoom.id;\n          \n          if (isCurrentGame || isCurrentRoom) {\n            // Update or create game state for everyone (players and spectators)\n            setCurrentGame(prevGame => {\n              // If we have a currentGame, update it\n              if (prevGame && prevGame.id === lastMessage.gameId) {\n                return {\n                  ...prevGame,\n                  board: lastMessage.board,\n                  currentPlayer: lastMessage.currentPlayer,\n                  lastMove: lastMessage.position,\n                  lastMoveAt: lastMessage.lastMoveAt || prevGame.lastMoveAt,\n                  serverTime: lastMessage.serverTime || prevGame.serverTime,\n                  timeRemaining: lastMessage.timeRemaining || prevGame.timeRemaining,\n                  playerXInfo: lastMessage.playerXInfo || prevGame.playerXInfo,\n                  playerOInfo: lastMessage.playerOInfo || prevGame.playerOInfo,\n                  timestamp: Date.now() // Force re-render\n                };\n              } else {\n                // Create new game state for spectators or reconnecting players\n                return {\n                  id: lastMessage.gameId,\n                  roomId: lastMessage.roomId || currentRoom?.id,\n                  gameMode: 'online',\n                  status: 'active',\n                  board: lastMessage.board,\n                  currentPlayer: lastMessage.currentPlayer,\n                  lastMove: lastMessage.position,\n                  lastMoveAt: lastMessage.lastMoveAt,\n                  serverTime: lastMessage.serverTime,\n                  timeRemaining: lastMessage.timeRemaining,\n                  playerXInfo: lastMessage.playerXInfo,\n                  playerOInfo: lastMessage.playerOInfo,\n                  timestamp: Date.now()\n                };\n              }\n            });\n            \n            // Force immediate re-render for fast sync\n            setCurrentGame(prevGame => ({\n              ...prevGame,\n              syncTimestamp: Date.now()\n            }));\n          }\n          break;\n        case 'auto_move':\n          // Handle auto-play moves - same as regular moves but from AI\n          const isCurrentGameAuto = currentGame && lastMessage.gameId === currentGame.id;\n          const isCurrentRoomAuto = currentRoom && lastMessage.roomId === currentRoom.id;\n          \n          if (isCurrentGameAuto || isCurrentRoomAuto) {\n            console.log('ü§ñ Auto-play move received:', lastMessage);\n            // Update or create game state for everyone (players and spectators)\n            setCurrentGame(prevGame => {\n              // If we have a currentGame, update it\n              if (prevGame && prevGame.id === lastMessage.gameId) {\n                return {\n                  ...prevGame,\n                  board: lastMessage.board,\n                  currentPlayer: lastMessage.currentPlayer,\n                  lastMove: lastMessage.position,\n                  lastMoveAt: lastMessage.lastMoveAt || prevGame.lastMoveAt,\n                  serverTime: lastMessage.serverTime || prevGame.serverTime,\n                  timeRemaining: lastMessage.timeRemaining || prevGame.timeRemaining,\n                  playerXInfo: lastMessage.playerXInfo || prevGame.playerXInfo,\n                  playerOInfo: lastMessage.playerOInfo || prevGame.playerOInfo,\n                  autoPlayActive: lastMessage.player, // Track which player is in auto-play\n                  timestamp: Date.now() // Force re-render\n                };\n              } else {\n                // Create new game state for spectators or reconnecting players\n                return {\n                  id: lastMessage.gameId,\n                  roomId: lastMessage.roomId || currentRoom?.id,\n                  gameMode: 'online',\n                  status: 'active',\n                  board: lastMessage.board,\n                  currentPlayer: lastMessage.currentPlayer,\n                  lastMove: lastMessage.position,\n                  lastMoveAt: lastMessage.lastMoveAt,\n                  serverTime: lastMessage.serverTime,\n                  timeRemaining: lastMessage.timeRemaining,\n                  playerXInfo: lastMessage.playerXInfo,\n                  playerOInfo: lastMessage.playerOInfo,\n                  timestamp: Date.now()\n                };\n              }\n            });\n            \n            // Force immediate re-render for fast sync\n            setCurrentGame(prevGame => ({\n              ...prevGame,\n              syncTimestamp: Date.now()\n            }));\n          }\n          break;\n        case 'auto_play_enabled':\n          // Handle auto-play activation notification\n          if (currentGame && lastMessage.gameId === currentGame.id) {\n            console.log('ü§ñ Auto-play enabled for player:', lastMessage.player);\n            setCurrentGame(prevGame => ({\n              ...prevGame,\n              autoPlayActive: lastMessage.player,\n              timestamp: Date.now()\n            }));\n          }\n          break;\n        case 'auto_play_disabled':\n          // Handle auto-play deactivation notification\n          if (currentGame && lastMessage.gameId === currentGame.id) {\n            console.log('üéÆ Auto-play disabled for player:', lastMessage.player);\n            setCurrentGame(prevGame => ({\n              ...prevGame,\n              autoPlayActive: null,\n              timestamp: Date.now()\n            }));\n          }\n          break;\n        case 'auto_play_disabled_success':\n          // Handle successful auto-play disabling with user feedback\n          if (currentGame && lastMessage.gameId === currentGame.id) {\n            console.log('‚úÖ Auto-play disabled successfully:', lastMessage.player);\n            toast({\n              title: \"Auto-Play Disabled\",\n              description: lastMessage.message || \"You've regained control! Make your next move.\",\n            });\n            setCurrentGame(prevGame => ({\n              ...prevGame,\n              autoPlayActive: null,\n              timestamp: Date.now()\n            }));\n          }\n          break;\n        case 'auto_play_error':\n          // Handle auto-play error messages\n          if (lastMessage.gameId === currentGame?.id) {\n            console.error('‚ùå Auto-play error:', lastMessage.error);\n            toast({\n              title: \"Auto-Play Error\",\n              description: lastMessage.error || \"Failed to disable auto-play\",\n              variant: \"destructive\",\n            });\n          }\n          break;\n        case 'winning_move':\n          // Handle winning move with position highlighting\n          if (currentGame && lastMessage.gameId === currentGame.id) {\n            //console.log('üéÆ Winning move received:', lastMessage);\n            setCurrentGame(prevGame => ({\n              ...prevGame,\n              board: lastMessage.board,\n              currentPlayer: lastMessage.currentPlayer,\n              lastMove: lastMessage.position,\n              winningPositions: lastMessage.winningPositions,\n              timestamp: Date.now()\n            }));\n          }\n          break;\n        case 'game_over':\n          // Handle game over from WebSocket\n          if (currentGame && lastMessage.gameId === currentGame.id) {\n            // Sound effects removed as requested\n            const userId = user?.userId || user?.id;\n            //console.log('üéÆ Game over message received:', lastMessage);\n            //console.log('üéÆ Winner info from server:', lastMessage.winnerInfo);\n            //console.log('üéÆ Player X Info:', lastMessage.playerXInfo || currentGame.playerXInfo);\n            //console.log('üéÆ Player O Info:', lastMessage.playerOInfo || currentGame.playerOInfo);\n\n            // Helper function to detect if board is full (draw condition)\n            const isBoardFull = (board: any) => {\n              if (!board) return false;\n              const validPositions = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15];\n              return validPositions.every(pos => board[pos.toString()]);\n            };\n\n            // Determine condition - if winner is null and board is full, it's a draw\n            const gameCondition = lastMessage.condition || \n              (lastMessage.winner === null && isBoardFull(lastMessage.board) ? 'draw' : null);\n\n            // Create comprehensive result object with all player info\n            const gameResult = {\n              winner: lastMessage.winner,\n              condition: gameCondition,\n              board: lastMessage.board,\n              winnerInfo: lastMessage.winnerInfo,\n              playerXInfo: lastMessage.playerXInfo || currentGame.playerXInfo,\n              playerOInfo: lastMessage.playerOInfo || currentGame.playerOInfo,\n              game: {\n                ...currentGame,\n                gameMode: currentGame.gameMode || 'online'\n              }\n            };\n\n            //console.log('üéÆ Setting complete game result:', gameResult);\n            setGameResult(gameResult);\n            \n            // Invalidate stats cache to update user stats immediately\n            console.log('üìä Game ended - refreshing user stats cache');\n            queryClient.invalidateQueries({ queryKey: ['/api/users/online-stats'] });\n            queryClient.invalidateQueries({ queryKey: ['/api/users/online'] });\n            queryClient.invalidateQueries({ queryKey: ['/api/leaderboard'] });\n            \n            // Call individual stats API to ensure immediate update\n            if (userId) {\n              console.log(`üìä Fetching updated stats for user: ${userId}`);\n              fetch(`/api/users/${userId}/stats`, {\n                credentials: 'include'\n              }).then(response => {\n                if (response.ok) {\n                  return response.json();\n                } else {\n                  throw new Error('Failed to fetch stats');\n                }\n              }).then(stats => {\n                console.log('‚úÖ User stats fetched and updated:', stats);\n                // Force re-invalidate after successful fetch\n                queryClient.invalidateQueries({ queryKey: ['/api/users/online-stats'] });\n                queryClient.invalidateQueries({ queryKey: ['/api/users/online'] });\n              }).catch(error => {\n                console.error('‚ùå Error fetching user stats:', error);\n              });\n            }\n            \n            // Close all modals to prevent blocking the game over modal\n            setShowOnlineUsers(false);\n            setShowProfile(false);\n            setShowAchievements(false);\n            setShowLeaderboard(false);\n            setShowCreateRoom(false);\n            setShowMatchmaking(false);\n            setShowHeaderSidebar(false);\n            \n            setShowGameOver(true);\n\n            // Note: Removed auto-close behavior for bot games to allow users to properly see the win/loss popup\n          }\n          break;\n        case 'player_left':\n          // Handle player leaving room\n          if (currentRoom && lastMessage.roomId === currentRoom.id) {\n            //console.log('üéÆ Player left room:', lastMessage);\n            // Show notification about player leaving\n          }\n          break;\n        case 'room_ended':\n          // Handle room ending - refresh the page\n          if (currentRoom && lastMessage.roomId === currentRoom.id) {\n            //console.log('üéÆ Room ended, refreshing page');\n            toast({\n              title: \"Room Ended\",\n              description: `${lastMessage.playerName || 'A player'} left the room. Refreshing page...`,\n                duration: 1000,\n            });\n            // Reset to AI mode after a short delay\n            setTimeout(() => {\n              setCurrentGame(null);\n              setCurrentRoom(null);\n              setSelectedMode('ai');\n              setShowGameOver(false);\n              setGameResult(null);\n              setIsCreatingGame(false);\n            }, 1000);\n          }\n          break;\n        case 'spectator_left':\n          // This case is now handled by custom event spectator_left_smooth for smooth transitions\n          console.log('üëÄ Spectator left handled by custom event');\n          break;\n        case 'match_found':\n        case 'matchmaking_response': \n        case 'matchmaking_success':\n          // Handle all matchmaking success scenarios\n          console.log('üéÆ Matchmaking success received:', lastMessage.type, lastMessage);\n          console.log('üéÆ Current matchmaking state - isMatchmaking:', isMatchmaking, 'showMatchmaking:', showMatchmaking);\n          \n          // IMMEDIATELY force close all matchmaking UI states\n          console.log('üéÆ EMERGENCY CLOSE: Forcing all matchmaking states to false');\n          setIsMatchmaking(false);\n          setShowMatchmaking(false);\n          \n          // Force update the DOM by triggering a re-render\n          setTimeout(() => {\n            setIsMatchmaking(false);\n            setShowMatchmaking(false);\n            console.log('üéÆ SECONDARY CLOSE: Double-checking matchmaking modal closure');\n          }, 10);\n          \n          // Handle the room joining\n          if (lastMessage.room) {\n            console.log('üéÆ Setting room from matchmaking success:', lastMessage.room.id);\n            setCurrentRoom(lastMessage.room);\n            setSelectedMode('online'); // Ensure we're in online mode\n            \n            // Join the room via WebSocket to receive game updates\n            joinRoom(lastMessage.room.id);\n            \n            toast({\n              title: \"Match Found!\",\n              description: lastMessage.message || \"You've been matched with an opponent. Game starting...\",\n            });\n          } else {\n            console.log('üéÆ Warning: No room data in matchmaking message');\n          }\n          break;\n\n        case 'reconnection_room_join':\n          //console.log('üîÑ Reconnection room join:', lastMessage);\n          if (lastMessage.room) {\n            handleRoomJoin(lastMessage.room);\n            toast({\n              title: \"Reconnected!\",\n              description: lastMessage.message || \"You've been reconnected to your game room.\",\n            });\n          }\n          break;\n        case 'game_reconnection':\n          //console.log('üîÑ Processing game reconnection:', lastMessage);\n          if (lastMessage.game && lastMessage.roomId) {\n            //console.log('‚úÖ Restoring game state:', lastMessage.game.id);\n            \n            // Restore game state immediately - room state will be handled by reconnection_room_join\n            setSelectedMode('online');\n            setCurrentGame({\n              ...lastMessage.game,\n              status: 'active',\n              gameMode: 'online',\n              timestamp: Date.now(),\n              syncTimestamp: Date.now()\n            });\n            \n            // Reset any modal states that might interfere\n            setIsCreatingGame(false);\n            setShowGameOver(false);\n            setGameResult(null);\n            setShowMatchmaking(false);\n            \n            toast({\n              title: \"Game Reconnected\",\n              description: \"Your game has been restored successfully.\",\n            });\n            \n            //console.log('‚úÖ Game reconnection completed');\n          }\n          break;\n        case 'player_reconnected':\n          //console.log('üîÑ Player reconnected:', lastMessage);\n          if (currentRoom && lastMessage.userId !== (user?.userId || user?.id)) {\n            toast({\n              title: \"Player Reconnected\",\n              description: `${lastMessage.playerName} has reconnected to the game.`,\n            });\n          }\n          break;\n        case 'game_expired':\n          console.log('‚è∞ Game expired:', lastMessage);\n          // Prevent multiple resets and effects from triggering\n          setIsResettingState(true);\n          \n          setTimeout(() => {\n            // Batch all state changes in a single update - preserve selectedMode\n            setCurrentGame(null);\n            setCurrentRoom(null);\n            // Don't reset selectedMode - keep user's preference\n            setShowGameOver(false);\n            setGameResult(null);\n            setIsCreatingGame(false);\n            \n            toast({\n              title: \"Game Expired\",\n              description: lastMessage.message || \"Game expired due to inactivity. Returning to lobby.\",\n              variant: \"destructive\",\n            });\n            \n            // Complete reset and initialize game only if in AI mode\n            setTimeout(() => {\n              setIsResettingState(false);\n              if (selectedMode === 'ai') {\n                initializeLocalGame();\n              }\n            }, 200);\n          }, 350);\n          break;\n        case 'player_left_win':\n          // This case is now handled directly in WebSocket hook for immediate response\n          console.log('üèÜ Player left win handled by WebSocket hook');\n          break;\n        case 'game_abandoned':\n          //console.log('üè† HOME USEEFFECT: Game abandoned - player left:', lastMessage);\n          //console.log('üè† HOME USEEFFECT: Current game state:', currentGame);\n          //console.log('üè† HOME USEEFFECT: Current room state:', currentRoom);\n          //console.log('üè† HOME USEEFFECT: Processing game abandonment via lastMessage');\n          \n          try {\n            // Immediate transition to prevent blinking - no delays\n            setIsResettingState(true);\n            \n            // Batch all state changes in a single synchronous update to prevent flickering\n            setCurrentGame(null);\n            setCurrentRoom(null);\n            // Don't reset selectedMode - keep user's preference for online mode\n            setShowGameOver(false);\n            setGameResult(null);\n            setIsCreatingGame(false);\n            \n            toast({\n              title: \"Game Ended\",\n              description: lastMessage.message || \"Game ended because a player left the room.\",\n              variant: \"destructive\",\n            });\n            \n            // Quick reset without delay to prevent visual artifacts\n            setTimeout(() => {\n              try {\n                setIsResettingState(false);\n                // Only initialize local game if user was in AI mode\n                if (selectedMode === 'ai') {\n                  initializeLocalGame();\n                }\n              } catch (innerError) {\n                console.error('üè† Error in initializeLocalGame:', innerError);\n                // Force page reload if local game initialization fails\n                // Reset to clean state instead of reload\n                setCurrentGame(null);\n                setCurrentRoom(null);\n                setSelectedMode('ai');\n                setShowGameOver(false);\n                setGameResult(null);\n                setIsCreatingGame(false);\n                setIsResettingState(false);\n              }\n            }, 50); // Minimal delay just for state synchronization\n          } catch (error) {\n            console.error('üè† Error handling game abandonment in useEffect:', error);\n            // Force page reload as fallback\n            setCurrentGame(null);\n            setCurrentRoom(null);\n            setSelectedMode('ai');\n            setShowGameOver(false);\n            setGameResult(null);\n            setIsCreatingGame(false);\n            setIsResettingState(false);\n          }\n          break;\n        case 'player_reaction':\n          // Handle player reaction - this will be broadcast to all players and spectators\n          if (currentGame && (lastMessage.gameId === currentGame.id || lastMessage.roomId === currentRoom?.id)) {\n            console.log('üéÆ Player reaction received:', lastMessage);\n            // The reaction will be displayed by the GameBoard component\n            // We don't need to handle it here as it's handled by the GameBoard component directly\n          }\n          break;\n        case 'player_chat':\n          // Handle player chat - this will be broadcast to all players and spectators\n          if (currentGame && (lastMessage.gameId === currentGame.id || lastMessage.roomId === currentRoom?.id)) {\n            //console.log('üéÆ Player chat received:', lastMessage);\n            // The chat will be displayed by the GameBoard component\n            // We don't need to handle it here as it's handled by the GameBoard component directly\n          }\n          break;\n        case 'play_again_request':\n          console.log('üîÑ Play again request received:', lastMessage);\n          setPlayAgainRequest(lastMessage);\n          setShowPlayAgainRequest(true);\n          break;\n        case 'play_again_response':\n          console.log('üîÑ Play again response received:', lastMessage);\n          if (lastMessage.response === 'accepted') {\n            toast({\n              description: \"Your play again request was accepted! Starting new game...\",\n            });\n          } else {\n            toast({\n              description: \"Your play again request was declined\",\n            });\n          }\n          break;\n        case 'play_again_rejected':\n          console.log('üîÑ Play again request rejected, redirecting to home');\n          // Clear all game and room state\n          setCurrentGame(null);\n          setCurrentRoom(null);\n          setGameResult(null);\n          setShowGameOver(false);\n          setShowPlayAgainRequest(false);\n          setPlayAgainRequest(null);\n          // Redirect to home\n          setLocation('/');\n          toast({\n            description: \"Play again request was declined. Returning to home.\",\n          });\n          break;\n      }\n    }\n  }, [lastMessage, currentGame, currentRoom, user]);\n\n  const handleRoomJoin = (room: any) => {\n    //console.log('üè† handleRoomJoin called with room:', room.id);\n    //console.log('üè† Current room before join:', currentRoom?.id);\n    \n    // Prevent duplicate room joins\n    if (currentRoom && currentRoom.id === room.id) {\n      //console.log('üè† Already in this room, skipping duplicate join');\n      return;\n    }\n    \n    // Automatically switch to online mode when joining a room\n    //console.log('üè† Switching to online mode for room join');\n    setSelectedMode('online');\n    \n    setCurrentRoom(room);\n    joinRoom(room.id);\n  };\n\n  const handleRoomLeave = () => {\n    if (currentRoom) {\n      leaveRoom(currentRoom.id);\n      setCurrentRoom(null);\n    }\n  };\n\n  const handlePlayWithAI = () => {\n    console.log('ü§ñ handlePlayWithAI called');\n\n    // Clean up any matchmaking state first to prevent conflicts\n    setIsMatchmaking(false);\n    setShowMatchmaking(false);\n\n    // Leave room if currently in one - this will trigger room end notification\n    if (currentRoom) {\n      console.log('ü§ñ Leaving room to start AI game:', currentRoom.id);\n\n      // Send explicit leave message to notify other players FIRST\n      const leaveMessage = {\n        type: 'leave_room',\n        roomId: currentRoom.id,\n        userId: user?.userId || user?.id,\n        playerName: user?.displayName || user?.firstName || user?.username || 'Player'\n      };\n\n      console.log('ü§ñ Sending leave message:', leaveMessage);\n      sendMessage(leaveMessage);\n\n      // Prevent multiple resets and effects from triggering\n      setIsResettingState(true);\n      \n      setTimeout(() => {\n        console.log('ü§ñ Cleaning up after leave message sent');\n        // Batch all state changes and switch to AI mode\n        setCurrentRoom(null);\n        setCurrentGame(null);\n        setShowGameOver(false);\n        setGameResult(null);\n        setIsCreatingGame(false);\n        setIsMatchmaking(false); // Ensure matchmaking is off\n        setShowMatchmaking(false); // Ensure modal is closed\n        setSelectedMode('ai'); // Switch to AI mode\n        \n        // Complete reset and initialize AI game\n        setTimeout(() => {\n          setIsResettingState(false);\n          initializeLocalGame();\n        }, 200);\n      }, 400);\n    } else {\n      console.log('ü§ñ No current room, starting AI game directly');\n      // Batch state changes to prevent screen blinking\n      const resetState = () => {\n        setCurrentRoom(null);\n        setCurrentGame(null);\n        setShowGameOver(false);\n        setGameResult(null);\n        setIsCreatingGame(false);\n        setIsMatchmaking(false); // Ensure matchmaking is off\n        setShowMatchmaking(false); // Ensure modal is closed\n        setSelectedMode('ai'); // Switch to AI mode\n      };\n      \n      // Prevent multiple resets and effects from triggering\n      setIsResettingState(true);\n      \n      setTimeout(() => {\n        resetState();\n        // Complete reset and initialize AI game\n        setTimeout(() => {\n          setIsResettingState(false);\n          initializeLocalGame();\n        }, 200);\n      }, 350);\n    }\n  };\n\n  const handleGameStart = (game: any) => {\n    //console.log('üéÆ handleGameStart called with game:', game);\n    setCurrentGame(game);\n  };\n\n  const handleMatchmakingStart = () => {\n    console.log('üéÆ handleMatchmakingStart called - cleaning up all state');\n    \n    // Clean up any existing game/room state first to prevent conflicts\n    if (currentGame) {\n      console.log('üéÆ Clearing existing game state before matchmaking');\n      setCurrentGame(null);\n    }\n    \n    if (currentRoom) {\n      console.log('üéÆ Clearing existing room state before matchmaking');\n      setCurrentRoom(null);\n    }\n    \n    // Reset any lingering game over state\n    setShowGameOver(false);\n    setGameResult(null);\n    setIsCreatingGame(false);\n    \n    // Switch to online mode for matchmaking\n    setSelectedMode('online');\n    \n    // Start matchmaking\n    setShowMatchmaking(true);\n    setIsMatchmaking(true);\n  };\n\n  const handleMatchmakingClose = () => {\n    console.log('üéÆ handleMatchmakingClose called - forcing modal closure');\n    setShowMatchmaking(false);\n    setIsMatchmaking(false);\n  };\n\n  const handleMatchFound = (room: any) => {\n    console.log('üéÆ handleMatchFound called - match found, processing...', room);\n    \n    // CRITICAL FIX: Force close all modals and reset states immediately\n    setIsMatchmaking(false);\n    setShowMatchmaking(false);\n    \n    // Clear any existing game state to prevent conflicts\n    setCurrentGame(null);\n    \n    // Clear local storage that might interfere\n    localStorage.removeItem('currentGameState');\n    sessionStorage.removeItem('currentGameState');\n    localStorage.removeItem('currentRoomState');\n    sessionStorage.removeItem('currentRoomState');\n    \n    // CRITICAL FIX: Ensure proper UI refresh by forcing component re-render\n    // This fixes the issue where the second player's game board doesn't refresh\n    setIsResettingState(true);\n    \n    setTimeout(() => {\n      // Set the room state and switch to online mode\n      setSelectedMode('online');\n      setCurrentRoom({\n        id: room.id,\n        code: room.code || 'ONLINE',\n        status: room.status || 'waiting',\n        name: room.name || 'Match Room',\n        maxPlayers: room.maxPlayers || 2,\n        ownerId: room.ownerId,\n        isPrivate: room.isPrivate || false,\n        createdAt: room.createdAt\n      });\n      \n      // Clear any conflicting states\n      setIsCreatingGame(false);\n      setShowGameOver(false);\n      setGameResult(null);\n      setIsResettingState(false);\n      \n      // Join the room via WebSocket\n      if (room.id) {\n        console.log('üéÆ Joining WebSocket room:', room.id);\n        joinRoom(room.id);\n      }\n      \n      // Show success toast\n      toast({\n        title: \"Match Found!\",\n        description: \"Connecting to your opponent...\",\n        duration: 2000,\n      });\n      \n      console.log('üéÆ Match found processing complete - room set and joined');\n    }, 50); // Small delay for proper state synchronization\n  };\n\n  // Initialize local game for AI and pass-play modes when no game exists\n  const initializeLocalGame = () => {\n    if (selectedMode === 'ai' || selectedMode === 'pass-play') {\n      //console.log('üéÆ Initializing local game for mode:', selectedMode);\n      const newGame = {\n        id: `local-game-${Date.now()}`,\n        board: {},\n        currentPlayer: 'X',\n        status: 'active',\n        gameMode: selectedMode,\n        aiDifficulty,\n        playerXId: user?.userId || user?.id,\n        playerOId: selectedMode === 'ai' ? 'ai' : 'player2',\n        playerXInfo: {\n          displayName: 'Player X',\n          firstName: 'Player X',\n          username: 'Player X'\n        },\n        playerOInfo: selectedMode === 'ai' ? {\n          displayName: 'AI',\n          firstName: 'AI',\n          username: 'AI'\n        } : {\n          displayName: 'Player O',\n          firstName: 'Player O',\n          username: 'Player O'\n        }\n      };\n      //console.log('üéÆ Created local game:', newGame);\n      setCurrentGame(newGame);\n    }\n  };\n\n  // Auto-initialize game when switching to AI or pass-play mode\n  useEffect(() => {\n    if (isResettingState) return; // Skip during reset operations\n    \n    if (selectedMode === 'ai' || selectedMode === 'pass-play') {\n      //console.log('üéÆ Mode changed to:', selectedMode);\n      // Clear any online game state first\n      if (currentGame && currentGame.gameMode === 'online') {\n        //console.log('üéÆ Clearing online game state for local mode');\n        setCurrentGame(null);\n        setCurrentRoom(null);\n        setShowGameOver(false);\n        setGameResult(null);\n        setIsCreatingGame(false);\n      }\n      \n      // Initialize local game if no game exists or if switching from online\n      if (!currentGame || currentGame.gameMode === 'online') {\n        //console.log('üéÆ Auto-initializing game for mode:', selectedMode);\n        setTimeout(() => {\n          initializeLocalGame();\n        }, 100);\n      }\n    }\n  }, [selectedMode, currentGame, user, isResettingState]);\n\n  // Fix white screen issue by ensuring game exists for all modes\n  useEffect(() => {\n    if (isResettingState) return; // Skip during reset operations\n    \n    //console.log('üéÆ Effect check - currentGame:', !!currentGame, 'currentRoom:', !!currentRoom, 'selectedMode:', selectedMode);\n    if (!currentGame && !currentRoom && selectedMode !== 'online') {\n      //console.log('üéÆ White screen fix - initializing local game');\n      initializeLocalGame();\n    }\n  }, [currentGame, currentRoom, selectedMode, user, isResettingState]);\n\n  // Add effect to prevent game state loss on WebSocket reconnections\n  useEffect(() => {\n    if (currentGame && currentRoom && !isConnected) {\n      //console.log('üîå WebSocket disconnected but have game/room, maintaining state');\n      // Don't reset game state on WebSocket disconnection\n    }\n  }, [isConnected, currentGame, currentRoom]);\n\n  // Auto-rejoin room when WebSocket reconnects\n  useEffect(() => {\n    if (isConnected && currentRoom) {\n      //console.log('üîå WebSocket reconnected, rejoining room:', currentRoom.id);\n      joinRoom(currentRoom.id);\n    }\n  }, [isConnected, currentRoom]);\n\n  // Force game initialization when user becomes available\n  useEffect(() => {\n    if (isResettingState) return; // Skip during reset operations\n    \n    if (user && !currentGame && !currentRoom && selectedMode !== 'online') {\n      //console.log('üéÆ User available - initializing local game');\n      initializeLocalGame();\n    }\n  }, [user]);\n\n  // Update AI difficulty when changed - reset the game\n  useEffect(() => {\n    if (currentGame && selectedMode === 'ai') {\n      //console.log('üéÆ AI difficulty changed, resetting game');\n      // Reset the game completely when difficulty changes\n      const newGame = {\n        id: `local-game-${Date.now()}`,\n        board: {},\n        currentPlayer: 'X',\n        status: 'active',\n        gameMode: selectedMode,\n        aiDifficulty,\n        playerXId: user?.userId || user?.id,\n        playerOId: 'ai',\n        playerXInfo: {\n          displayName: 'Player X',\n          firstName: 'Player X',\n          username: 'Player X'\n        },\n        playerOInfo: {\n          displayName: 'AI',\n          firstName: 'AI',\n          username: 'AI'\n        }\n      };\n      setCurrentGame(newGame);\n    }\n  }, [aiDifficulty, selectedMode, user]);\n\n  const handleGameOver = async (result: any) => {\n    //console.log('üéÆ handleGameOver called with result:', result);\n\n    // Ultra-simple approach - just store the winner and condition\n    const simpleResult = {\n      winner: result?.winner || null,\n      winnerName: result?.winnerName || (result?.winner === 'X' ? 'Player X' : result?.winner === 'O' ? 'AI' : null),\n      condition: result?.condition || 'unknown'\n    };\n\n    //console.log('üéÆ Setting simple game result:', simpleResult);\n    setGameResult(simpleResult);\n    setShowGameOver(true);\n    \n    // Award coins for AI game wins\n    if (selectedMode === 'ai' && result?.winner === 'X' && user?.userId) {\n      try {\n        console.log('ü™ô Player won AI game, awarding 10 coins');\n        const response = await fetch('/api/coins/award', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            userId: user.userId,\n            amount: 10,\n            reason: 'AI game win'\n          })\n        });\n        \n        if (response.ok) {\n          console.log('ü™ô Coins awarded successfully');\n          // Refresh user data to show updated coin balance\n          queryClient.invalidateQueries({ queryKey: ['/api/auth/user'] });\n        } else {\n          console.error('Failed to award coins:', response.status);\n        }\n      } catch (error) {\n        console.error('Error awarding coins:', error);\n      }\n    }\n    \n    // Invalidate stats cache for local games too\n    console.log('üìä Local game ended - refreshing user stats cache');\n    queryClient.invalidateQueries({ queryKey: ['/api/users/online-stats'] });\n    queryClient.invalidateQueries({ queryKey: ['/api/users/online'] });\n    queryClient.invalidateQueries({ queryKey: ['/api/leaderboard'] });\n  };\n\n  const handlePlayAgain = async () => {\n    if (isCreatingGame) {\n      //console.log('üéÆ Already creating game, ignoring request');\n      return;\n    }\n\n    setIsCreatingGame(true);\n    setShowGameOver(false);\n    setGameResult(null);\n\n    if (selectedMode === 'online' && currentRoom) {\n      // For online mode, create a new game in the same room\n      try {\n        //console.log('üéÆ Creating new game for room:', currentRoom.id);\n        \n        // Clear the current game first to prevent using finished game\n        setCurrentGame(null);\n        \n        const response = await fetch(`/api/rooms/${currentRoom.id}/start-game`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n        });\n\n        if (response.ok) {\n          const newGame = await response.json();\n          //console.log('üéÆ New game created for play again:', newGame);\n          //console.log('üéÆ Game created successfully, waiting for server broadcast to all participants');\n          \n          // Don't set the game locally - let the server broadcast handle it\n          // This ensures both players get the exact same game state at the same time\n\n          // Sound effects removed as requested\n        } else {\n          //console.error('Failed to create new game:', response.status);\n          // Reset game state on error\n          setCurrentGame(null);\n        }\n      } catch (error) {\n        //console.error('Error starting new game:', error);\n        // Reset game state on error\n        setCurrentGame(null);\n      }\n    } else {\n      // For AI and pass-play modes, restart locally\n      const newGame = {\n        id: `local-game-${Date.now()}`,\n        board: {},\n        currentPlayer: 'X',\n        status: 'active',\n        gameMode: selectedMode,\n        aiDifficulty,\n        playerXId: user?.userId || user?.id,\n        playerOId: selectedMode === 'ai' ? 'ai' : 'player2',\n        playerXInfo: {\n          displayName: 'Player X',\n          firstName: 'Player X',\n          username: 'Player X'\n        },\n        playerOInfo: selectedMode === 'ai' ? {\n          displayName: 'AI',\n          firstName: 'AI',\n          username: 'AI'\n        } : {\n          displayName: 'Player O',\n          firstName: 'Player O',\n          username: 'Player O'\n        }\n      };\n\n      setCurrentGame(newGame);\n      // Sound effects removed as requested\n    }\n\n    // Reset creating state after a short delay\n    setTimeout(() => {\n      setIsCreatingGame(false);\n    }, 1000);\n  };\n\n\n\n  return (\n    <div className=\"min-h-screen bg-slate-900 text-white\">\n      {/* Enhanced Navigation Header - Larger Topbar */}\n      <nav className=\"bg-gradient-to-r from-slate-800 via-slate-700 to-slate-800 border-b border-slate-600 shadow-lg px-2 py-4 sm:px-4 sm:py-7 md:py-8\">\n        <div className=\"max-w-7xl mx-auto flex items-center justify-between\">\n          {/* Epic Gaming Profile Section - Larger Layout */}\n          <div \n            className=\"flex items-center space-x-3 sm:space-x-4 md:space-x-7 cursor-pointer hover:opacity-80 transition-opacity duration-200\"\n            onClick={() => setShowUserProfile(true)}\n            title=\"Click to view your profile stats\"\n          >\n            {/* Main Profile Display */}\n            <div className=\"relative group\">\n              {/* Epic Profile Picture with Multiple Visual Effects */}\n              <div className=\"relative\">\n                {/* Outer Glow Ring - Slightly larger */}\n                <div className=\"absolute inset-0 w-14 h-14 sm:w-18 sm:h-18 md:w-24 md:h-24 bg-gradient-to-r from-cyan-400 via-blue-500 to-purple-600 rounded-full blur-md opacity-75 group-hover:opacity-100 animate-pulse\"></div>\n                \n                {/* Main Profile Picture Container - Slightly larger sizing */}\n                <div className=\"relative w-14 h-14 sm:w-18 sm:h-18 md:w-24 md:h-24 bg-gradient-to-br from-blue-500 via-purple-600 to-pink-500 rounded-full p-0.5 sm:p-1 shadow-2xl\">\n                  {user?.profilePicture ? (\n                    <img \n                      src={user.profilePicture} \n                      alt=\"Profile\" \n                      className=\"w-full h-full rounded-full object-cover border-2 border-white/30 shadow-lg\"\n                    />\n                  ) : (\n                    <div className=\"w-full h-full bg-gradient-to-br from-slate-700 to-slate-900 rounded-full flex items-center justify-center border-2 border-white/30\">\n                      <User className=\"w-6 h-6 sm:w-9 sm:h-9 md:w-12 md:h-12 text-white\" />\n                    </div>\n                  )}\n                  \n                  {/* Online Status with Enhanced Glow - Mobile responsive */}\n                  <div className={`absolute -bottom-0.5 -right-0.5 sm:-bottom-1 sm:-right-1 w-4 h-4 sm:w-6 sm:h-6 md:w-7 md:h-7 rounded-full border-2 sm:border-3 border-slate-800 ${actualOnlineStatus ? 'bg-green-500 shadow-lg shadow-green-500/50' : 'bg-red-500 shadow-lg shadow-red-500/50'} animate-pulse`}></div>\n                  \n                  {/* Level Badge - Mobile responsive */}\n                  <div className=\"absolute -top-1 -left-1 sm:-top-2 sm:-left-2 bg-gradient-to-r from-yellow-400 to-orange-500 text-black text-xs sm:text-sm font-black px-1.5 py-0.5 sm:px-2 sm:py-1 rounded-full shadow-lg border border-yellow-300\">\n                    Lv.{userStats?.level || '0'}\n                  </div>\n                </div>\n                \n                {/* Floating Particles Effect - Hidden on very small screens */}\n                <div className=\"absolute inset-0 pointer-events-none hidden sm:block\">\n                  <div className=\"absolute top-0 left-4 w-2 h-2 bg-blue-400 rounded-full animate-ping opacity-75\"></div>\n                  <div className=\"absolute bottom-2 right-0 w-1 h-1 bg-purple-400 rounded-full animate-ping opacity-60 animation-delay-500\"></div>\n                  <div className=\"absolute top-3 right-6 w-1.5 h-1.5 bg-pink-400 rounded-full animate-ping opacity-50 animation-delay-1000\"></div>\n                </div>\n              </div>\n            </div>\n            \n            {/* Player Info with Gaming Stats - Larger Layout */}\n            <div className=\"flex flex-col space-y-1.5 sm:space-y-2 min-w-0 flex-1\">\n              <div className=\"flex items-center space-x-2 sm:space-x-3\">\n                <h2 className=\"text-base sm:text-xl md:text-3xl font-black bg-gradient-to-r from-white via-blue-100 to-purple-200 bg-clip-text text-transparent truncate\">\n                  {user?.displayName || user?.firstName || user?.username || 'Player'}\n                </h2>\n                <div className={`flex items-center space-x-1 px-2 py-1 sm:px-2.5 sm:py-1.5 rounded-full text-xs sm:text-sm font-semibold ${actualOnlineStatus ? 'bg-green-500/20 text-green-400 border border-green-500/30' : 'bg-red-500/20 text-red-400 border border-red-500/30'}`}>\n                  <div className={`w-2 h-2 sm:w-2.5 sm:h-2.5 rounded-full ${actualOnlineStatus ? 'bg-green-400' : 'bg-red-400'} animate-pulse`}></div>\n                  <span className=\"hidden sm:inline\">{actualOnlineStatus ? 'ONLINE' : 'OFFLINE'}</span>\n                </div>\n              </div>\n              \n              {/* Epic Stats Display - Larger Layout */}\n              <div className=\"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-1.5 sm:gap-2 md:flex md:items-center md:space-x-5 text-xs sm:text-sm\">\n                <div className=\"flex items-center space-x-1 bg-blue-500/20 px-2 py-1.5 sm:px-2.5 sm:py-2 rounded border border-blue-500/30\">\n                  <Trophy className=\"w-3 h-3 sm:w-4 sm:h-4 text-yellow-400\" />\n                  <span className=\"text-yellow-400 font-bold\">{userStats?.wins || 0}</span>\n                  <span className=\"text-blue-300 hidden sm:inline\">Wins</span>\n                </div>\n                \n                <div className=\"flex items-center space-x-1 bg-purple-500/20 px-2 py-1.5 sm:px-2.5 sm:py-2 rounded border border-purple-500/30\">\n                  <Zap className=\"w-3 h-3 sm:w-4 sm:h-4 text-orange-400\" />\n                  <span className=\"text-orange-400 font-bold\">{userStats?.currentWinStreak || 0}</span>\n                  <span className=\"text-purple-300 hidden sm:inline\">Streak</span>\n                </div>\n                \n                <div className=\"flex items-center space-x-1 bg-pink-500/20 px-2 py-1.5 sm:px-2.5 sm:py-2 rounded border border-pink-500/30\">\n                  <span className=\"text-pink-400 font-bold\">{Math.round(((userStats?.wins || 0) / Math.max((userStats?.wins || 0) + (userStats?.losses || 0), 1)) * 100)}%</span>\n                  <span className=\"text-pink-300 hidden sm:inline\">Rate</span>\n                </div>\n                \n                <div className=\"flex items-center space-x-1 bg-green-500/20 px-2 py-1.5 sm:px-2.5 sm:py-2 rounded border border-green-500/30\">\n                  <span className=\"text-green-400 font-bold text-sm\">üí∞</span>\n                  <span className=\"text-green-400 font-bold\">{formatNumber(userStats?.coins ?? 1000)}</span>\n                  <span className=\"text-green-300 hidden sm:inline\">Coins</span>\n                </div>\n              </div>\n            </div>\n          </div>\n\n\n            \n            {/* Enhanced Action Buttons - Larger Layout */}\n            <div className=\"flex items-center space-x-2 sm:space-x-3 md:space-x-4\">\n              {/* Leaderboard Button - Larger Size */}\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => setShowLeaderboard(true)}\n                className=\"bg-gradient-to-r from-yellow-600 to-orange-600 border-yellow-500/50 text-white hover:from-yellow-500 hover:to-orange-500 px-3 py-2 sm:px-4 sm:py-2.5 md:px-5 md:py-3 rounded-xl shadow-lg hover:shadow-yellow-500/25 transition-all duration-300 backdrop-blur-sm\"\n              >\n                <Trophy className=\"w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6\" />\n                <span className=\"hidden md:inline ml-2 font-semibold\">{t('leaderboard') || 'Leaderboard'}</span>\n              </Button>\n              \n              {/* Menu Button - Larger Size */}\n              <div className=\"relative\" ref={headerSidebarRef}>\n                <Button \n                  variant=\"outline\" \n                  size=\"sm\"\n                  onClick={() => setShowHeaderSidebar(!showHeaderSidebar)}\n                  className=\"bg-slate-700/80 border-slate-500/50 text-white hover:bg-slate-600/80 px-3 py-2 sm:px-4 sm:py-2.5 md:px-5 md:py-3 rounded-xl shadow-lg backdrop-blur-sm hover:shadow-slate-500/25 transition-all duration-300\"\n                >\n                  {showHeaderSidebar ? (\n                    <X className=\"w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6\" />\n                  ) : (\n                    <Menu className=\"w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6\" />\n                  )}\n                  <span className=\"hidden md:inline ml-2 font-semibold\">Menu</span>\n                </Button>\n              \n              {/* Header Sidebar */}\n              {showHeaderSidebar && (\n                <div className=\"absolute right-0 top-full mt-2 w-64 bg-slate-800 border border-slate-700 rounded-lg shadow-lg z-50 overflow-visible\">\n                  <div className=\"p-4 space-y-4 overflow-visible\">\n                    <div className=\"text-sm font-medium text-gray-300 border-b border-slate-700 pb-2\">\n                      {t('quickActions')}\n                    </div>\n                    \n                    {/* Language Selector */}\n                    <div className=\"flex items-center justify-between overflow-visible\">\n                      <div className=\"flex items-center space-x-2\">\n                        <Languages className=\"w-4 h-4 text-gray-400\" />\n                        <span className=\"text-sm text-gray-300\">{t('language')}</span>\n                      </div>\n                      <div className=\"relative z-[9999]\">\n                        <CustomLanguageSelector />\n                      </div>\n                    </div>\n                    \n                    {/* Theme Selector */}\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center space-x-2\">\n                        <Palette className=\"w-4 h-4 text-gray-400\" />\n                        <span className=\"text-sm text-gray-300\">{t('theme')}</span>\n                      </div>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          console.log('Theme change button clicked');\n                          // Don't close the sidebar, just open theme selector\n                          const event = new CustomEvent('openThemeSelector');\n                          window.dispatchEvent(event);\n                        }}\n                        className=\"bg-slate-700 border-slate-600 text-white hover:bg-slate-600 text-xs cursor-pointer\"\n                      >\n                        <Palette className=\"h-3 w-3 mr-1\" />\n                        {t('change')}\n                      </Button>\n                    </div>\n                    \n                    {/* Friends */}\n                    <div className=\"w-full\">\n                      <Friends />\n                    </div>\n                    \n                    {/* Online Players */}\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center space-x-2\">\n                        <Users className=\"w-4 h-4 text-gray-400\" />\n                        <span className=\"text-sm text-gray-300\">{t('onlineUsers')}</span>\n                      </div>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => {\n                          setShowOnlineUsers(true);\n                          setShowHeaderSidebar(false);\n                        }}\n                        className=\"bg-slate-700 border-slate-600 text-white hover:bg-slate-600 text-xs\"\n                      >\n                        {onlineUserCount} {t('playersLabel')}\n                      </Button>\n                    </div>\n                    \n                    {/* Achievements */}\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center space-x-2\">\n                        <Trophy className=\"w-4 h-4 text-gray-400\" />\n                        <span className=\"text-sm text-gray-300\">{t('achievements')}</span>\n                      </div>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => {\n                          setShowAchievements(true);\n                          setShowHeaderSidebar(false);\n                        }}\n                        className=\"bg-slate-700 border-slate-600 text-white hover:bg-slate-600 text-xs\"\n                      >\n                        <Trophy className=\"h-3 w-3 mr-1\" />\n                        {t('view')}\n                      </Button>\n                    </div>\n                    \n                    {/* Share Game */}\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center space-x-2\">\n                        <span className=\"text-sm text-gray-300\">{t('shareGame')}</span>\n                      </div>\n                      <ShareButton\n                        title=\"TicTac 3x5 - Strategic Tic-Tac-Toe\"\n                        text=\"Join me for strategic tic-tac-toe on TicTac 3x5! It's more challenging than regular tic-tac-toe with diagonal-only wins.\"\n                        variant=\"outline\"\n                        size=\"sm\"\n                        className=\"bg-slate-700 border-slate-600 text-white hover:bg-slate-600 text-xs\"\n                      />\n                    </div>\n                    \n\n                    \n                    {/* Profile Settings */}\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center space-x-2\">\n                        <Settings className=\"w-4 h-4 text-gray-400\" />\n                        <span className=\"text-sm text-gray-300\">{t('profileSettings')}</span>\n                      </div>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          setShowHeaderSidebar(false);\n                          // Give a small delay to ensure sidebar is closed before opening profile\n                          setTimeout(() => {\n                            setShowProfile(true);\n                          }, 100);\n                        }}\n                        className=\"bg-slate-700 border-slate-600 text-white hover:bg-slate-600 text-xs\"\n                      >\n{t('settings')}\n                      </Button>\n                    </div>\n                    \n                    {/* Logout */}\n                    <div className=\"border-t border-slate-700 pt-2\">\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => logout()}\n                        className=\"w-full bg-red-700 border-red-600 text-white hover:bg-red-600 justify-start\"\n                      >\n                        <LogOut className=\"w-4 h-4 mr-2\" />\n{t('logout')}\n                      </Button>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </nav>\n\n      <div className=\"max-w-7xl mx-auto px-3 py-4 sm:px-4 sm:py-6 md:px-6 md:py-8\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6 md:gap-8\">\n          {/* Game Board Section */}\n          <div ref={gameBoardRef} className=\"lg:col-span-2\">\n            {currentGame ? (\n              <div>\n                <div className=\"mb-4 text-center\">\n                  <span className=\"text-sm text-gray-400\">\n                    Game ID: {currentGame.id} | Room: {currentRoom?.code || 'Local'}\n                  </span>\n                </div>\n                <GameBoard \n                  key={currentGame?.id}\n                  game={currentGame}\n                  onGameOver={handleGameOver}\n                  gameMode={selectedMode}\n                  user={user}\n                  lastMessage={lastMessage}\n                  sendMessage={sendMessage}\n                  isSpectator={isSpectator}\n                />\n              </div>\n            ) : (\n              <div className=\"text-center p-8 text-gray-400\">\n                <p>No active game. Select a game mode to start playing.</p>\n              </div>\n            )}\n\n            {/* Game Rules */}\n            <Card className=\"mt-4 sm:mt-6 bg-slate-800 border-slate-700\">\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-base sm:text-lg\">{t('gameRules')}</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-2 sm:space-y-3 text-xs sm:text-sm text-gray-300 pt-0\">\n                <div className=\"flex items-start space-x-2\">\n                  <div className=\"w-1.5 h-1.5 bg-green-500 rounded-full mt-2\"></div>\n                  <span>{t('horizontalWin')}</span>\n                </div>\n                <div className=\"flex items-start space-x-2\">\n                  <div className=\"w-1.5 h-1.5 bg-blue-500 rounded-full mt-2\"></div>\n                  <span>{t('verticalWin')}</span>\n                </div>\n                <div className=\"flex items-start space-x-2\">\n                  <div className=\"w-1.5 h-1.5 bg-purple-500 rounded-full mt-2\"></div>\n                  <span>{t('diagonalWin')}</span>\n                </div>\n                <div className=\"flex items-start space-x-2\">\n                  <div className=\"w-1.5 h-1.5 bg-yellow-500 rounded-full mt-2\"></div>\n                  <span>{t('gridLayout')}</span>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Sidebar */}\n          <div className=\"space-y-4 sm:space-y-6\">\n            {/* User Profile */}\n            <Card className=\"bg-slate-800 border-slate-700\">\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-base sm:text-lg flex items-center space-x-2\">\n                  <User className=\"w-4 h-4 sm:w-5 sm:h-5\" />\n                  <span>Profile</span>\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"pt-0\">\n                <div className=\"text-center\">\n                  {user?.profilePicture ? (\n                    <img \n                      src={user.profilePicture} \n                      alt=\"Profile\" \n                      className=\"w-12 h-12 sm:w-16 sm:h-16 rounded-full object-cover mx-auto mb-2 sm:mb-3\"\n                    />\n                  ) : (\n                    <div className=\"w-12 h-12 sm:w-16 sm:h-16 bg-primary rounded-full flex items-center justify-center mx-auto mb-2 sm:mb-3\">\n                      <User className=\"w-6 h-6 sm:w-8 sm:h-8 text-white\" />\n                    </div>\n                  )}\n                  <p className=\"text-xs sm:text-sm text-gray-300 mb-2 sm:mb-3 px-2 truncate\">\n                    {user?.displayName || user?.username || 'Player'}\n                  </p>\n                  <ProfileManager user={user} open={false} />\n                </div>\n              </CardContent>\n            </Card>\n\n\n\n            {/* Game Mode Selection */}\n            <GameModeSelector \n              selectedMode={selectedMode}\n              onModeChange={(mode) => {\n                // Sound effects removed as requested\n                setSelectedMode(mode);\n              }}\n              aiDifficulty={aiDifficulty}\n              onDifficultyChange={setAiDifficulty}\n            />\n\n\n\n            {/* Online Room Management */}\n            {selectedMode === 'online' && (\n              <Card className=\"bg-slate-800 border-slate-700\">\n                <CardHeader>\n                  <CardTitle className=\"text-lg\">{t('onlineMode')}</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    {!currentRoom && (\n                      <>\n                        <div className=\"p-4 bg-gradient-to-r from-blue-900/20 to-purple-900/20 rounded-lg border border-blue-500/20\">\n                          <div className=\"text-center space-y-3\">\n                            <div className=\"text-sm font-semibold text-blue-300\">{t('quickMatch')}</div>\n                            <p className=\"text-xs text-gray-400\">\n                              {t('getMatchedWithAnotherPlayer')}\n                            </p>\n                            <Button \n                              onClick={handleMatchmakingStart}\n                              className=\"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700\"\n                              disabled={isMatchmaking}\n                            >\n                              {isMatchmaking ? (\n                                <>\n                                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                                  {t('thinking')}\n                                </>\n                              ) : (\n                                <>\n                                  <Zap className=\"w-4 h-4 mr-2\" />\n                                  {t('findMatch')}\n                                </>\n                              )}\n                            </Button>\n                          </div>\n                        </div>\n                        \n                        <div className=\"text-center text-sm text-gray-500\">\n                          <span>{t('or')}</span>\n                        </div>\n                        \n                        <div className=\"text-center\">\n                          <p className=\"text-sm text-gray-300 mb-2\">\n                            {t('createOrJoinRoom')}\n                          </p>\n                        </div>\n                      </>\n                    )}\n                    \n                    {currentRoom && (\n                      <div className=\"flex items-center space-x-2\">\n                        <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\n                        <span className=\"text-sm\">{t('connectedToRoom')} {currentRoom.code}</span>\n                      </div>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Room Management */}\n            {selectedMode === 'online' && (\n              <RoomManager \n                currentRoom={currentRoom}\n                onRoomJoin={handleRoomJoin}\n                onRoomLeave={handleRoomLeave}\n                onCreateRoom={() => setShowCreateRoom(true)}\n                onGameStart={handleGameStart}\n                gameMode={selectedMode}\n                user={user}\n              />\n            )}\n\n            {/* Players & Spectators */}\n            {currentRoom && (\n              <PlayerList roomId={currentRoom.id} />\n            )}\n\n            {/* Audio Controls removed as requested */}\n\n            {/* Game Statistics */}\n            <Card className=\"bg-slate-800 border-slate-700\">\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-base sm:text-lg\">{t('gameStats')}</CardTitle>\n              </CardHeader>\n              <CardContent className=\"pt-0\">\n                <div className=\"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-2 xl:grid-cols-4 gap-3 text-center\">\n                  <div className=\"p-2 sm:p-3 bg-slate-700 rounded-lg\">\n                    <div className=\"text-xl sm:text-2xl font-bold text-blue-500\">\n                      {userStats?.wins || 0}\n                    </div>\n                    <div className=\"text-xs text-gray-400\">{t('wins')}</div>\n                  </div>\n                  <div className=\"p-2 sm:p-3 bg-slate-700 rounded-lg\">\n                    <div className=\"text-xl sm:text-2xl font-bold text-red-500\">\n                      {userStats?.losses || 0}\n                    </div>\n                    <div className=\"text-xs text-gray-400\">{t('losses')}</div>\n                  </div>\n                  <div className=\"p-2 sm:p-3 bg-slate-700 rounded-lg\">\n                    <div className=\"text-xl sm:text-2xl font-bold text-yellow-500\">\n                      {userStats?.draws || 0}\n                    </div>\n                    <div className=\"text-xs text-gray-400\">{t('draws')}</div>\n                  </div>\n                  <div className=\"p-2 sm:p-3 bg-slate-700 rounded-lg\">\n                    <div className=\"text-xl sm:text-2xl font-bold text-gray-400\">\n                      {(userStats?.wins || 0) + (userStats?.losses || 0) + (userStats?.draws || 0)}\n                    </div>\n                    <div className=\"text-xs text-gray-400\">{t('total')}</div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n\n      {/* Modals */}\n      <CreateRoomModal \n        open={showCreateRoom}\n        onClose={() => setShowCreateRoom(false)}\n        onRoomCreated={handleRoomJoin}\n      />\n\n      <GameOverModal \n        open={showGameOver}\n        onClose={() => setShowGameOver(false)}\n        result={gameResult}\n        onPlayAgain={handlePlayAgain}\n        isCreatingGame={isCreatingGame}\n        onPlayWithAI={handlePlayWithAI}\n        isSpectator={isSpectator}\n        currentUser={user ? {\n          userId: (user as any).userId || (user as any).id,\n          username: (user as any).username || 'Unknown',\n          displayName: (user as any).displayName || (user as any).firstName || (user as any).username\n        } : null}\n      />\n\n      <PlayAgainRequestDialog\n        open={showPlayAgainRequest}\n        onClose={() => {\n          setShowPlayAgainRequest(false);\n          setPlayAgainRequest(null);\n        }}\n        request={playAgainRequest}\n      />\n\n      {showEmailVerification && user?.email && (\n        <EmailVerificationModal \n          email={user.email}\n          onClose={() => setShowEmailVerification(false)}\n        />\n      )}\n\n      <MatchmakingModal \n        open={showMatchmaking}\n        onClose={handleMatchmakingClose}\n        onMatchFound={handleMatchFound}\n        user={user}\n        isWebSocketConnected={isConnected}\n        refreshWebSocketConnection={refreshConnection}\n      />\n\n      <OnlineUsersModal \n        open={showOnlineUsers}\n        onClose={() => setShowOnlineUsers(false)}\n        currentRoom={currentRoom}\n        user={user}\n      />\n\n      <LevelUpModal \n        open={showLevelUp}\n        onClose={handleLevelUpAcknowledge}\n        userDisplayName={(user as any)?.displayName || (user as any)?.firstName || (user as any)?.username || 'Player'}\n        newLevel={levelUpData?.newLevel || 1}\n        previousLevel={levelUpData?.previousLevel || 0}\n        userProfilePicture={(user as any)?.profilePicture || (user as any)?.photoURL}\n      />\n\n      <ProfileManager \n        user={user}\n        open={showProfile}\n        onClose={() => setShowProfile(false)}\n      />\n\n      <ThemeSelector />\n\n      <AchievementModal \n        open={showAchievements}\n        onClose={() => setShowAchievements(false)}\n        user={user}\n      />\n\n      <Leaderboard \n        open={showLeaderboard}\n        onClose={() => setShowLeaderboard(false)}\n        trigger={\n          <div style={{ display: 'none' }} />\n        }\n      />\n\n      {/* Global Room Invitation Popup */}\n      <InvitationPopup onRoomJoin={handleRoomJoin} />\n\n      {/* User Profile Stats Modal */}\n      <UserProfileModal \n        open={showUserProfile}\n        onClose={() => setShowUserProfile(false)}\n        userId={user?.userId || user?.id || ''}\n        username={user?.username || ''}\n        displayName={user?.displayName || user?.firstName || user?.username || 'Player'}\n        profilePicture={user?.profilePicture}\n        profileImageUrl={user?.profileImageUrl}\n      />\n\n    </div>\n  );\n}","size_bytes":86145},"client/src/pages/landing.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { GamepadIcon } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { useTranslation } from \"@/contexts/LanguageContext\";\nimport { LanguageSelector } from \"@/components/LanguageSelector\";\nimport { ShareButton } from \"@/components/ShareButton\";\n\nexport default function Landing() {\n  const [, setLocation] = useLocation();\n  const { t } = useTranslation();\n\n  const handleLogin = () => {\n    setLocation(\"/auth\");\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900\">\n      {/* Header */}\n      <nav className=\"px-6 py-4 border-b border-slate-700\">\n        <div className=\"max-w-7xl mx-auto flex items-center justify-between\">\n          <div className=\"flex items-center space-x-4\">\n            <div className=\"w-10 h-10 bg-primary rounded-lg flex items-center justify-center\">\n              <GamepadIcon className=\"w-6 h-6 text-white\" />\n            </div>\n            <h1 className=\"text-xl font-bold text-white\">{t('appName')}</h1>\n          </div>\n          <div className=\"flex items-center gap-4\">\n            <LanguageSelector />\n            <ShareButton \n              text={t('shareGameText')}\n              variant=\"ghost\"\n              size=\"sm\"\n            />\n            <Button \n              onClick={handleLogin}\n              className=\"bg-primary hover:bg-primary/90\"\n            >\n              {t('getStarted')}\n            </Button>\n          </div>\n        </div>\n      </nav>\n\n      {/* Hero Section */}\n      <div className=\"max-w-7xl mx-auto px-6 py-16\">\n        <div className=\"text-center mb-16\">\n          <h2 className=\"text-5xl font-bold text-white mb-6\">\n            {t('strategicTicTacToe')}\n            <span className=\"block text-primary\">{t('game')}</span>\n          </h2>\n          <p className=\"text-xl text-slate-300 max-w-3xl mx-auto mb-8\">\n            {t('gameDescription')}\n          </p>\n          <Button \n            size=\"lg\" \n            onClick={handleLogin}\n            className=\"bg-primary hover:bg-primary/90 text-lg px-8 py-3\"\n          >\n            {t('startPlayingNow')}\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":2299},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/pages/reset-password.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { KeyRound, CheckCircle, XCircle } from \"lucide-react\";\n\nexport default function ResetPassword() {\n  const [resetCode, setResetCode] = useState('');\n  const [newPassword, setNewPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [isSuccess, setIsSuccess] = useState(false);\n  const [error, setError] = useState('');\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n    setError('');\n\n    if (!resetCode.trim()) {\n      setError('Please enter your reset code');\n      setIsLoading(false);\n      return;\n    }\n\n    if (resetCode.length !== 6 || !/^\\d+$/.test(resetCode)) {\n      setError('Reset code must be 6 digits');\n      setIsLoading(false);\n      return;\n    }\n\n    if (newPassword !== confirmPassword) {\n      setError('Passwords do not match');\n      setIsLoading(false);\n      return;\n    }\n\n    if (newPassword.length < 6) {\n      setError('Password must be at least 6 characters long');\n      setIsLoading(false);\n      return;\n    }\n\n    try {\n      const response = await fetch('/api/auth/reset-password', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ token: resetCode, newPassword })\n      });\n\n      const data = await response.json();\n\n      if (response.ok) {\n        setIsSuccess(true);\n        toast({\n          title: \"Password Reset\",\n          description: \"Your password has been reset successfully.\",\n        });\n      } else {\n        setError(data.error || 'Failed to reset password');\n        toast({\n          title: \"Error\",\n          description: data.error || \"Failed to reset password.\",\n          variant: \"destructive\",\n        });\n      }\n    } catch (error) {\n      setError('Failed to reset password. Please try again.');\n      toast({\n        title: \"Error\",\n        description: \"Failed to reset password. Please try again.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleLoginRedirect = () => {\n    setLocation('/auth');\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center p-4\">\n      <Card className=\"w-full max-w-md bg-slate-800 border-slate-700\">\n        <CardHeader className=\"text-center\">\n          <div className=\"mx-auto mb-4 p-3 rounded-full w-fit\">\n            {isSuccess ? (\n              <div className=\"bg-green-100 p-3 rounded-full\">\n                <CheckCircle className=\"h-8 w-8 text-green-600\" />\n              </div>\n            ) : error ? (\n              <div className=\"bg-red-100 p-3 rounded-full\">\n                <XCircle className=\"h-8 w-8 text-red-600\" />\n              </div>\n            ) : (\n              <div className=\"bg-blue-100 p-3 rounded-full\">\n                <KeyRound className=\"h-8 w-8 text-blue-600\" />\n              </div>\n            )}\n          </div>\n          <CardTitle className=\"text-white text-xl\">\n            {isSuccess ? 'Password Reset Complete' : error ? 'Reset Failed' : 'Reset Password'}\n          </CardTitle>\n          <CardDescription className=\"text-slate-300\">\n            {isSuccess \n              ? 'Your password has been successfully reset'\n              : error \n                ? 'There was an issue resetting your password'\n                : 'Enter your reset code and new password below'\n            }\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {error && (\n            <Alert className=\"bg-red-900 border-red-700\">\n              <XCircle className=\"h-4 w-4 text-red-400\" />\n              <AlertDescription className=\"text-red-300\">\n                {error}\n              </AlertDescription>\n            </Alert>\n          )}\n          \n          {isSuccess ? (\n            <>\n              <Alert className=\"bg-green-900 border-green-700\">\n                <CheckCircle className=\"h-4 w-4 text-green-400\" />\n                <AlertDescription className=\"text-green-300\">\n                  Your password has been reset successfully. You can now log in with your new password.\n                </AlertDescription>\n              </Alert>\n              \n              <Button\n                onClick={handleLoginRedirect}\n                className=\"w-full bg-primary hover:bg-primary/90\"\n              >\n                Continue to Login\n              </Button>\n            </>\n          ) : !error ? (\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"resetCode\" className=\"text-slate-300\">Reset Code</Label>\n                <Input\n                  id=\"resetCode\"\n                  type=\"text\"\n                  placeholder=\"Enter 6-digit code\"\n                  value={resetCode}\n                  onChange={(e) => setResetCode(e.target.value.replace(/\\D/g, '').slice(0, 6))}\n                  className=\"bg-slate-700 border-slate-600 text-white text-center text-2xl font-mono letter-spacing-wide\"\n                  maxLength={6}\n                  autoComplete=\"off\"\n                />\n              </div>\n              \n              <div className=\"space-y-2\">\n                <Label htmlFor=\"new-password\" className=\"text-slate-300\">New Password</Label>\n                <Input\n                  id=\"new-password\"\n                  type=\"password\"\n                  placeholder=\"Enter new password\"\n                  value={newPassword}\n                  onChange={(e) => setNewPassword(e.target.value)}\n                  required\n                  className=\"bg-slate-700 border-slate-600 text-white\"\n                />\n              </div>\n              \n              <div className=\"space-y-2\">\n                <Label htmlFor=\"confirm-password\" className=\"text-slate-300\">Confirm Password</Label>\n                <Input\n                  id=\"confirm-password\"\n                  type=\"password\"\n                  placeholder=\"Confirm new password\"\n                  value={confirmPassword}\n                  onChange={(e) => setConfirmPassword(e.target.value)}\n                  required\n                  className=\"bg-slate-700 border-slate-600 text-white\"\n                />\n              </div>\n              \n              <Button\n                type=\"submit\"\n                disabled={isLoading}\n                className=\"w-full bg-primary hover:bg-primary/90\"\n              >\n                {isLoading ? 'Resetting...' : 'Reset Password'}\n              </Button>\n            </form>\n          ) : (\n            <div className=\"text-center\">\n              <Button\n                onClick={handleLoginRedirect}\n                className=\"w-full bg-primary hover:bg-primary/90\"\n              >\n                Back to Login\n              </Button>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":7495},"client/src/pages/verify-email.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { CheckCircle, XCircle, Mail } from \"lucide-react\";\n\nexport default function VerifyEmail() {\n  const [verificationCode, setVerificationCode] = useState('');\n  const [verificationStatus, setVerificationStatus] = useState<'idle' | 'loading' | 'success' | 'error'>('idle');\n  const [message, setMessage] = useState('');\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n\n  const handleVerifyCode = async () => {\n    if (!verificationCode.trim()) {\n      toast({\n        title: \"Error\",\n        description: \"Please enter your verification code\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (verificationCode.length !== 6 || !/^\\d+$/.test(verificationCode)) {\n      toast({\n        title: \"Error\",\n        description: \"Verification code must be 6 digits\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setVerificationStatus('loading');\n    \n    try {\n      const response = await fetch('/api/auth/verify-email', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ token: verificationCode })\n      });\n\n      if (response.ok) {\n        const data = await response.json();\n        setVerificationStatus('success');\n        setMessage(data.message || 'Email verified successfully!');\n        \n        toast({\n          title: \"Email Verified\",\n          description: \"Your email has been verified successfully. You can now log in.\",\n        });\n      } else {\n        const errorData = await response.json();\n        setVerificationStatus('error');\n        setMessage(errorData.error || 'Failed to verify email');\n      }\n    } catch (error) {\n      setVerificationStatus('error');\n      setMessage('Failed to verify email. Please try again.');\n    }\n  };\n\n  const handleLoginRedirect = () => {\n    setLocation('/auth');\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center p-4\">\n      <Card className=\"w-full max-w-md bg-slate-800 border-slate-700\">\n        <CardHeader className=\"text-center\">\n          <div className=\"mx-auto mb-4 p-3 rounded-full w-fit\">\n            {verificationStatus === 'idle' && (\n              <div className=\"bg-blue-100 p-3 rounded-full\">\n                <Mail className=\"h-8 w-8 text-blue-600\" />\n              </div>\n            )}\n            {verificationStatus === 'loading' && (\n              <div className=\"bg-blue-100 p-3 rounded-full\">\n                <Mail className=\"h-8 w-8 text-blue-600\" />\n              </div>\n            )}\n            {verificationStatus === 'success' && (\n              <div className=\"bg-green-100 p-3 rounded-full\">\n                <CheckCircle className=\"h-8 w-8 text-green-600\" />\n              </div>\n            )}\n            {verificationStatus === 'error' && (\n              <div className=\"bg-red-100 p-3 rounded-full\">\n                <XCircle className=\"h-8 w-8 text-red-600\" />\n              </div>\n            )}\n          </div>\n          <CardTitle className=\"text-white text-xl\">\n            {(verificationStatus === 'idle' || verificationStatus === 'loading') && 'Verify Your Email'}\n            {verificationStatus === 'success' && 'Email Verified!'}\n            {verificationStatus === 'error' && 'Verification Failed'}\n          </CardTitle>\n          <CardDescription className=\"text-slate-300\">\n            {(verificationStatus === 'idle' || verificationStatus === 'loading') && 'Enter the 6-digit code we sent to your email'}\n            {verificationStatus === 'success' && 'Your account has been successfully verified'}\n            {verificationStatus === 'error' && 'There was an issue verifying your email'}\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {(verificationStatus === 'idle' || verificationStatus === 'loading') && (\n            <div className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"verificationCode\" className=\"text-slate-300\">Verification Code</Label>\n                <Input\n                  id=\"verificationCode\"\n                  type=\"text\"\n                  placeholder=\"Enter 6-digit code\"\n                  value={verificationCode}\n                  onChange={(e) => setVerificationCode(e.target.value.replace(/\\D/g, '').slice(0, 6))}\n                  className=\"bg-slate-700 border-slate-600 text-white text-center text-2xl font-mono letter-spacing-wide\"\n                  maxLength={6}\n                  autoComplete=\"off\"\n                />\n              </div>\n              <Button\n                onClick={handleVerifyCode}\n                disabled={verificationStatus === 'loading'}\n                className=\"w-full bg-primary hover:bg-primary/90\"\n              >\n                {verificationStatus === 'loading' ? 'Verifying...' : 'Verify Email'}\n              </Button>\n            </div>\n          )}\n          \n          {(verificationStatus === 'success' || verificationStatus === 'error') && (\n            <Alert className={`${\n              verificationStatus === 'success' ? 'bg-green-900 border-green-700' : \n              'bg-red-900 border-red-700'\n            }`}>\n              <AlertDescription className={`${\n                verificationStatus === 'success' ? 'text-green-300' : 'text-red-300'\n              }`}>\n                {message}\n              </AlertDescription>\n            </Alert>\n          )}\n          \n          {verificationStatus !== 'loading' && (\n            <div className=\"flex flex-col gap-2\">\n              <Button\n                onClick={handleLoginRedirect}\n                variant=\"outline\"\n                className=\"w-full border-slate-600 text-slate-300 hover:bg-slate-700\"\n              >\n                {verificationStatus === 'success' ? 'Continue to Login' : 'Back to Login'}\n              </Button>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":6415},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1419},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }","size_bytes":1127},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":1901},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","size_bytes":1858},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/dialog.tsx":{"content":"import * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { cn } from \"@/lib/utils\"\nimport { X } from \"lucide-react\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n  DialogClose,\n}","size_bytes":3832},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-[9999] max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7613},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":791},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5742},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/components/ui/sidebar.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { VariantProps, cva } from \"class-variance-authority\"\nimport { PanelLeft } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    defaultOpen?: boolean\n    open?: boolean\n    onOpenChange?: (open: boolean) => void\n  }\n>(\n  (\n    {\n      defaultOpen = true,\n      open: openProp,\n      onOpenChange: setOpenProp,\n      className,\n      style,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const isMobile = useIsMobile()\n    const [openMobile, setOpenMobile] = React.useState(false)\n\n    // This is the internal state of the sidebar.\n    // We use openProp and setOpenProp for control from outside the component.\n    const [_open, _setOpen] = React.useState(defaultOpen)\n    const open = openProp ?? _open\n    const setOpen = React.useCallback(\n      (value: boolean | ((value: boolean) => boolean)) => {\n        const openState = typeof value === \"function\" ? value(open) : value\n        if (setOpenProp) {\n          setOpenProp(openState)\n        } else {\n          _setOpen(openState)\n        }\n\n        // This sets the cookie to keep the sidebar state.\n        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n      },\n      [setOpenProp, open]\n    )\n\n    // Helper to toggle the sidebar.\n    const toggleSidebar = React.useCallback(() => {\n      return isMobile\n        ? setOpenMobile((open) => !open)\n        : setOpen((open) => !open)\n    }, [isMobile, setOpen, setOpenMobile])\n\n    // Adds a keyboard shortcut to toggle the sidebar.\n    React.useEffect(() => {\n      const handleKeyDown = (event: KeyboardEvent) => {\n        if (\n          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n          (event.metaKey || event.ctrlKey)\n        ) {\n          event.preventDefault()\n          toggleSidebar()\n        }\n      }\n\n      window.addEventListener(\"keydown\", handleKeyDown)\n      return () => window.removeEventListener(\"keydown\", handleKeyDown)\n    }, [toggleSidebar])\n\n    // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n    // This makes it easier to style the sidebar with Tailwind classes.\n    const state = open ? \"expanded\" : \"collapsed\"\n\n    const contextValue = React.useMemo<SidebarContextProps>(\n      () => ({\n        state,\n        open,\n        setOpen,\n        isMobile,\n        openMobile,\n        setOpenMobile,\n        toggleSidebar,\n      }),\n      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n    )\n\n    return (\n      <SidebarContext.Provider value={contextValue}>\n        <TooltipProvider delayDuration={0}>\n          <div\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH,\n                \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n                ...style,\n              } as React.CSSProperties\n            }\n            className={cn(\n              \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\n              className\n            )}\n            ref={ref}\n            {...props}\n          >\n            {children}\n          </div>\n        </TooltipProvider>\n      </SidebarContext.Provider>\n    )\n  }\n)\nSidebarProvider.displayName = \"SidebarProvider\"\n\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    side?: \"left\" | \"right\"\n    variant?: \"sidebar\" | \"floating\" | \"inset\"\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n  }\n>(\n  (\n    {\n      side = \"left\",\n      variant = \"sidebar\",\n      collapsible = \"offcanvas\",\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n    if (collapsible === \"none\") {\n      return (\n        <div\n          className={cn(\n            \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\n            className\n          )}\n          ref={ref}\n          {...props}\n        >\n          {children}\n        </div>\n      )\n    }\n\n    if (isMobile) {\n      return (\n        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n          <SheetContent\n            data-sidebar=\"sidebar\"\n            data-mobile=\"true\"\n            className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n              } as React.CSSProperties\n            }\n            side={side}\n          >\n            <SheetHeader className=\"sr-only\">\n              <SheetTitle>Sidebar</SheetTitle>\n              <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n            </SheetHeader>\n            <div className=\"flex h-full w-full flex-col\">{children}</div>\n          </SheetContent>\n        </Sheet>\n      )\n    }\n\n    return (\n      <div\n        ref={ref}\n        className=\"group peer hidden text-sidebar-foreground md:block\"\n        data-state={state}\n        data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n        data-variant={variant}\n        data-side={side}\n      >\n        {/* This is what handles the sidebar gap on desktop */}\n        <div\n          className={cn(\n            \"relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear\",\n            \"group-data-[collapsible=offcanvas]:w-0\",\n            \"group-data-[side=right]:rotate-180\",\n            variant === \"floating\" || variant === \"inset\"\n              ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\n          )}\n        />\n        <div\n          className={cn(\n            \"fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex\",\n            side === \"left\"\n              ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n              : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n            // Adjust the padding for floating and inset variants.\n            variant === \"floating\" || variant === \"inset\"\n              ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n            className\n          )}\n          {...props}\n        >\n          <div\n            data-sidebar=\"sidebar\"\n            className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\n          >\n            {children}\n          </div>\n        </div>\n      </div>\n    )\n  }\n)\nSidebar.displayName = \"Sidebar\"\n\nconst SidebarTrigger = React.forwardRef<\n  React.ElementRef<typeof Button>,\n  React.ComponentProps<typeof Button>\n>(({ className, onClick, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeft />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n})\nSidebarTrigger.displayName = \"SidebarTrigger\"\n\nconst SidebarRail = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\">\n>(({ className, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <button\n      ref={ref}\n      data-sidebar=\"rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarRail.displayName = \"SidebarRail\"\n\nconst SidebarInset = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"main\">\n>(({ className, ...props }, ref) => {\n  return (\n    <main\n      ref={ref}\n      className={cn(\n        \"relative flex w-full flex-1 flex-col bg-background\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInset.displayName = \"SidebarInset\"\n\nconst SidebarInput = React.forwardRef<\n  React.ElementRef<typeof Input>,\n  React.ComponentProps<typeof Input>\n>(({ className, ...props }, ref) => {\n  return (\n    <Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInput.displayName = \"SidebarInput\"\n\nconst SidebarHeader = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarHeader.displayName = \"SidebarHeader\"\n\nconst SidebarFooter = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarFooter.displayName = \"SidebarFooter\"\n\nconst SidebarSeparator = React.forwardRef<\n  React.ElementRef<typeof Separator>,\n  React.ComponentProps<typeof Separator>\n>(({ className, ...props }, ref) => {\n  return (\n    <Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n      {...props}\n    />\n  )\n})\nSidebarSeparator.displayName = \"SidebarSeparator\"\n\nconst SidebarContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarContent.displayName = \"SidebarContent\"\n\nconst SidebarGroup = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarGroup.displayName = \"SidebarGroup\"\n\nconst SidebarGroupLabel = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\n\nconst SidebarGroupAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\n\nconst SidebarGroupContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"group-content\"\n    className={cn(\"w-full text-sm\", className)}\n    {...props}\n  />\n))\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\n\nconst SidebarMenu = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu\"\n    className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n    {...props}\n  />\n))\nSidebarMenu.displayName = \"SidebarMenu\"\n\nconst SidebarMenuItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    data-sidebar=\"menu-item\"\n    className={cn(\"group/menu-item relative\", className)}\n    {...props}\n  />\n))\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    isActive?: boolean\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(\n  (\n    {\n      asChild = false,\n      isActive = false,\n      variant = \"default\",\n      size = \"default\",\n      tooltip,\n      className,\n      ...props\n    },\n    ref\n  ) => {\n    const Comp = asChild ? Slot : \"button\"\n    const { isMobile, state } = useSidebar()\n\n    const button = (\n      <Comp\n        ref={ref}\n        data-sidebar=\"menu-button\"\n        data-size={size}\n        data-active={isActive}\n        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n        {...props}\n      />\n    )\n\n    if (!tooltip) {\n      return button\n    }\n\n    if (typeof tooltip === \"string\") {\n      tooltip = {\n        children: tooltip,\n      }\n    }\n\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\n        <TooltipContent\n          side=\"right\"\n          align=\"center\"\n          hidden={state !== \"collapsed\" || isMobile}\n          {...tooltip}\n        />\n      </Tooltip>\n    )\n  }\n)\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\n\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    showOnHover?: boolean\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\n\nconst SidebarMenuBadge = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"menu-badge\"\n    className={cn(\n      \"pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground\",\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n      \"peer-data-[size=sm]/menu-button:top-1\",\n      \"peer-data-[size=default]/menu-button:top-1.5\",\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\n\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    showIcon?: boolean\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[--skeleton-width] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n})\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\n\nconst SidebarMenuSub = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu-sub\"\n    className={cn(\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\n\nconst SidebarMenuSubItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ ...props }, ref) => <li ref={ref} {...props} />)\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\n\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<\"a\"> & {\n    asChild?: boolean\n    size?: \"sm\" | \"md\"\n    isActive?: boolean\n  }\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":23567},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-1.5 w-full grow overflow-hidden rounded-full bg-slate-900/20\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-slate-900 dark:bg-slate-50\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-4 w-4 rounded-full border border-slate-200 border-slate-900/50 bg-white shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-slate-950 disabled:pointer-events-none disabled:opacity-50 dark:border-slate-800 dark:border-slate-50/50 dark:bg-slate-950 dark:focus-visible:ring-slate-300\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }","size_bytes":1174},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitive from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitive.Root\n    className={cn(\n      \"peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-950 focus-visible:ring-offset-2 focus-visible:ring-offset-white disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-slate-900 data-[state=unchecked]:bg-slate-200 dark:focus-visible:ring-slate-300 dark:focus-visible:ring-offset-slate-950 dark:data-[state=checked]:bg-slate-50 dark:data-[state=unchecked]:bg-slate-800\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitive.Thumb\n      className={cn(\n        \"pointer-events-none block h-4 w-4 rounded-full bg-white shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0 dark:bg-slate-950\"\n      )}\n    />\n  </SwitchPrimitive.Root>\n))\nSwitch.displayName = SwitchPrimitive.Root.displayName\n\nexport { Switch }","size_bytes":1313},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }","size_bytes":1881},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209}},"version":1}